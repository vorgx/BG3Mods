WH.deepFreeze=e=>{"use strict";if(Object.isFrozen(e)){return e}const t=Object.getOwnPropertyNames(e);for(const a of t){const t=e[a];if(t&&typeof t==="object"){WH.deepFreeze(t)}}return Object.freeze(e)};(function(){function e(e){var t=true;var a=false;var i=null;var n={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};function s(e){if(e&&e!==document&&e.nodeName!=="HTML"&&e.nodeName!=="BODY"&&"classList"in e&&"contains"in e.classList){return true}return false}function r(e){var t=e.type;var a=e.tagName;if(a==="INPUT"&&n[t]&&!e.readOnly){return true}if(a==="TEXTAREA"&&!e.readOnly){return true}if(e.isContentEditable){return true}return false}function o(e){if(e.classList.contains("focus-visible")){return}e.classList.add("focus-visible");e.setAttribute("data-focus-visible-added","")}function l(e){if(!e.hasAttribute("data-focus-visible-added")){return}e.classList.remove("focus-visible");e.removeAttribute("data-focus-visible-added")}function c(a){if(a.metaKey||a.altKey||a.ctrlKey){return}if(s(e.activeElement)){o(e.activeElement)}t=true}function u(e){t=false}function d(e){if(!s(e.target)){return}if(t||r(e.target)){o(e.target)}}function f(e){if(!s(e.target)){return}if(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added")){a=true;window.clearTimeout(i);i=window.setTimeout((function(){a=false}),100);l(e.target)}}function h(e){if(document.visibilityState==="hidden"){if(a){t=true}p()}}function p(){document.addEventListener("mousemove",H);document.addEventListener("mousedown",H);document.addEventListener("mouseup",H);document.addEventListener("pointermove",H);document.addEventListener("pointerdown",H);document.addEventListener("pointerup",H);document.addEventListener("touchmove",H);document.addEventListener("touchstart",H);document.addEventListener("touchend",H)}function m(){document.removeEventListener("mousemove",H);document.removeEventListener("mousedown",H);document.removeEventListener("mouseup",H);document.removeEventListener("pointermove",H);document.removeEventListener("pointerdown",H);document.removeEventListener("pointerup",H);document.removeEventListener("touchmove",H);document.removeEventListener("touchstart",H);document.removeEventListener("touchend",H)}function H(e){if(e.target.nodeName&&e.target.nodeName.toLowerCase()==="html"){return}t=false;m()}document.addEventListener("keydown",c,true);document.addEventListener("mousedown",u,true);document.addEventListener("pointerdown",u,true);document.addEventListener("touchstart",u,true);document.addEventListener("visibilitychange",h,true);p();e.addEventListener("focus",d,true);e.addEventListener("blur",f,true);if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host){e.host.setAttribute("data-js-focus-visible","")}else if(e.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}if(typeof window!=="undefined"&&typeof document!=="undefined"){window.applyFocusVisiblePolyfill=e;var t;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){t=document.createEvent("CustomEvent");t.initCustomEvent("focus-visible-polyfill-ready",false,false,{})}window.dispatchEvent(t)}if(typeof document!=="undefined"){e(document)}})();
/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */(function(e,t,a){var i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)};var n=function(){var i={};var n=t.createElement("div").style;var s=function(){var e=["t","webkitT","MozT","msT","OT"],t,a=0,i=e.length;for(;a<i;a++){t=e[a]+"ransform";if(t in n)return e[a].substr(0,e[a].length-1)}return false}();function r(e){if(s===false)return false;if(s==="")return e;return s+e.charAt(0).toUpperCase()+e.substr(1)}i.getTime=Date.now||function e(){return(new Date).getTime()};i.extend=function(e,t){for(var a in t){e[a]=t[a]}};i.addEvent=function(e,t,a,i){e.addEventListener(t,a,!!i)};i.removeEvent=function(e,t,a,i){e.removeEventListener(t,a,!!i)};i.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t};i.momentum=function(e,t,i,n,s,r){var o=e-t,l=a.abs(o)/i,c,u;r=r===undefined?6e-4:r;c=e+l*l/(2*r)*(o<0?-1:1);u=l/r;if(c<n){c=s?n-s/2.5*(l/8):n;o=a.abs(c-e);u=o/l}else if(c>0){c=s?s/2.5*(l/8):0;o=a.abs(e)+c;u=o/l}return{destination:a.round(c),duration:u}};var o=r("transform");i.extend(i,{hasTransform:o!==false,hasPerspective:r("perspective")in n,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:r("transition")in n});i.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion);i.extend(i.style={},{transform:o,transitionTimingFunction:r("transitionTimingFunction"),transitionDuration:r("transitionDuration"),transitionDelay:r("transitionDelay"),transformOrigin:r("transformOrigin")});i.hasClass=function(e,t){var a=new RegExp("(^|\\s)"+t+"(\\s|$)");return a.test(e.className)};i.addClass=function(e,t){if(i.hasClass(e,t)){return}var a=e.className.split(" ");a.push(t);e.className=a.join(" ")};i.removeClass=function(e,t){if(!i.hasClass(e,t)){return}var a=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(a," ")};i.offset=function(e){var t=-e.offsetLeft,a=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;a-=e.offsetTop}return{left:t,top:a}};i.preventDefaultException=function(e,t){for(var a in t){if(t[a].test(e[a])){return true}}return false};i.extend(i.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});i.extend(i.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return a.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e=e-1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){if((e/=1)<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}}},elastic:{style:"",fn:function(e){var t=.22,i=.4;if(e===0){return 0}if(e==1){return 1}return i*a.pow(2,-10*e)*a.sin((e-t/4)*(2*a.PI)/t)+1}}});i.tap=function(e,a){var i=t.createEvent("Event");i.initEvent(a,true,true);i.pageX=e.pageX;i.pageY=e.pageY;e.target.dispatchEvent(i)};i.click=function(e){var a=e.target,i;if(!/(SELECT|INPUT|TEXTAREA)/i.test(a.tagName)){i=t.createEvent("MouseEvents");i.initMouseEvent("click",true,true,e.view,1,a.screenX,a.screenY,a.clientX,a.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);i._constructed=true;a.dispatchEvent(i)}};return i}();function s(e,a){this.wrapper=typeof e=="string"?t.querySelector(e):e;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var i in a){this.options[i]=a[i]}this.translateZ=this.options.HWCompositing&&n.hasPerspective?" translateZ(0)":"";this.options.useTransition=n.hasTransition&&this.options.useTransition;this.options.useTransform=n.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?n.ease[this.options.bounceEasing]||n.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}s.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(e){if(n.eventType[e.type]!=1){if(e.button!==0){return}}if(!this.enabled||this.initiated&&n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.isBadAndroid&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.touches?e.touches[0]:e,i;this.initiated=n.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=n.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;i=this.getComputedPosition();this._translate(a.round(i.x),a.round(i.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=t.pageX;this.pointY=t.pageY;this._execEvent("beforeScrollStart")},_move:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault){e.preventDefault()}var t=e.touches?e.touches[0]:e,i=t.pageX-this.pointX,s=t.pageY-this.pointY,r=n.getTime(),o,l,c,u;this.pointX=t.pageX;this.pointY=t.pageY;this.distX+=i;this.distY+=s;c=a.abs(this.distX);u=a.abs(this.distY);if(r-this.endTime>300&&(c<10&&u<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(c>u+this.options.directionLockThreshold){this.directionLocked="h"}else if(u>=c+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){e.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}s=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){e.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}i=0}i=this.hasHorizontalScroll?i:0;s=this.hasVerticalScroll?s:0;o=this.x+i;l=this.y+s;if(o>0||o<this.maxScrollX){o=this.options.bounce?this.x+i/3:o>0?0:this.maxScrollX}if(l>0||l<this.maxScrollY){l=this.options.bounce?this.y+s/3:l>0?0:this.maxScrollY}this.directionX=i>0?-1:i<0?1:0;this.directionY=s>0?-1:s<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(o,l);if(r-this.startTime>300){this.startTime=r;this.startX=this.x;this.startY=this.y}},_end:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.changedTouches?e.changedTouches[0]:e,i,s,r=n.getTime()-this.startTime,o=a.round(this.x),l=a.round(this.y),c=a.abs(o-this.startX),u=a.abs(l-this.startY),d=0,f="";this.isInTransition=0;this.initiated=0;this.endTime=n.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(o,l);if(!this.moved){if(this.options.tap){n.tap(e,this.options.tap)}if(this.options.click){n.click(e)}this._execEvent("scrollCancel");return}if(this._events.flick&&r<200&&c<100&&u<100){this._execEvent("flick");return}if(this.options.momentum&&r<300){i=this.hasHorizontalScroll?n.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0};s=this.hasVerticalScroll?n.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:l,duration:0};o=i.destination;l=s.destination;d=a.max(i.duration,s.duration);this.isInTransition=1}if(o!=this.x||l!=this.y){if(o>0||o<this.maxScrollX||l>0||l<this.maxScrollY){f=n.ease.quadratic}this.scrollTo(o,l,d,f);return}this._execEvent("scrollEnd")},_resize:function(){var e=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout((function(){e.refresh()}),this.options.resizePolling)},resetPosition:function(e){var t=this.x,a=this.y;e=e||0;if(!this.hasHorizontalScroll||this.x>0){t=0}else if(this.x<this.maxScrollX){t=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){a=0}else if(this.y<this.maxScrollY){a=this.maxScrollY}if(t==this.x&&a==this.y){return false}this.scrollTo(t,a,e,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var e=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=n.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(e,t){if(!this._events[e]){this._events[e]=[]}this._events[e].push(t)},off:function(e,t){if(!this._events[e]){return}var a=this._events[e].indexOf(t);if(a>-1){this._events[e].splice(a,1)}},_execEvent:function(e){if(!this._events[e]){return}var t=0,a=this._events[e].length;if(!a){return}for(;t<a;t++){this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,a,i){e=this.x+e;t=this.y+t;a=a||0;this.scrollTo(e,t,a,i)},scrollTo:function(e,t,a,i){i=i||n.ease.circular;this.isInTransition=this.options.useTransition&&a>0;if(!a||this.options.useTransition&&i.style){this._transitionTimingFunction(i.style);this._transitionTime(a);this._translate(e,t)}else{this._animate(e,t,a,i.fn)}},scrollToElement:function(e,t,i,s,r){e=e.nodeType?e:this.scroller.querySelector(e);if(!e){return}var o=n.offset(e);o.left-=this.wrapperOffset.left;o.top-=this.wrapperOffset.top;if(i===true){i=a.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)}if(s===true){s=a.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)}o.left-=i||0;o.top-=s||0;o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left;o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top;t=t===undefined||t===null||t==="auto"?a.max(a.abs(this.x-o.left),a.abs(this.y-o.top)):t;this.scrollTo(o.left,o.top,t,r)},_transitionTime:function(e){e=e||0;this.scrollerStyle[n.style.transitionDuration]=e+"ms";if(!e&&n.isBadAndroid){this.scrollerStyle[n.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(e){this.scrollerStyle[n.style.transitionTimingFunction]=e},_translate:function(e,t){if(this.options.useTransform){this.scrollerStyle[n.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ}else{e=a.round(e);t=a.round(t);this.scrollerStyle.left=e+"px";this.scrollerStyle.top=t+"px"}this.x=e;this.y=t},_initEvents:function(t){var a=t?n.removeEvent:n.addEvent,i=this.options.bindToWrapper?this.wrapper:e;a(e,"orientationchange",this);a(e,"resize",this);if(this.options.click){a(this.wrapper,"click",this,true)}if(!this.options.disableMouse){a(this.wrapper,"mousedown",this);a(i,"mousemove",this);a(i,"mousecancel",this);a(i,"mouseup",this)}if(n.hasPointer&&!this.options.disablePointer){a(this.wrapper,n.prefixPointerEvent("pointerdown"),this);a(i,n.prefixPointerEvent("pointermove"),this);a(i,n.prefixPointerEvent("pointercancel"),this);a(i,n.prefixPointerEvent("pointerup"),this)}if(n.hasTouch&&!this.options.disableTouch){a(this.wrapper,"touchstart",this);a(i,"touchmove",this);a(i,"touchcancel",this);a(i,"touchend",this)}a(this.scroller,"transitionend",this);a(this.scroller,"webkitTransitionEnd",this);a(this.scroller,"oTransitionEnd",this);a(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t=e.getComputedStyle(this.scroller,null),a,i;if(this.options.useTransform){t=t[n.style.transform].split(")")[0].split(", ");a=+(t[12]||t[4]);i=+(t[13]||t[5])}else{a=+t.left.replace(/[^-\d.]/g,"");i=+t.top.replace(/[^-\d.]/g,"")}return{x:a,y:i}},_animate:function(e,t,a,s){var r=this,o=this.x,l=this.y,c=n.getTime(),u=c+a;function d(){var f=n.getTime(),h,p,m;if(f>=u){r.isAnimating=false;r._translate(e,t);if(!r.resetPosition(r.options.bounceTime)){r._execEvent("scrollEnd")}return}f=(f-c)/a;m=s(f);h=(e-o)*m+o;p=(t-l)*m+l;r._translate(h,p);if(r.isAnimating){i(d)}}this.isAnimating=true;d()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":if(!e._constructed){e.preventDefault();e.stopPropagation()}break}}};s.utils=n;if(typeof module!="undefined"&&module.exports){module.exports=s}else{e.IScroll=s}})(window,document,Math);var g_localTime=new Date;var g_blogimages={};function MessageBox(e,t){e.find(".wh-message-box").remove();var a=$("<div></div>");a.hide();a.addClass("wh-message-box");a.html('<div class="message">'+t+'</div><div class="close" title="Click on this box to close it"></div>');a.click((function(){$(this).fadeOut()}));e.append(a[0]);a.fadeIn()}function Rectangle(e,t,a,i){this.l=e;this.t=t;this.r=e+a;this.b=t+i}Rectangle.prototype={intersectWith:function(e){return!(this.l>=e.r||e.l>=this.r||this.t>=e.b||e.t>=this.b)},contains:function(e){return this.l<=e.l&&this.t<=e.t&&this.r>=e.r&&this.b>=e.b},containedIn:function(e){return e.contains(this)}};WH.onLoad((()=>{const e=WH.SessionStorage;if(!(window.JSON&&e.isSupported())){return}let t=e.get(e.KEY_LISTVIEW_BROWSE);if(!t)return;let a=/^\/[a-z-]+(=|\/([\w-]*-)?)\d+[^?&#]*/i;let i=a.exec(location.pathname);if(!i)return;i=i[0];var n=function(e,t){if(!t){return WH.ce("i",{className:"fa fa-"+e})}return WH.ce("a",{className:"fa fa-"+e,href:t})};for(var s=0;s<t.length;s++){var r=t[s].urls;for(var o=0;o<r.length;o++){if(r[o]==i){var l=o>0?r[o-1]:false;var c=o+1<r.length?r[o+1]:false;var u=t[s].path+t[s].hash;var d=WH.qs(".breadcrumb");if(!d){return}var f=WH.ce("div",{className:"breadcrumb-browse"});WH.ae(d,f);var h=n("arrow-circle-up",u);WH.Tooltips.attach(h,WH.TERMS.backtolist,"q2",{noWrap:true});WH.ae(f,n("arrow-circle-left",l));WH.ae(f,h);WH.ae(f,n("arrow-circle-right",c));return}}}}));WH.smoothScroll=function(e,t){switch(typeof e){case"string":case"object":case"jQuery":var a=$(e).offset();if(!a){return}e=a.top;break;case"number":break;default:return}if(ZUL.getEnabled()){e-=50}else{e-=10}$("html, body").animate({scrollTop:e},t||500)};WH.getReputationPlusAchievementText=function(e,t,a,i){var n=WH.getAchievementText(e,t,a,true);var s=$("<span>").addClass("wsach-pts");s.mouseover((function(e){WH.Tooltips.showAtCursor(e,WH.TERMS.reputationtip,"q")})).mousemove((function(e){WH.Tooltips.cursorUpdate(e)})).mouseout((function(){WH.Tooltips.hide()}));s.addClass("q1");s.text(WH.numberFormat(i));var r=$("<span>");r.append(" (");r.append(s);r.append(" &ndash; ");r.append(n);r.append(") ");return r};WH.getAchievementText=function(e,t,a,i){var n=$("<span>").addClass("wsach-pts");n.mouseover((function(e){WH.Tooltips.showAtCursor(e,WH.TERMS.userachcount_tip,"q")})).mousemove((function(e){WH.Tooltips.cursorUpdate(e)})).mouseout((function(){WH.Tooltips.hide()}));var s=" ";if(!i){s+=" ("}if(e){s+="<i>"+e+"</i>"+"&middot;"}if(t){s+="<b>"+t+"</b>"+"&middot;"}if(!a){a=0}s+="<u>"+a+"</u>";if(!i){s+=")"}n.html(s);return n};WH.formatTimeElapsed=function(e,t=false){const a={abbreviated:[WH.TERMS.year_abbrev,WH.TERMS.month_abbrev,WH.TERMS.week_abbrev,WH.TERMS.day_abbrev,WH.TERMS.hour_abbrev,WH.TERMS.minute_abbrev,WH.TERMS.second_abbrev],singular:[WH.TERMS.year_lc,WH.TERMS.month_lc,WH.TERMS.week_lc,WH.TERMS.day_lc,WH.TERMS.hour_lc,WH.TERMS.minute_lc,WH.TERMS.second_lc],plural:[WH.TERMS.years_lc,WH.TERMS.months_lc,WH.TERMS.weeks_lc,WH.TERMS.days_lc,WH.TERMS.hours_lc,WH.TERMS.minutes_lc,WH.TERMS.seconds_lc]};function i(e,t,i){if(i){return e+" "+a.abbreviated[t]}else{return e+" "+(e==1?a.singular[t]:a.plural[t])}}var n=[31557600,2629800,604800,86400,3600,60,1];var s=[1,3,3,-1,5,-1,-1];e=Math.max(e,1);for(var r=3,o=n.length;r<o;++r){if(e>=n[r]){var l=r;var c=Math.floor(e/n[l]);if(s[l]!=-1){var u=s[l];e%=n[l];var d=Math.floor(e/n[u]);if(d>0){return i(c,l,1)+" "+i(d,u,1)}}return i(c,l,t)}}return"(n/a)"};WH.formatDate=function(e,t,a,i,n){var s=new Date;var r=new Date;r.setTime(s.getTime()-1e3*t);var o;var l=new Date(r.getYear(),r.getMonth(),r.getDate());var c=new Date(s.getYear(),s.getMonth(),s.getDate());var u=c.getTime()-l.getTime();u/=1e3;u/=86400;u=Math.round(u);if(t>=2592e3||t<0){o=WH.TERMS.on_lc+WH.formatDateSimple(a,i)}else if(u>1){o=WH.sprintf(WH.TERMS.daysago_format,u);if(e){var d=new Date;d.setTime(a.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else if(t>=43200){if(s.getDay()==r.getDay()){o=WH.TERMS.today_lc}else{o=WH.TERMS.yesterday_lc}o=WH.formatTimeSimple(r,o);if(e){var d=new Date;d.setTime(a.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else{o=WH.sprintf(WH.TERMS.ago2_format,WH.formatTimeElapsed(t));if(e){var d=new Date;d.setTime(a.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}if(n==1){o=o.substr(0,1).toUpperCase()+o.substr(1)}if(e){WH.ae(e,WH.ct(o))}else{return o}};WH.formatDateSimple=function(e,t){function a(e){return e<10?"0"+e:e}var i="",n=e.getDate(),s=e.getMonth()+1,r=e.getFullYear();if(r<=1970){i+=WH.TERMS.unknowndate_stc}else{i+=WH.sprintf(WH.TERMS.date3_format,a(n),a(s),r)}if(t!=null){i=WH.formatTimeSimple(e,i)}return i};WH.formatTimeSimple=function(e,t,a){function i(e){return e<10?"0"+e:e}var n=e.getHours(),s=e.getMinutes();if(t==null){t=""}t+=a?" ":WH.TERMS.at_lc;if(n==12){t+=WH.TERMS.noon_lc}else if(n==0){t+=WH.TERMS.midnight_lc}else if(n>12){t+=n-12+":"+i(s)+" "+WH.TERMS.pm}else{t+=n+":"+i(s)+" "+WH.TERMS.am}return t};WH.formatStartEndDates=function(e,t){if(!e&&!t){return""}var a=false;var i=false;if(e)a=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());if(t)i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());var n="";if(!i){n=WH.TERMS.starts+" "+a.toLocaleDateString()}else if(!a){n=WH.TERMS.ends+" "+i.toLocaleDateString()}else{var s=function(){try{(new Date).toLocaleDateString("i")}catch(e){return e.name==="RangeError"}return false}();var r={month:"long",year:"numeric"};var o="",l="",c=0;if(s&&a.getDate()==1){o=a.toLocaleDateString(undefined,r);c++}else{o=a.toLocaleDateString()}if(s&&new Date(i.valueOf()+36*60*60*1e3).getMonth()!=i.getMonth()){l=i.toLocaleDateString(undefined,r);c++}else{l=i.toLocaleDateString()}if(o==l){n=o}else if(c==1){n=a.toLocaleDateString()+" - "+i.toLocaleDateString()}else{n=o+" - "+l}}return n};WH.createProgressBar=function(e){if(e==null)e={};if(typeof e.text=="undefined"){e.text=" "}if(e.color==null){e.color="rep0"}if(e.width==null||e.width>100){e.width=100}var t,a;if(e.hoverText){t=WH.ce("a");t.href="javascript:"}else{t=WH.ce("span")}t.className="progressbar";if(e.text||e.hoverText){a=WH.ce("div");a.className="progressbar-text";if(e.text){var i=WH.ce("del");WH.ae(i,WH.ct(e.text));WH.ae(a,i)}if(e.hoverText){var n=WH.ce("ins");WH.ae(n,WH.ct(e.hoverText));WH.ae(a,n)}WH.ae(t,a)}a=WH.ce("div");a.className="progressbar-"+e.color;a.style.width=e.width+"%";if(e.height){a.style.height=e.height}WH.ae(a,WH.ct(WH.Strings.nbsp));WH.ae(t,a);if(e.text){var a=WH.ce("div");a.className="progressbar-text progressbar-hidden";WH.ae(a,WH.ct(e.text));WH.ae(t,a)}return t};WH.createReputationBar=function(e,t){if(!t){t=0}var a=WH.getReputationProgress(t);var i=a.length>0?a[a.length-1][1]+999:0;if(!e)e=0;if(e<0){e=0}else if(e>i){e=i}var n=e,s=0,r,o=i;if(i!=0){while(s<a.length){if(e<a[s][1]){break}++s}--s;n-=a[s][1];o=s+1<a.length?a[s+1][1]-a[s][1]:999}if(t){r=WH.Wow.Faction.getFriendshipName(t,s)}else{r=WH.Wow.Faction.getRankName(s)}var l={text:r,hoverText:n+" / "+o,color:"rep"+s,width:parseInt(n/o*100)};return WH.createProgressBar(l)};WH.getReputationProgress=function(e){if(window.g_friendships_thresholds&&Array.isArray(g_friendships_thresholds[e])){return g_friendships_thresholds[e]}return[[0,0],[0,36e3],[0,39e3],[0,42e3],[0,45e3],[0,51e3],[0,63e3],[0,84e3]]};WH.createAchievementBar=function(e,t,a,i){if(!e){e=0}var n={text:e+(i>0?"(+"+i+")":"")+(t>0?" / "+t:""),color:a?"rep7":"ach"+(t>0?0:1),width:t>0?parseInt(e/t*100):100};return WH.createProgressBar(n)};WH.addCompletionIcons=function(e,t,a,i){var n=0;let s;if(t===WH.Types.TRANSMOG_SET){s=typeof a==="object"?a:WH.getPageData("transmog-set-detail-completion")}for(var r in g_user.lists){if(!g_user.lists.hasOwnProperty(r)){continue}let o=g_user.lists[r];if(!o.character){continue}let l=0;if(t===WH.Types.TRANSMOG_SET){l=WH.Wow.TransmogSet.getCompletionAmount(s,o.id);if(l==null){continue}}else{let e=WH.User.Completion.getByType(t);if(!e.hasOwnProperty(o.id)){continue}l=e[o.id].includes(a)?1:0}if(i&&!l){continue}WH.ae(e,WH.createCompletionIcon(o,l));n++}if(t===WH.Types.QUEST&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var o,r=0;o=g_user.characterProfiles[r];r++){var l=WH.inArray(o.quests,a)!=-1;if(i&&!l){continue}WH.ae(e,WH.createCompletionIcon({classs:o["class"],character:o.name,realm:o.realm},l?1:0));n++}}return n};WH.createCompletionIcon=function(e,t,a){var i=WH.ce("a");if(e.url){i.href=WH.Profiler.getPath(e)}i.className="progress-icon progress-"+(t?Math.max(1,Math.floor(t*8)):0);WH.Tooltips.attach(i,WH.getCompletionTooltip(e,t));if(a){i.rel=a}return i};WH.getCompletionTooltip=function(e,t){let a=WH.ce("div");WH.ae(a,WH.ce("span",{className:"q"},WH.ct((t>=1?WH.TERMS.complete:WH.TERMS.incomplete)+WH.TERMS.colon_punct)));WH.ae(a,WH.ce("br"));let i=WH.ce("span",{style:{whiteSpace:"nowrap"}});WH.ae(a,i);WH.ae(i,WH.ce("b",{className:"c"+e.classs},WH.ct(e.character)));let n=[WH.Strings.nbsp,e.realm];if(e.hasOwnProperty("region")){n.push(e.region)}WH.ae(i,WH.ce("span",{className:"q0"},WH.ct(n.join(" "))));if(t>0&&t<1){WH.ae(i,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",Math.round(t*100)+"%")))}return a.innerHTML};WH.getCompletionFlags=function(e,t){var a=0;var i=g_user.lists||[];let n=WH.User.Completion.getByType(e);for(var s=i.length-1;s>=0;s--){var r=i[s];if(!(r.id in n)||!r.character){continue}a=a<<1|(n[r.id].includes(t)?1:0)}if(e==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var s=g_user.characterProfiles.length-1;s>=0;s--){var o=g_user.characterProfiles[s];var l=WH.inArray(o.quests,t)!=-1;a=a<<1|(l?1:0)}}return a};WH.preventPageScroll=function(e){var t=e.originalEvent&&e.originalEvent.wheelDelta||e.originalEvent&&-e.originalEvent.detail||e.wheelDelta||-e.detail;this.scrollTop+=(t<0?1:-1)*100;e.preventDefault()};WH.pickerWheel=function(e){e.preventDefault();if(e.deltaY>0){this.scrollTop+=100}else{this.scrollTop-=100}};WH.setSelectedLink=function(e,t){if(!WH.setSelectedLink.groups){WH.setSelectedLink.groups={}}var a=WH.setSelectedLink.groups;if(a[t]){a[t].className=a[t].className.replace("selected","")}e.className+=" selected";a[t]=e};WH.addPagination=function(e,t){function a(e,a){var i;if(e==t.page){i=WH.ce("span");i.className="selected"}else{i=WH.ce("a");i.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}WH.ae(i,WH.ct(a!=null?a:e));return i}if(!t.pound){t.pound=""}if(!t.sep){t.sep="."}if(t.allOrNothing&&t.nPages<=1){return}var i=t.align&&t.align=="left";var n=WH.ce("div"),s,r=WH.ce("var");n.className="pages";if(i){n.className+=" pages-left"}if(t.nPages>1){s=WH.ce("div");s.className="pages-numbers";var o=Math.max(2,t.page-2);var l=Math.min(t.nPages-1,t.page+2);var c=[];if(t.page!=t.nPages){c.push(a(t.page+1,String.fromCharCode(187)))}c.push(a(t.nPages));if(l<t.nPages-1){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}for(var d=l;d>=o;--d){c.push(a(d))}if(o>2){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}c.push(a(1));if(t.page!=1){c.push(a(t.page-1,String.fromCharCode(171)))}if(i){c.reverse()}for(var d=0,f=c.length;d<f;++d){WH.ae(s,c[d])}s.firstChild.style.marginRight="0";s.lastChild.style.marginLeft="0"}var r=WH.ce("var");WH.ae(r,WH.ct(WH.Strings.sprintf(WH.TERMS[t.wording[t.nItems==1?0:1]],t.nItems)));if(t.nPages>1){var u=WH.ce("span");WH.ae(u,WH.ct(String.fromCharCode(8211)));WH.ae(r,u);var h=WH.ce("a");h.className="go-to-page fa fa-files-o";h.href="javascript:";h.onclick=function(){var e=prompt(WH.sprintf(WH.TERMS.gotopage_format,1,t.nPages),t.page);if(e!=null){e|=0;if(e!=t.page&&e>=1&&e<=t.nPages){document.location.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}}};h.onmouseover=function(e){WH.Tooltips.showAtCursor(e,WH.TERMS.gotopage_tip,"q2")};h.onmousemove=WH.Tooltips.cursorUpdate;h.onmouseout=WH.Tooltips.hide;WH.ae(r,h)}if(i){WH.ae(n,r);if(s){WH.ae(n,s)}}else{if(s){WH.ae(n,s)}WH.ae(n,r)}WH.ae(e,n)};WH.disclose=function(e,t){let a=WH.toggleDisplay(e,true);t.classList.remove("disclosure-"+(a?"off":"on"));t.classList.add("disclosure-"+(a?"on":"off"));return false};WH.toggle=function(e){let t=WH.toggleDisplay(e,true);this.classList.remove("toggler-"+(t?"off":"on"));this.classList.add("toggler-"+(t?"on":"off"));return false};WH.setupChangeWarning=(e,t,a)=>{if(!e){return}WH.aE(e,"submit",(()=>window.onbeforeunload=null));let i=[];for(let e in t){const n=t[e];if(!n){continue}i[e]=n.value;WH.aE(n,"keydown",(()=>{for(let e in t){const n=t[e];if(!n){continue}if(n.value!==i[e]){window.onbeforeunload=()=>a;return}window.onbeforeunload=null}}))}};$(document).ready((function(){WH.qsa("dfn[title]").forEach((function(e){let t=e.title;e.removeAttribute("title");e.classList.add("tip");WH.Tooltips.attach(e,t,"q",{byCursor:true,maxWidth:250})}));$(".text").bind("copy",(function(){$("*[unselectable]",this).each((function(e,t){var a=$(t).text();$(t).text("");setTimeout((function(){$(t).text(a)}),1)}))}))}));$(document).ready((function(){$("input").each((function(){var e=$(this).attr("maxlength");var t=$(this).attr("data-charwarning");var a=t?$("#"+t):null;if(!e||!a){return}var i=function(){a.hide()};var n=function(t){var i=e-t;var n=t/e;var s=parseInt(n>=.5?255:n*2*255).toString(16);var r=parseInt(n<.5?255:255-(n-.5)*2*255).toString(16);if(s.length==1){s="0"+s}if(r.length==1){r="0"+r}a.text(WH.sprintf(WH.TERMS.charactersremaining_format,i));a.show();a.css("color","#"+s+r+"00")};$(this).focus((function(){n($(this).val().length)})).blur((function(){i()})).keyup((function(){n($(this).val().length)}))}))}));WH.getN5=function(e){var t=Math.abs(e);if(t<1e4){return WH.numberFormat(e)}if(t<1e5){return Math.round(e/100)/10+"k"}if(t<1e6){return Math.round(e/1e3)+"k"}if(t<1e7){return Math.round(e/1e3/10)/100+"m"}if(t<1e8){return Math.round(e/1e3/100)/10+"m"}if(t<1e9){return Math.round(e/1e3/1e3)+"m"}if(t<1e10){return Math.round(e/1e3/1e3/10)/100+"b"}if(t<1e10){return Math.round(e/1e3/1e3/100)/10+"b"}return Math.round(e/1e3/1e3/1e3)+"b"};WH.debug=function(e){if(!WH.isDev()&&!WH.User?.hasRole(WH.User.ROLE_ADMIN)){WH.debug=()=>{};return}WH.debug=function(){console.debug.apply(console.debug,Array.prototype.slice.call(arguments))};WH.debug.apply(WH,Array.prototype.slice.call(arguments))};WH.decodeNumber=function(e,t){var a=0;e=e+"";var i=1;while(e.length>0){var n=e.charAt(e.length-1);var s=t.indexOf(n);if(s===-1){return null}a+=s*i;i*=t.length;e=e.substr(0,e.length-1)}return a};WH.encodeNumber=function(e,t){var a=t.length;var i=[e];while(i[0]>a){var n=Math.floor(i[0]/a);i[0]=i[0]-n*a;i.unshift(n)}var s="";for(var r=0,o=i.length;r<o;r++){s+=t.charAt(i[r])}return s};WH.getThrownErrorMessage=function(e){if(typeof e==="string"){return e}return e&&[e.name,e.message].filter(Boolean).join(": ")||"Unknown error"};WH.userIsLoggedIn=function(){return typeof g_user=="object"&&g_user.id};WH.getElementViewportOffset=function(e){if(!(e instanceof jQuery)){e=$(e)}var t=e.offset().top;var a=t+e.outerHeight();var i=$(window);var n=i.scrollTop();var s=n+i.height();if(a>s){return a-s}if(t<n){return t-n}return 0};WH.onMutate=function(e,t,a){a=a||{};var i={observer:null};var n=a.triggerOnce?function(){i.observer.disconnect();t.apply(e)}:t.bind(e);var s={characterData:true,childList:true,subtree:true};["attributes","attributeFilter","characterData","childList","subtree"].forEach((e=>{if(a.hasOwnProperty(e)){s[e]=a[e]}}));var r=new MutationObserver(n);i.observer=r;r.observe(e,s)};WH.getMajorHeading=function(e,t,a,i){if(isNaN(t)||t<1||t>6){t=2}if(isNaN(a)||a<1||a>6){a=t}var n=["heading-size-"+a];return WH.constructHeading("h"+t,e,n,i)};WH.getImitationHeading=function(e,t,a){if(isNaN(t)||t<1||t>6){t=2}var i=["imitation-heading","heading-size-"+t];return WH.constructHeading("div",e,i,a)};WH.constructHeading=function(e,t,a,i){if(typeof i!="object"){i={}}if(typeof i.classes=="string"){a.push(i.classes)}var n=WH.ce(e);n.className=a.join(" ");if(typeof i.styles=="string"){n.style=i.styles}if(typeof i.id=="string"){n.id=i.id}if(typeof t=="string"){n.innerHTML=t}else if(t.nodeType===Node.ELEMENT_NODE||t.nodeType===Node.TEXT_NODE){n.appendChild(t)}else{$(n).append(t)}return n};WH.clickToCopy=function(e,t,a){a=a||{};WH.aE(e,"click",WH.clickToCopy.copy.bind(null,e,t,a));WH.preventSelectStart(e);e.classList.add("click-to-copy");if(a.modifyTooltip){e._fixTooltip=function(e){return e+"<br>"+WH.ce("span",{className:"q2",innerHTML:WH.clickToCopy.getTooltip(false,a)}).outerHTML};a.overrideOtherTooltips=false}WH.Tooltips.attach(e,WH.clickToCopy.getTooltip.bind(null,false,a),undefined,{byCursor:!a.attachToElement,stopPropagation:a.overrideOtherTooltips})};WH.clickToCopy.copy=function(e,t,a,i){i.preventDefault();i.stopPropagation();if(t===undefined){if(!e.childNodes[0]||!e.childNodes[0].textContent){let t="Could not find text to copy.";WH.error(t,e);if(a.attachToElement){WH.Tooltips.show(e,t,"q10")}else{WH.Tooltips.showAtCursor(i,t,"q10")}return}t=e.childNodes[0].textContent}else if(typeof t==="function"){t=t()}WH.copyToClipboard(t);if(a.attachToElement){WH.Tooltips.show(e,WH.clickToCopy.getTooltip(true,a))}else{WH.Tooltips.showAtCursor(i,WH.clickToCopy.getTooltip(true,a))}};WH.clickToCopy.getTooltip=function(e,t){let a="";let i=undefined;if(e){a=" "+WH.TERMS.copied;i={className:"q1 fa fa-check"}}else{a=WH.TERMS.clickToCopy}let n=WH.ce("div",i,WH.ct(a));if(t.prefix){n.style.marginTop="10px";let e=typeof t.prefix==="function"?t.prefix():t.prefix;return e+n.outerHTML}return n.outerHTML};WH.copyToClipboard=function(e,t){if(!WH.copyToClipboard.hiddenInput){WH.copyToClipboard.hiddenInput=WH.ce("textarea",{className:"hidden-element"});WH.ae(document.body,WH.copyToClipboard.hiddenInput)}WH.copyToClipboard.hiddenInput.value=e;let a=WH.copyToClipboard.hiddenInput.value==="";if(a){WH.copyToClipboard.hiddenInput.value=WH.TERMS.nothingToCopy_tip}WH.copyToClipboard.hiddenInput.focus();WH.copyToClipboard.hiddenInput.select();if(!document.execCommand("copy")){prompt(null,e)}WH.copyToClipboard.hiddenInput.blur();if(t){if(a){WH.Tooltips.showFadingTooltipAtCursor(WH.TERMS.nothingToCopy_tip,t,"q10")}else{let e=WH.ce("span",{className:"q1 fa fa-check"},WH.ct(" "+WH.TERMS.copied));WH.Tooltips.showFadingTooltipAtCursor(e.outerHTML,t)}}};WH.createRange=function(e,t){var a={};for(var i=e;i<=t;++i){a[i]=i}return a};WH.objectToArray=function(e,t){var a=[];for(var i in e){if(e.hasOwnProperty(i)){a.push({property:i,value:e[i]})}}if(t){a.sort((function(e,a){return WH.stringCompare(e[t],a[t])}))}return a};WH.sortIdArray=function(e,t,a){e.sort(a?function(e,i){return WH.stringCompare(t[e][a],t[i][a])}:function(e,a){return WH.stringCompare(t[e],t[a])})};WH.sortJsonArray=function(e,t,a,i){var n=[];for(var s in e){if(e.hasOwnProperty(s)&&t[s]&&(i==null||i(t[s]))){n.push(s)}}if(a!=null){n.sort(a)}else{WH.sortIdArray(n,t)}return n};WH.sortObjectArray=function(e,t){for(var a=0,i;i=t[a];a++){var n=1;if(i.substr(0,1)==="-"){n=-1;i=i.substr(1)}e.sort(function(e,t,a,i){if(a[e]===i[e]){return 1*t}if(typeof a[e]==="string"||typeof i[e]==="string"){return WH.stringCompare(""+a[e],""+i[e])*t}return(a[e]>i[e]?1:-1)*t}.bind(null,i,n))}};WH.isEqualSimpleObject=function(e,t){for(var a in e){if(typeof e[a]=="object"){if(typeof t[a]!="object")return false;if(!WH.isEqualSimpleObject(e[a],t[a]))return false}else{if(e[a]!==t[a])return false}}for(var i in t){if(typeof t[i]=="object"){if(typeof e[i]!="object")return false;if(!WH.isEqualSimpleObject(e[i],t[i]))return false}else{if(e[i]!==t[i])return false}}return true};WH.deUrlize=function(e){var t=e.split("-");var a="";for(var i=0;i<t.length;i++){if(a){a+=" "}a+=WH.ucfirst(t[i])}return a};WH.ensureUrlProtocol=function(e,t){if(typeof e!=="string"){WH.error("Supplied URL was not a string.",e);e=""}if(t){if(!t.match(/:$/)){t+=":"}return e.replace(/^https?:/,t).replace(/^(\/[^\/])/,t+"//"+location.host+"$1").replace(/^(\/\/)/,t+"$1")}else{return e.replace(/^(\/[^\/])/,location.protocol+"//"+location.host+"$1").replace(/^(\/\/)/,location.protocol+"$1")}};WH.getTinyIconUrl=function(e){return e.indexOf("/")===-1?WH.Icon.getIconUrl(e,WH.Icon.TINY):e};WH.removeAccents=function(e){var t=e;var a=[["ß","á","ä","à","â","è","ê","é","ë","í","î","ì","ï","ñ","ò","ó","ö","ô","ú","ü","û","ù","œ","Á","Ä","À","Â","È","Ê","É","Ë","Í","Î","Ì","Ï","Ñ","Ò","Ó","Ö","Ô","Ú","Ü","Û","Ù","œ"],["ss","a","a","a","a","e","e","e","e","i","i","i","i","n","o","o","o","o","u","u","u","u","oe","A","A","A","A","E","E","E","E","I","I","I","I","N","O","O","O","O","U","U","U","U","Oe"]];for(var i=0;i<a[0].length;i++){t=t.replace(new RegExp(a[0][i],"g"),a[1][i])}return t};WH.isDateValid=function(e){return/^(20[0-2]\d)-([01]\d)-([0-3]\d) ([0-2]\d):([0-5]\d):([0-5]\d)$/.exec(e)};WH.isIpAddress=function(e){return/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/.test(e)};WH.isEmailValid=function(e){if(e.length>64){return false}return e.match(/^([a-z0-9._-]+)(\+[a-z0-9._-]+)?(@[a-z0-9.-]+\.[a-z]{2,})$/i)!=null};WH.getCurrentDomain=function(){if(WH.getCurrentDomain.CACHE){return WH.getCurrentDomain.CACHE}var e=location.hostname;if(!WH.isIpAddress(e)){var t=e.split(".");if(t.length>2){t.splice(0,t.length-2)}e=t.join(".")}WH.getCurrentDomain.CACHE=e;return e};WH.isExternalUrl=function(e){return!(!e||e.indexOf("http")!=0&&e.indexOf("//")!=0||e.indexOf("wowhead.com")!=-1||e.indexOf("wowheadnews.")!=-1||e.indexOf(WH.getCurrentDomain())!=-1)};WH.getRelativeHostPrefix=function(){var e=true;if(WH.isDev()){e=location.protocol==="https:"}var t=e?"_https":"_http";if(!WH.getRelativeHostPrefix.CACHE){WH.getRelativeHostPrefix.CACHE={}}if(t in WH.getRelativeHostPrefix.CACHE){return WH.getRelativeHostPrefix.CACHE[t]}var a="";if(e!==(location.protocol==="https:")&&!/^[0-9\.]+$/.test(location.hostname)){var i=/^([\w\W]*)\.[^\.]+\.com$/.exec(location.hostname);i=i?i[1]:"www";var n="";if(location.port){n=location.port}if(n.substr(0,1)!==":"){n=":"+n}if(n===":80"||n===":"){n=""}a="https://"+i+".wowhead.com"+n}if(!e){a=a.replace(/^https:/,"http:")}WH.getRelativeHostPrefix.CACHE[t]=a;return a};WH.fixWowheadHttps=function(e){return e.replace(/\bhttp:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"https:$1")};WH.goToLoginPage=function(e){window.location=WH.Url.getLoginPath(e)};WH.createOrRegex=function(e,t){e=e.replace(/(\(|\)|\|\+|\*|\?|\$|\^)/g,"\\$1");var a=e.split(" "),i="";for(var n=0,s=a.length;n<s;++n){if(n>0){i+="|"}i+=a[n]}return new RegExp((t!=null?"("+t+")?":"")+"("+i+")","gi")};WH.getHash=function(){return"#"+decodeURIComponent(location.href.split("#")[1]||"")};WH.modifyUrl=function(e,t,a,i){if(!a){a=$.noop}var n="";if(e.match(/(#.+)$/)){n=RegExp.$1;e=e.replace(n,"")}if(typeof a.custom=="function"){e=a.custom(e,i)}if(a.returnAfterCustom){return e+n}$.each(t,(function(t,i){var n;var s;var r;var o=e.match(new RegExp("(&|\\?)?"+t+"=?([^&]+)?"));if(o!=null){n=o[0];s=o[1];r=decodeURIComponent(o[2])}if(i==null){if(!n)return;r=null}else if(i.substr(0,2)=="+="){if(r&&a.onAppendCollision){r=a.onAppendCollision(r,i.substr(2),a.menuUrl)}else if(!r&&a.onAppendEmpty){r=a.onAppendEmpty(i.substr(2),a.menuUrl)}else{if(!r)r="";r+=$.trim(i.substr(2))}}else{r=i}if(n){var l="";if(s){l+=s}if(r!=null){l+=t;if(r){l+="="+WH.urlEncodeHref(r)}}e=e.replace(n,l)}else if(r||i==null||i.substr(0,2)!="+="){e+=(/[&?]/.test(e)?"&":"?")+t;if(r){e+="="+WH.urlEncodeHref(r)}}}));e=e.replace("?&","?");e=e.replace(/&&/g,"&");e=e.replace(/\/\?/g,"/");e=e.replace(/(&|\?)+$/,"");return e+n};WH.pageWasReloaded=function(){if(window.performance){if(performance.getEntriesByType){var e=performance.getEntriesByType("navigation");for(var t=0;t<e.length;t++){if(e[t].type==="reload"){return true}}}else if(performance.navigation){return performance.navigation.type===1}}return false};WH.getPreferredTransmogRace=function(){let e=WH.LocalStorage.get(WH.LocalStorage.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL);if(!e&&g_user&&g_user.settings&&g_user.settings.defaultModel){e=[g_user.settings.defaultModel.race,g_user.settings.defaultModel.gender].join(",")}if(!e||(""+e).indexOf(",")<0){e="1,2"}e=e.split(",");if(e[0]==25||e[0]==26){e[0]=24}if(!parseInt(e[0],10)){e[0]=1}if(!parseInt(e[1],10)){e[1]=2}if(!WH.Wow.Race.isPlayableRace(e[0])){e[0]=WH.Wow.Race.ID_HUMAN}return{race:parseInt(e[0]),gender:parseInt(e[1])}};WH.isBlizzardReferral=function(){var e=false;if(typeof WH.getGets().brl!=="undefined"){e="brl"}else{e=!!(document.referrer&&document.referrer.match(/^https?:\/\/[^\/]*\bbattle\.net\//))}WH.isBlizzardReferral=function(e){return e}.bind(null,e);return e};WH.prepInfobox=function(){$(".infobox").each((function(){var e=$(this);if(e.data("infobox-completion-info-added")!==true&&g_user.lists&&typeof g_pageInfo=="object"&&WH.Types.existsInDataEnv(g_pageInfo.type)&&typeof g_pageInfo.typeId=="number"){var t=$(".compact-completion-display",e);if(t.length){var a=$("span",t);if(a.length){var i=0;a.each((function(){var e=$(this);var t=e.html();try{t=JSON.parse(t)}catch(e){return}var a;for(var n=0,s;s=g_user.lists[n];n++){if(s.id==t.id){a=s;break}}if(a){e.parent().append(WH.createCompletionIcon(a,t.completed?1:0,t.rel));e.remove();i++}}));if(i){t.parent().parent().show()}}else{if(t.is(":empty")&&WH.addCompletionIcons(t.get(0),g_pageInfo.type,g_pageInfo.typeId)){t.parent().parent().show()}}}e.data("infobox-completion-info-added",true)}}))};WH.enhanceTextarea=function(e,t){const a=WH.LocalStorage;if(!(e instanceof jQuery)){e=$(e)}if(e.data("wh-enhanced")||e.prop("tagName")!="TEXTAREA"){return}if(typeof t!="object"){t={}}var i=function(e){if(!e.dynamicResizeOption){return true}let t=a.get(a.KEY_TEXTAREA_DYNAMIC_SIZING);if(typeof t==="boolean"){return t}return!e.hasOwnProperty("dynamicSizing")||e.dynamicSizing}.bind(null,t);var n=e.height()||500;var s=$("<div/>",{class:"enhanced-textarea-wrapper"}).insertBefore(e).append(e);if(!t.hasOwnProperty("dynamicSizing")||t.dynamicSizing||t.dynamicResizeOption){var r=$("<div/>",{class:"enhanced-textarea-expander"}).prependTo(s);r.css("width",r.parent().width()+"px");var o=function(e,t,a,i){if(!i()){return}var n=e.val()||e.attr("placeholder")||"";if(n){n=WH.htmlEntities(n)}t.html(n.replace(/\n/g,"<br>")+"<br>");var s=t.height()+(a?14:34);e.css("height",s+"px")};e.bind("keydown keyup change",o.bind(this,e,r,t.exactLineHeights,i));o(e,r,t.exactLineHeights,i);setTimeout(o.bind(this,e,r,t.exactLineHeights,i),100);if(!t.dynamicResizeOption||t.dynamicResizeOption&&i()){s.addClass("enhanced-textarea-dynamic-sizing")}}if(t.markup){var l=$("<div/>",{class:"enhanced-textarea-markup-wrapper"}).prependTo(s);var c=$("<div/>",{class:"enhanced-textarea-markup"}).appendTo(l);var u=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(c);var d=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(c);if(t.markup==="inline"){WH.markup.Toolbar.addInline(e.get(0),u.get(0),d.get(0))}else{WH.markup.Toolbar.addStandard(e.get(0),u.get(0),d.get(0))}if(t.dynamicResizeOption){var f=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(c);var h=$("<label/>").appendTo(f);var p=$("<input/>",{type:"checkbox",checked:i()}).appendTo(h);p.change(function(e,t,i,n,s,r){var o=this.is(":checked");a.set(a.KEY_TEXTAREA_DYNAMIC_SIZING,o);if(o){t.addClass("enhanced-textarea-dynamic-sizing");r(i,e.exactLineHeights,n)}else{t.removeClass("enhanced-textarea-dynamic-sizing");i.css("height",s+"px")}}.bind(p,t,s,e,i,n,o));$("<span/>",{text:WH.TERMS.autoresizetextbox}).appendTo(h)}if(t.scrollingMarkup){if(WH.enhanceTextarea.scrollerCount){WH.enhanceTextarea.scrollerCount++}else{WH.enhanceTextarea.scrollerCount=1}var m="fixable-markup-controls-"+WH.enhanceTextarea.scrollerCount;var H="fixed-markup-controls-"+WH.enhanceTextarea.scrollerCount;var g=function(e){var t=e.css("backgroundColor");if(t=="rgba(0, 0, 0, 0)"||t=="transparent"){return g(e.parent())}else{return t}};var W=g(c);for(var E,_=0;(E=window.document.styleSheets[_])&&E.href;_++){}if(!E){window.document.head.appendChild(document.createElement("style"));E=window.document.styleSheets[_]}var T="."+H+" ."+m+" .enhanced-textarea-markup";E.insertRule(T+" {background:"+W+";padding-bottom:5px;padding-top:10px;position:fixed;top:0;z-index:3}",E.cssRules.length);E.insertRule('body[data-zul-bar="true"]'+T+" {padding-top: 50px}",E.cssRules.length);l.addClass(m);var v=function(e,t,a){let i=ZUL.getEnabled()?ZUL.HEIGHT:0;var n=this.scrollY||this.pageYOffset||0;if(n>e.offset().top-10-i&&n<t.offset().top+t.height()-100-i){$("body").addClass(a)}else{$("body").removeClass(a)}};var S=$(window);S.scroll(v.bind(window,l,s,H));v.call(window,l,s,H);var b=function(e,t){t.css("width",e.width()+"px");e.css("height",t.height()+"px")}.bind(null,l,c);b();S.on("resize",b);$((function(){setTimeout(b,2e3)}))}}e.data("wh-enhanced",true)};WH.createOptionsMenuWidget=function(e,t,a){var i=0;var n=1;var s=2;var r=3;var o=WH.createOptionsMenuWidget.chevron;if(a.noChevron){o=""}var l=WH.ce("span");l.id="options-menu-widget-"+e;l.className="options-menu-widget "+l.id;l.innerHTML=t+o;if(a.id){l.id=a.id}if(a.className){l.className+=" "+a.className}if(a.options instanceof Array){var c=[];for(var u=0,d;d=a.options[u];u++){var f=[u,d[n]];if((typeof a.selected=="number"||typeof a.selected=="string")&&a.selected==d[i]){l.innerHTML=d[n]+o;if(d[r]){switch(typeof d[r].className){case"string":$.data(l,"options-menu-widget-class",d[r].className);l.className+=" "+d[r].className;break;case"function":$.data(l,"options-menu-widget-class",d[r].className(d,true));l.className+=" "+d[r].className(d,true);break}}}if(d[s]){f.push(function(e,t,a,i){switch(typeof a[s]){case"string":window.location=a[s];break;case"function":if(typeof i.updateWidgetText=="undefined"||i.updateWidgetText){t.innerHTML=a[n]+e;var o=$.data(t,"options-menu-widget-class");if(o){t.className=t.className.replace(new RegExp(" *\\b"+o+"\\b"),"")}if(a[r]){switch(typeof a[r].className){case"string":$.data(t,"options-menu-widget-class",a[r].className);t.className+=" "+a[r].className;break;case"function":$.data(t,"options-menu-widget-class",a[r].className(a,true));t.className+=" "+a[r].className(a,true);break}}}a[s](t,a);break}}.bind(null,o,l,d,a))}else if(!d[r]||!d[r].menu){f[0]=null}f[Menu.ITEM_OPTIONS]={};if(d[r]){switch(typeof d[r].className){case"string":f[Menu.ITEM_OPTIONS].className=d[r].className;break;case"function":f[Menu.ITEM_OPTIONS].className=d[r].className.bind(null,d,false);break}switch(typeof d[r].column){case"number":case"string":f[Menu.ITEM_OPTIONS].column=d[r].column;break;case"function":f[Menu.ITEM_OPTIONS].column=d[r].column.bind(null,d);break}switch(typeof d[r].tinyIcon){case"string":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon;break;case"function":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon.bind(null,d);break}switch(typeof d[r].fontIcon){case"string":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon;break;case"function":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon.bind(null,d);break}if(typeof d[r].isChecked=="function"){f[Menu.ITEM_OPTIONS].checkedFunc=d[r].isChecked.bind(null,d)}if(typeof d[r].menu=="object"&&d[r].menu instanceof Array){Menu.setSubmenu(f,d[r].menu)}}c.push(f)}l.menu=c;if(a.menuOnClick){l.onmousedown=WH.rf;Menu.add(l,c,{showAtElement:true})}else{Menu.add(l,c)}}if(a.target){$(a.target).append(l)}else{return l}};WH.createOptionsMenuWidget.chevron=' <i class="fa fa-chevron-down fa-color-gray"></i>';WH.setupSmoothNavClicks=function(e){var t=$(".smooth-nav-inner > a",e);if(!t.length){setTimeout(WH.setupSmoothNavClicks.bind(null,e),9);return}let a=WH.Device.isTouch();t.each((function(){var e=this.href.replace(new RegExp("^"+location.href.replace(/#.*/,"")),"");if(e&&e.substr(0,1)==="#"){$(this).click(function(e,t){if(t.which===2){return}var i=e==="#top"?0:$(e).offset().top-20;if(isNaN(i)){return}if(a){i-=37}$("html, body").stop().animate({scrollTop:i},"500","swing");return false}.bind(null,e))}}))};WH.countdownClock=function(e){var t=$(e.element||"#countdown-clock-"+e.id);if(!t.length){return}var a;if(e.url){a=$("<a/>",{href:e.url,target:"_blank"})}else{a=$("<div/>")}a.addClass("countdown-clock-content").css({"background-image":"url("+e.bg+")"});var i=$("<div/>",{class:"countdown-clock-content-inner"}).appendTo(a);if(e.impressionImage){$("<img>",{src:e.impressionImage,css:{bottom:0,height:"1px",position:"absolute",right:0,width:"1px"}}).appendTo(a)}if(e.text){i.append($("<span/>",{class:"countdown-clock-text",html:e.text}))}var n=$("<span/>",{class:"countdown-clock-time"}).appendTo(i);var s=$("<table/>").appendTo(n);var r=$("<tr/>").appendTo(s);var o=$("<tr/>").appendTo(s);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:WH.TERMS.days_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.hours_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.minutes_lc}).appendTo(o);t.addClass("countdown-clock").append(a);var l={days:0,hours:0,minutes:0};var c=(new Date).getTime();var u=c;if(typeof e.time==="string"){u=new Date(e.time).getTime()}else if(typeof e.time==="object"){var d=new Date;if(!e.time.hasOwnProperty("year")){e.time.year=d.getFullYear()}if(!e.time.hasOwnProperty("month")){e.time.month=d.getMonth+1}if(!e.time.hasOwnProperty("day")){e.time.day=d.getDay()}if(!e.time.hasOwnProperty("hour")){e.time.hour=0}if(!e.time.hasOwnProperty("minute")){e.time.minute=0}if(!e.time.hasOwnProperty("second")){e.time.second=0}u=new Date(e.time.year,e.time.month-1,e.time.day,e.time.hour,e.time.minute,e.time.second).getTime()}var f=parseInt((u-c)/1e3);var h=60;var p=h*60;var m=p*24;l.days=parseInt(f/m);f=f-l.days*24*60*60;l.hours=parseInt(f/p);f=f-l.hours*60*60;l.minutes=parseInt(f/h);var H=function(e,t,a){if(t.days<=0&&t.hours<=0&&t.minutes<=0){e.html(a.completionText).parent().parent().addClass("countdown-clock-complete");return}$("tr:first-child > td:nth-child(1)",e).html(t.days);$("tr:last-child > td:nth-child(1)",e).html(t.days===1?WH.TERMS.day_lc:WH.TERMS.days_lc);$("tr:first-child > td:nth-child(3)",e).html(t.hours);$("tr:last-child > td:nth-child(3)",e).html(t.hours===1?WH.TERMS.hour_lc:WH.TERMS.hours_lc);$("tr:first-child > td:nth-child(5)",e).html(t.minutes);$("tr:last-child > td:nth-child(5)",e).html(WH.TERMS.minute_abbrev);t.minutes--;if(t.minutes<0){if(t.hours>0||t.days>0){t.minutes=59}else{t.minutes=0}t.hours--}if(t.hours<0){if(t.days>0){t.hours=23}else{t.hours=0}t.days--}if(t.days<0){t.days=0}setTimeout(H.bind(null,e,t,a),6e4)};H(n,l,e)};WH.slashHashEvent=null;try{WH.slashHashEvent=new Event("slashhash")}catch(e){try{WH.slashHashEvent=document.createEvent("Event");WH.slashHashEvent.initEvent("slashhash",true,true)}catch(e){}}WH.getSlashHash=function(e){var t=""+location.href;var a=t.indexOf(e);if(a==-1){return location.hash?(""+location.hash).replace(/^#/,""):""}var i=t.substr(0,a+e.length);return t.substr(i.length+1)};WH.setSlashHash=function(e,t,a){var i=""+location.href;var n=i.indexOf(e);if(n==-1){alert("Bad hash update: No root found!");return}var s=i.substr(0,n+e.length);var r=i.substr(s.length+1);if(t.substr(0,1)=="#"){t=t.substr(1)}var o=t?"/"+t:"";if(a){WH.Url.pushHistory(s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}else{WH.Url.replaceHistory(s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}return r};WH.setHash=function(e,t){let a=""+location.hash;if(!e.startsWith("#")){e="#"+e}if(e==="#."){WH.clearHash(t||false)}else{if(t){WH.Url.pushHistory(location.pathname+e)}else{WH.Url.replaceHistory(location.pathname+e)}}return a};WH.clearHash=function(e){var t=""+location.hash;var a=(""+location.href).replace(/#.*/,"");if(e){if(window.history){window.history.pushState({},"",a)}else{location.hash="#."}}else{if(window.history){window.history.replaceState({},"",a)}else{location.replace("#.")}}return t};WH.selectText=function(e){var t=document,a=t.getElementById(e),i,n;if(t.body.createTextRange){i=document.body.createTextRange();i.moveToElementText(a);i.select()}else if(window.getSelection){n=window.getSelection();i=document.createRange();i.selectNodeContents(a);n.removeAllRanges();n.addRange(i)}};WH.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};WH.loadAssets=function(e,t,a){const i=WH.Game;let n=function(e,t){var a=WH.ce("link");a.rel="stylesheet";if(WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}a.href=e;if(t){WH.aE(a,"load",t)}WH.ae(document.getElementsByTagName("head")[0],a)};var s=function(e,t,a){var i=WH.ce("script");i.type="text/javascript";if(a&&WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}i.src=e;if(t){WH.aE(i,"load",t)}WH.ae(document.getElementsByTagName("head")[0],i)};switch(e){case"artifact-weapon-calc":if(WH.isSet("ArtifactCalc")){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/artifact-calc.css");var r=WH.STATIC_URL+"/js/WH/Wow/ArtifactCalc.js";if(WH.isSet("g_artifact_textures")){s(r,t,true)}else{var o=WH.Url.getDataPageUrl("artifact-calc");s(o,s.bind(null,r,t,true))}break;case"azerite-finder":if(WH.Wow.AzeriteFinder){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/azerite-finder.css");s(WH.STATIC_URL+"/js/WH/Wow/AzeriteFinder.js",t,true);break;case"build-summary":if(WH.Wow.BuildSummary){if(t){t()}return}let d=2;let f=()=>--d<=0&&t&&t();n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}tools/build-summary.css`,f);s(WH.Url.getDataPageUrl("item-bonuses",a),(()=>{s(WH.STATIC_URL+"/js/WH/Wow/BuildSummary.js",f,true)}));break;case"di-paragon-skill-calc":if(WH.DI.ParagonCalc&&WH.DI.ParagonCalc.Shell){if(t){t()}break}WH.Fonts.load(i.DI);n(WH.STATIC_URL+"/css/tools/partials/paragon-calc.css");n(WH.STATIC_URL+"/css/tools/paragon-calc-shell.css");s(WH.Url.getDataPageUrl("paragon-calc",WH.dataEnv.DI),(()=>{s(WH.STATIC_URL+"/js/WH/DI/ParagonCalc.js",(()=>{s(WH.STATIC_URL+"/js/WH/DI/ParagonCalc/Shell.js",t,true)}),true)}));break;case"diablo-2-skill-calc":if(WH.D2.hasOwnProperty("SkillCalc")){if(t){t()}break}WH.Fonts.load(i.D2);n(WH.STATIC_URL+"/css/d2/skill-calc.css");s(WH.Url.getDataPageUrl("diablo2-skills",WH.dataEnv.D2),(function(){s(WH.STATIC_URL+"/js/WH/D2/SkillCalc.js",t,true)}));break;case"d4-skill-tree":{a=i.getByEnv(a)===i.D4?a:i.getDefaultEnv(i.D4);if(WH.D4.SkillPlanner?.isReady(a)){t&&t();return}n(`${WH.STATIC_URL}/css/WH/Popover.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/skill-planner.css`);let e=2;let r=()=>--e>0||s(`${WH.STATIC_URL}/js/WH/D4/SkillPlanner.js`,t,true);s(WH.Url.getDataPageUrl("skill-tree-planner",a),r,false);s(`${WH.STATIC_URL}/js/WH/Popover.js`,r,true);break}case"d4-paragon-calc":{a=i.getByEnv(a)===i.D4?a:i.getDefaultEnv(i.D4);if(WH.D4.ParagonCalc?.isReady(a)){t&&t();return}n(`${WH.STATIC_URL}/css/WH/Popover.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/frame-box.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/modal.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/points.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/paragon-calc.css`);let e=3;let r=()=>--e>0||s(`${WH.STATIC_URL}/js/WH/D4/ParagonCalc.js`,t,true);s(WH.Url.getDataPageUrl("paragon-calc",a),r,false);s(`${WH.STATIC_URL}/js/WH/Popover.js`,r,true);s(`${WH.STATIC_URL}/js/WH/D4/Components/Modal.js`,r,true);s(`${WH.STATIC_URL}/js/WH/D4/Components/Points.js`,r,true);break}case"d4-build":{a=i.getByEnv(a)===i.D4?a:i.getDefaultEnv(i.D4);n(`${WH.STATIC_URL}/css/WH/Popover.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/d4/BuildPlanner/BuildPlanner.css`);n(`${WH.STATIC_URL}/css/tools/d4/witch-powers.css`);n(`${WH.STATIC_URL}/css/tools/d4/boss-powers.css`);n(`${WH.STATIC_URL}/css/tools/d4/horadric-spells.css`);n(`${WH.STATIC_URL}/css/tools/d4/chaos-perks.css`);const e=`${WH.STATIC_URL}/js/WH/D4/`;const r=[{url:WH.Url.getDataPageUrl("paragon-calc",a),includeVersion:false},{url:WH.Url.getDataPageUrl("skill-tree-planner",a),includeVersion:false},{url:WH.Url.getDataPageUrl("build-planner",a),includeVersion:false},{url:`${e}Components/FrameBox.js`,includeVersion:true},{url:`${e}Components/ItemSlotBox.js`,includeVersion:true},{url:`${e}Components/Modal.js`,includeVersion:true},{url:`${e}Components/Points.js`,includeVersion:true},{url:`${WH.STATIC_URL}/js/WH/Popover.js`,includeVersion:true},{url:`${e}ParagonCalc.js`,includeVersion:true},{url:`${e}SkillPlanner.js`,includeVersion:true},{url:`${e}VampiricPowers.js`,includeVersion:true},{url:`${e}SeneschalCompanion.js`,includeVersion:true},{url:`${e}WitchPowers.js`,includeVersion:true},{url:`${e}BossPowers.js`,includeVersion:true},{url:`${e}HoradricSpells.js`,includeVersion:true},{url:`${e}ChaosPerks.js`,includeVersion:true}];let o=r.length;let l=()=>--o>0||t();r.forEach((e=>s(e.url,l,e.includeVersion)));break}case"dragonflight-talent-calc":if(WH.Wow.TalentCalcDragonflight&&WH.Wow.TalentCalcDragonflight.isReady(a)){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/talent-calc-dragonflight.css");s(WH.Url.getDataPageUrl("talents-dragonflight",a),(()=>s(WH.STATIC_URL+"/js/WH/Wow/TalentCalcDragonflight.js",t,true)));break;case"dragonflight-talent-calc-manual":if(WH.Wow.TalentCalcDragonflightManual){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/talent-calc-dragonflight.css");s(WH.STATIC_URL+"/js/WH/Wow/TalentCalcDragonflightManual.js",t,true);break;case"gear-planner":{let e="GearPlanner";if(WH.getDataTree(a)===WH.dataTree.TBC)e="GearPlannerTbc";if(WH.getDataTree(a)===WH.dataTree.WRATH)e="GearPlannerWrath";if(WH.Wow[e]){t&&t();return}const i=[WH.dataTree.CLASSIC,WH.dataTree.TBC,WH.dataTree.WRATH,WH.dataTree.CATA];const r=[WH.dataTree.CLASSIC,WH.dataTree.TBC,WH.dataTree.WRATH];const o=`${WH.STATIC_URL}/js/WH/`;let l=[{url:WH.Url.getDataPageUrl("gear-planner",a),includeVersion:false},{url:WH.Url.getDataPageUrl("weight-presets",a),includeVersion:false}];if(i.includes(WH.getDataTree(a))){l.push({url:`${o}Wow/TalentCalcClassic.js`,includeVersion:true})}else{l.push({url:`${o}Wow/TalentCalcMists.js`,includeVersion:true});n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/talent-calc-mists.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/universal/Toolbar.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/universal/SelectDropDown.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/universal/Divider/Divider.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}`+"/Components/universal/InteractiveTile/InteractiveTile.css")}if(r.includes(WH.getDataTree(a))){n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/gear-planner.css`);l=[...l,...[{url:`${o}Wow/CharacterCustomization.js`,includeVersion:true},{url:`${o}Listview/Templates/item.js`,includeVersion:true},{url:`${o}Wow/${e}.js`,includeVersion:true}]]}else{n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/GearPlanner/GearPlanner.css`)}if(e!=="GearPlanner"&&!WH.applyStatModifications.ScalingData){l=[...l,{url:WH.Url.getDataPageUrl("item-scaling",a),includeVersion:false}]}if(WH.getDataTree(a)===WH.dataTree.WRATH){l=[...l,...[{url:`${o}Wow/GearPlanner/Ui.js`,includeVersion:true},{url:`${o}Wow/GearPlanner/Components/Tabs.js`,includeVersion:true}]]}let c=l.length;let u=()=>--c>0||t();WH.loadAssets("talent-calc-classic",(()=>l.forEach((e=>s(e.url,u,e.includeVersion)))),a);break}case"heart-of-azeroth-calc":if(WH.Wow.HeartOfAzerothCalc){if(t){t()}break}n(WH.staticUrl+"/css/tools/heart-of-azeroth-calc.css");var l=s.bind(null,WH.staticUrl+"/js/WH/Wow/HeartOfAzerothCalc.js",t,true);if(!WH.Wow.AzeriteEssence){s(WH.staticUrl+"/js/WH/Wow/AzeriteEssence.js",s.bind(null,WH.Url.getDataPageUrl("azerite-essence"),l,false),true)}else{l()}break;case"hero-talents-embed":n(WH.STATIC_URL+"/css/tools/hero-talents-embed.css");s(WH.STATIC_URL+"/js/WH/Wow/HeroTalentsEmbed.js",t,true);break;case"legion-remix-artifact":if(WH.Wow.LegionRemixArtifact&&WH.Wow.LegionRemixArtifact.isReady(a)){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/legion-remix-artifact.css");s(WH.Url.getDataPageUrl("legion-remix-artifact",a),(()=>s(WH.STATIC_URL+"/js/WH/Wow/LegionRemixArtifact.js",t,true)));break;case"profession-tree-calc":if(WH.Wow.ProfessionTreeCalc&&WH.Wow.ProfessionTreeCalc.isReady(a)){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/profession-tree-calc.css");s(WH.Url.getDataPageUrl("profession-tree-calc",a),(()=>s(WH.STATIC_URL+"/js/WH/Wow/ProfessionTreeCalc.js",t,true)));break;case"pvp-talent-calc":if(WH.isSet("PvpTalentCalc")){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/pvp-calc.css");var c=WH.STATIC_URL+"/js/talent-pvp.js";if(WH.isSet("g_talents_pvp")){s(c,t,true)}else{s(WH.Url.getDataPageUrl("talents-pvp"),s.bind(null,c,t,true))}break;case"section-header":n(`${WH.STATIC_URL}/css/Components/universal/Collapsible.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}Components/universal/SectionHeader.css`,t);break;case"soulbind-calc":if(WH.Wow.SoulbindCalc){if(t){t()}break}n(WH.staticUrl+"/css/tools/soulbind-calc.css");s(WH.staticUrl+"/js/WH/Wow/SoulbindCalc.js",t,true);break;case"talent-calc":if(WH.isSet("TalentCalc")){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/talent-calc.css");var u=WH.STATIC_URL+"/js/WH/Wow/TalentCalc.js";if(WH.isSet("g_glyphs")){s(u,t,true)}else{s(WH.Url.getDataPageUrl("glyphs"),s.bind(null,u,t,true))}break;case"talent-calc-classic":case"pet-talent-calc":let h=e==="pet-talent-calc";if(WH.Wow.TalentCalcClassic?.isReady(h,a)){if(t){t()}return}n(WH.STATIC_URL+"/css/"+WH.Theme.getThemePath()+"tools/talent-calc-classic.css");s(WH.STATIC_URL+"/js/WH/Wow/TalentCalcClassic.js",s.bind(null,WH.Url.getDataPageUrl("talents-classic"+(h?"-pet":""),a),t),true);break;case"talent-calc-mists":if(WH.Wow.TalentCalcMists?.isReady(a)){if(t){t()}return}n(WH.STATIC_URL+"/css/"+WH.Theme.getThemePath()+"tools/talent-calc-mists.css");n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/universal/Toolbar.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/universal/SelectDropDown.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/Components/universal/Divider/Divider.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}`+"/Components/universal/InteractiveTile/InteractiveTile.css");{const e=[{url:WH.STATIC_URL+"/js/WH/Wow/TalentCalcMists.js",includeVersion:true},{url:WH.Url.getDataPageUrl("talents-classic",a)}];let i=e.length;let n=()=>--i>0||t();e.forEach((e=>s(e.url,n,e.includeVersion)))}break;case"list-card":n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}Components/Guides/ListCard.css`);break;case"guide-hub-header":n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}Components/Guides/GuideHubHeader.css`);break;case"popover":{let e={css:false,js:false};let a=()=>e.css&&e.js&&t&&t();n(`${WH.STATIC_URL}/css/WH/Popover.css`,(()=>(e.css=true)&&a()));s(`${WH.STATIC_URL}/js/WH/Popover.js`,(()=>(e.js=true)&&a()),true);break}case"wow-mapper":if(Mapper.isDataReady(a)){t?.()}else{s(WH.Url.getDataPageUrl("zones",a),t)}break;default:alert('Tried to load unknown asset set "'+String(e)+'".')}};WH.isInt=function(e){return typeof e==="number"&&parseFloat(e)==parseInt(e)&&!isNaN(e)};WH.ensureObjectPath=function(e,t){var a=Array.prototype.slice.call(arguments,1);if(typeof a[0]!="string"){return e}if(typeof e[a[0]]!="object"){e[a[0]]={}}if(a[1]){e[a[0]]=WH.ensureObjectPath.apply(this,[e[a[0]]].concat(a.slice(1)))}return e};WH.preventDefault=function(e){if(e&&e.preventDefault){e.preventDefault()}};WH.preventTyping=function(e){if(e&&e.preventDefault){var t="which"in e?e.which:e.keyCode;var a=t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=105||t>=106&&t<=111||t>=186&&t<=192||t>=219&&t<=222;var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;if(a&&!i){e.preventDefault()}}};WH.leadingZeroes=function(e,t){var a=e+"";while(a.length<t)a="0"+a;return a};$(document).ready((function(){$("a.wsach").each((function(){var e=$(this).text();var t=$(this).attr("title");var a=parseInt($(this).attr("data-earned"));var i=$(this).attr("data-user");var n=$(this).parent().parent().attr("id")=="user-achievement-list";var s=$(this).attr("data-progress");var r=$(this).attr("data-quality");var o=$(this).attr("data-count");$(this).attr("title","");var l=$("<div>");l.append('<table><tr><td style="padding-bottom: 0.35em"><b class="q" data-quality="'+r+'"></b></td></tr><tr><td><span></span></td></tr></table>');l.find("b").text(e);l.find("span").text(t);if(a){var c=null;var u=(new Date).getTime()/1e3;if(i){if(a>31*24*60*60){l.append('<span class="q0"><br>'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime4_format:WH.TERMS.earnedwsatime4_format,i,WH.formatDateSimple(new Date((u-a)*1e3)))+"</span>")}else{l.append('<span class="q0"><br>'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime2_format:WH.TERMS.earnedwsatime2_format,i,WH.formatTimeElapsed(a))+"</span>")}}else if(!n){if(a>31*24*60*60){l.append('<span class="q0"><br>'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime3_format:WH.TERMS.earnedwsatime3_format,WH.formatDateSimple(new Date((u-a)*1e3)))+"</span>")}else{l.append('<span class="q0"><br>'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime_format:WH.TERMS.earnedwsatime_format,WH.formatTimeElapsed(a))+"</span>")}}if(c){l.append('<span class="q0"><br>'+c+"</span>")}}else if(!n&&s){l.append('<span class="q0"><br><small></small>'+WH.TERMS.progress_format.replace("%s",s)+"</td></tr>")}WH.Tooltips.attach(this,l.html(),undefined,{byCursor:true})}))}));WH.User=new function(){const e=this;this.CAP_BAN_SPAM="BanSpam";this.CAP_DB2_RESCAN_BUTTON="Db2RescanButton";this.CAP_CONTENT_PHASE_EDIT="ContentPhaseEdit";this.CAP_MODERATE_FORUMS="ModerateForums";this.CAP_OUT_OF_DATE_COMMENTS="OutOfDateComments";this.CAP_TRANSMOG_SET_EDIT="TransmogSetEdit";this.CAP_STAFF_ONLY_SCREENSHOTS="StaffOnlyScreenshots";this.CAP_SEO_INFO="SeoInfo";this.SETTING_PREMIUM_TOOLTIP_SCREENSHOTS="premium.tooltipScreenshots";this.SETTING_IDS_IN_LISTS="misc.idsInLists";this.ROLE_TESTER=1;this.ROLE_ADMIN=2;this.ROLE_EDITOR=4;this.ROLE_MOD=8;this.ROLE_BUREAU=16;this.ROLE_DEV=32;this.ROLE_VIP=64;this.ROLE_BLOGGER=128;this.ROLE_PREMIUM=256;this.ROLE_LOCALIZER=512;this.ROLE_SALES_AGENT=1024;this.ROLE_SCREENSHOT=2048;this.ROLE_VIDEO=4096;this.ROLE_API_ONLY=8192;this.ROLE_PENDING=16384;this.ROLE_BLIZZARD=32768;this.ROLE_GROUP_EMPLOYEE=this.ROLE_ADMIN|this.ROLE_BUREAU|this.ROLE_DEV;this.ROLE_GROUP_STAFF=this.ROLE_TESTER|this.ROLE_GROUP_EMPLOYEE|this.ROLE_EDITOR|this.ROLE_MOD|this.ROLE_BLOGGER|this.ROLE_LOCALIZER|this.ROLE_SALES_AGENT|this.ROLE_SCREENSHOT|this.ROLE_VIDEO;this.ROLE_GROUP_GREEN_TEXT=this.ROLE_MOD|this.ROLE_BUREAU|this.ROLE_DEV;this.ROLE_GROUP_MODERATOR=this.ROLE_ADMIN|this.ROLE_MOD|this.ROLE_BUREAU;this.ROLE_GROUP_COMMENTS_MODERATOR=this.ROLE_GROUP_MODERATOR|this.ROLE_LOCALIZER|this.ROLE_EDITOR;this.ROLE_GROUP_PREMIUM_PERMISSIONS=this.ROLE_PREMIUM|this.ROLE_GROUP_STAFF|this.ROLE_VIP|this.ROLE_EDITOR|this.ROLE_BLIZZARD;this.NEWS_AUTHOR_ROLES=this.ROLE_GROUP_EMPLOYEE|this.ROLE_BLOGGER;this.GUIDE_MANAGER_ROLES=this.ROLE_GROUP_EMPLOYEE;this.GUIDE_EDITOR_ROLES=this.GUIDE_MANAGER_ROLES|this.ROLE_EDITOR;const t="TOMRUS";this.getClassicCharacterProfiles=()=>g_user.characterProfiles??[];this.getCommentRoleClass=(e,a)=>{if(e&(U_GROUP_ADMIN|U_GROUP_BLIZZARD)){return"comment-role-admin"}else if(e&U_GROUP_GREEN_TEXT&&a!==t){return"comment-role-moderator"}else if(e&U_GROUP_VIP){return"comment-role-vip"}else if(e&U_GROUP_PREMIUMISH){return"comment-role-premium"}return null};this.getCommentRoleLabel=(t,a,i)=>{if(a){return a}if(t&U_GROUP_ADMIN){return WH.TERMS.administrator_abbrev}else if(t&U_GROUP_BLIZZARD){return WH.TERMS.blizzardRep}else if(t&e.ROLE_MOD){return WH.TERMS.moderator}else if(i){return i}else if(t&U_GROUP_PREMIUMISH){return WH.TERMS.premiumuser}return null};this.getCommentTitleClass=(e,a,i)=>{if(e&(U_GROUP_ADMIN|U_GROUP_BLIZZARD)){return"comment-role-admin"}else if(e&U_GROUP_GREEN_TEXT&&i!==t){return"comment-role-moderator"}else if(e&U_GROUP_VIP){return"comment-role-vip"}else if(a){return a}else if(e&U_GROUP_PREMIUMISH){return"comment-role-premium"}return null};this.getDebug=function(){return WH.User.hasSetting(WH.User.SETTING_IDS_IN_LISTS)};this.getId=function(){return g_user.id};this.getPath=function(){if(!WH.User.isLoggedIn()){return null}return WH.Url.generatePath("/user="+encodeURIComponent(WH.User.getUsername()))};this.getReputation=function(){return g_user.reputation||0};this.getSessionKey=()=>g_user.sessionKey||"invalid-session-key";this.getUsername=function(){return g_user.name||""};this.hasCapability=e=>(WH.getPageData("user.capabilities")||[]).includes(e);this.hasPremiumSub=()=>!!(g_user.premiumStatus||{}).hasSubscription;this.hasRole=function(e){if(!e){return true}return!!(g_user.roles&e)};this.hasSetting=e=>!!((WH.getPageData("user.settings")||{})[e]||false);this.isClientCtaSuppressed=()=>WH.getPageData("user.suppressClientCta")===true;this.isLoggedIn=function(){return g_user.id>0};this.isPremium=function(){return!!g_user.premium};this.isUsernameValid=function(e){return e.match(/[^a-z0-9]/i)==null&&e.length>=4&&e.length<=16};this.saveOption=function(e,t,a){let i={method:"POST",json:{key:e,value:t}};if(typeof a==="function"){i.success=a}WH.fetch(WH.Url.generatePath("/account/save-option"),i)}};var U_GROUP_ADMIN=WH.User.ROLE_ADMIN;var U_GROUP_EDITOR=WH.User.ROLE_EDITOR;var U_GROUP_MOD=WH.User.ROLE_MOD;var U_GROUP_BUREAU=WH.User.ROLE_BUREAU;var U_GROUP_DEV=WH.User.ROLE_DEV;var U_GROUP_VIP=WH.User.ROLE_VIP;var U_GROUP_BLOGGER=WH.User.ROLE_BLOGGER;var U_GROUP_PREMIUM=WH.User.ROLE_PREMIUM;var U_GROUP_LOCALIZER=WH.User.ROLE_LOCALIZER;var U_GROUP_SALESAGENT=WH.User.ROLE_SALES_AGENT;var U_GROUP_SCREENSHOT=WH.User.ROLE_SCREENSHOT;var U_GROUP_VIDEO=WH.User.ROLE_VIDEO;var U_GROUP_PENDING=WH.User.ROLE_PENDING;var U_GROUP_BLIZZARD=WH.User.ROLE_BLIZZARD;var U_GROUP_EMPLOYEE=WH.User.ROLE_GROUP_EMPLOYEE;var U_GROUP_STAFF=WH.User.ROLE_GROUP_STAFF;var U_GROUP_GREEN_TEXT=WH.User.ROLE_GROUP_GREEN_TEXT;var U_GROUP_PREMIUMISH=WH.User.ROLE_PREMIUM|WH.User.ROLE_EDITOR;var U_GROUP_MODERATOR=WH.User.ROLE_GROUP_MODERATOR;var U_GROUP_COMMENTS_MODERATOR=WH.User.ROLE_GROUP_COMMENTS_MODERATOR;var g_users={};WH.LocalStorage=new function(){const e=this;const t=WH.Game;this.KEY_D4_EVENT_VOTING="d4.eventVoting";this.KEY_ADMIN_ROLE_PERMS_EXPANDED="admin.managePerms.rolePermsExpanded";this.KEY_ADMIN_SHOW_INDIVIDUAL_PERMS="admin.managePerms.showIndividualPerms";this.KEY_ANNOUNCEMENTS_CLOSED="announcements.closed";this.KEY_AUDIO_PLAYLIST="audioPlaylist";this.KEY_BLUETRACKER_GAMES_FILTER="bluetracker.games";this.KEY_BLUETRACKER_REGION_FILTER="bluetracker.region";this.KEY_EDIT_ADJACENT_PREVIEW="edit.adjacentPreview";this.KEY_GUIDE_SIDEBAR_STATE="guide.sidebarState";this.KEY_HIGHLIGHTS_CLOSED="highlights.closed";this.KEY_LAYOUT_FULLSCREEN="layout.fullscreen";this.KEY_LAYOUT_FULLSCREEN_DB2_READER="layout.fullscreen.db2Reader";this.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC="layout.userReturnedFromClassic";this.KEY_MENU_RECENT_PATHS="menu.recentPaths";this.KEY_NEWS_LIST_FILTER="news.listFilter";this.KEY_NEWS_TOGGLER="home.layout.togglers";this.KEY_NEWSLETTER_CTA_POPOVER_SETTINGS="newsletter.cta.popover.settings";this.KEY_NEWSLETTER_CTA_POPOVER_VISITS="newsletter.cta.popover.visits";this.KEY_NOTIFICATIONS_ERROR_SHOWN="notifications.errorShown";this.KEY_NOTIFICATIONS_ONBOARDING="notifications.onboarding";this.KEY_PREFERRED_SEASON="listview.season";this.KEY_TEXTAREA_DYNAMIC_SIZING="textarea.dynamicSizing";this.KEY_TOOLTIP_SCREENSHOTS="tooltip.screenshots";this.KEY_WAS_BLIZZARD_REFERRAL_TIME="was.blizzardReferralTime";this.KEY_WAS_COIL_START_TIME="was.coilStartTime";this.KEY_WAS_DFP_LOG="was.dfpLog";this.KEY_WOW_API_CHARACTER_CACHE="wow.api.characterCache";this.KEY_WOW_ATTUNEMENT_TRACKER="wow.attunementTracker";this.KEY_WOW_DATABASE_CLASS_FILTER="wow.database.classFilter";this.KEY_WOW_DATABASE_SPEC_FILTER="wow.database.specFilter";this.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY="wow.dressingRoom.appearanceHistory";this.KEY_WOW_DRESSING_ROOM_LAST_CATEGORY="wow.dressingRoom.lastCategory";this.KEY_WOW_DRESSING_ROOM_LAST_MODEL="wow.dressingRoom.lastModel";this.KEY_WOW_GEAR_PLANNER_HASHES="wow.gearPlanner.hashes";this.KEY_WOW_GEAR_PLANNER_SHOW_MODEL="wow.gearPlanner.showModel";this.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL="wow.modelViewer.defaultModel";this.KEY_WOW_MODEL_VIEWER_LAST_MODEL="wow.modelViewer.lastModel";this.KEY_WOW_MODEL_VIEWER_SHEATHED="wow.modelViewer.sheathed";this.KEY_WOW_SHADOWLANDS_BUILD_PLANNER_HASH="wow.shadowlandsBuildPlanner.hash";this.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS="wow.talentCalc.showTopBuilds";this.KEY_WOW_TALENT_CALC_HERO_CONDENSED="wow.talentCalc.heroCondensed";this.KEY_WOW_TODAY_IN_WOW_FILTER="wow.todayInWow.filter";this.KEY_WOW_TODAY_IN_WOW_VISIBILITY="wow.todayInWow.visibility";const a=["lvBrowse","showRandomWidget","transmog_racegender"];const i={[this.KEY_AUDIO_PLAYLIST]:"AudioPlaylist",[this.KEY_EDIT_ADJACENT_PREVIEW]:"edit.adjacentPreview",[this.KEY_GUIDE_SIDEBAR_STATE]:"guide.sidebarState",[this.KEY_LAYOUT_FULLSCREEN]:"fullscreenMode",[this.KEY_LAYOUT_FULLSCREEN_DB2_READER]:"fullscreenMode.db2Reader",[this.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC]:"fromClassic",[this.KEY_MENU_RECENT_PATHS]:"menu.recentPaths",[this.KEY_NEWS_LIST_FILTER]:"newsListFilter",[this.KEY_NOTIFICATIONS_ERROR_SHOWN]:"notifications-error-seen",[this.KEY_NOTIFICATIONS_ONBOARDING]:"notifications.onboarding",[this.KEY_TEXTAREA_DYNAMIC_SIZING]:"dynamic-textarea-resizing",[this.KEY_TOOLTIP_SCREENSHOTS]:"tooltipScreenshots",[this.KEY_WAS_BLIZZARD_REFERRAL_TIME]:"blizz-skin-suppression",[this.KEY_WAS_COIL_START_TIME]:"cmStarted",[this.KEY_WAS_DFP_LOG]:"dfpLog",[this.KEY_WOW_API_CHARACTER_CACHE]:"BattleNetCharCache",[this.KEY_WOW_ATTUNEMENT_TRACKER]:"wow.attunementTracker",[this.KEY_WOW_DATABASE_CLASS_FILTER]:"dynamic_quest_class",[this.KEY_WOW_DATABASE_SPEC_FILTER]:"tooltips_class:spec",[this.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY]:"dressingRoom.appearanceHistory",[this.KEY_WOW_DRESSING_ROOM_LAST_CATEGORY]:"WH.Wow.DressingRoom.lastCategory",[this.KEY_WOW_DRESSING_ROOM_LAST_MODEL]:"dressingRoom.lastViewedModel",[this.KEY_WOW_GEAR_PLANNER_HASHES]:(()=>{switch(WH.getDataTree()){case WH.dataTree.CLASSIC:return"wow.gearPlanner.hashes";case WH.dataTree.TBC:return"wow.gearPlannerTbc.hashes";default:return"wow.gearPlannerWrath.hashes"}})(),[this.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL]:"defaultModel",[this.KEY_WOW_MODEL_VIEWER_LAST_MODEL]:"lastViewedModel",[this.KEY_WOW_MODEL_VIEWER_SHEATHED]:"WH.ModelViewer.sheathed",[this.KEY_WOW_SHADOWLANDS_BUILD_PLANNER_HASH]:"WH.Wow.ShadowlandsBuildPlanner.hash",[this.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS]:"talent-calc-show-top-builds",[this.KEY_WOW_TODAY_IN_WOW_FILTER]:"today-in-wow-filter",[this.KEY_WOW_TODAY_IN_WOW_VISIBILITY]:"today-in-wow-visibility"};const n={[this.KEY_NEWSLETTER_CTA_POPOVER_SETTINGS]:"KEY_CTA_POPOVER_SETTINGS",[this.KEY_NEWSLETTER_CTA_POPOVER_VISITS]:"KEY_CTA_POPOVER_VISITS"};const s=1;const r=2;const o={[this.KEY_AUDIO_PLAYLIST]:s,[this.KEY_BLUETRACKER_GAMES_FILTER]:s,[this.KEY_BLUETRACKER_REGION_FILTER]:s,[this.KEY_NEWS_LIST_FILTER]:s,[this.KEY_NEWS_TOGGLER]:s,[this.KEY_PREFERRED_SEASON]:s,[this.KEY_WOW_ATTUNEMENT_TRACKER]:r,[this.KEY_WOW_DATABASE_CLASS_FILTER]:s,[this.KEY_WOW_DATABASE_SPEC_FILTER]:s,[this.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY]:s,[this.KEY_WOW_DRESSING_ROOM_LAST_MODEL]:s,[this.KEY_WOW_GEAR_PLANNER_HASHES]:r,[this.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL]:r,[this.KEY_WOW_MODEL_VIEWER_LAST_MODEL]:r,[this.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS]:s,[this.KEY_WOW_TODAY_IN_WOW_VISIBILITY]:r};const l="accessed";const c="created";const u="modified";this.get=function(t){if(!e.isSupported()){return undefined}let a=p(t);let i=H(a);if(i){try{i.accessed=d(new Date);localStorage.setItem(a,JSON.stringify(i))}catch(e){WH.error("Error when updating local storage data access time.",a,e)}return i.value}else{return i}};this.isSupported=function(){let t;try{t="localStorage"in window&&window["localStorage"]!==null;if(t){localStorage.setItem("test","123");t=localStorage.getItem("test")==="123";localStorage.removeItem("test")}}catch(e){t=false}e.isSupported=(e=>e).bind(null,t);return t};this.remove=function(t){if(!e.isSupported()){return}localStorage.removeItem(p(t));if(i[t]){localStorage.removeItem(i[t])}};this.set=function(t,a){if(!e.isSupported()){return}E(p(t),a)};function d(e){return Math.floor(e.getTime()/1e3).toString(36)}function f(e){return new Date(parseInt(e,36)*1e3)}function h(e){return{value:undefined,created:d(e||new Date)}}function p(e,t,a){let i="wh:";if(e.startsWith(i)){WH.error("Tried to re-finalize a local storage key.");return e}switch(o[e]){case s:a=WH.getDataTree(t);i+=`${WH.getDataTreeKey(a)}.${WH.getDataEnvKey(t)}`;break;case r:i+=`${WH.getDataTreeKey(a)}`;break}return`${i}/${e}`}function m(e,t){let a=H(p(e));if(a){return f(a[t])}}function H(e){try{let t=JSON.parse(localStorage.getItem(e));if(t===null||g(t)){return t}}catch(t){let a;try{a=localStorage.getItem(e)}catch(e){a="Error with getItem(): "+WH.getThrownErrorMessage(e)}WH.error("Failed to parse local storage data that should have been JSON.",e,a)}}function g(e){return!!(e&&typeof e==="object"&&typeof e.created==="string"&&e.hasOwnProperty("value"))}function W(){const s=WH.Wow.PlayerClass;const r=WH.Wow.Race;if(!e.isSupported()){return}let o=new Date;let l=WH.getDataTree();let c=t.getDataEnvs(t.WOW);let u=[WH.dataTree.CLASSIC,WH.dataTree.TBC,WH.dataTree.WRATH,WH.dataTree.CATA,WH.dataTree.MISTS];try{let t=/^announcements-closed(-(\d+))?$/;let a=[];let i={};Object.keys(localStorage).filter((e=>e.startsWith("announcements-closed"))).forEach((e=>{let n=e.match(t);if(!n){return}let s;try{s=localStorage.getItem(e)}catch(t){WH.error(`Could not fetch closed announcement value from legacy key "${e}".`);return}let r;try{r=s.match(/^"?([\d,]+)"?$/)[1].split(",").map((e=>parseInt(e))).filter(Boolean)}catch(e){}if(!Array.isArray(r)){a.push(e);return}if(n[2]){i[n[2]]=r}else{i[0]=r}a.push(e)}));if(a.length){E(p(e.KEY_ANNOUNCEMENTS_CLOSED),i,o);a.forEach((e=>localStorage.removeItem(e)))}}catch(e){WH.error("Error when migrating announcements local storage values.",e)}try{let t=/^highlight-([a-z0-9-]+)$/;let a=[];let i=[];Object.keys(localStorage).filter((e=>e.startsWith("highlight-"))).forEach((e=>{let n=e.match(t);if(!n){return}let s;try{s=JSON.parse(localStorage.getItem(e))}catch(t){WH.error(`Could not fetch closed highlight value from legacy key "${e}".`);return}if(s!==true){return}i.push(n[1]);a.push(e)}));if(a.length){E(p(e.KEY_HIGHLIGHTS_CLOSED),i,o);a.forEach((e=>localStorage.removeItem(e)))}}catch(e){WH.error("Error when migrating highlights local storage values.",e)}const d=[e.KEY_WOW_DATABASE_SPEC_FILTER,e.KEY_WOW_SHADOWLANDS_BUILD_PLANNER_HASH];Object.entries(i).forEach((([t,a])=>{try{let i;try{i=localStorage.getItem(a)}catch(e){WH.error(`Could not migrate legacy local storage value from legacy key "${a}".`);return}if(i===null){return}let n;try{n=JSON.parse(i)}catch(e){if(d.includes(t)){WH.debug("Found legacy non-JSON local storage value. Migrating it to JSON.",a,i);n=i}else{WH.error(`Could not migrate invalid JSON value from legacy key "${a}".`);return}}let f;let h;switch(t){case e.KEY_AUDIO_PLAYLIST:f=c;break;case e.KEY_NEWS_LIST_FILTER:f=[WH.dataEnv.MAIN];break;case e.KEY_WOW_ATTUNEMENT_TRACKER:h=[WH.dataTree.TBC];break;case e.KEY_WOW_DATABASE_CLASS_FILTER:let d=parseInt(n);f=c.filter((e=>s.exists(d,e)));break;case e.KEY_WOW_DATABASE_SPEC_FILTER:try{n=n.split(":");n={classId:parseInt(n[0]),specId:parseInt(n[1])};f=c.filter((e=>s.exists(n.classId,e)))}catch(e){f=[]}break;case e.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY:f=[WH.dataEnv.MAIN,WH.dataEnv.PTR,WH.dataEnv.PTR2,WH.dataEnv.BETA];let m=false;if(u.includes(l)){m=true;u.forEach((e=>{Object.entries(WH.dataEnvToTree).forEach((([t,a])=>{if(a===e){f.push(parseInt(t))}}))}))}f.forEach((e=>{if(!m&&u.includes(WH.getDataTree(e))){return}let a=r.ID_HUMAN;let n=JSON.parse(i);Object.keys(n.entries).forEach((t=>{t=parseInt(t);if(r.exists(t,e)){a=Math.max(a,t)}else{if(![r.ID_BLOOD_ELF,r.ID_DRAENEI].includes(t)){m=false;if(u.includes(WH.getDataTree(e))){return}}delete n.entries[t]}}));if(!r.exists(n.race,e)){n.race=a}if(Object.keys(n.entries)){E(p(t,e),n,o)}}));localStorage.removeItem(a);return;case e.KEY_WOW_DRESSING_ROOM_LAST_MODEL:case e.KEY_WOW_MODEL_VIEWER_LAST_MODEL:c.forEach((e=>{let a=Array.isArray(n);if(a){n.forEach((t=>{if(t.race&&!r.exists(parseInt(t.race),e)){a=false}}))}if(a){E(p(t,e),n,o)}}));localStorage.removeItem(a);return;case e.KEY_WOW_GEAR_PLANNER_HASHES:h=[WH.dataTree.CLASSIC,WH.dataTree.TBC].includes(l)?[l]:[WH.dataTree.WRATH];break;case e.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL:if(n.race){h=c.filter((e=>r.exists(n.race,e)))}break;case e.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS:f=[WH.dataEnv.MAIN];break;case e.KEY_WOW_TODAY_IN_WOW_VISIBILITY:h=[WH.dataTree.RETAIL];break}try{JSON.stringify(n)}catch(e){WH.error("Failed to stringify local storage value during migration.",WH.getThrownErrorMessage(e),t,n);return}localStorage.removeItem(a);if(f){f.forEach((e=>{E(p(t,e),n,o)}))}else if(h){h.forEach((e=>{E(p(t,undefined,e),n,o)}))}else{E(p(t),n,o)}}catch(e){WH.error(`Error when migrating legacy local storage key "${a}".`,e)}}));Object.entries(n).forEach((([t,a])=>{try{let i=e.get(a)??null;if(i!==null){e.set(t,i);e.remove(a)}}catch(e){WH.error(`Error when renaming modern key "${a}" to "${t}".`,e)}}));Object.values(a).forEach((e=>localStorage.removeItem(e)))}function E(e,t,a){a=a||new Date;let i=H(e);if(i){i.modified=d(a)}else{i=h(a)}i.value=t;let n;try{n=JSON.stringify(i)}catch(a){WH.error("Failed to stringify local storage data.",WH.getThrownErrorMessage(a),e,t);return}localStorage.setItem(e,n)}WH.aE(document,"bodyAvailable",W);WH.aE(document,"bodyAvailable",(()=>{if(!WH.User.isLoggedIn()||!e.get(e.KEY_TOOLTIP_SCREENSHOTS)){return}if(WH.User.hasSetting(WH.User.SETTING_PREMIUM_TOOLTIP_SCREENSHOTS)){e.remove(e.KEY_TOOLTIP_SCREENSHOTS);return}WH.fetch(WH.Url.generate("/account/update-tooltip-screenshots"),{method:"POST",json:{_csrf:WH.User.getSessionKey(),newState:true},success:t=>{if(t.success){e.remove(e.KEY_TOOLTIP_SCREENSHOTS)}}})}))};WH.SessionStorage=new function(){const e=this;this.KEY_RANDOM_SHOW_ICON="random.showIcon";this.KEY_LISTVIEW_BROWSE="listview.browse";const t=1;const a={[this.KEY_LISTVIEW_BROWSE]:t};this.isSupported=function(){let t;try{t="sessionStorage"in window&&window["sessionStorage"]!==null;if(t){let e=i("test");let a="123";sessionStorage.setItem(e,a);t=sessionStorage.getItem(e)===a;sessionStorage.removeItem(e)}}catch(e){t=false}e.isSupported=(e=>e).bind(null,t);return t};this.set=function(t,a){if(!e.isSupported()){return}let n;try{n=JSON.stringify(a)}catch(e){WH.error("Failed to stringify session storage data.",WH.getThrownErrorMessage(e),t,a);return}sessionStorage.setItem(i(t),n)};this.get=function(t){if(!e.isSupported()){return undefined}let a=i(t);try{return JSON.parse(sessionStorage.getItem(a))}catch(e){let i;try{i=sessionStorage.getItem(a)}catch(e){i="Error with getItem(): "+WH.getThrownErrorMessage(e)}WH.error("Failed to parse session storage data that should have been JSON.",t,i);return undefined}};this.remove=function(t){if(!e.isSupported()){return}sessionStorage.removeItem(i(t))};function i(e){let i="wh.";if(e.startsWith(i)){WH.error("Tried to re-finalize a session storage key.");return e}switch(a[e]){case t:i+=`dataEnv:${WH.getDataEnv()}.`;break}return i+e}};WH.Time=new function(){const e=this;this.ANIMATION_SPEED_FAST_MS=150;this.DAYS_PER_WEEK=7;this.FORMAT_ABBR="ABBR";this.FORMAT_PLURAL="PLURAL";this.FORMAT_SINGULAR="SINGULAR";this.FORMAT_SYMBOL="SYMBOL";this.MS_SEC=1e3;this.MS_MIN=this.MS_SEC*60;this.MS_HOUR=this.MS_MIN*60;this.MS_DAY=this.MS_HOUR*24;this.SEC_MIN=60;this.SEC_HOUR=this.SEC_MIN*60;this.SEC_DAY=this.SEC_HOUR*24;this.MIN_HOUR=60;const t=[WH.TERMS.january,WH.TERMS.february,WH.TERMS.march,WH.TERMS.april,WH.TERMS.may,WH.TERMS.june,WH.TERMS.july,WH.TERMS.august,WH.TERMS.september,WH.TERMS.october,WH.TERMS.november,WH.TERMS.december];const a={[this.FORMAT_ABBR]:{SECOND:WH.TERMS.second_abbrev,MINUTE:WH.TERMS.minute_abbrev,HOUR:WH.TERMS.hour_abbrev,DAY:WH.TERMS.day_abbrev,WEEK:WH.TERMS.week_abbrev,MONTH:WH.TERMS.month_abbrev,YEAR:WH.TERMS.year_abbrev},[this.FORMAT_PLURAL]:{SECOND:WH.TERMS.seconds_lc,MINUTE:WH.TERMS.minutes_lc,HOUR:WH.TERMS.hours_lc,DAY:WH.TERMS.days_lc,WEEK:WH.TERMS.weeks_lc,MONTH:WH.TERMS.months_lc,YEAR:WH.TERMS.years_lc},[this.FORMAT_SINGULAR]:{SECOND:WH.TERMS.second_lc,MINUTE:WH.TERMS.minute_lc,HOUR:WH.TERMS.hour_lc,DAY:WH.TERMS.day_lc,WEEK:WH.TERMS.week_lc,MONTH:WH.TERMS.month_lc,YEAR:WH.TERMS.year_lc},[this.FORMAT_SYMBOL]:{SECOND:WH.TERMS.second_short_abbrev,MINUTE:WH.TERMS.minute_short_abbrev,HOUR:WH.TERMS.hour_short_abbrev,DAY:WH.TERMS.day_short_abbrev,WEEK:WH.TERMS.week_short_abbrev,MONTH:WH.TERMS.month_short_abbrev,YEAR:WH.TERMS.year_short_abbrev}};const i=[WH.TERMS.sunday,WH.TERMS.monday,WH.TERMS.tuesday,WH.TERMS.wednesday,WH.TERMS.thursday,WH.TERMS.friday,WH.TERMS.saturday];this.formatDeltaWithSymbols=function(t){let i;if(t<e.SEC_MIN){let e=Math.floor(t);i=e+a.SYMBOL.SECOND}else if(t<e.SEC_HOUR){let e=Math.floor(t/60);i=e+a.SYMBOL.MINUTE}else if(t<e.SEC_DAY){let n=Math.floor(t/e.SEC_HOUR);let s=Math.floor((t-n*e.SEC_HOUR)/e.SEC_MIN);i=n+a.SYMBOL.HOUR;if(s>0){i+=WH.TERMS.wordspace_punct+s+a.SYMBOL.MINUTE}}else{let n=Math.floor(t/e.SEC_DAY);let s=Math.floor((t-n*e.SEC_DAY)/e.SEC_HOUR);i=n+a.SYMBOL.DAY;if(s>0){i+=WH.TERMS.wordspace_punct+s+a.SYMBOL.HOUR}}return i};this.formatFutureTimeAndDay=(n,s,r)=>{let o;let l=new Date;let c=l.getTime()/e.MS_SEC;let u=n.getTime()/e.MS_SEC;if(u-e.SEC_HOUR<c){let t=Math.floor((u-c)/e.SEC_MIN);let i=r===e.FORMAT_SYMBOL?"":WH.TERMS.wordspace_punct;let n=r??(t===1?e.FORMAT_SINGULAR:e.FORMAT_PLURAL);let s=new DocumentFragment;let l=WH.ce("span",{},WH.ct(t+i+a[n].MINUTE));WH.ae(s,l);o=s}else if(u-e.SEC_HOUR*8<c){let t=Math.floor((u-c)/e.SEC_MIN);let i=Math.floor(t/60);t-=i*60;let l=r===e.FORMAT_SYMBOL?"":WH.TERMS.wordspace_punct;let d=r??(i===1?e.FORMAT_SINGULAR:e.FORMAT_PLURAL);let f=i+l+a[d].HOUR;if(t>0){let i=r??(t===1?e.FORMAT_SINGULAR:e.FORMAT_PLURAL);f+=WH.TERMS.wordspace_punct+t+l+a[i].MINUTE}let h=WH.ce("span",{className:"status-widget-info-timer-future"},WH.ct(WH.TERMS.openparenthesis_punct+e.formatTimeOfDay(n,s)+WH.TERMS.closedparenthesis_punct));let p=WH.ce("span",{},WH.ct(f+WH.TERMS.wordspace_punct));let m=new DocumentFragment;WH.ae(m,p);WH.ae(m,h);o=m}else{let a=new DocumentFragment;if(n.toDateString()===l.toDateString()){let t=WH.ce("span",{},WH.ct(e.formatTimeOfDay(n,s)));WH.ae(a,t);o=a}else{let r;if(n<=new Date(l.getFullYear(),l.getMonth(),l.getDate()+6,23,59)){r=n.getDate()-1===l.getDate()?WH.TERMS.tomorrow:i[n.getDay()]}else{r=i[n.getDay()]+WH.TERMS.wordspace_punct+t[n.getMonth()]+WH.TERMS.wordspace_punct+n.getDate()}let c=WH.ce("span",{},WH.ct(e.formatTimeOfDay(n,s)+WH.TERMS.wordspace_punct));let u=WH.ce("span",{className:"status-widget-info-timer-future"},WH.ct(r));WH.ae(a,c);WH.ae(a,u);o=a}}return o};this.formatTimeOfDay=function(e,t){let a=e.getHours();let i=WH.leadingZeroes(e.getMinutes(),2);let n;if(t===true){n=a+":"+i}else{let e=a>=12?WH.TERMS.pm:WH.TERMS.am;if(a>12){n=a-12}else if(a===0){n=12}else{n=a}n+=":"+i+WH.TERMS.wordspace_punct+e}return n};this.getMonthName=function(e){return t[e]};this.getWeekdayName=function(e){return i[e]};this.toISO8601=e=>WH.Strings.sprintf("%04d-%02d-%02dT%02d:%02d:%02d",e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());this.unix=function(){return Math.floor((new Date).getTime()/1e3)}};WH.Admin=new function(){this.foo="test"};function Ajax(e,t){if(!e){return}var a;try{a=new XMLHttpRequest}catch(e){return}this.request=a;WH.cO(this,t);this.method=this.method||this.params&&"POST"||"GET";a.open(this.method,e,this.async==null?true:this.async);a.onreadystatechange=Ajax.onReadyStateChange.bind(this);if(this.method.toUpperCase()=="POST"){a.setRequestHeader("Content-Type",(this.contentType||"application/x-www-form-urlencoded")+"; charset="+(this.encoding||"UTF-8"))}a.send(this.params)}Ajax.onReadyStateChange=function(){if(this.request.readyState==4){if(this.request.status==0||this.request.status>=200&&this.request.status<300){this.onSuccess!=null&&this.onSuccess(this.request,this)}else{this.onFailure!=null&&this.onFailure(this.request,this)}if(this.onComplete!=null){this.onComplete(this.request,this)}}};WH.Announcement=function(e){const t=this;const a=WH.LocalStorage;const i=WH.Strings;const n=WH.Track;const s=WH.User;const r={allowMarkup:undefined,class:undefined,elements:{innerDiv:undefined},id:undefined,mobileText:undefined,parent:undefined,text:undefined};this.hide=function(){r.parentDiv.dataset.animation="hide";setTimeout((function(){r.parentDiv.classList.remove("show");delete r.parentDiv.dataset.animation}),200)};this.markRead=function(){n.interactiveEvent({category:"Announcements",action:"Close",label:""+r.name});if(!u()){let e=a.get(a.KEY_ANNOUNCEMENTS_CLOSED)||{};let t=s.getId();if(!Array.isArray(e[t])){e[t]=[]}if(!e[t].includes(r.id)){e[t].push(r.id)}a.set(a.KEY_ANNOUNCEMENTS_CLOSED,e)}t.hide()};this.setClass=function(e){r.class=e;r.parentDiv.className=l()};this.setStyle=function(e){r.elements.innerDiv.setAttribute("style",e?WH.fixWowheadHttps(e):"")};this.setText=function(e,t){r.text=e;r.mobiletext=t;o(r.parent+"-markup",r.text);o(r.parent+"-markup-responsive",t||e)};this.show=function(){r.parentDiv.classList.add("show");n.nonInteractiveEvent({category:"Announcements",action:"Show",label:""+r.name})};function o(e,t){let a=WH.ge(e);if(r.allowMarkup){WH.markup.printHtml(t,a.id,{allow:WH.markup.CLASS.STAFF})}else{WH.st(a,t)}WH.qsa("a",a).forEach((e=>{WH.aE(e,"click",(()=>{let t="unknown";let a=WH.getFirstTextContent(e);if(a){t=i.slug(a)}else if(e.title){t=i.slug(e.title)}else if(e.id){t=i.slug(e.id)}t=`${r.id||0}-${t}`;n.linkClick(e,{category:"Announcements",label:t})}))}))}function l(){let e="announcement announcement-";switch(r.mode){case 2:e+="fixed";break;case 0:e+="pagetop";break;case 1:default:e+="contenttop"}if(r.class){r.class.split(" ").forEach((function(t){e+=" announcement-styling-"+t}))}return e}function c(e){if(WH.UserAgent.isWebCrawler()){return}if(!e||!e.hasOwnProperty("id")||!["number","string","undefined"].includes(typeof e.id)||typeof e.parent!=="string"||typeof e.text!=="string"){WH.error("Announcement initialized with invalid options.",e);return}r.id=e.id;r.parent=e.parent;r.text=e.text;if(!e.admin&&u()){return}r.allowMarkup=typeof e.allowMarkup==="boolean"?e.allowMarkup:true;r.parentDiv=e.parentDiv||WH.ge(r.parent);r.parentDiv.dataset.announcementId=r.id;WH.displayNone(r.parentDiv);r.class=e.class;r.parentDiv.className=l();let a=r.elements.innerDiv=WH.ce("div",{className:"announcement-inner text"});if(e.style){t.setStyle(e.style)}let i=typeof e.id==="string";if(WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BUREAU)>0&&!i){if(!e.admin){let e=WH.ce("a",{ariaLabel:WH.TERMS.edit,className:"fa fa-pencil",href:WH.Url.generatePath("/admin/announcements/edit/"+r.id)});WH.Tooltips.attachNonTouch(e,WH.TERMS.edit,"q2");WH.ae(a,e)}}WH.ae(a,WH.ce("div",{className:"announcement-markup",id:r.parent+"-markup"}));WH.ae(a,WH.ce("div",{className:"announcement-markup-responsive",id:r.parent+"-markup-responsive"}));if(!i&&!e.admin){let i=WH.ce("a",{className:"fa fa-times announcement-close",id:"closeannouncement"});WH.aE(i,"click",e.nocookie?t.hide:t.markRead);WH.ae(a,i);WH.Tooltips.attachNonTouch(i,WH.TERMS.close,"q2")}WH.ae(a,WH.ce("div",{style:{clear:"both"}}));WH.ae(r.parentDiv,a);t.setText(e.text,e.mobiletext);t.show()}function u(){if(!r.id){return false}let e=(a.get(a.KEY_ANNOUNCEMENTS_CLOSED)||{})[s.getId()];return Array.isArray(e)&&e.includes(r.id)}c(e)};WH.Announcement.forgetRead=function(){const e=WH.LocalStorage;let t=e.get(e.KEY_ANNOUNCEMENTS_CLOSED);delete t[WH.User.getId()];e.set(e.KEY_ANNOUNCEMENTS_CLOSED,t);let a=WH.ge("announcetext");if(a){WH.ee(a);WH.ae(a,WH.ct(WH.TERMS.purgesuccess_tip));a.className="q2"}else{alert(WH.TERMS.purgesuccess_tip)}};var g_audiocontrols={__windowloaded:false,__rewardedAchievement:false};var g_audioplaylist={};if(!window.JSON){window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(e){if(e instanceof Object){var t="";if(e.constructor===Array){for(var a=0;a<e.length;t+=this.stringify(e[a])+",",a++);return"["+t.substr(0,t.length-1)+"]"}if(e.toString!==Object.prototype.toString){return'"'+e.toString().replace(/"/g,"\\$&")+'"'}for(var i in e){t+='"'+i.replace(/"/g,"\\$&")+'":'+this.stringify(e[i])+","}return"{"+t.substr(0,t.length-1)+"}"}return typeof e==="string"?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}}}AudioControls=function(){const e=WH.Strings;const t={addAllTracks:false,list:undefined};var a=-1;var i=false;var n=false;var s=false;var r={};var o=[];function l(){if(g_audiocontrols.__rewardedAchievement)return;if(!(WH.isSet("g_user")&&g_user.id))return;$.ajax({url:WH.Url.generatePath("/website-achievement-explored"),data:{trigger:"playsound"},success:function(){AchievementCheck()},type:"POST"});g_audiocontrols.__rewardedAchievement=true}function c(e,n,c){var f=WH.ce("audio");f.preload="none";f.controls="true";$(f).click((function(e){e.stopPropagation()}));WH.aE(f,"ended",l);f.style.marginTop="5px";r.audio.parentNode.replaceChild(f,r.audio);r.audio=f;WH.aE(r.audio,"ended",d.bind(e));if(c){f.preload="auto";s=true;WH.aE(r.audio,"canplaythrough",u.bind(this))}if(!i)r.table.style.visibility="visible";var h;do{a+=n;if(a>o.length-1){a=0;if(!i){WH.de(r.table);WH.de('a[href*="/sound&playlist"].btn');return}}if(a<0)a=o.length-1;h=o[a]}while(r.audio.canPlayType(h.type)=="");var p=WH.ce("source");p.src=h.url;p.type=h.type;WH.ae(r.audio,p);if(t.list){t.list.childNodes.forEach((function(e){e.dataset.current=JSON.stringify(e.dataset.track===h.title)}))}if(r.hasOwnProperty("trackDisplay")){WH.st(r.trackDisplay,a+1+" / "+o.length)}if(!i){i=true;for(let e=a+1;e<=o.length-1;e++){if(r.audio.canPlayType(o[e].type)){WH.qsa("a",r.controls).forEach((function(e){delete e.dataset.disabled}));break}}}if(r.hasOwnProperty("addbutton")){delete r.addbutton.dataset.disabled;WH.st(r.addbutton,WH.TERMS.playlist)}}function u(){if(!s)return;s=false;r.audio.play()}this.init=function(a,i,s){if(!Array.isArray(a)){return}if(a.length===0){return}if(i.id===""||g_audiocontrols.hasOwnProperty(i.id)){i.id=e.guid()}g_audiocontrols[i.id]=this;if(typeof s=="undefined"){s={}}t.list=s.list;n=!!s.loop;o=a;r.div=i;r.controls=WH.ce("div",{className:"audio-controls-controls"});if(!s.listview){var l=WH.ce("table",{className:"audio-controls"});r.table=l;r.table.style.visibility="hidden";WH.ae(r.div,l);var c=WH.ce("tr");WH.ae(l,c);var u=WH.ce("td");WH.ae(c,u);r.audio=WH.ce("div");WH.ae(u,r.audio);WH.ae(u,r.controls);let e=f(WH.TERMS.previous,"step-backward",true);WH.ae(r.controls,e);WH.aE(e,"click",this.btnPrevTrack.bind(this));r.trackDisplay=WH.ce("div",{className:"audio-controls-track"});WH.ae(r.controls,r.trackDisplay);let t=f(WH.TERMS.next,"step-forward",true);WH.ae(r.controls,t);WH.aE(t,"click",this.btnNextTrack.bind(this))}else{t.addAllTracks=true;let e=WH.ce("div",{className:"audio-controls"});r.table=e;WH.ae(r.div,e);r.audio=WH.ce("div");WH.ae(e,r.audio);r.trackDisplay=s.trackDisplay;WH.ae(e,r.controls)}r.table.dataset.tracks=""+o.length;r.trackDisplay.dataset.tracks=""+o.length;if(g_audioplaylist.isEnabled()&&!s.fromPlaylist){let e=f(WH.TERMS.playlist,"plus");WH.ae(r.controls,e);WH.aE(e,"click",this.btnAddToPlaylist.bind(this,e));r.addbutton=e}if(g_audiocontrols.__windowloaded)this.btnNextTrack()};function d(){c(this,1,n||a<o.length-1)}this.btnNextTrack=function(){c(this,1,i&&r.audio.readyState>1&&!r.audio.paused)};this.btnPrevTrack=function(){c(this,-1,i&&r.audio.readyState>1&&!r.audio.paused)};this.btnAddToPlaylist=function(e){if(t.addAllTracks){for(let e=0;e<o.length;e++){g_audioplaylist.addSound(o[e])}}else{g_audioplaylist.addSound(o[a])}e.dataset.disabled="true";e.classList.remove("fa-plus");e.classList.add("fa-check");WH.st(e,WH.TERMS.added)};this.isPlaying=function(){return!r.audio.paused};this.removeSelf=function(){r.table.parentNode.removeChild(r.table);delete g_audiocontrols[r.div]};function f(e,t,a){let i=WH.ce("a",{className:"audio-controls-control page-action fa fa-"+t,href:"javascript:"},WH.ct(e));if(a){i.dataset.disabled="true"}return i}};WH.aE(window,"load",(function(){g_audiocontrols.__windowloaded=true;for(var e in g_audiocontrols)if(e.substr(0,2)!="__")g_audiocontrols[e].btnNextTrack()}));AudioPlaylist=function(){const e=WH.LocalStorage;var t=false;var a=[];var i,n;var s=false;this.init=function(){if(!e.isSupported()){return}t=true;let i=e.get(e.KEY_AUDIO_PLAYLIST);if(Array.isArray(i)){a=i}};this.savePlaylist=function(){if(!t)return false;e.set(e.KEY_AUDIO_PLAYLIST,a)};this.isEnabled=function(){return t};this.addSound=function(e){if(!t)return false;this.init();a.push(e);this.savePlaylist();r()};this.deleteSound=function(e){if(e<0){a=[]}else{a.splice(e,1)}this.savePlaylist();if(!i.isPlaying()){i.removeSelf();this.setAudioControls(n)}if(a.length==0)WH.Tooltips.hide()};this.getList=function(){var e=[];for(var t=0;t<a.length;t++)e.push(a[t].title);return e};this.setAudioControls=function(e){if(!t)return false;n=e;i=new AudioControls;i.init(a,n,{loop:true,fromPlaylist:true})};function r(){if(s)return;if(!(WH.isSet("g_user")&&g_user.id))return;if(a.length<2)return;$.ajax({url:WH.Url.generatePath("/sound?playlist"),data:{achievement:1},success:function(){AchievementCheck()},type:"POST"});s=true}};g_audioplaylist=new AudioPlaylist;g_audioplaylist.init();WH.BlizzardApi=new function(){const e=WH.LocalStorage;const t={us:"northamerican_abbrev",eu:"european_abbrev",cn:"chinese_abbrev",tw:"taiwanese_abbrev",kr:"korean_abbrev"};var a={us:"us.api.blizzard.com",eu:"eu.api.blizzard.com",kr:"kr.api.blizzard.com",tw:"tw.api.blizzard.com"};var i=false;var n={};var s=[];this.apiCall=function(e,t,i){e=e.toLowerCase();if(!a.hasOwnProperty(e)){WH.error("Invalid region passed to Blizzard API:",e);return}if(!n.token||n.hasOwnProperty("expires")&&n.expires<new Date){if(n.failed){var s=["error","complete"];for(var r,o=0;r=s[o];o++){if(typeof i[r]==="function"){i[r]=[i[r]]}if(Array.isArray(i[r])){while(i[r].length){i[r].shift()({status:400},"abort")}}}}else{this.getNewToken(this.apiCall.bind(this,e,t,i))}return}i.url="https://"+a[e]+t;if(!i.hasOwnProperty("headers")){i.headers={}}i.headers.Authorization="Bearer "+n.token;$.ajax(i)};this.characterExists=function(t,a,n,s){if(!e.isSupported()||!(JSON&&"stringify"in JSON)){s(true);return}var r=a.toLowerCase().replace(/[^\w -]/,"").replace(" ","-");var o=(t+"|"+r+"|"+n).toLowerCase();if(!i){i={};try{i=e.get(e.KEY_WOW_API_CHARACTER_CACHE);if(i==null){i={}}}catch(e){i={}}}if(i.hasOwnProperty(o)){if(parseInt(i[o].substr(1),10)>Math.floor((Date.now()-1e3*60*60*24*4)/1e3)){s(i[o].substr(0,1)=="t");return}}var l=function(t){i[o]=(t&&t.is_valid?"t":"f")+Math.floor(Date.now()/1e3);e.set(e.KEY_WOW_API_CHARACTER_CACHE,i);s(t&&t.name)};WH.Wow.Realm.fetchData(function(){var e=WH.Wow.Realm.getSlugByName(t,a);if(!e){l(false)}else{this.apiCall(t,WH.Strings.sprintf("/profile/wow/character/%s/%s/status?namespace=profile-%s",encodeURIComponent(e),encodeURIComponent(n.toLocaleLowerCase()),t.toLowerCase()),{dataType:"json",method:"GET",success:l,error:l.bind(null,false)})}}.bind(this))};this.getCharacterThumbnailUrl=function(e,t){return"https://render-"+e.toLowerCase()+".worldofwarcraft.com/character/"+t};this.getNewToken=function(e){s.push(e);if(s.length>1){return}var t=$.ajax.bind($,{url:WH.Url.generatePath("/blizzard-api/token"),dataType:"json",method:"GET",success:this.setToken,error:function(e){WH.error("Could not get Blizzard API token from Wowhead",e);this.setToken(null)}.bind(this)});if(!n.hasOwnProperty("token")&&document.readyState=="loading"&&document.addEventListener){var a=function(){document.removeEventListener("readystatechange",a,false);if(!n.hasOwnProperty("token")){t()}};document.addEventListener("readystatechange",a,false)}else{t()}};this.getNotFoundMessage=function(){let e=document.createDocumentFragment();WH.ae(e,WH.ct(WH.TERMS.characterDoesNotExist_tip));let t=WH.ce("ul");WH.ae(e,t);WH.ae(t,WH.ce("li",{},WH.ct(WH.TERMS.characterHasBeenAccessedRecently_tip)));WH.ae(t,WH.ce("li",{innerHTML:WH.Strings.sprintf(WH.TERMS.yourBlizzardSettingsSetToEnabled_format,WH.ce("a",{href:"https://account.blizzard.com/privacy"},WH.ct(WH.TERMS.gameDataAndProfilePrivacy)).outerHTML)}));let a=WH.ce("div",{innerHTML:WH.Strings.sprintf(WH.TERMS.furtherIssues_format,WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.feedback)).outerHTML)});WH.aE(a.querySelector("a"),"click",ContactTool.show.bind(ContactTool,undefined));while(a.hasChildNodes()){WH.ae(e,a.removeChild(a.firstChild))}return e};this.getRegionAbbreviation=function(e){return WH.TERMS[t[e.toLowerCase()]]};this.setToken=function(e){if(!e||!e.hasOwnProperty("token")){n={failed:true};while(s.length){s.shift()()}n={};return}n=e;n.expires=new Date(Date.now()+n.expires*1e3);while(s.length){s.shift()()}}};WH.Button=function({clickHandler:e,disabled:t,href:a,iconConfig:i,label:n,size:s=null,style:r=null,type:o=null,...l}){const c=Object.seal({elements:Object.seal({button:undefined,iconContainer:undefined,label:undefined}),iconPortalId:undefined});this.enable=()=>c.elements.button.removeAttribute("disabled");this.getElement=()=>c.elements.button;this.updateIcon=e=>{if(c.iconPortalId){WH.React.closePortal(c.iconPortalId)}if(c.elements.iconContainer){WH.de(c.elements.iconContainer)}const{iconPosition:t}=e;f(c.elements.button,e);if(t){c.elements.button.dataset.iconPosition=t}};this.updateText=e=>{if(r==="image"){return}if(!c.elements.label){d(c.elements.button,e)}else{WH.st(c.elements.label,e)}};const u=({clickHandler:e,disabled:t,href:a,iconConfig:i,label:n,size:s=null,style:r=null,type:o=null,...l})=>{const u=a?"a":"button";c.elements.button=WH.ce(u,{className:"wh-button"});if(t){c.elements.button.setAttribute("disabled","true")}if(i){const{iconPosition:e}=i;f(c.elements.button,i);if(e){c.elements.button.dataset.iconPosition=e}}if(a){c.elements.button.href=a}n&&r!=="image"&&d(c.elements.button,n);const h={size:s,style:r,type:o};Object.entries(h).forEach((([e,t])=>{if(t!=null){c.elements.button.dataset[e]=t}}));if(l&&typeof l==="object"){Object.entries(l).forEach((([e,t])=>c.elements.button.setAttribute(e,t)))}if(e){WH.aE(c.elements.button,"click",(t=>e(t,c.elements.button)))}};const d=(e,a)=>{c.elements.label=WH.ae(e,WH.ce("span",{className:"wh-button-text",disabled:t},WH.ct(a)))};const f=(e,t)=>{const{faIcon:a,faIconName:i,iconUrl:n}=t;c.elements.iconContainer=WH.ae(e,WH.ce("span",{className:"wh-button-icon"}));if(n){WH.ae(c.elements.iconContainer,WH.ce("img",{src:n}))}else if(a){h(c.elements.iconContainer,a)}else if(i){["fa",`fa-${i}`].forEach((e=>c.elements.iconContainer.classList.add(e)))}};const h=(e,t)=>{WH.React.startTransition((async()=>{({portalId:c.iconPortalId}=await WH.React.initComponent(e,"modules/FontIcon",{faIcon:{prefix:t.prefix,name:t.name}}))}))};u.apply(this,arguments)};WH.CommentReplies=new function(){this.setupReplies=function(i,n,s){e(i,n,s,false);t(i,n,s);i.find(".comment-reply-row").each((function(){a($(this),n,s)}));i.find(".comment-reply-row").hover((function(){$(this).find("span").attr("data-hover","true")}),(function(){$(this).find("span").attr("data-hover","false")}))};function e(e,t,a,i){let n=null;let s=null;let r=null;let o=null;let l=null;let c=null;let u=WH.getPageData("guide.author")===WH.User.getUsername()?WH.Comments.MAX_LENGTH_COMMENT:WH.Comments.MAX_LENGTH_REPLY;let d=WH.Comments.MIN_LENGTH;let f=null;let h=false;let p=false;let m=false;let H=false;let g=e.find(".comment-replies > table");let W=e.find(".add-reply");let E=t.replies.length;if(i){T()}else{W.click((function(){T()}))}function _(){if(h){return}h=true;let a=$("<tr/>");if(i){a.addClass("comment-reply-row").addClass("reply-edit-row")}a.html('<td style="width: 0"></td>'+'<td class="comment-form"><form><table>'+"<form>"+"<table><tr>"+'<td style="width: 600px">'+'<textarea required="required" name="body" cols="68" rows="3"></textarea>'+"</td>"+"<td>"+'<input type="submit" value="'+(i?WH.TERMS.save:WH.TERMS.addreply)+'" />'+'<img src="'+WH.staticUrl+'/images/icons/ajax.gif" class="ajax-loader" />'+"</td>"+"</tr>"+'<tr><td colspan="2">'+'<span class="text-counter">Text counter placeholder</span>'+"</td></tr></table>"+"</form>"+"</td>");r=a.find(".comment-form textarea");n=a.find(".comment-form input[type=submit]");f=a.find(".comment-form span.text-counter");l=a.find(".comment-form form");s=a.find(".comment-form .ajax-loader");c=a.find(".comment-form");l.submit((function(){S();return false}));R();r.keyup((function(e){R()}));r.keydown((function(e){if(e.keyCode==27){v();return false}}));r.keypress((function(e){if(e.keyCode==13){S();return false}}));if(i){e.after(a);e.hide();l.find("textarea").text(t.replies[e.attr("data-idx")].body)}else{g.append(a)}o=a;WH.safeFocus(l.find("textarea"))}function T(){if(!h){_()}p=true;if(!i){W.hide();e.find(".comment-replies").show();c.show()}}function v(){p=false;if(i){if(o){o.remove()}e.show();return}W.show();c.hide();if(E==0){e.find(".comment-replies").hide()}}function S(){if(!p||H){return}if(r.val().length<d||r.val().length>u){if(!m){m=true;f.animate({opacity:"0.0"},150);f.animate({opacity:"1.0"},150,null,(function(){m=false}))}return false}b();$.ajax({type:"POST",url:WH.Url.generatePath(i?"/comment/edit-reply":"/comment/add-reply"),data:{commentId:t.id,replyId:i?e.attr("data-replyid"):0,body:r.val()},success:function(e){I(e)},dataType:"json",error:function(e){A(e.responseText)}});return true}function b(){H=true;s.show();n.prop("disabled",true);c.find(".wh-message-box").remove()}function y(){H=false;s.hide();n.prop("disabled",false)}function I(e){t.replies=e;Listview.templates.comment.updateReplies.call(a,t)}function A(e){y();MessageBox(c,e)}function R(){let e="(error)";let t="q0";let a=r.val().replace(/(\s+)/g," ").replace(/^\s*/,"").replace(/\s*$/,"").length;let i=u-a;if(a==0){e=WH.sprintf(WH.TERMS.replylength1_format,d)}else if(a<d){e=WH.sprintf(WH.TERMS.replylength2_format,d-a)}else{e=WH.sprintf(WH.term(i===1?"replylength4_format":"replylength3_format"),i);if(i<120){t="chars-left-none"}else if(i<240){t="chars-left-some"}else if(i<360){t="chars-left-many"}}f.html(e).attr("class",t)}}function t(e,t,a){var i=e.find(".show-more-replies");var n=e.find(".comment-replies");i.click((function(){s()}));function s(){i.hide();n.append($("<img>",{class:"ajax-loader",alt:"",src:WH.staticUrl+"/images/icons/ajax.gif"}));$.ajax({type:"GET",url:WH.Url.generatePath("/comment/show-replies"),data:{id:t.id},success:function(e){t.replies=e;Listview.templates.comment.updateReplies.call(a,t)},dataType:"json",error:function(){r()}})}function r(){i.show();n.find(".ajax-loader").remove();MessageBox(n,"There was an error fetching the comments. Try refreshing the page.")}}function a(t,a,i){var n=t.attr("data-replyid");var s=t.find(".reply-upvote");var r=t.find(".reply-downvote");const o=t.find("#comment-reply-report");var l=t.find(".reply-rating");var c=t.find(".reply-controls");const u=t.find("#comment-reply-delete");const d=t.find("#comment-reply-edit");var f=false;var h=false;d.click((function(){e(t,a,i,true)}));o.click((function(){if(f||!confirm(WH.TERMS.replyreportwarning_tip))return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"report"},success:function(){m()},error:function(e){g(e.responseText)}})}));s.click((function(){if(s.attr("data-hasvoted")=="true"||s.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"up"},success:function(){p(1)},error:function(e){g(e.responseText)}})}));r.click((function(){if(r.attr("data-hasvoted")=="true"||r.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"down"},success:function(){p(-1)},error:function(e){g(e.responseText)}})}));u.click((function(){if(h)return;if(!confirm(WH.TERMS.deletereplyconfirmation_tip))return;h=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/delete-reply"),data:{id:n},success:function(){H()},error:function(e){g(e.responseText)}})}));function p(e){var t=parseInt(l.text());t+=e;l.text(t);if(e>0)s.attr("data-hasvoted","true");else r.attr("data-hasvoted","true");s.attr("data-canvote","false");r.attr("data-canvote","false");if(e>0){o.remove()}f=false}function m(){f=false;o.remove()}function H(){t.remove();h=false}function g(e){f=false;h=false;if(!e)e="An error has occurred. Try refreshing the page.";MessageBox(c,e)}}};WH.Comments=new function(){const e=this;this.MIN_LENGTH=15;this.MAX_LENGTH_COMMENT=1e5;this.MAX_LENGTH_REPLY=600;this.EDIT_MODE_EDIT_FORUM_POST=-1;this.EDIT_MODE_EDIT_COMMENT=0;this.EDIT_MODE_ADD_COMMENT=1;this.EDIT_MODE_USER_DESCRIPTION=2;this.EDIT_MODE_ADD_FORUM_REPLY=3;this.EDIT_MODE_USER_SIGNATURE=4;this.LOW_RATING_THRESHOLD=-4;var t=1;var a=2;this.appendImportedSubject=function(e,t){if(!t){return}var a=t.replace(/^\s*Re\b|\bRe\s*$/,"").replace(/\s/,"");if(!a||!a.match(/[^:]/)){return}var i=WH.ce("span");WH.st(i,'"'+t+'"');var n=WH.ce("span",{className:"comment-imported-subject"});WH.st(n,WH.TERMS.subject_colon);WH.ae(n,i);e.append(n)};this.getColorClass=function(t,a,i,n){switch(a){case e.EDIT_MODE_EDIT_FORUM_POST:var s=null;if(!i){s=t.divPost.childNodes[1].className.match(/comment-([a-z-]+)/)}else{s=t.divBody[0].className.match(/comment-([a-z-]+)/)}if(s!=null){return" comment-"+s[1]}break;case e.EDIT_MODE_ADD_FORUM_REPLY:if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}case e.EDIT_MODE_USER_SIGNATURE:let a=WH.User.getCommentRoleClass(t.roles,t.user);if(a){return" "+a}break}if(t.roles&(U_GROUP_ADMIN|U_GROUP_BLIZZARD)){return" comment-role-admin"}if(n){return" comment-guide-author"}if(t.commentv2&&t.sticky||t.roles&U_GROUP_GREEN_TEXT||t.rating>=10){return" comment-high-rating"}if(t.rating&&t.rating<-2){return" comment-low-rating"}if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}return""};this.edit=function(t,a,n){if(WH.qs(`#p${t.id} .comment-edit`)||t.container&&WH.qs(`.comment-edit`,t.container[0])){return}if(n){t.divBody.hide();t.divResponse.hide()}var s=$("<div/>");s.addClass("comment-edit");t.divEdit=s[0];if(a===e.EDIT_MODE_EDIT_FORUM_POST){if(g_users[t.user]!=null){t.roles=g_users[t.user].roles}}let r=a===e.EDIT_MODE_EDIT_FORUM_POST||a===e.EDIT_MODE_EDIT_COMMENT?undefined:"submit";let o=e.editAppend(s,t,a,n,undefined,undefined,r);const l=WH.ce("div",{className:"wh-button-group"});const c=new WH.Button({"data-variation":WH.getDataTreeKey(),clickHandler:()=>i.bind(this,true,t,a,n)(),iconConfig:{faIcon:{prefix:"fas",name:"floppy-disk"}},label:WH.TERMS.save,size:"small",style:"primary"});WH.ae(l,c.getElement());const u=new WH.Button({"data-variation":WH.getDataTreeKey(),clickHandler:()=>i.bind(this,false,t,a,n)(),label:WH.TERMS.cancel,size:"small",style:"secondary"});WH.ae(l,u.getElement());s.append(l);s.insertAfter(t.divBody);WH.safeFocus(o)};this.editAppend=function(i,o,l,c,u,d,f){var h=e.getCharLimit(l);if(o.body===null){o.body=""}if(l===e.EDIT_MODE_ADD_COMMENT||l===e.EDIT_MODE_ADD_FORUM_REPLY||l===e.EDIT_MODE_USER_SIGNATURE){o.user=g_user.name;o.roles=g_user.roles;o.rating=1}else if(l===e.EDIT_MODE_USER_DESCRIPTION){o.roles=g_user.roles;o.rating=1}if(u){o.roles&=~U_GROUP_PENDING}if(l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT){var p=$("<div/>",{text:WH.TERMS.mode_colon});p.addClass("comment-edit-modes");var m=$("<a/>",{href:"javascript:",text:WH.TERMS.edit});m.click(s.bind(m[0],t,l,o));m.addClass("selected");p.append(m);p.append(WH.ct("|"));var H=$("<a/>",{href:"javascript:",text:WH.TERMS.preview});H.click(s.bind(H[0],a,l,o));p.append(H);i.append(p)}var g=$("<div/>",{css:{display:"none"}});g.addClass("text comment-body"+e.getColorClass(o,l,c));var W=$("<div/>");W.addClass("comment-edit-body");const E=WH.ce("div",{className:"toolbar",style:{float:"left"}});const _=WH.ae(E,WH.ce("div",{className:"wh-button-group"}));var T=$("<div/>");T.addClass("menu-buttons");var v=$("<textarea/>",{val:o.body,rows:10,css:{clear:"left"},"aria-label":WH.TERMS.addyourcomment_stc});v.addClass("comment-editbox");switch(l){case e.EDIT_MODE_ADD_COMMENT:v.attr("name","commentbody");break;case e.EDIT_MODE_USER_DESCRIPTION:v.attr({name:"desc",originalValue:o.body});break;case e.EDIT_MODE_ADD_FORUM_REPLY:v.attr("name","body");break;case e.EDIT_MODE_USER_SIGNATURE:v.attr({name:"sig",originalValue:o.body,rows:3});v.css("height","auto");break}if(l!==e.EDIT_MODE_EDIT_FORUM_POST&&l!==e.EDIT_MODE_EDIT_COMMENT){var S=$("<a/>"),b=$("<div/>"),y=$("<div/>"),I=screen.availWidth<=480;var A=n.bind(e,o,l,v[0],b[0]);S.addClass("disclosure-"+(I?"off":"on"));S.text(WH.TERMS.livepreview);S.attr("href","javascript:");S.click((function(){A(1);var e=WH.toggleDisplay(b);S.toggleClass("disclosure-on",e);S.toggleClass("disclosure-off",!e)}));y.addClass("pad");g.append(WH.getMajorHeading(S,3,null,{classes:"first"}));g.append(b);g.append(y);WH.onAfterTyping(v[0],A,50);v.focus((function(){A();g.css("display",I?"none":"");if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){v.css("height","22em")}}))}else if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){v.focus((function(){v.css("height","22em")}))}const R=[{id:"b",icon:"bold",title:WH.TERMS.bold,pre:"[b]",post:"[/b]"},{id:"i",icon:"italic",title:WH.TERMS.italic,pre:"[i]",post:"[/i]"},{id:"u",icon:"underline",title:WH.TERMS.underline,pre:"[u]",post:"[/u]"},{id:"s",icon:"strikethrough",title:WH.TERMS.strikethrough,pre:"[s]",post:"[/s]"},{id:"small",icon:"text-height",title:WH.TERMS.smalltext_stc,pre:"[small]",post:"[/small]"},{id:"url",icon:"link",title:WH.TERMS.link,nopending:true,onclick:()=>{const e=prompt(WH.TERMS.linkurl_tip,"https://");if(e){WH.insertTag(v[0],"[url="+e+"]","[/url]")}}},{id:"quote",icon:"quote-left",title:WH.TERMS.quotebox_stc,pre:"[quote]",post:"[/quote]"},{id:"code",icon:"code",title:WH.TERMS.codebox_stc,pre:"[code]",post:"[/code]"},{id:"ul",icon:"list-ul",title:WH.TERMS.unorderedlistbullets_stc,pre:"[ul]\n[li]",post:"[/li]\n[/ul]",rep:e=>e.replace(/\n/g,"[/li]\n[li]")},{id:"ol",icon:"list-ol",title:WH.TERMS.orderedlistnumbers_stc,pre:"[ol]\n[li]",post:"[/li]\n[/ol]",rep:e=>e.replace(/\n/g,"[/li]\n[li]")},{id:"li",icon:"circle",title:WH.TERMS.listitem_stc,pre:"[li]",post:"[/li]"}];const N=e=>new WH.Button({"data-variation":WH.getDataTreeKey(),clickHandler:t=>{t.preventDefault();e.onclick!=null?e.onclick():WH.insertTag.bind(0,v[0],e.pre,e.post,e.rep)()},iconConfig:{faIcon:{prefix:"fas",name:e.icon}},size:"small",style:"secondary",title:e.title});if(!c){for(let t=0,a=R.length;t<a;++t){const a=R[t];if(l===e.EDIT_MODE_USER_SIGNATURE&&a.id=="quote"){break}if(g_user.roles&U_GROUP_PENDING&&a.nopending){continue}const i=N(a);WH.ae(_,i.getElement())}}else{for(let e=0,t=R.length;e<t;++e){const t=R[e];if(g_user.rolls&U_GROUP_PENDING&&t.nopending){continue}const a=N(t);WH.ae(_,a.getElement())}E.classList.add("formatting")}let w=[];let C;for(let e in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(e)){continue}if(C=WH.markup.tags[e].entityType){let t=[C,WH.Types.getUpperSingular(C)+WH.TERMS.ellipsis_punct,WH.markup.insertEntityTag.bind(null,v[0],WH.Types.getLowerSingular(C),e)];let a=WH.Types.getRequiredTrees(C);if(a){t.push(null,{requiredTrees:a})}w.push(t)}}w.sort((function(e,t){return e[1].localeCompare(t[1])}));const M=new WH.Button({"data-icon-position":"end","data-variation":WH.getDataTreeKey(),iconConfig:{faIcon:{prefix:"fas",name:"caret-down"}},label:WH.TERMS.links,size:"small",style:"secondary"}).getElement();Menu.add(M,w);T[0].append(M);W.append(E);W.append(T);W.append($('<div style="clear: left" />'));W.append(v);W.append($("<br/>"));let O=WH.ce("section",{classList:"comment-edit-body-footer",dataset:{hasSubmitButton:JSON.stringify(!!f)}});if(f){let e={type:"submit",classList:"comment-edit-body-footer-submit-button",value:WH.TERMS.save};if(f){e.name=f}let t=WH.ce("section",{classList:"comment-edit-body-footer-submit"},WH.ce("input",e));WH.ae(O,t)}let L=WH.ce("section",{classList:"comment-edit-body-footer-limit"});WH.ae(O,L);W.append(O);if(l===e.EDIT_MODE_USER_SIGNATURE){WH.ae(L,WH.ct(WH.sprintf(WH.TERMS.uptoxcharactersorlines_format,WH.Strings.formatNumber(h),WH.Strings.formatNumber(3))))}else{WH.ae(L,WH.ct(WH.sprintf(WH.TERMS.uptoxcharacters_format,WH.Strings.formatNumber(h))))}let D=WH.Strings.formatNumber(h-o.body.length);let k=WH.sprintf(WH.TERMS.xcharactersremaining_format,D);let P=WH.ce("span",undefined,WH.ct(k));WH.ae(L,P);v.keyup(r.bind(e,v,P,h));v.keydown(r.bind(e,v,P,h));if((l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT)&&g_user.roles&U_GROUP_MODERATOR){var x=$("<div/>",{class:"pad"});var U=$("<div/>",{text:(g_user.roles&U_GROUP_ADMIN?"Admin":"Moderator")+" response"});var F=$("<textarea/>",{val:o.response,rows:3,css:{height:"6em"}});W.append(x);W.append(U);W.append(F)}i.append(W);i.append(g);return v};this.getCharLimit=function(t){if(t===e.EDIT_MODE_USER_DESCRIPTION){return 7500}if(t===e.EDIT_MODE_USER_SIGNATURE){return 250}if(g_user.roles&U_GROUP_STAFF){return 1e5}var a=WH.User.isPremium()?3:1;switch(t){case e.EDIT_MODE_EDIT_COMMENT:case e.EDIT_MODE_ADD_COMMENT:return 7500*a;case e.EDIT_MODE_EDIT_FORUM_POST:case e.EDIT_MODE_ADD_FORUM_REPLY:return 15e3*a}return 0};this.updateLastEdit=function(e){var t=e.divLastEdit;if(!t){return}if(e.lastEdit!=null){var a=e.lastEdit;t.childNodes[1].firstChild.nodeValue=a[2];t.childNodes[1].href=WH.Url.generatePath("/user="+a[2]);var i=new Date(a[0]);var n=(WH.getServerTime()-i)/1e3;if(t.childNodes[3].firstChild){WH.de(t.childNodes[3].firstChild)}WH.formatDate(t.childNodes[3],n,i);var s="";if(e.rating!=null){s+=WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(i))}if(a[1]>1){s+=WH.TERMS.dash_punct+WH.sprintf(WH.TERMS.editcount_format,a[1])}t.childNodes[4].nodeValue=s;t.style.display=""}else{t.style.display="none"}};this.validate=function(t,a){a|=0;var i=a===e.EDIT_MODE_EDIT_FORUM_POST||a===e.EDIT_MODE_ADD_FORUM_REPLY;if(i){if(WH.trim(t.value).length<1){alert(WH.TERMS.postempty_tip);return false}}else{if(WH.trim(t.value).length<1){alert(WH.TERMS.messagetooshort_tip);return false}}var n=e.getCharLimit(a);if(t.value.length>n){return confirm(WH.sprintf(i?WH.TERMS.postlength_format:WH.TERMS.commentlength_format,n,t.value.substring(n-30,n)))}return true};function i(t,a,i,n){if(t){var s=WH.gE(a.divEdit,"textarea");var r=s[0];if(!e.validate(r,i)){return}if(r.value!=a.body||s[1]&&s[1].value!=a.response){var o=0;if(a.lastEdit!=null){o=a.lastEdit[1]}++o;a.lastEdit=[WH.getServerTime(),o,g_user.name];if(!a.commentv2){e.updateLastEdit(a)}var l=e.getCharLimit(i);var c=WH.markup.rolesToClass(a.roles);var u=WH.markup.getDomFragment(r.value.length>l?r.value.substring(0,l):r.value,{allow:c,mode:WH.markup.MODE.COMMENT,roles:a.roles});var d=s[1]&&s[1].value.length>0?WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+s[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:WH.markup.MODE.COMMENT,roles:g_user.roles}):document.createDocumentFragment();if(a.commentv2){a.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){a.response=s[1].value}Listview.templates.comment.updateCommentCell.call(this,a)}else{if(!n){$(a.divBody).empty().append(u);$(a.divResponse).empty().append(d)}else{a.divBody.empty().append(u);a.divResponse.empty().append(d)}a.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){a.response=s[1].value}}if(i===e.EDIT_MODE_EDIT_FORUM_POST){const e={postId:a.id,body:a.body};if(a.response!==undefined){e.response=a.response}$.ajax({url:WH.Url.generatePath("/forums/edit-post"),method:"post",data:e})}else{WH.fetch(WH.Url.generatePath("/comment/edit"),{json:{id:a.id,body:a.body,response:a.response}})}}}if(a.commentv2){Listview.templates.comment.updateCommentCell.call(this,a)}else if(!n){a.divBody.style.display="";a.divResponse.style.display="";a.divLinks.firstChild.style.display=""}else{a.divBody.show();a.divResponse.show()}if(!a.commentv2){WH.de(a.divEdit);a.divEdit=null}}function n(t,a,i,n){if(n.style.display=="none"){return}var s=e.getCharLimit(a);var r=i.value.length>s?i.value.substring(0,s):i.value;if(a===e.EDIT_MODE_USER_SIGNATURE){var o;if((o=r.indexOf("\n"))!=-1&&(o=r.indexOf("\n",o+1))!=-1&&(o=r.indexOf("\n",o+1))!=-1){r=r.substring(0,o)}}var l=WH.markup.rolesToClass(t.roles);var c=WH.markup.getDomFragment(r,{allow:l,mode:WH.markup.MODE.COMMENT,roles:t.roles});if(c.hasChildNodes()){$(n).empty().append(c)}else{n.innerHTML='<span class="q6">...</span>'}}function s(i,n,s){var r=e.getCharLimit(n);var o=WH.markup.MODE.COMMENT;WH.arrayWalk(WH.gE(this.parentNode,"a"),(function(e){e.className=""}));this.className="selected";var l=WH.gE(this.parentNode.parentNode,"textarea");var c=l[0];var u=c.parentNode;var d=$(".comment-body",u.parentNode)[0];if(n===e.EDIT_MODE_USER_SIGNATURE){o=WH.markup.MODE.SIGNATURE}switch(i){case t:u.style.display="";d.style.display="none";WH.safeFocus(u.firstChild);break;case a:u.style.display="none";var f=c.value.length>r?c.value.substring(0,r):c.value;if(n===e.EDIT_MODE_USER_SIGNATURE){var h;if((h=f.indexOf("\n"))!=-1&&(h=f.indexOf("\n",h+1))!=-1&&(h=f.indexOf("\n",h+1))!=-1){f=f.substring(0,h)}}var p=WH.markup.rolesToClass(s.roles);var m=WH.markup.getDomFragment(f,{allow:p,mode:o,roles:s.roles});if(l[1]&&l[1].value.length>0){m.appendChild(WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+l[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:o,roles:g_user.roles}))}$(d).empty().append(m);d.style.display="";break}}function r(e,t,a){var i=$(e).val();if(i.length>a){$(e).val(i.substring(0,a))}else{$(t).html(" "+WH.sprintf(WH.TERMS.xcharactersremaining_format,(a-i.length).toLocaleString())).removeClass("q10");if(i.length===a){$(t).addClass("q10")}}}};function co_addYourComment(){tabsContribute.focus(0);var e=WH.gE(document.forms["addcomment"],"textarea")[0];WH.safeFocus(e)}function co_validateForm(e){var t=WH.gE(e,"textarea")[0];var a=false;if(WH.isSet("tabsContribute")){for(var i=0;i<tabsContribute.tabs.length;i++){if(tabsContribute.tabs[i].id=="suggest-a-video"){a=i;break}}}if(a!==false&&t.value.length<350){var n;for(var i in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(i)){continue}if(n=vi_sitevalidation[i].exec(t.value)){break}}if(n&&!confirm(WH.TERMS.commentasvideo_tip)){tabsContribute.show(a);$('#tab-suggest-a-video input[name="videourl"]').attr("value",n[0]);return false}}return WH.Comments.validate(t)}$(document).ready((function(){WH.setupChangeWarning(WH.qs("form[name=addcomment]"),[WH.qs("textarea[name=commentbody]")],WH.TERMS.messagestarted_tip)}));WH.Confetti=function(){const e=this;const t=WH.Time;const a=2;const i=3*t.MS_SEC;const n=["DodgerBlue","OliveDrab","Gold","Pink","SlateBlue","LightBlue","Violet","PaleGreen","SteelBlue","SandyBrown","Chocolate","Crimson"];const s=500;const r={animationTimer:undefined,elements:{darkModeButton:undefined,container:undefined},particles:[],streamingConfetti:false,waveAngle:0};this.haveAParty=()=>{if(r.streamingConfetti){return}d();setTimeout(c,i)};function o(e){let t;let a;for(let i=0;i<r.particles.length;i++){t=r.particles[i];e.beginPath();e.lineWidth=t.diameter;e.strokeStyle=t.color;a=t.x+t.tilt;e.moveTo(a+t.diameter/2,t.y);e.lineTo(a,t.y+t.tilt+t.diameter/2);e.stroke()}}function l(t,a){r.elements.darkModeButton=a;r.elements.container=t;e.haveAParty()}function c(){f();r.particles=[]}function u(e,t,a){e.color=n[Math.random()*n.length|0];e.x=Math.random()*t;e.y=Math.random()*a-a;e.diameter=Math.random()*10+5;e.tilt=Math.random()*10-10;e.tiltAngleIncrement=Math.random()*.07+.05;e.tiltAngle=0;return e}function d(){let e=window.innerWidth;let t=window.innerHeight;window.requestAnimFrame=function(){return window.requestAnimationFrame||function(e){return window.setTimeout(e,16.6666667)}}();let a=WH.ce("canvas",{classList:"confetti-canvas"});WH.aef(r.elements.container,a);a.style.display="block";a.width=window.innerWidth;a.height=window.innerHeight;window.addEventListener("resize",(function(){a.width=window.innerWidth;a.height=window.innerHeight}),true);r.elements.darkModeButton.classList.add("fa","fa-check");let i=a.getContext("2d");while(r.particles.length<s)r.particles.push(u({},e,t));r.streamingConfetti=true;if(!r.animationTimer){(function e(){i.clearRect(0,0,window.innerWidth,window.innerHeight);if(r.particles.length===0){r.animationTimer=undefined}else{h();o(i);r.animationTimer=requestAnimFrame(e)}})()}}function f(){r.streamingConfetti=false}function h(){let e=window.innerWidth;let t=window.innerHeight;let i;r.waveAngle+=.01;for(let n=0;n<r.particles.length;n++){i=r.particles[n];if(!r.streamingConfetti&&i.y<-15){i.y=t+100}else{i.tiltAngle+=i.tiltAngleIncrement;i.x+=Math.sin(r.waveAngle);i.y+=(Math.cos(r.waveAngle)+i.diameter+a)*.5;i.tilt=Math.sin(i.tiltAngle)*15}if(i.x>e+20||i.x<-20||i.y>t){if(r.streamingConfetti&&r.particles.length<=s){u(i,e,t)}else{r.particles.splice(n,1);n--}}}}l.apply(this,arguments)};WH.Cookies=new function(){const e=this;this.available=function(){if(!t()){return false}return a()};this.getDomain=function(){return location.hostname.replace(/^www\./,"")};function t(){if(typeof window.OptanonActiveGroups!=="string"){return true}return window.OptanonActiveGroups.split(",").indexOf("C0001")!==-1}function a(){WH.setCookie("enabledTest",1,"1",undefined,undefined,location.protocol==="https:");let e=WH.getCookies("enabledTest")==="1";if(e){WH.deleteCookie("enabledTest",undefined,undefined,location.protocol==="https:")}a=function(){return e};return e}};WH.D2={};WH.DI.getPlayerLevelMax=function(){return 60};var Dialog=function(){var e=this,t,a=null,i,n={},s,r=false,o=WH.ce("form"),l={};o.onsubmit=function(){p();return false};this.show=function(l,u){if(l){i=l;t=WH.cOr({},Dialog.templates[i]);e.template=t}else return;if(t.onInit&&!r)t.onInit.bind(e,o,u)();if(u.onBeforeShow)n.onBeforeShow=u.onBeforeShow.bind(e,o);if(t.onBeforeShow)t.onBeforeShow=t.onBeforeShow.bind(e,o);if(u.onShow)n.onShow=u.onShow.bind(e,o);if(t.onShow)t.onShow=t.onShow.bind(e,o);if(u.onHide)n.onHide=u.onHide.bind(e,o);if(t.onHide)t.onHide=t.onHide.bind(e,o);if(u.onSubmit)n.onSubmit=u.onSubmit;if(t.onSubmit)a=t.onSubmit.bind(e,o);if(u.data){r=false;s={};WH.cO(s,u.data)}e.data=s;Lightbox.show("dialog-"+i,{onShow:c,onHide:h})};this.getValue=function(e){return H(e)};this.setValue=function(e,t){g(e,t)};this.getSelectedValue=function(e){return W(e)};this.getCheckedValue=function(e){return E(e)};function c(e,a){if(a||!r)d(e);if(t.onBeforeShow)t.onBeforeShow();if(n.onBeforeShow)n.onBeforeShow();Lightbox.setSize(t.width);e.className+=" dialog";f();if(t.onShow)t.onShow();if(n.onShow)n.onShow();window.setTimeout(u,5)}function u(){for(var e=0,a,i;a=t.fields[e];e++){if(WH.inArray(["text","number"],a.type)>=0){l[a.id].focus();break}}}function d(a){WH.ee(a);WH.ee(o);var i=WH.ce("div");i.className="lightbox-content text";WH.ae(a,i);WH.ae(i,o);if(t.title){WH.ae(o,WH.getImitationHeading(WH.ct(t.title),1))}var n=WH.ce("table"),c=WH.ce("tbody"),u=false;var d;var f;var h;WH.ae(n,c);WH.ae(o,n);for(var m=0,H=t.fields.length;m<H;++m){var g=t.fields[m],W;if(!u){d=WH.ce("tr");f=WH.ce("th");h=WH.ce("td")}g.__tr=d;if(s[g.id]==null)s[g.id]=g.value?g.value:"";var E;if(g.options){E=[];if(g.optorder)WH.cO(E,g.optorder);else{for(var _ in g.options)E.push(_)}if(g.sort)E.sort((function(e,t){return g.sort*WH.stringCompare(g.options[e],g.options[t])}))}switch(g.type){case"caption":f.colSpan=2;f.style.textAlign="left";f.style.padding=0;if(g.compute)g.compute.bind(e,null,s[g.id],o,f,d)();else if(g.label)WH.ae(f,WH.ct(g.label));WH.ae(d,f);WH.ae(c,d);continue;break;case"textarea":var T=W=WH.ce("textarea");T.name=g.id;if(g.disabled)T.disabled=true;T.rows=g.size[0];T.cols=g.size[1];h.colSpan=2;if(g.label){f.colSpan=2;f.style.textAlign="left";f.style.padding=0;h.style.padding=0;WH.ae(f,WH.ct(g.label));WH.ae(d,f);WH.ae(c,d);d=WH.ce("tr")}if(g.maxLength){T.maxLength=g.maxLength}WH.ae(h,T);break;case"select":var T=W=WH.ce("select");T.name=g.id;if(g.size)T.size=g.size;if(g.disabled)T.disabled=true;if(g.multiple)T.multiple=true;if(g.onchange){T.onchange=g.onchange.bind(e,T)}for(var _=0,v=E.length;_<v;++_){var S=WH.ce("option");S.value=E[_];WH.ae(S,WH.ct(g.options[E[_]]));WH.ae(T,S)}WH.ae(h,T);break;case"dynamic":h.colSpan=2;h.style.textAlign="left";h.style.padding=0;if(g.compute)g.compute.bind(e,null,s[g.id],o,h,d)();WH.ae(d,h);WH.ae(c,d);W=h;break;case"checkbox":case"radio":var b=0;W=[];for(var _=0,v=E.length;_<v;++_){var y=WH.ce("span"),T,I,A="sdfler46"+g.id+"-"+E[_];if(_>0&&!g.noInputBr)WH.ae(h,WH.ce("br"));I=WH.ce("label");I.setAttribute("for",A);I.onmousedown=WH.rf;T=WH.ce("input");T.setAttribute("type",g.type);T.name=g.id;T.value=E[_];T.id=A;if(g.disabled)T.disabled=true;if(g.onchange){T.onchange=g.onchange.bind(e,T)}if(g.submitOnDblClick)I.ondblclick=T.ondblclick=function(e){p()};if(g.compute)g.compute.bind(e,T,s[g.id],o,h,d,I)();WH.ae(I,T);WH.ae(I,WH.ct(g.options[E[_]]));WH.ae(h,I);W.push(T)}break;default:var T=W=WH.ce("input");T.name=g.id;if(g.size)T.size=g.size;if(g.disabled)T.disabled=true;if(g.submitOnEnter){T.onkeypress=function(e){if(e.keyCode===13){p()}}}T.setAttribute("type",g.type);WH.ae(h,T);break}if(g.label){if(g.type=="textarea"){if(g.labelAlign)h.style.textAlign=g.labelAlign;h.colSpan=2}else{if(g.labelAlign)f.style.textAlign=g.labelAlign;WH.ae(f,WH.ct(g.label));WH.ae(d,f)}}if(g.placeholder){T.placeholder=g.placeholder}if(g.type!="checkbox"&&g.type!="radio"){if(g.width)T.style.width=g.width;if(g.compute&&g.type!="caption"&&g.type!="dynamic")g.compute.bind(e,T,s[g.id],o,h,d)()}if(g.caption){var y=WH.ce("small");if(g.type!="textarea")y.style.paddingLeft="2px";WH.ae(y,WH.ct(g.caption));WH.ae(h,y)}if(g.style&&typeof T!=="undefined"){for(var R in g.style){T.style[R]=g.style[R]}}WH.ae(d,h);WH.ae(c,d);u=g.mergeCell;l[g.id]=W}var N={arrow:"external-link",check:"check",question:"question",x:"times"};for(var m=t.buttons.length;m>0;--m){var w=t.buttons[m-1],C=WH.ce("a");C.onclick=p.bind(C,w[0]);C.className="dialog-option fa fa-"+(N[w[0]]||"circle fa-size-xs");C.href="javascript:";WH.ae(C,WH.ct(w[1]));WH.ae(a,C)}r=true}function f(){for(var a=0,i=t.fields.length;a<i;++a){var n=t.fields[a],r=l[n.id];switch(n.type){case"caption":break;case"select":for(let e=0,t=r.options.length;e<t;e++){r.options[e].selected=r.options[e].value==s[n.id]||s[n.id]instanceof Array&&WH.inArray(s[n.id],r.options[e].value)!==-1}break;case"checkbox":case"radio":for(let e=0,t=r.length;e<t;e++){r[e].checked=r[e].value==s[n.id]||Array.isArray(s[n.id])&&WH.inArray(s[n.id],r[e].value)!=-1}break;default:r.value=s[n.id];break}if(n.update)n.update.bind(e,null,s[n.id],o,r)()}}function h(){if(t.onHide)t.onHide();if(n.onHide)n.onHide()}function p(e){if(e=="x")return Lightbox.hide();for(var a=0,i=t.fields.length;a<i;++a){var n=t.fields[a],r;switch(n.type){case"caption":continue;case"select":r=W(n.id);break;case"checkbox":case"radio":r=E(n.id);break;case"dynamic":if(n.getValue){r=n.getValue(n,s,o);break}default:r=H(n.id);break}if(n.validate){if(!n.validate(r,s,o))return}if(r&&typeof r=="string")r=WH.trim(r);s[n.id]=r}m(e)}function m(e){var t;if(a)t=a(s,e,o);if(n.onSubmit)t=n.onSubmit(s,e,o);if(t===undefined||t)Lightbox.hide();return false}function H(e){return l[e].value}function g(e,t){l[e].value=t}function W(e){var t=[],a=l[e];for(var i=0,n=a.options.length;i<n;i++){if(a.options[i].selected)t.push(parseInt(a.options[i].value)==a.options[i].value?parseInt(a.options[i].value):a.options[i].value)}if(t.length==1)t=t[0];return t}function E(e){var t=[],a=l[e];for(var i=0,n=a.length;i<n;i++){if(a[i].checked)t.push(parseInt(a[i].value)==a[i].value?parseInt(a[i].value):a[i].value)}return t}};Dialog.prompt=function(e,t){let a=new Dialog;t=t||{};a.show("prompt",{promptOptions:{callback:e,caption:t.caption,initial:t.initial,label:t.label,placeholder:t.placeholder,size:t.size,text:t.text,title:t.title}})};Dialog.templates={prompt:{buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"topText",type:"caption"},{id:"inputField",type:"text",size:40,submitOnEnter:true}],onInit:function(e,t){this.template.title=t.promptOptions.title;this.template.fields[0].label=t.promptOptions.text||"";this.template.fields[1].label=t.promptOptions.label||"";this.template.fields[1].caption=t.promptOptions.caption||"";this.template.fields[1].placeholder=t.promptOptions.placeholder||"";let a=parseInt(t.promptOptions.size);if(a){this.template.fields[1].size=a}let i=t.promptOptions.callback;this.template.onSubmit=e=>i(e.inputField.value);t.data={};if(t.promptOptions.initial!=null){t.data.inputField=t.promptOptions.initial}delete t.promptOptions},onShow:function(e){setTimeout((()=>e.inputField.focus()),50);setTimeout(Lightbox.reveal,100)}}};Dialog.extraFields={};WH.DOM=new function(){const e=this;const t={bodyAddCallbacks:new WeakMap,lazyCssObserver:undefined,nodeData:new WeakMap};this.addScriptOnce=function(e,t){if(WH.qs('script[src="'+e+'"]')){return}t=t||{};t.src=e;let a=WH.ce("script",t);WH.ae(document.head,a);return a};this.bindBreakpoints=function(e,t,a,i="display"){let n=Object.entries(t).sort(((e,t)=>a?t[1]-e[1]:e[1]-t[1]));const s=()=>{let t=e.offsetWidth;let s=n.find((([e,i])=>a?t>=i:t<=i));if(s){e.dataset[i]=s[0]}else{delete e.dataset[i]}};WH.aE(e,"resize",s);if(e.clientWidth){s({detail:{contentRect:{width:e.offsetWidth}}})}};this.getColorFilter=function(e,t,a){let i=["svg-color-filter",Math.floor(e*1e3),Math.floor(t*1e3),Math.floor(a*1e3)].join("-");if(!WH.qs("svg filter#"+i)){let n=e=>document.createElementNS("http://www.w3.org/2000/svg",e);let s=n("svg");let r=n("defs");let o=n("filter");let l=n("feColorMatrix");WH.ae(s,r);WH.ae(r,o);WH.ae(o,l);o.setAttribute("id",i);o.setAttribute("color-interpolation-filters","sRGB");l.setAttribute("type","matrix");l.setAttribute("values","0 0 0 0 "+e+" 0 0 0 0 "+t+" 0 0 0 0 "+a+" 0 0 0 1 0");WH.ae(document.body,s)}return"url(#"+i+")"};this.createImitationSelect=function(t){t=t||{};let n=WH.ce("a",{className:"imitation-select",dataset:{fieldFilled:`${!!(t.isFilled??true)}`},href:"javascript:",tabIndex:0},WH.ct(t.text||""));if(t.native){n.dataset.native=1;Menu.add(n,a.bind(e,n),{showAtElement:true});WH.ae(n,WH.ce("span",{className:"imitation-select-width"}));let t=new MutationObserver(i.bind(e,n));t.observe(n,{childList:true,subtree:true,characterData:true});let s=0;Object.defineProperty(n,"selectedIndex",{get:function(){return s},set:function(e){let t=WH.qsa("option",n);s=parseInt(e);if(isNaN(s)){s=0}s=Math.max(s,0);if(t.length===0){s=0;WH.ee(n);n.style.backgroundImage="";delete n.dataset.icon;return}s=Math.min(t.length-1,s);WH.st(n,t[s].label);let a=t[s].dataset.tinyIcon;if(a){n.dataset.icon=a;n.style.backgroundImage='url("'+WH.Icon.getIconUrl(a,WH.Icon.MEDIUM)+'")'}else{n.style.backgroundImage="";delete n.dataset.icon}}});Object.defineProperty(n,"options",{get:function(){return WH.qsa("option",n)}})}else if(t.menu){Menu.add(n,t.menu,{showAtElement:true})}return n};this.dispatchEvent=function(e,t){e.dispatchEvent(new Event(t))};this.dragToMove=function(e,t,a=1){if(e.classList.contains("drag-to-move")){return}if(WH.Device.isTouch()){e.style.overflow="scroll";return}let i=0;let n=0;let s=0;let r=0;t.style.position="absolute";t.style.top="0";t.style.left="0";const o=t=>{if(t.button!==0){return}t.preventDefault();WH.aE(document,"mousemove",l);WH.aE(document,"mouseup",(()=>{delete e.dataset.dragging;document.removeEventListener("mousemove",l)}),{once:true});e.dataset.dragging="true";i=t.clientX;s=t.clientY};const l=e=>{n=(i-e.clientX)*a;i=e.clientX;t.style.left=`${t.offsetLeft-n}px`;r=(s-e.clientY)*a;s=e.clientY;t.style.top=`${t.offsetTop-r}px`};WH.aE(e,"mousedown",o);e.classList.add("drag-to-move")};this.dragToScroll=function(e){if(e.classList.contains("drag-to-scroll")){return}let t={};const a=a=>{a.preventDefault();t.left=e.scrollLeft;t.top=e.scrollTop;t.x=a.clientX;t.y=a.clientY;e.dataset.dragging="true";WH.aE(document,"mousemove",i,{passive:true});WH.aE(document,"mouseup",n,{once:true})};const i=a=>{let i=a.clientX-t.x;let n=a.clientY-t.y;e.scrollTop=t.top-n;e.scrollLeft=t.left-i};const n=t=>{delete e.dataset.dragging;document.removeEventListener("mousemove",i)};WH.aE(e,"mousedown",a);e.classList.add("drag-to-scroll")};this.enableEvents=function(e,t){if(e.addEventListener){throw new Error("Object already has events enabled.")}if(t&&!t.dispatchEvent){throw new Error("Parent does not support dispatchEvent.")}let a=new EventTarget;let i=["addEventListener","removeEventListener"];if(t){e.dispatchEvent=e=>{a.dispatchEvent(e);if(e.bubbles){t.dispatchEvent(e)}}}else{i.push("dispatchEvent")}i.forEach((t=>e[t]=a[t].bind(a)))};this.getData=function(e,a){return(t.nodeData.get(e)||{})[a]};this.getInnerHeight=function(e){return parseFloat(getComputedStyle(e,null).height.replace("px",""))};this.getInnerWidth=function(e){return parseFloat(getComputedStyle(e,null).width.replace("px",""))};this.lazyLoadBackground=function(e){if(!t.lazyCssObserver){return}if(!e.style.backgroundImage){WH.warn("Element does not have a background image to lazy-load.",e);return}e.classList.add("lazy-load-background");t.lazyCssObserver.observe(e)};this.isEmpty=function(e){for(let t=0,a;a=e.childNodes[t];t++){if(a.nodeType===Node.ELEMENT_NODE||a.nodeType===Node.TEXT_NODE&&a.textContent.trim()){return false}}return true};this.isInView=e=>{let t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth};this.isVisible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};this.mouseWheelZoom=function(e,t,a,i){a=a||.2;i=i||2;let n=(e,t)=>t.style.transform=e===1?"":`scale(${e})`;let s=1;WH.aE(e,"wheel",(e=>{e.preventDefault();let r=e.deltaY;switch(e.deltaMode){case 0:break;case 1:r*=15;break;case 2:r*=window.innerHeight;break}s+=-.1*(r/120);s=Math.min(Math.max(a,s),i);let o=t.getBoundingClientRect();let l=(e.clientX-o.left)/o.width;let c=(e.clientY-o.top)/o.height;n(s,t);o=t.getBoundingClientRect();let u=o.left+l*o.width;let d=o.top+c*o.height;let f=parseInt(getComputedStyle(t).left,10);let h=parseInt(getComputedStyle(t).top,10);t.style.left=`${f+e.clientX-u}px`;t.style.top=`${h+e.clientY-d}px`;let p=Math.max(1,1/s);t.dataset.unzoomScale=p;WH.qsa("[data-unzoom]",t).forEach(n.bind(null,p))}),{passive:false});WH.onMutate(t,(e=>{let a=parseFloat(t.dataset.unzoomScale);WH.qsa("[data-unzoom]",t).forEach(n.bind(null,a))}),{attributes:true,attributeFilter:["data-unzoom"]})};this.onBodyAdd=function(e,a){if(document.body.contains(e)){window.requestAnimationFrame(a)}else{let i=t.bodyAddCallbacks.get(e)||[];i.push(a);t.bodyAddCallbacks.set(e,i)}};this.onBodyAvailable=e=>{if(document.body){requestAnimationFrame(e)}else{WH.aE(document,"bodyAvailable",e)}};this.scaleElementInParent=(e,t)=>{let a=()=>{e.style.transform="none";let a=e.getBoundingClientRect();e.style.transformOrigin="center";e.style.transform=`scale(${t})`;let i=e.getBoundingClientRect();let n=(i.width-a.width)/2;let s=(i.height-a.height)/2;e.style.margin=`${s}px ${n}px`};setTimeout((()=>{WH.onMutate(e,a);a()}))};this.setData=function(e,a,i){let n=t.nodeData.get(e);if(!n){n={};t.nodeData.set(e,n)}n[a]=i};this.setLoading=function(e,t){e.dataset.loading=t?"true":"false"};this.setRelativeHeight=function(e,t,a){e.style.paddingTop=a/t*100+"%"};this.setTemporaryIcon=function(e,t,a){if(a){e.classList.remove("fa-"+a)}else{e.classList.add("fa")}e.classList.add("fa-"+t);clearTimeout(e.temporaryIconTimer);e.temporaryIconTimer=setTimeout((function(){e.classList.remove("fa-"+t);if(a){e.classList.add("fa-"+a)}else{e.classList.remove("fa")}}),2500)};this.styleRangeElement=function(e){if(!e.style.setProperty){return}let t=function(){e.style.setProperty("--min",e.min);e.style.setProperty("--max",e.max);e.style.setProperty("--val",e.value)};WH.aE(e,"input",t);let a=Object.getPrototypeOf(e);["value","min","max"].forEach((function(i){let n=Object.getOwnPropertyDescriptor(a,i);Object.defineProperty(e,i,{get:function(){return n.get.apply(this,arguments)},set:function(){n.set.apply(this,arguments);t();return this[i]}})}));t()};this.touchGestures=function(e,t,a=.2,i=2){const n=0;const s=1;const r=2;let o,l;let c=n;e.style.position="relative";e.style.overflow="hidden";t.style.position="absolute";const u=e=>{const a=10;const i=e.touches[0].clientX-o;const n=e.touches[0].clientY-l;if(Math.abs(i)>a||Math.abs(n)>a){e.preventDefault();e.stopPropagation();t.style.left=`${i}px`;t.style.top=`${n}px`}};const d=e=>{};const f=e=>{if(c===s&&e.touches.length===1){u(e)}else if(c===r&&e.shiftKey===true||e.touches.length===2){}};const h=e=>{if(e.touches.length===1&&e.shiftKey!==true){c=s;o=e.touches[0].clientX-parseInt(getComputedStyle(t).left,10);l=e.touches[0].clientY-parseInt(getComputedStyle(t).top,10)}else if(e.touches.length===2||e.shiftKey===true){c=r}WH.aE(document,"touchmove",f,{passive:false});WH.aE(document,"touchend",(()=>{c=n;document.removeEventListener("touchmove",f)}),{once:true})};WH.aE(e,"touchstart",h,{passive:false})};function a(e){let t=[];let a;let i;let n=0;WH.qsa("option, optgroup",e).forEach((function(s){if(s.nodeName==="OPTGROUP"){a=s;i=[];t.push(Menu.createItem({label:s.label,submenu:i,options:{checkedFunc:function(t){return t[Menu.ITEM_SUBMENU].some((function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}))}}}));return}if(n===0&&!s.label){n++;return}if(a&&s.parentNode!==a){i=undefined;a=undefined}let r={checkedFunc:function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}};if(s.dataset.tinyIcon){r.tinyIcon=s.dataset.tinyIcon}if(s.className){r.className=s.className}(i||t).push(Menu.createItem({crumb:n,label:s.dataset.menuLabel||s.label,url:function(t){e.selectedIndex=t;e.dispatchEvent(new Event("change"))}.bind(null,n),options:r}));n++}));return t}function i(e,t){let a=false;let i=WH.qs(".imitation-select-width",e);if(!i){WH.ae(e,i=WH.ce("span",{className:"imitation-select-width"}));a=true}for(let i,n=0;i=t[n];n++){let t=i.type==="characterData"?i.target.parentNode:i.target;if(t.nodeName!=="OPTION"&&t.nodeName!=="OPTGROUP"){continue}WH.qsa("option",e).forEach((function(t,i){if(t.label){a=true}if(t.selected){e.selectedIndex=i}}));break}if(a){WH.ee(i);WH.qsa("option",e).forEach((function(e,t){if(e.label){WH.ae(i,WH.ct(e.label));WH.ae(i,WH.ce("br"))}}))}}function n(){s();WH.aE(document,"selectstart",(function(e){let t=e.target;while(t){if(t.nodeName==="LABEL"||t.dataset&&t.dataset.preventSelectStart==="true"){e.preventDefault();break}t=t.parentNode}}));WH.onLoad(r)}function s(){if(!document.body){WH.aE(document,"bodyAvailable",s);return}let e=e=>{switch(e.nodeName){case"DATALIST":case"INPUT":case"TEXTAREA":WH.aE(e,["change","click","keydown","keyup"],o);o.call(e);break;case"SELECT":WH.aE(e,["change","click","keydown","keyup"],l);l.call(e)}};let a=e=>{let a=t.bodyAddCallbacks.get(e);if(a){t.bodyAddCallbacks.delete(e);while(a.length){a.shift()()}}};WH.onMutate(document.body,(function(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE){e(t);a(t);if(t.childNodes){t.querySelectorAll("datalist, input, textarea, select").forEach(e);t.querySelectorAll("*").forEach(a)}}}))}))}));WH.qsa("datalist, input, textarea, select").forEach(e)}function r(){if(document.body.dataset.lazyLoading==="disabled"){WH.qsa(".lazy-load-background").forEach((e=>e.classList.remove("lazy-load-background")))}if(document.body.dataset.lazyLoading){return}if(typeof IntersectionObserver==="undefined"){WH.qsa(".lazy-load-background").forEach((e=>e.classList.remove("lazy-load-background")));document.body.dataset.lazyLoading="disabled";return}t.lazyCssObserver=new IntersectionObserver((function(e){let a=[];e.forEach((function(e){if(!e.isIntersecting||a.includes(e.target)){return}a.push(e.target);e.target.classList.remove("lazy-load-background");t.lazyCssObserver.unobserve(e.target)}))}));WH.qsa('[style*="url("]').forEach((function(e){if(e.style.backgroundImage){e.classList.add("lazy-load-background")}}));WH.qsa(".lazy-load-background").forEach((function(e){t.lazyCssObserver.observe(e)}));document.body.dataset.lazyLoading="ready"}function o(){if(this.type==="checkbox"||this.type==="radio"){this.dataset.fieldFilled=this.checked?"true":"false";let e=this.closest("label");if(e){e.dataset.fieldFilled=this.checked?"true":"false"}}else{this.dataset.fieldFilled=(this.value||"").trim()?"true":"false"}}function l(){this.dataset.fieldFilled=(this.value||"").trim()&&(this.options[this.selectedIndex].text||"").trim()?"true":"false"}n()};WH.addCss=function(e){WH.ae(document.head,WH.ce("style",{type:"text/css"},WH.ct(e)))};WH.setTextNodes=function(e,t){if(e.nodeType==3){e.nodeValue=t}else{for(var a=0;a<e.childNodes.length;++a){WH.setTextNodes(e.childNodes[a],t)}}};WH.getFirstTextContent=function(e){for(var t=0;t<e.childNodes.length;++t){if(e.childNodes[t].nodeName=="#text"){return e.childNodes[t].nodeValue}var a=WH.getFirstTextContent(e.childNodes[t]);if(a){return a}}return false};WH.getTextContent=function(e){var t="";for(var a=0;a<e.childNodes.length;++a){if(e.childNodes[a].nodeValue){t+=e.childNodes[a].nodeValue}else if(e.childNodes[a].nodeName=="BR"){t+="\n"}t+=WH.getTextContent(e.childNodes[a])}return t};WH.toggleDisplay=function(e,t){var a=$(e);var i=a.is(":visible");if(t){a.slideToggle(150)}else{a.toggle()}if(!i){WH.Tools.Bloodmallet.updateChartsSizes(e)}return!i};WH.preventScroll=function(e,t){if(e){if(typeof t==="string"){t=WH.qs(t)}WH.preventScroll.allowedScrollArea=t;WH.aE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.aE(document.body,"touchmove",WH.preventScroll.cancelScroll)}else{WH.dE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.dE(document.body,"touchmove",WH.preventScroll.cancelScroll)}};WH.preventScroll.cancelScroll=function(e){if(WH.preventScroll.allowedScrollArea&&WH.preventScroll.allowedScrollArea.contains(e.target)){return}e.preventDefault();e.stopPropagation()};WH.safeFocus=function(e){if(!WH.Device.isTouch()){$(e).focus()}};WH.safeSelect=function(e){if(!WH.Device.isTouch()){$(e).select()}};WH.setCaretPosition=function(e,t){if(!e){return}if(e.createTextRange){var a=e.createTextRange();a.move("character",t);a.select()}else if(e.selectionStart!=undefined){e.focus();e.setSelectionRange(t,t)}else{e.focus()}};WH.insertTag=function(e,t,a,i){if(a==null){a=""}var n=WH.ge(e);n.focus();if(n.selectionStart!=null){var s=n.selectionStart,r=n.selectionEnd,o=n.scrollLeft,l=n.scrollTop;var c=n.value.substring(s,r);if(typeof i==="function"){c=i(c)}n.value=n.value.substr(0,s)+t+c+a+n.value.substr(r);n.selectionStart=n.selectionEnd=r+t.length;n.scrollLeft=o;n.scrollTop=l}else if(document.selection&&document.selection.createRange){var u=document.selection.createRange();if(u.parentElement()!=n){return}var c=u.text;if(typeof i==="function"){c=i(c)}u.text=t+c+a}if(n.onkeyup)n.onkeyup()};WH.onAfterTyping=function(e,t,a){let i;WH.aE(e,"keyup",(function(){if(i){clearTimeout(i)}i=setTimeout(t,a)}))};WH.isLeftClick=function(e){return!!(e&&e.button===0)};WH.preventEmptyFormSubmission=function(){if(!$.trim(this.elements[0].value)){return false}};var Draggable=new function(){var e={},t={},a,i;function n(t){if(this._handle){let e=t.target;let a=false;let i=0;while(e&&i<=3){if(e==this._handle){a=true;break}e=e.parentNode;i++}if(!a){return false}}a=this;e=WH.getCursorPos(t);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);if(a.onClick){a.onClick(t,a)}return false}function s(n){var s=WH.getCursorPos(n);if(a){if(Math.abs(s.x-e.x)>5||Math.abs(s.y-e.y)>5){o(n,a);a=null}}if(!i||!i._bounds)return false;var r=d(i),l=s.x-e.x,u=s.y-e.y;l=Math.max(i._bounds.x1-t.x,Math.min(i._bounds.x2-t.x-(r.x2-r.x1),l));u=Math.max(i._bounds.y1-t.y,Math.min(i._bounds.y2-t.y-(r.y2-r.y1),u));c(l,u);return false}function r(e){a=null;if(i)l(e)}function o(e,a){if(i)l(e);var n=WH.ac(a);t.x=n[0];t.y=n[1];if(a._targets.length){i=a.cloneNode(true);i._orig=a;WH.ae(document.body,i);c(-2323,-2323)}else i=a;WH.Tooltips.setEnabled(false);WH.Tooltips.hide();if(a.onDrag)a.onDrag(e,i,a);i._bounds=d(a._container);i.className+=" dragged"}function l(e){var t=false,a=WH.getCursorPos(e);if(i._orig&&i._orig._targets.length){u();var n={x1:i._x,x2:i._x+parseInt(i.offsetWidth),y1:i._y,y2:i._y+parseInt(i.offsetHeight)};WH.de(i);i=i._orig;for(var o=0,l=i._targets.length;o<l;++o){var c=i._targets[o],f=d(c);if(n.x2>=f.x1&&n.x1<f.x2&&n.y2>=f.y1&&n.y1<f.y2){t=true;if(i.onDrop)i.onDrop(e,i,c,a.x>=f.x1&&a.x<=f.x2&&a.y>=f.y1&&a.y<=f.y2);else WH.ae(c,i)}}}if(!t&&i.onDrop)i.onDrop(e,i,null);WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);WH.Tooltips.setEnabled(true);i.className=i.className.replace(/dragged/,"");i=null}function c(e,a){i.style.position="absolute";i.style.left=t.x+e+"px";i.style.top=t.y+a+"px";i._x=t.x+e;i._y=t.y+a}function u(){i.style.left="-2323px";i.style.top="-2323px"}function d(e){var t=WH.ac(e);return{x1:t[0],x2:t[0]+parseInt(e.offsetWidth),y1:t[1],y2:t[1]+parseInt(e.offsetHeight)}}this.init=function(e,t){e.onmousedown=n;if(!e._targets)e._targets=[];if(!e._container)e._container=document.body;if(t!=null){if(t.targets){for(var a=0,i=t.targets.length;a<i;++a)e._targets.push(WH.ge(t.targets[a]))}if(t.container)e._container=WH.ge(t.container);if(t.onClick)e.onClick=t.onClick;if(t.onDrop)e.onDrop=t.onDrop;if(t.onDrag)e.onDrag=t.onDrag}}};WH.Entity=new function(){const e=this;const t=WH.Icon;var a=[WH.Types.ADVENTURE_COMBATANT_ABILITY,WH.Types.AZERITE_ESSENCE,WH.Types.AZERITE_ESSENCE_POWER,WH.Types.DECOR,WH.Types.GEAR_SET,WH.Types.GUIDE,WH.Types.PROFESSION_TRAIT,WH.Types.RESOURCE,WH.Types.STORYLINE,WH.Types.TITLE,WH.Types.TRADING_POST_ACTIVITY,WH.Types.D4_AFFIX,WH.Types.D4_ASPECT,WH.Types.D4_BOSS_POWER,WH.Types.D4_BUILD,WH.Types.D4_CHAOS_PERK,WH.Types.D4_HORADRIC_COMPONENT,WH.Types.D4_ITEM,WH.Types.D4_PARAGON_GLYPH,WH.Types.D4_PARAGON_NODE,WH.Types.D4_SENESCHAL_STONE,WH.Types.D4_SKILL,WH.Types.D4_VAMPIRIC_POWER,WH.Types.D4_WITCH_POWER,WH.Types.DI_EQUIP_ITEM,WH.Types.DI_MISC_ITEM,WH.Types.DI_NPC,WH.Types.DI_OBJECT,WH.Types.DI_PARAGON_SKILL,WH.Types.DI_QUEST,WH.Types.DI_SET,WH.Types.DI_SKILL,WH.Types.DI_ZONE];this.createIcon=function(a,i,n){n=n||{};let s=n.url===undefined?e.getUrl(i,n.id||a.id,a.name,undefined,n.dataEnv):n.url;delete n.id;delete n.url;return t.createByEntity(a,i,s,n)};this.getLink=function(t,a){let i=WH.Gatherer.getName(t,a);let n=WH.ce("a",{href:WH.Entity.getUrl(t,a,i||false)},WH.ct(i||e.getUnknownName(t,a)));let s=WH.Gatherer.get(t,a);if(s){if(s.icon){n.classList.add("icontinyl");n.style.backgroundImage="url("+WH.Icon.getIconUrl(s.icon,WH.Icon.TINY)+")"}if(s.quality!=null&&s.quality!==-1){n.classList.add("q"+s.quality)}}return n};this.getPlaceholderName=function(e,t,a){return WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+t+(a==null?"":WH.TERMS.wordspace_punct+a)+WH.TERMS.closedparenthesis_punct};this.getUnknownName=function(e,t){return WH.term("unknownEntityName_format",WH.Types.getUpperSingular(e),t)};this.getUrl=function(e,t,a,i,n,r){let o=s(e,t,a,i);if(WH.Types.existsInDataEnv(e,n)){return WH.Url.generate(o,{dataEnv:n,locale:r})}let l=WH.Types.getRequiredTrees(e);if(l&&l.length){return WH.Url.generate(o,{dataEnv:WH.getRootByTree(l[0]),locale:r})}return WH.Url.generate(o,{dataEnv:n,locale:r})};this.isReference=function(e){return/^[a-z-]+=-?\d+$/.test(e)};function i(e,t,a){var i="/"+WH.Types.getDetailPageName(e)+"="+t;if(!a&&a!==false){a=WH.Gatherer.getName(e,t)}if(a){i+="/"+WH.Strings.slug(a,true)}return i}function n(e,t,a){var i="/"+WH.Types.getDetailPageName(e)+"/";if(!a&&a!==false){a=WH.Gatherer.getName(e,t)}if(a){i+=WH.Strings.slug(a,true)+"-"+t}else{i+=t}return i}function s(e,t,s,r){let o;if(a.indexOf(e)!==-1){o=n(e,t,s)}else{o=i(e,t,s)}if(typeof r==="string"){if(r!==""){o+="?"+r}}else if(r&&typeof r==="object"){r=WH.Url.buildQuery(r);if(r){o+="?"+r}}return o}};WH.Favorites=new function(){const e=this;const t={favorites:null,pageType:null,pageId:null,pageStar:null};this.pageInit=function(e,a,i){if(typeof e==="string"){e=WH.qs(e)}if(!e||typeof a!=="number"||typeof i!=="number"){return}t.pageType=a;t.pageId=i;u(e)};this.hasFavorites=function(){o();return t.favorites.length>0};this.getMenu=function(){o();let e=[];let a=0;let i=0;for(let n=0;n<t.favorites.length;n++){let s=t.favorites[n];if(!s.entities.length){continue}a++;let r=[];for(let e=0;e<s.entities.length;e++){let t=s.entities[e];let a=t[2]||WH.Entity.getUrl(s.id,t[0]);r.push([t[0],t[1],a]);i++}Menu.sort(r);e.push(Menu.createItem({crumb:s.id,label:WH.Types.getUpperPlural(s.id),submenu:r}))}Menu.sort(e);if(a===1&&i<=45||a===2&&a+i<=30||a>2&&a+i<=15){let t=[];for(let a=0;a<e.length;a++){let i=e[a];t.push([undefined,i[Menu.ITEM_LABEL]]);let n=Menu.getSubmenu(i);for(let e=0;e<n.length;e++){let a=n[e];let i=[a[Menu.ITEM_CRUMB],a[Menu.ITEM_LABEL],a[Menu.ITEM_URL]];if(a[Menu.ITEM_OPTIONS]){i[Menu.ITEM_OPTIONS]=a[Menu.ITEM_OPTIONS]}t.push(i)}}e=t}if(e.length){e.unshift([0,WH.TERMS.favorites,null,null,{heading:true}])}return e};this.refreshMenu=function(t=WH.qs("#header-favorites-button")){if(!t){return}let a=e.getMenu();if(!a.length){t.style.display="none";return}if(Menu.hasMenu(t)){Menu.replace(t,a,{padded:true})}else{Menu.add(t,a,{padded:true})}t.style.display=""};function a(a,n,s,o){let l=r(a,true);if(l===-1){return}let u=t.favorites[l].entities;for(let e=0;e<u.length;e++){if(!o&&u[e][0]===n){alert(WH.TERMS.entityalreadyfavorited_format.replace("%s",WH.Types.getLowerSingular(a)));return}}t.favorites[l].entities.push([n,s]);e.refreshMenu();if(!o){i("add",a,n,c.bind(null,a,n,s,true))}}function i(e,t,a,i){WH.fetch(WH.Url.generatePath("/account/favorites"),{method:"POST",json:{action:e,type:t,id:a,_csrf:g_user.sessionKey},error:function(n,s,r){i();WH.error("Error executing favorites action:",e,t,a,s,r);f(t,a)}})}function n(){const e=typeof g_pageInfo==="object"&&typeof g_pageInfo.type==="number"&&typeof g_pageInfo.typeId==="number";let a=null;if(e){a=WH.qs("#main-contents .heading-size-1")||WH.qs('#main-contents .wh-heading-responsive[data-text-style="heading-1"]')}if(!a){if(document.readyState!=="complete"){setTimeout(n,9)}return}o();t.pageType=g_pageInfo.type;t.pageId=g_pageInfo.typeId;u(a)}function s(e){for(let a=0;a<t.favorites.length;a++){if(t.favorites[a].id===e){return a}}return null}function r(e,a){let i=s(e);if(i!==null){return i}if(!a){return-1}t.favorites.push({id:e,entities:[]});t.favorites.sort((function(e,t){return WH.stringCompare(WH.Types.getUpperPlural(e.id),WH.Types.getUpperPlural(t.id))}));return s(e)}function o(){if(t.favorites===null){t.favorites=WH.getPageData("user.favorites")||[]}}function l(e,a){let i=r(e);if(i===-1){return false}let n=t.favorites[i].entities;for(let e=0;e<n.length;e++){if(n[e][0]===a){return true}}return false}function c(n,s,o,l){let c=r(n);if(c===-1){return}let u=t.favorites[c].entities;for(let r=0;r<u.length;r++){let d=u[r];if(d[0]===s){u.splice(r,1);if(!u.length){t.favorites.splice(c,1)}e.refreshMenu();if(!l){i("remove",n,s,a.bind(null,n,s,o,true))}break}}}function u(e){t.pageStar=WH.ce("span",{className:"fa fav-star"});WH.ae(e,t.pageStar);if(WH.userIsLoggedIn()&&g_user.sessionKey){t.pageStar.classList.add("fa-star"+(l(t.pageType,t.pageId)?"":"-o"));WH.aE(t.pageStar,"click",function(e,t,a){d(e,t,a);f(e,t);WH.Tooltips.hide()}.bind(null,t.pageType,t.pageId,e.textContent.trim().replace(/(.+)<.*/,"$1")));WH.Tooltips.attachNonTouch(t.pageStar,(function(){let e=this.classList.contains("fa-star-o")?WH.TERMS.addtofavorites:WH.TERMS.removefromfavorites;return'<div class="no-wrap">'+e+"</div>"}),"q2")}else{t.pageStar.classList.add("fa-star-o");WH.aE(t.pageStar,"click",(function(){WH.goToLoginPage()}));WH.Tooltips.attachNonTouch(t.pageStar,WH.TERMS.logintosavefavorites_tip+'<div class="q2" style="margin-top:10px">'+WH.TERMS.clicktologin_stc+"</div>")}}function d(e,t,i){if(l(e,t)){c(e,t,i)}else{a(e,t,i)}}function f(e,a){if(!t.pageStar){return}let i="fa-star-o";let n="fa-star";if(!l(e,a)){i="fa-star";n="fa-star-o"}t.pageStar.classList.remove(i);t.pageStar.classList.add(n)}n()};WH.Feedback=new function(){this.EMAIL_ADDR="feedback@wowhead.com"};var ContactTool=new function(){const e=this;this.MODE_COMMENT=1;this.MODE_POST=2;const t=10;const a=1e5;const i=1e3;const n=500;this.general=0;this.comment=1;this.post=2;this.screenshot=3;this.video=5;this.guide=6;var s;var r={0:[[1,true],[9,true],[2,true],[8,true],[3,true],[4,true],[5,true],[6,true],[7,true]],1:[[15,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[16,true],[18,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[19,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[20,function(e){return(e.roles&U_GROUP_MODERATOR)==0}]],2:[[30,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[37,function(e){return(e.roles&U_GROUP_MODERATOR)==0&&g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&g_users[e.user].avatar==2}],[31,true],[32,true],[33,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[34,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&e.op&&!e.sticky}],[35,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[36,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],3:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],5:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],6:[[45,true],[46,true],[48,true]]};var o={1:WH.TERMS.captchaerror_tip,2:WH.TERMS.shortdescription_tip,3:WH.TERMS.contactreason_tip,7:WH.TERMS.alreadyreported_tip};var l=null;this.displayError=function(e,t){alert(t)};this.onShow=function(){if(location.hash&&location.hash!="#contact"){l=location.hash}if(this.data.mode==0){location.replace("#contact")}};this.onHide=function(){if(l&&(l.indexOf("screenshots:")==-1||l.indexOf("videos:")==-1)){WH.setHash(l)}else{WH.clearHash()}};this.onSubmit=function(e,t,a){if(e.submitting){return false}for(var i=0;i<a.elements.length;++i){a.elements[i].disabled=true}var n=["contact=1","mode="+WH.urlEncode(e.mode),"reason="+WH.urlEncode(e.reason),"desc="+WH.urlEncode(e.description),"ua="+WH.urlEncode(navigator.userAgent),"appname="+WH.urlEncode(navigator.appName),"page="+WH.urlEncode(e.currenturl)];if(e.mode==0){if(e.relatedurl){n.push("relatedurl="+WH.urlEncode(e.relatedurl))}if(e.email){n.push("email="+WH.urlEncode(e.email))}}else if(e.mode==1){n.push("id="+WH.urlEncode(e.comment.id))}else if(e.mode==2){n.push("id="+WH.urlEncode(e.post.id))}else if(e.mode==3){n.push("id="+WH.urlEncode(e.screenshot.id))}else if(e.mode==5){n.push("id="+WH.urlEncode(e.video.id))}else if(e.mode==6){n.push("id="+WH.urlEncode(e.guide))}if(e.reason===1||e.reason===9){var s="";if(!WH.WAS){s="Ads class not found. User may have ad blocking enabled. No ad log available."}else{var r=WH.WAS.getDfpLog();if(r&&r.length){s+="<br><b><i>DFP LOG</i></b><br>";for(var l=0,c;c=r[l];l++){s+="<br><b>"+c._time+"</b><br>";s+="<b>Unit:</b> "+c._env+" "+c._slot+"<br>";s+="<b>Channel:</b> "+c._channelName+" ("+c._channelGroup+")<br>";if(c._error){s+='<span style="color:'+WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_FAIL)+'"><b>Error:</b> '+c._error+"</span><br>"}delete c._time;delete c._env;delete c._slot;delete c._channelName;delete c._channelGroup;delete c._error;var u=WH.objectToArray(c,"property");for(var d=0,f;f=u[d];d++){s+="<b>"+f.property+":</b> "+JSON.stringify(f.value)+"<br>"}}}}if(!s){s="No ad data. Probably blocked by user."}n.push("adinfo="+encodeURIComponent(s));if(WH.LocalStorage.isSupported()){let e=localStorage.getItem("zafusr");if(e){n.push("zafusr="+encodeURIComponent(e))}}}e.submitting=true;var h=WH.Url.generatePath("/contactus");new Ajax(h,{method:"POST",params:n.join("&"),onSuccess:function(e,t){var a=e.responseText;if(a==0){if(g_user.name){alert(WH.sprintf(WH.TERMS.contactreceived_format,g_user.name))}else{alert(WH.TERMS.contactthanks_tip)}Lightbox.hide()}else{if(o[a]){alert(o[a])}else{alert("Error: "+a)}}},onFailure:function(e,t){alert("Failure submitting contact request: "+e.statusText)},onComplete:function(t,i){for(var n=0;n<a.elements.length;++n){a.elements[n].disabled=false}e.submitting=false}});return false};this.show=function(t){if(!t){t={}}let a={mode:0};WH.cO(a,t);a.reasons=r[a.mode];if(location.href.indexOf("#contact")!==-1){a.currenturl=location.href.substr(0,location.href.indexOf("#contact"))}else{a.currenturl=location.href}let i="contactus";if(a.mode!==0){i="reportform"}if(!s){e.init()}s.show(i,{data:a,onShow:e.onShow,onHide:e.onHide,onSubmit:e.onSubmit})};this.checkPound=function(){if(location.hash&&location.hash=="#contact"){ContactTool.show()}};this.init=function(){s=new Dialog;Dialog.templates.contactusEmailOnly={title:WH.TERMS.contactwowhead,width:550,buttons:[["x",WH.TERMS.cancel]],fields:[{id:"noemailwarning",type:"caption",compute:function(e,t,a,i){$(i).html('<b id="contact-emailwarn">'+WH.TERMS.contactDialogEmailOnly_tip.replace("%1$s",'<a href="mailto:'+WH.Feedback.EMAIL_ADDR+'">').replace("%2$s","</a>")+"</b>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){setTimeout(Lightbox.reveal,250)}};Dialog.templates.contactus={title:WH.TERMS.contactwowhead,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,required:1,options:[],compute:function(e,t,a,i){WH.ee(e);for(var n=0;n<this.data.reasons.length;++n){var s=this.data.reasons[n][0];var r=this.data.reasons[n][1];var o=false;if(typeof r=="function"){o=r(this.extra)}else{o=r}if(!o){continue}var l=WH.ce("option");l.value=s;if(t&&t==s){l.selected=true}WH.ae(l,WH.ct(c(s)));WH.ae(e,l)}e.onchange=function(){if(this.value==1||this.value==2||this.value==3){a.currenturl.parentNode.parentNode.style.display="";a.relatedurl.parentNode.parentNode.style.display=""}else if(this.value==9){a.currenturl.parentNode.parentNode.style.display="";a.relatedurl.parentNode.parentNode.style.display="none"}else{a.currenturl.parentNode.parentNode.style.display="none";a.relatedurl.parentNode.parentNode.style.display="none"}}.bind(e);i.style.width="98%"},validate:function(e,t,a){var i="";if(!e||e.length==0){i=WH.TERMS.contactreason_tip}if(i==""){return true}ContactTool.displayError(a.reason,i);WH.safeFocus(a.reason);return false}},{id:"currenturl",type:"text",disabled:true,label:WH.TERMS.currenturl_colon,size:40},{id:"relatedurl",type:"text",label:WH.TERMS.relatedurl_colon,caption:WH.TERMS.optional,size:40,validate:function(e,t,a){var i="";var s=/^(http(s?)\:\/\/|\/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((\/?\w+\/)+|\/?)(\w+\.[\w]{3,4})?((\?\w+=\w+)?(&\w+=\w+)*)?/;e=e.trim();if(e.length>=n){i=WH.TERMS.relatedurl_tip}else if(e.length>0&&!s.test(e)){i=WH.TERMS.entervalidurl_tip}if(i==""){return true}ContactTool.displayError(a.relatedurl,i);WH.safeFocus(a.relatedurl);return false}},{id:"email",type:"text",label:WH.TERMS.emailaddress_colon,caption:WH.TERMS.emailcontact_tip,compute:function(e,t,a,i,n){var s=function(){$("#contact-emailwarn").css("display",WH.isEmailValid($(a.email).val())?"none":"");Lightbox.reveal()};$(e).keyup(s).blur(s)},validate:function(e,t,a){var i="";e=e.trim();if(e.length>=100){i=WH.TERMS.emailaddresslength_tip}else if(e.length>0&&!WH.isEmailValid(e)){i=WH.TERMS.entervalidemail_tip}if(i==""){return true}ContactTool.displayError(a.email,i);WH.safeFocus(a.email);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",maxLength:a,required:1,size:[10,30],validate:function(e,i,n){var s="";e=e.trim();if(e.length<t||e.length>a){s=WH.TERMS.shortdescription_tip}if(s==""){return true}ContactTool.displayError(n.description,s);WH.safeFocus(n.description);return false}},{id:"noemailwarning",type:"caption",compute:function(e,t,a,i){$(i).html('<span id="contact-emailwarn" class="q10">'+WH.TERMS.noemailwarning_tip+"</span>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(e["reason"]&&!e.reason.value){setTimeout(e.reason.focus.bind(e.reason),10)}else if(e["relatedurl"]&&!e.relatedurl.value){setTimeout(e.relatedurl.focus.bind(e.relatedurl),10)}else if(e["email"]&&!e.email.value){setTimeout(e.email.focus.bind(e.email),10)}else if(e["description"]&&!e.description.value){setTimeout(e.description.focus.bind(e.description),10)}setTimeout(Lightbox.reveal,250)}};Dialog.templates.reportform={title:WH.TERMS.report,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,options:[],compute:function(e,t,a,i){let n;switch(this.data.mode){case 1:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.comment.user));a.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportcomment_format,'<a href="'+n+'">'+this.data.comment.user+"</a>");break;case 2:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.post.user));var s='<a href="'+n+'">'+this.data.post.user+"</a>";if(this.data.post.op){a.firstChild.innerHTML=WH.sprintf(WH.TERMS.reporttopic_format,s)}else{a.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportpost_format,s)}break;case 3:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.screenshot.user));a.firstChild.innerHTML=WH.sprintf(WH.TERMS.screenshotreport_format,'<a href="'+n+'">'+this.data.screenshot.user+"</a>");break;case 5:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.video.user));a.firstChild.innerHTML=WH.sprintf(WH.TERMS.videoreport_format,'<a href="'+n+'">'+this.data.video.user+"</a>");break;case 6:a.firstChild.innerHTML="Report guide";break}a.firstChild.setAttribute("style","");WH.ee(e);var r;if(this.data.mode==1){r=this.data.comment}else if(this.data.mode==2){r=this.data.post}else if(this.data.mode==3){r=this.data.screenshot}else if(this.data.mode==5){r=this.data.video}else if(this.data.mode==6){r=this.data.guide}WH.ae(e,WH.ce("option",{selected:!t,value:-1}));for(var o=0;o<this.data.reasons.length;++o){var l=this.data.reasons[o][0];var u=this.data.reasons[o][1];var d=false;if(typeof u=="function"){d=u(r)}else{d=u}if(!d){continue}var f=WH.ce("option");f.value=l;if(t&&t==l){f.selected=true}WH.ae(f,WH.ct(c(l)));WH.ae(e,f)}i.style.width="98%"},validate:function(e,t,a){var i="";if(!e||e==-1||e.length==0){i=WH.TERMS.contactreason_tip}if(i==""){return true}ContactTool.displayError(a.reason,i);WH.safeFocus(a.reason);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",maxLength:i,required:1,size:[10,30],validate:function(e,a,n){var s="";e=e.trim();if(e.length<t||e.length>i){s=WH.TERMS.shortdescription_tip}if(s==""){return true}ContactTool.displayError(n.description,s);WH.safeFocus(n.description);return false}}],onInit:function(e){},onShow:function(e){let t=WH.qs('*[name="reason"]',e);let a=WH.qs('*[name="description"]',e);if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(!t.value){setTimeout(t.focus.bind(t),10)}else if(!a.value){setTimeout(a.focus.bind(a),10)}}}};function c(e){return(WH.getPageData("contactReasons")||{})[e]||WH.TERMS.unknown}WH.onLoad(this.checkPound)};WH.Gatherer=new function(){var requested={};this.addData=function(e,t,a){g_gathered_types[e]=g_gathered_types[e]||{};let i=g_gathered_types[e];for(let e in a){if(!a.hasOwnProperty(e)){continue}if(t===WH.getDataEnv()){if(!i.hasOwnProperty(e)){i[e]=a[e]}else{WH.cO(i[e],a[e])}}else{let n=getEnvKey(t);if(!i.hasOwnProperty(e)){i[e]=a[e];i[e][n]=WH.cO({},a[e])}else{if(!i[e].hasOwnProperty(n)){i[e][n]={}}WH.cO(i[e][n],a[e]);for(let t in a[e]){if(!a[e].hasOwnProperty(t)){continue}if(!i[e].hasOwnProperty(t)){i[e][t]=a[e][t]}}}}}};this.fetchItems=function(e,t){fetchData("items",e,t)};this.fetchSpells=function(e,t){fetchData("spells",e,t)};this.get=function(e,t,a,i){if(!g_gathered_types.hasOwnProperty(e)){return undefined}var n=g_gathered_types[e][t];if(n===undefined||!a||a===WH.getDataEnv()){return n}var s=getEnvKey(a);var r=i?undefined:n;return n.hasOwnProperty(s)?n[s]:r};this.getIconName=function(e,t){return g_gathered_types?.[e]?.[t]?.icon||WH.Icon.UNKNOWN};this.getIconNameNoFallback=function(e,t){return g_gathered_types?.[e]?.[t]?.icon||undefined};this.getHtmlNameFromEntity=(e,t=WH.getDataEnv(),a=Locale.getId())=>e.displayName||e[`nameHtml_${Locale.getName(Locale.getDataEnvForcedLocale(t)??a)}`]||e[`nameHtml_${Locale.getName(LOCALE_ENUS)}`];this.getName=function(e,t){if(!g_gathered_types[e]||!g_gathered_types[e][t]){switch(e){case WH.Types.RACE:return WH.Wow.Race.getName(t)||null;case WH.Types.PLAYER_CLASS:return WH.Wow.PlayerClass.getName(t);case WH.Types.CURRENCY:return WH.Wow.Currency.getName(t);case WH.Types.ZONE:return WH.Wow.Area.getName(t);case WH.Types.HUNTER_PET:return WH.Wow.Pet.getName(t);case WH.Types.SKILL:return WH.Wow.Skill.getName(t)}return null}if(g_gathered_types[e][t].name){return g_gathered_types[e][t].name}return g_gathered_types[e][t]["name_"+Locale.getName()]||null};this.getPlainNameFromEntity=(e,t=WH.getDataEnv(),a=Locale.getId())=>e.name||e[`name_${Locale.getName(Locale.getDataEnvForcedLocale(t)??a)}`]||e[`name_${Locale.getName(LOCALE_ENUS)}`];function fetchData(type,entityIDs,options){if(!options){options={}}var entityArray=prepareEntityArray(type,entityIDs,options);if(!entityArray.length){switch(typeof options.onSuccess){case"string":eval(options.onSuccess+"()");break;case"function":options.onSuccess();break}return}entityArray.sort();var url=WH.Url.generatePath("/gatherer?"+type+"="+entityArray.join(","));if(typeof options.onSuccess=="string"){url+="&callback="+options.onSuccess}var callback=typeof options.onSuccess=="function"?options.onSuccess:null;$.getScript(WH.Url.generatePath(url),callback)}function getEnvKey(e){return"_dataEnv_"+WH.dataEnvKey[e]}function prepareEntityArray(e,t,a){if(!requested[e]){requested[e]={}}if(t instanceof Array){var i=[];for(var n=0,s;s=t[n];n++){if(validateID(s)){if(requested[e][s]&&!a.forceRequest){}else{requested[e][s]=true;i.push(s)}}}return i}else if(validateID(t)){if(requested[e][t]&&!a.forceRequest){return[]}else{requested[e][t]=true;return[t]}}else{WH.error("Gatherer requires an array of IDs or single ID.");return[]}}function validateID(e){return typeof e=="number"||typeof e=="string"&&!e.match(/[^0-9]/)}};WH.GlobalStrings=WH.GlobalStrings||{};(function(){if(typeof Proxy!=="function"){return}var e=WH.GlobalStrings;WH.GlobalStrings=new Proxy(e,{get:function(e,t){return e[t]||t}})})();WH.Guide=new function(){const e=WH.getPageData("guides.statusNames");this.getStatusName=function(t){return(e||[])[t]}};function GetStars(e,t,a,i){var n=5;var s=e;if(a){e=a}e=Math.round(e*2)/2;var r=Math.round(e);var o=$("<span>").addClass("stars").addClass("max-"+n).addClass("stars-"+r);if(!g_user.id){t=false}if(t){o.addClass("ratable")}if(a){o.addClass("rated")}var l="<span>";var c=e;for(var u=1;u<=n;++u){if(c<1&&c>0){l+='<b class="stars-half">'}else if(c<=0){l+='<b class="stars-empty">'}else{l+='<b class="stars-full">'}c--;l+='<i class="fa fa-star"></i><i class="fa fa-star-o"></i><i class="fa fa-star-half"></i>'}for(var u=1;u<=n;++u){l+="</b>"}l+="</span>";o.append(l);if(t){var d=0;$("b",o).each((function(){var e=++d;$("> i",this).click((function(){VoteGuide(i,s,e);return false}))}))}if(a){var f=$("<span>").addClass("clear fa fa-times-circle").click((function(){VoteGuide(i,s,0);WH.Tooltips.hide()}));o.append(f)}if(e>=0)o.mouseover((function(t){WH.Tooltips.showAtCursor(t,"Rating:&nbsp;"+e+"&nbsp;/&nbsp;"+n,"q")})).mousemove((function(e){WH.Tooltips.cursorUpdate(e)})).mouseout((function(){WH.Tooltips.hide()}));return o}function VoteGuide(e,t,a){$("#guiderating").html(GetStars(t,true,a,e));WH.fetch(WH.Url.generate("/guide/vote"),{json:{_csrf:WH.User.getSessionKey(),guideId:e,rating:a},success:function(e){WH.st(WH.ge("guiderating-value"),e.rating);WH.st(WH.ge("guiderating-votes"),WH.getN5(e.nvotes))},error:function(e){if(e.rating&&e.nvotes){$("#guiderating-value").text(e.rating);$("#guiderating-votes").text(WH.getN5(e.nvotes))}alert("Voting failed. Try again later."+(e.error?` (${e.error})`:""))}})}WH.Highlight=function(e,t,a,i){const n=WH.LocalStorage;const s={buttonSize:undefined,class:undefined,closeButtonText:undefined,contents:undefined,elements:{target:undefined,wrapper:undefined},extraButtons:[],fixedPosition:false,id:e,position:undefined,useLocalStorage:true};function r(e,t,a){a=a||{};if(a.hasOwnProperty("useLocalStorage")){s.useLocalStorage=a.useLocalStorage}if(s.useLocalStorage){let e=n.get(n.KEY_HIGHLIGHTS_CLOSED);if(Array.isArray(e)&&e.includes(s.id)){return}}else{let e=WH.qs(`.element-highlight[data-id="${s.id}"]`);if(e){WH.de(e)}}s.elements.target=$(e);if(!s.elements.target.length||!s.elements.target.is(":visible")){return}s.fixedPosition=WH.isElementPositionFixedOrSticky(s.elements.target[0]);if(typeof a.buttonSize==="string"){s.buttonSize=a.buttonSize}if(a.extraButtons instanceof Array){s.extraButtons=a.extraButtons}if(typeof a["class"]==="string"){s["class"]=a["class"]}s.contents=t;s.closeButtonText=a.closeButtonText||WH.TERMS.gotIt_exclamation;s.position=["bottom","left","right","top"].indexOf(a.position)!==-1?a.position:"bottom";l();o()}function o(){$(window).resize((function(){var e=document.querySelectorAll(".element-highlight");for(var t=0,a=e.length;t<a;t++){WH.de(e[t])}}));o=function(){}}function l(){var e=s.fixedPosition?s.elements.target[0].getBoundingClientRect():s.elements.target.offset();var t=s.elements.target.outerHeight();var a=s.elements.target.outerWidth();s.elements.wrapper=$("<div/>",{class:"element-highlight",css:{left:e.left+"px",top:e.top+"px"},"data-id":s.id});if(s.fixedPosition){s.elements.wrapper.css("position","fixed")}$("<div/>",{class:"element-highlight-highlighter",css:{height:t+"px",width:a+"px","border-radius":s.elements.target.css("border-radius")}}).appendTo(s.elements.wrapper);var i={};switch(s.position){case"bottom":i.left=a/2+"px";i.top=t+"px";break;case"left":i.right="0px";i.top=t/2+"px";break;case"right":i.left=a+"px";i.top=t/2+"px";break;case"top":i.bottom="0px";i.left=a/2+"px";break}var n=$("<div/>",{class:"element-highlight-dialog",css:i,"data-position":s.position}).appendTo(s.elements.wrapper);var r=$("<div/>",{class:"element-highlight-dialog-content","data-buttons":s.extraButtons.length+1}).appendTo(n);if(s["class"]){s.elements.wrapper.addClass(s["class"])}if(typeof s.contents==="string"){r.text(s.contents)}else{$(s.contents).appendTo(r)}var o=$("<div/>",{class:"element-highlight-dialog-content-buttons"}).appendTo(r);if(s.extraButtons.length){for(var l=0,u=s.extraButtons.length;l<u;l++){var d=s.extraButtons[l];if(!d.url&&!d.action){continue}var f=$("<a/>",{class:"element-highlight-dialog-content-button btn btn-site",text:d.text}).appendTo(o);if(d.url){f.attr("href",d.url)}if(d.action){f.click(d.action)}if(s.buttonSize){f.addClass("btn-"+s.buttonSize)}}}var h=$("<a/>",{class:"element-highlight-dialog-content-close btn btn-site",text:s.closeButtonText,click:c}).appendTo(o);if(s.buttonSize){h.addClass("btn-"+s.buttonSize)}s.elements.wrapper.appendTo(document.body);switch(s.position){case"left":case"right":setTimeout((function(){r.css("top","-"+r.outerHeight()/2+"px")}),0);break}}function c(){s.elements.wrapper.fadeOut((function(){$(this).remove()}));if(s.useLocalStorage){let e=n.get(n.KEY_HIGHLIGHTS_CLOSED);if(!Array.isArray(e)){e=[]}if(!e.includes(s.id)){e.push(s.id)}n.set(n.KEY_HIGHLIGHTS_CLOSED,e)}}r(t,a,i)};WH.jQuery=new function(){this.formatJqxhrMessage=function(e){let t=[];if(e.status){t.push("status: ["+e.status+"]")}if(e.statusText){t.push("statusText: ["+e.statusText+"]")}if(e.responseJSON&&e.responseJSON.error){t.push("responseJSON.error: ["+e.responseJSON.error+"]")}else if(e.responseText){t.push("responseText: ["+e.responseText+"]")}return t.join(", ")}};WH.Layout=new function(){const e=this;const t=WH.Device;const a=WH.DOM;const i=WH.Game;const n=WH.LocalStorage;const s=WH.SessionStorage;const r=`Breadcrumb Nav (${WH.getDataEnvKey()} ${Locale.getName()})`;const o=`Featured Nav (${WH.getDataEnvKey()} ${Locale.getName()})`;const l=`Main Nav (${WH.getDataEnvKey()} ${Locale.getName()})`;const c={activeNavItem:null,autoSearchFocus:true,breadcrumb:null,checkedMenuItems:[],disableLayoutAnimation:0,elements:{$breadcrumb:$('<nav class="breadcrumb" aria-label="breadcrumb" />'),header:undefined,headerNav:undefined,"header-right":undefined,"header-search":undefined,"header-user":undefined,"header-wrapper":undefined,layout:undefined,"main-contents":undefined,"page-content":undefined,searchForm:undefined},forcedFullscreenMode:false,fullscreenMode:undefined,fullscreenModeDefault:false,fullscreenModeLocalStorageKey:null,initialized:false,navMenusAttached:false,pageName:null};this.addPageControls=e=>{let t=WH.qs(".page-controls");if(!t){WH.error("Could not find page controls to add to.");return}if(t.childNodes.length>1){WH.error("Page controls already have both columns filled.");return}WH.ae(t,e)};this.addShareLinks=function(e,t,a){e=typeof e==="string"?e.replace(/\./g,"\\."):e;let i=$("<div>",{class:"share-links"}).prependTo(e);let n=WH.ShareServices.getShareServices(t,WH.ShareServices.getSubredditByNewsType(a));for(let e=0,t=n.length;e<t;e++){let t=n[e].type==="permalink"?WH.term("copy_format",n[e].name):WH.Strings.sprintf(WH.TERMS.shareon_format,n[e].name);const a=WH.ce("i",{className:"fonticon-icon"});WH.React.initComponent(a,"modules/FontIcon",{faIcon:n[e].fontIcon});let s=$("<a>",{"aria-label":n[e].name,href:n[e].url,rel:"np",target:"_blank"}).appendTo(i);s.prepend(a);WH.Tooltips.attach(s[0],t,"q2");if(n[e].type==="permalink"){WH.aE(s[0],"click",(t=>{t.preventDefault();WH.copyToClipboard(n[e].url,t)}))}}};this.disableLayoutAnimation=function(){document.body.dataset.disableLayoutAnimation="true";c.disableLayoutAnimation++};this.enableLayoutAnimation=function(){if(c.disableLayoutAnimation===0||--c.disableLayoutAnimation===0){delete document.body.dataset.disableLayoutAnimation}};this.expandSite=function(t){if(!WH.WAS||!document.body){WH.aE(document,"bodyAvailable",e.expandSite.bind(this,t));return}if(!WH.WAS.showAds()){return}t=t!==false;if(!t){e.disableLayoutAnimation();setTimeout((function(){requestAnimationFrame(e.enableLayoutAnimation)}),10)}WH.WAS.removeAll(t);document.body.classList.add("no-ads-breadcrumb");setTimeout((function(){document.body.classList.remove("has-ads");document.body.classList.add("no-ads")}),(t?WH.WAS.ANIMATION_DURATION_MS:0)+1)};this.getBreadcrumb=function(){return c.elements.$breadcrumb};this.getEnvSwitcherUrl=e=>{const t=WH.Url;let a=WH.getDataTree(e);let i="/";let n="";if(!(WH.PageMeta.disabledInTrees||[]).includes(a)){i=t.getPathCommand().replace(/^\/wow\/retail\/?/,"/");n=location.search}i=t.getAlternatePathCommand(e,i)??i;if(i!=="/"){switch(WH.getDataTree()){case WH.dataTree.CLASSIC:n+=(n?"&":"?")+"fromClassic";break;case WH.dataTree.TBC:n+=(n?"&":"?")+"fromBurningCrusade";break;case WH.dataTree.WRATH:n+=(n?"&":"?")+"fromWrath";break;case WH.dataTree.CATA:n+=(n?"&":"?")+"fromCata";break;case WH.dataTree.MISTS:n+=(n?"&":"?")+"fromMists";break}}return t.generate(i,{dataEnv:e})+n+location.hash};this.getElement=function(e){if(!c.elements.hasOwnProperty(e)){WH.error("Requested unsupported element.",e);return null}if(c.elements[e]===undefined){c.elements[e]=WH.qs("."+e);if(!c.elements[e]){if(document.readyState!=="complete"){c.elements[e]=undefined}else{c.elements[e]=null}}}return c.elements[e]};this.getFaviconUrl=(e,t)=>`${WH.STATIC_URL}/images/logos/favicon-${e}-${t||32}.png`;this.getFullscreenMode=function(){if(c.forcedFullscreenMode){return true}if(c.fullscreenMode===undefined){c.fullscreenMode=W()}return c.fullscreenMode};this.getHeaderBottom=()=>ZUL.getEnabled()?ZUL.HEIGHT:e.getElement("header-wrapper")?.getBoundingClientRect().bottom||0;this.getPageName=function(){return c.pageName||null};this.getShareTypes=function(){let e=["twitter","facebook","reddit"];if(Locale.get().id===LOCALE_RURU){e.unshift("vk")}return e};this.init=function(){S();let e=b();y();_();WH.Layout.Responsive.init(e);I();c.initialized=true};this.initPageState=(a,i,n)=>{if(Locale.exists(a)){Locale.set(a)}if(n!==false){ZUL.init(i)}f();let s=t.isMobile()?"mobile":t.isTablet()?"tablet":"pointer";document.documentElement.classList.add(s+"-device");if(t.isTouch()){document.documentElement.classList.add("touch-device")}w();O();e.initPageState=()=>{}};this.locateBreadcrumb=function(){let t=Menu.getFullPath(Menu.getMenu(),c.breadcrumb);if(!t.length){return}if(!g_pageInfo||!g_pageInfo.hasOwnProperty("typeId")){return}let a=new RegExp("\\b"+WH.Types.getDetailPageName(g_pageInfo.type)+"="+g_pageInfo.typeId+"\\b");let i=JSON.parse(JSON.stringify(c.breadcrumb));i.pop();let n=false;let s=function(e){i.push(e[Menu.ITEM_CRUMB]);let t=Menu.getSubmenu(e);if(t&&t.length){for(let e=0,a=t.length;e<a&&!n;e++){s(t[e])}}else{n|=e.length>2&&a.test(e[Menu.ITEM_URL])}if(!n){i.pop()}};s(t.pop());if(n){c.breadcrumb=i;e.updateBreadcrumb()}};this.onHeaderBottomMove=t=>{const i="onHeaderBottomMove resize observer attached";const n="onHeaderBottomMove callbacks";let s=e.getElement("header-wrapper");if(a.getData(s,i)!==true){WH.aE(s,"resize",(()=>{(a.getData(s,n)??[]).forEach((t=>t(e.getHeaderBottom())))}));a.setData(s,i,true)}let r=a.getData(s,n)??[];r.push(t);a.setData(s,n,r);t(e.getHeaderBottom())};this.set=function(t){if(!t){return}let a=false;if(t.hasOwnProperty("activeTab")&&c.activeNavItem!==t.activeTab){c.activeNavItem=typeof t.activeTab==="string"&&t.activeTab.match(/^\d+$/)?parseInt(t.activeTab):t.activeTab;a=true}let i=false;if(t.hasOwnProperty("breadcrumb")&&JSON.stringify(c.breadcrumb)!==JSON.stringify(t.breadcrumb)){c.breadcrumb=t.breadcrumb;i=true}if(t.hasOwnProperty("pageName")){c.pageName=t.pageName}if(t.hasOwnProperty("autoSearchFocus")){c.autoSearchFocus=t.autoSearchFocus}if(c.initialized){if(a){L()}if(i){e.updateBreadcrumb()}}};this.setForcedFullscreenMode=function(t){let a=e.getFullscreenMode();c.forcedFullscreenMode=t;if(e.getFullscreenMode()!==a){O()}else{document.body.dataset.forcedFullscreenMode=JSON.stringify(t)}};this.setFullscreenMode=function(t){let a=e.getFullscreenMode();c.fullscreenMode=t;let i=t?c.fullscreenModeDefault===false&&g()===false?"Re-enabled":"Enabled":c.fullscreenModeDefault===true&&g()===true?"Re-disabled":"Disabled";n.set(p(),!!t);WH.Track.interactiveEvent({category:"Changed Option",action:"Fullscreen Mode",label:i});if(e.getFullscreenMode()!==a){O()}};this.setFullscreenModeLocalStorageKey=function(t,a){let i=e.getFullscreenMode();c.fullscreenModeLocalStorageKey=t;c.fullscreenModeDefault=t===null||typeof a!=="boolean"?false:a;c.fullscreenMode=undefined;if(e.getFullscreenMode()!==i){O()}};this.setTitle=e=>{if(e.includes(WH.TERMS.wowhead)){document.title=e;return}let t=(e=>({[WH.dataEnv.MAIN]:WH.term("worldofwarcraft"),[WH.dataEnv.PTR]:WH.term("ptrVersion_format",WH.Wow.getVersionString(e)),[WH.dataEnv.PTR2]:WH.term("ptrVersion_format",WH.Wow.getVersionString(e)),[WH.dataEnv.BETA]:WH.term("betaVersion_format",WH.Wow.getVersionString(e)),[WH.dataEnv.CLASSIC]:WH.term("classicworldofwarcraft")}[e]||WH.Seo.getDataEnvName(e)))(WH.getDataEnv());if(e.includes(t)){document.title=e}else{document.title=e+WH.TERMS.hyphen_punct+t}};this.toggleFullscreenMode=function(){e.setFullscreenMode(!W())};this.updateBreadcrumb=function(){if(!Menu.isFinishedLoading()){Menu.onLoad(e.updateBreadcrumb);return}if(!c.breadcrumb||!c.breadcrumb.length){c.elements.$breadcrumb.detach();setTimeout((function(){if(c.elements.$breadcrumb.is(":empty")){c.elements.$breadcrumb.detach()}}),0);return}c.elements.$breadcrumb.empty();if(c.checkedMenuItems.length){$.each(c.checkedMenuItems,(function(){this.checked=false;Menu.updateItem(this)}));c.checkedMenuItems=[]}let t=Menu.getFullPath(Menu.getMenu(),c.breadcrumb);if(!t.length){return}let a=t.length-1;let i=[];for(let e=0,n=t.length;e<n;e++){let n=t[e];let s=Menu.getItemOptions(n);n.checked=true;if(n[Menu.ITEM_OPTIONS]&&n[Menu.ITEM_OPTIONS].breadcrumbParent||t[e+1]&&t[e+1][Menu.ITEM_OPTIONS]&&t[e+1][Menu.ITEM_OPTIONS].breadcrumbParent){if(!n[Menu.ITEM_OPTIONS]){n[Menu.ITEM_OPTIONS]={}}n[Menu.ITEM_OPTIONS].checkedFunc=e=>WH.qs(".page-controls .breadcrumb span a.open")?.textContent===e[Menu.ITEM_LABEL]}c.checkedMenuItems.push(n);Menu.updateItem(n);let o=H();let l=o;let u=Menu.getItemUrl(n);if(typeof u==="string"){u=WH.ensureUrlProtocol(u);l=$("<a/>",{href:u,rel:"np"}).appendTo(o);WH.aE(l[0],"click",(()=>Menu.logLinkClick(n,false,r)))}else{u=undefined}let d=Menu.getLabel(n,true);l.text(d);Menu.add(l,n.parentMenu,{openingMenuItem:n,trackingLabel:r});o.appendTo(c.elements.$breadcrumb);i.push({name:d,url:u,image:s.tinyIcon?WH.ensureUrlProtocol(WH.Icon.getIconUrl(s.tinyIcon,WH.Icon.MEDIUM)):undefined});if(s.onBreadcrumbDisplay){s.onBreadcrumbDisplay(c.breadcrumb)}let f=Menu.getSubmenu(n);if(e===a&&f){o.addClass("breadcrumb-arrow");let e=$('<span class="breadcrumb-ellipsis">...</span>');Menu.add(e,f,{openingMenuItem:n,trackingLabel:r});e.appendTo(c.elements.$breadcrumb)}}WH.Seo.addJsonLdBreadcrumb(i);c.elements.$breadcrumb.trigger("update");if(!c.elements.$breadcrumb.is(":empty")){const e=WH.qs(".page-controls");e&&WH.aef(e,c.elements.$breadcrumb[0]);c.elements.$breadcrumb.show()}ZUL.regenerateMenu()};this.updateDataEnvLink=function(t,a){if(t.dataset.disabled==="true"){delete t.href;return}t.href=e.getEnvSwitcherUrl(a)};this.updateSearchWidth=function(t){const a=e.getElement("header");const i=e.getElement("header-right");const n=e.getElement("header-user");const s=e.getElement("header-search");c.elements.searchForm??=WH.qs("form",s);if(a&&i&&n&&s&&c.elements.searchForm){const e=s.getBoundingClientRect().left-a.getBoundingClientRect().left;const t=window.getComputedStyle(i).getPropertyValue("left");c.elements.searchForm.style.position="absolute";c.elements.searchForm.style.top="10px";c.elements.searchForm.style.left=e-parseInt(t)+"px";c.elements.searchForm.style.right=i.getBoundingClientRect().right-n.getBoundingClientRect().left+parseInt(window.getComputedStyle(document.body).getPropertyValue("--wh-margin1")||0)+"px"}if(t!==false){WH.Layout.Responsive.check()}};this.useAlternateSwitcherPathCommand=(e,t)=>WH.Url.getAlternatePathCommand(e,t)!==undefined;function u(){const e=getComputedStyle(document.documentElement).getPropertyValue("--wh-ui-tree-accent-color").trim();const t=document.querySelector('meta[name="theme-color"]');if(t){t.setAttribute("content",e)}else{const t=WH.ce("meta",{name:"theme-color",content:e});WH.ae(document.head,t)}}function d(){let e=location.pathname+location.search;let t=e.indexOf("?")!==-1||e.indexOf("&")!==-1?"&":"?";e+=t+"classicRedirect";e+=location.hash;location.href=WH.Url.generate(e,{dataEnv:WH.PageMeta.classicDataEnv,locale:Locale.getId()})}function f(){let e=Locale.getPreferred();if(e===undefined){return}Locale.setPreferred(e);if(e===Locale.getId()){return}if(!document.referrer){return}let t;try{t=new URL(document.referrer)}catch(e){return}if(/\.wowhead\.com$/.test("."+t.hostname)){return}if(Locale.getDataEnvForcedLocale(WH.getDataEnv())){return}if(location.href.indexOf(location.origin)!==0){WH.warn("Could not determine path by removing origin",location);return}let a=WH.Url.generate(location.href.substr(location.origin.length),{locale:e});if(location.href!==a){location.href=a}}function h(){return n.get(n.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC)===true}function p(){return c.fullscreenModeLocalStorageKey||n.KEY_LAYOUT_FULLSCREEN}function m(e,t){let a=Menu.getItemOptions(e);let i=WH.ce("a",{className:a.headerNavIcon?"header-nav-icon":"header-nav-text",href:e[Menu.ITEM_URL],rel:"np"});if(e[Menu.ITEM_URL]){WH.aE(i,"click",(()=>Menu.logLinkClick(e,false,t)))}else{i.href="javascript:";i.className+=" unlinked"}if(a.className){i.className+=" "+a.className}if(a.title){i.title=a.title}let n=WH.ce("span");WH.ae(i,n);if(a.headerNavIcon){n.classList.add("header-nav-icon-image");if(a.headerNavIconClass){n.classList.add(a.headerNavIconClass)}else if(a.headerNavIcon.indexOf("/")>-1){n.style.background="url("+WH.staticUrl+a.headerNavIcon+")"}else{n.style.background="url("+WH.staticUrl+"/images/wow/icons/medium/"+a.headerNavIcon+".jpg)"}if(a.headerNavIconWithName){let t=WH.ce("span",{className:"header-nav-icon-text"});WH.st(t,e[Menu.ITEM_LABEL]);WH.ae(i,t)}}else{WH.st(n,e[Menu.ITEM_LABEL])}Menu.onLoad((()=>{let a=Menu.getSubmenu(e);if(a){Menu.add(i,a,{openingMenuItem:e,trackingLabel:t,padded:true})}}));return i}function H(){c.elements.$breadcrumb.children("span:last").addClass("breadcrumb-arrow");return $("<span/>").appendTo(c.elements.$breadcrumb)}function g(){let e=n.get(p());return typeof e==="boolean"?e:undefined}function W(){let e=g();return e===undefined?c.fullscreenModeDefault:e}function E(){let e=WH.ge("main-contents");let t=WH.qs(WH.PageMeta.classicLinkSelector);let i="bottom";if(!t||!a.isVisible(t)){t=WH.qs(".main-contents > .text > .heading-size-1");if(!t||!a.isVisible(t)){if(WH.Layout.Responsive.check()){return}t=e;i="top";if(!t||!a.isVisible(t)){return}}}let n=a.getInnerWidth(t);if(n&&n+230<(a.getInnerWidth(e)||window.innerWidth)){i="right"}let s=WH.Page.getType();let r=WH.Types.hasName(s)?WH.Types.getLowerSingular(s):WH.TERMS.page_lc;let o=WH.Strings.escapeHtml(WH.Url.generate(location.pathname,{dataEnv:WH.PageMeta.classicDataEnv}));let l=WH.ce("div",{className:"highlight-classic-link-content"});l.innerHTML=WH.term("dataEnvVersionLink_format",WH.getDataEnvSeoName(WH.PageMeta.classicDataEnv),r,'<a href="'+o+'">',"</a>");setTimeout((function(){let e="classic-link-type-"+(s||"other");new WH.Highlight(e,t,l,{buttonSize:"small",class:"highlight-classic-link",closeButtonText:WH.TERMS.close,extraButtons:[{text:WH.TERMS.wowheadClassic,url:o}],position:i})}),250)}function _(){e.updateBreadcrumb()}function T(){requestAnimationFrame(e.updateSearchWidth);if(typeof MutationObserver!=="undefined"){let t=WH.qs(".header");if(t){let a=new MutationObserver(e.updateSearchWidth);a.observe(t,{characterData:true,childList:true,subtree:true})}}}function v(){e.initPageState(LOCALE_ENUS,null);u();WH.prepInfobox();WH.Responsive.test();M()}function S(){const t=WH.Url;let a=WH.getPageData("listPage.notFoundPath");if(a){history.replaceState({},"",t.generatePath(a))}WH.qsa(".data-env-links a[title]").forEach((function(t){let a=WH.getDataEnvFromKey(t.dataset.env);if(WH.getDataEnv()!==a){WH.aE(t,"click",e.updateDataEnvLink.bind(t,t,a));WH.aE(t,"mouseover",e.updateDataEnvLink.bind(t,t,a));e.updateDataEnvLink(t,a)}let i=WH.ce("div",{className:"no-wrap"},WH.ct(t.title));let n=(e,t)=>WH.ae(i,WH.ce("div",{className:t,style:{marginTop:"5px"}},WH.ct(e)));if(WH.PageMeta.page==="home"||(WH.PageMeta.page||"").indexOf("news")===0){n(a===WH.dataEnv.MAIN?WH.TERMS.newsTypes+WH.TERMS.colon_punct+WH.TERMS.all:WH.TERMS.newsType+WH.TERMS.colon_punct+WH.TERMS[WH.getDataEnvTerm(a)])}if(t.dataset.restricted==="true"){n(WH.TERMS.staffonly_stc,"q5")}WH.Tooltips.attachNonTouch(t,i,t.href?"q2":"q");t.title=""}));$(".header-theme-switcher a").click((function(){if(this.classList.contains("current")){return}this.classList.remove("fa-square");this.classList.add("fa-refresh");this.classList.add("fa-spin");if(!WH.User.isLoggedIn()){window.location=t.generatePath(t.getLoginPath(t.getPathCommand()+window.location.hash));return}WH.Theme.set(this.dataset.theme)}))}function b(){let t=e.getElement("header");if(!t){return null}let a=WH.ce("div",{className:"header-nav-wrapper"});WH.ae(t,a);c.elements.headerNav=WH.ce("div",{className:"header-nav"});WH.ae(a,c.elements.headerNav);let i=Menu.getMenu();let n=[];let s=[];for(let e=0,t;t=i[e];e++){let e=Menu.getItemOptions(t);if(e.breadcrumbOnly||e.hide){continue}let a=WH.ce("a",{dataset:{id:t[Menu.ITEM_CRUMB]}});a.whMenuItem=t;WH.st(a,t[Menu.ITEM_LABEL]);if(e.collapseOrder){a.dataset.collapseOrder=e.collapseOrder;s.push(a)}if(e.rel){a.rel=e.rel}let i=$(a);Menu.linkifyItem(t,i,false,l);a.menuItem=t;i.data("menuItem",t);n.push(a);WH.ae(c.elements.headerNav,a)}L();let r=m(Menu.createItem({label:"",options:{className:"header-nav-ellipsis"}}),l);let u=WH.ce("span",{className:"fa fa-ellipsis-h"});r.ariaLabel=WH.term("show_format",WH.TERMS.more);WH.ae(r.firstElementChild,u);WH.ae(c.elements.headerNav,r);let d=WH.ce("div",{className:"header-nav-features"});WH.ae(a,d);let f=Menu.getFeaturedNavigationMenu();let h=[];for(let e=0,t;t=f[e];e++){let e=m(t,o);e.menuItem=t;h.push(e);WH.ae(d,e)}let p=m(Menu.createItem({label:"",options:{className:"header-nav-ellipsis"}}),o);let H=WH.ce("span",{className:"fa fa-ellipsis-h"});p.ariaLabel=WH.term("show_format",WH.TERMS.more);WH.ae(p.firstElementChild,H);WH.ae(d,p);A(h);s.sort((function(e,t){return e.menuItem[Menu.ITEM_OPTIONS].collapseOrder-t.menuItem[Menu.ITEM_OPTIONS].collapseOrder}));return{collapsibleNavLinks:s,featuredEllipsis:p,featuredLinks:h,featuredNav:d,header:t,headerWrapper:t.parentNode,nav:c.elements.headerNav,navEllipsis:r,navLinks:n,navWrapper:a}}function y(){const t=e.getElement("header-search");if(!t){return}c.elements.searchForm??=WH.qs("form",t);WH.React.initComponent(c.elements.searchForm,"modules/TextFieldWrapper",{ariaLabel:WH.TERMS.search,attributes:{name:"q",onBlur:()=>t.dataset.hasFocus="false",onFocus:()=>t.dataset.hasFocus="true"},includeClearButton:true,onClear:(e,t)=>WH.Search.Live.reset(t),onMount:e=>a(e),faIcon:{prefix:"fas",name:"search"},iconSubmit:true,placeholder:WH.TERMS.searchGuidesNewsDatabase_stc_ellipsis,size:"small"});const a=e=>{WH.Search.Live.attach(e);if(Array.prototype.indexOf&&c.autoSearchFocus){WH.aE(document.body,"keydown",(t=>{const a=e.getBoundingClientRect().top>=0;if(!a){return}if(!t.ctrlKey&&!t.metaKey&&!t.altKey&&WH.keyPressIsAlphaNumeric(t)&&(!document.activeElement||!["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)&&!document.activeElement.isContentEditable)){e.focus()}}))}};if(s.get(s.KEY_RANDOM_SHOW_ICON)===true){s.remove(s.KEY_RANDOM_SHOW_ICON);const e=WH.qs(".header-nav");if(e){const t=WH.ce("a",{className:"header-search-random fa fa-random fa-no-padding",href:WH.Url.generatePath("/random")});WH.Tooltips.attach(t,WH.TERMS.anotherrandompage_exclamation,"q2");WH.ae(e,t)}}if(c.elements.searchForm){WH.aE(c.elements.searchForm,"submit",WH.preventEmptyFormSubmission)}T()}function I(){if(WH.getGets().hasOwnProperty("classicRedirect")&&!WH.isRetailTree()){if(window.history){window.history.replaceState({},"",location.pathname.replace(/[?&]classicRedirect$/,"")+location.search.replace(/[?&]classicRedirect$/,"")+location.hash)}setTimeout((function(){let e='.data-env-links [data-env="live"]';new WH.Highlight("highlight-retail",e,WH.term("returnToRetail_tip",WH.getDataEnvSeoName()),{extraButtons:[{text:WH.Strings.sprintf(WH.TERMS.backTo_format,WH.qs(e).textContent.trim()),url:WH.qs(e).href}],position:"bottom"})}),250)}}function A(e){let t=function(e){return Math.floor(Math.random()*e)+1};switch(document.body.dataset.logo){case"april-fools":const a=WH.Time.MS_SEC*3;const i=WH.Time.MS_SEC*30;let n=true;let s=e.slice();let r=function(){let e=t(s.length)-1;let o=s[e];o.className="header-nav-text header-nav-april-fools";o.classList.add(n?"first-fool":"entrance-"+t(3));s.splice(e,1);n=false;if(s.length){setTimeout(r,t(i))}else{setTimeout((function(){let e=WH.qs(".header-nav-april-fools.first-fool");e.classList.add("fool-behaves");e.classList.remove("first-fool")}),a)}};setTimeout(r,a);break;case"noblegarden":let o=function(e,a){if(a>3){e.classList.add("header-nav-noblegarden-"+a);e.classList.add("header-nav-noblegarden-dye-"+t(6))}else{e.className="header-nav-text header-nav-noblegarden-"+a;e.classList.add("header-nav-noblegarden-dye-"+t(6))}};if(t(20)===20){for(let t=0,a=e.length;t<a;t++){let a=e[t];if(a.classList.contains("header-nav-classes")){o(a,1)}else{o(a,4)}}break}let l=t(20)===20?6:t(3);let c=[];let u=[];while(c.length<l){let a=t(6);if(c.includes(a)){continue}let i=t(e.length)-1;if(u.includes(i)){continue}let n=e[i];if(a>3&&n.classList.contains("header-nav-classes")){continue}c.push(a);u.push(i);o(n,a)}break}}function R(){let e=$(this).siblings("form").submit().children("input");WH.safeFocus(e)}function N(){let e=WH.getGets();if(e.hasOwnProperty("classicRedirect")||e.hasOwnProperty("fromClassic")||e.hasOwnProperty("fromBurningCrusade")||e.hasOwnProperty("fromWrath")||e.hasOwnProperty("fromCata")||e.hasOwnProperty("fromMists")){WH.Url.replacePageQuery((function(e){delete e.classicRedirect;delete e.fromClassic;delete e.fromBurningCrusade;delete e.fromWrath;delete e.fromCata;delete e.fromMists}));return true}return false}function w(){document.body.dataset.isWowhead="true";document.body.dataset.env=WH.getDataEnvKey();document.body.dataset.game=i.getKey(i.get());document.body.dataset.locale=Locale.getName();document.body.dataset.theme=WH.Theme.getTheme();document.body.dataset.touch=JSON.stringify(t.isTouch());document.body.dataset.tree=WH.getDataTreeKey();document.body.dataset.width=WH.PageMeta.fullWidth?"full":"standard";if(WH.PageMeta.logo){document.body.dataset.logo=WH.PageMeta.logo}if(WH.PageMeta.page){document.body.dataset.page=WH.Strings.slug(WH.PageMeta.page)}}function C(){n.set(n.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC,true)}function M(){if(N()){C();return}if(!WH.isRetailTree()||!WH.PageMeta.classicDataEnv||h()){return}if(!WH.PageMeta.classicRedirectSkip){d();return}E()}function O(){let t=e.getFullscreenMode();let a=JSON.stringify(t);let i=document.body.dataset.fullscreenMode&&document.body.dataset.fullscreenMode!==a;document.body.dataset.fullscreenMode=a;document.body.dataset.forcedFullscreenMode=JSON.stringify(c.forcedFullscreenMode);if(i){Menu.hide(true);WH.Tooltips.hide();WH.WAS.updateSkinMode()}WH.Layout.Responsive.check(true);WH.WAS.updateSkinPosition(true)}function L(){if(!c.elements.headerNav){return}let e=Menu.getMenu();for(let a=0,i=e.length;a<i;a++){let i=e[a];let n=WH.qs('a[data-id="'+i[Menu.ITEM_CRUMB]+'"]',c.elements.headerNav);if(!n){continue}let s=t.isTouch();if(i[Menu.ITEM_CRUMB]===c.activeNavItem){n.classList.add(s?"active-touch":"active")}else{n.classList.remove(s?"active-touch":"active")}if(c.navMenusAttached){continue}Menu.onLoad((()=>{let e=Menu.getSubmenu(i);if(e){if(s){Menu.addTouch(n,e)}else{Menu.add(n,e,{openingMenuItem:i,trackingLabel:l,padded:true})}}}))}c.navMenusAttached=true}WH.onLoad(v)};WH.DynamicFixedElement=new function(){const e=WH.Layout;const t={elements:{}};this.checkAll=function(){for(let e in t.elements){if(t.elements.hasOwnProperty(e)){a(e,true)}}};this.init=function(i,n,s){const r=crypto.randomUUID();s=s||{};if(typeof n==="string"){n=WH.qs(n)}if(!n||n.nodeType!==Node.ELEMENT_NODE){WH.error("Could not find element to set up a dynamic fixed position.",r,n,s);return}if(n.dataset.dynamicFixedElementInitialized){WH.error("Element is already set up for a dynamic fixed position.",r,n,s);return}let o=["left","right"].includes(s.side)?s.side:"right";let l=getComputedStyle(n);t.elements[r]={checkCallback:s.checkCallback,classNameBase:i,defaultSide:parseInt(l.getPropertyValue(o))||0,defaultTop:parseInt(l.getPropertyValue("top"))||0,element:n,fixed:false,getTopOffsetCallback:s.getTopOffsetCallback,minWidth:s.minWidth,offset:false,parent:n.parentNode,side:o};WH.aE(window,"scroll",(()=>a(r)));[window,t.elements[r].element,t.elements[r].parent,e.getElement("layout")].forEach((e=>WH.aE(e,"resize",(()=>a(r,true)))));a(r);n.dataset.dynamicFixedElementInitialized="true"};function a(a,o){const{checkCallback:l,classNameBase:c,defaultTop:u,element:d,getTopOffsetCallback:f,minWidth:h,parent:p}=t.elements[a];if(h&&window.innerWidth<h){i(a);n(a);return}const m=p.getBoundingClientRect();const H=10+e.getHeaderBottom();const g=f?f():0;if(m.top<H-u-g){const e=`scrollable-${c}`;let t;if(d.classList.contains(e)){d.classList.remove(e);t=d.offsetHeight;d.classList.add(e)}else{t=d.offsetHeight}const l=(p.offsetHeight||0)-(t||0)-g;const u=m.top*-1+H-g;if(u<l){n(a);s(a,H,o)}else{i(a);const e=(p.offsetHeight||0)-(d.offsetHeight||0)-g;r(a,Math.min(u,e),o)}}else{i(a);n(a)}if(l){l(t.elements[a])}}function i(e){const{classNameBase:a,element:i,fixed:n,side:s}=t.elements[e];if(n){i.classList.remove("fixed-"+a,"scrollable-"+a);i.style[s]=null;i.style.top=null;t.elements[e].fixed=false}}function n(e){let a=t.elements[e];if(a.offset){a.element.style.marginTop=null;a.offset=false}}function s(e,a,i){const{classNameBase:s,defaultSide:r,element:o,fixed:l,parent:c,side:u}=t.elements[e];const d=WH.getOffset(c);if(!l||i===true){n(e);const i=u==="left"?d.left:document.documentElement.getBoundingClientRect().width-d.left-c.offsetWidth+r;o.classList.add("fixed-"+s);o.style[u]=i+"px";o.style.top=a+"px";if(o.offsetHeight+10+a>window.innerHeight){o.classList.add("scrollable-"+s)}t.elements[e].fixed=true}}function r(e,a,i){let n=t.elements[e];if(!n.offset||i===true){n.element.style.marginTop=a-n.defaultTop+"px";n.offset=true}}};window.Lightbox=new function(){const e=this;const t=WH.DOM;const a=WH.Tooltips;this.BLEED_SIZE=50*2;this.UI_HEIGHT=52;this.UI_WIDTH=20;const i={callbacks:{onHide:undefined,onResize:undefined,onShow:undefined},elements:{frame:undefined,frames:{},inner:undefined,outer:undefined},initialized:false,lastId:undefined};this.addListviewCloseButton=function(e){let t=WH.ce("a",{className:"listview-option-button fa fa-times",dataset:{type:"close"},href:"javascript:"});WH.aE(t,"click",Lightbox.hide);WH.ae(e,t)};this.hide=function(){if(!i.initialized||!e.isVisible()){return}l();if(i.callbacks.onHide){i.callbacks.onHide()}WH.displayNone(i.elements.outer);i.elements.inner.style.width="";Menu.hide(true);a.hide();WH.WAS.restoreHidden();PoundChecker.resume();WH.preventScroll(false)};this.isVisible=function(){return!!i.elements.outer&&t.isVisible(i.elements.outer)};this.reveal=function(){i.elements.outer.dataset.frame=i.lastId;i.elements.frame=i.elements.frames[i.lastId];WH.displayDefault(i.elements.frame);WH.displayDefault(i.elements.outer);c();WH.qsa(".tabs-container",i.elements.frame).forEach((e=>WH.DOM.getData(e.parentNode,"tabs").markFirstTabInRow()))};this.setSize=function(e){i.elements.inner.style.width=e+"px"};this.show=function(t,r,o){r=r||{};i.callbacks.onHide=r.onHide;i.callbacks.onResize=r.onResize;i.callbacks.onShow=r.onShow;Menu.hide(true);a.hide();WH.WAS.hideAll();PoundChecker.pause();s();n();if(i.lastId!==t&&i.elements.frames[i.lastId]){WH.displayNone(i.elements.frames[i.lastId])}i.lastId=t;let l=!i.elements.frames[t];if(l){let e=WH.ce("div",{className:"lightbox-frame"});WH.ae(i.elements.inner,e);i.elements.frames[t]=e}i.elements.frame=i.elements.frames[t];if(i.callbacks.onShow){i.callbacks.onShow(i.elements.frame,l,o)}e.reveal();WH.preventScroll(true,".lightbox-content")};this.showPicker=function(e,t,a){e+="-picker";Lightbox.show(e,{onShow:function(i,n){Lightbox.setSize(800);let s;if(n){i.classList.add(e);WH.ae(i,WH.ce("div",{className:"lightbox-content listview",id:"lv-"+e}));let a=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(a,"click",Lightbox.hide);WH.ae(i,a);t.id=e;s=new Listview(t)}if(a){a(i,n,s)}}})};function n(){WH.aE(document,"keydown",r);WH.aE(window,"resize",o)}function s(){if(i.initialized){return}i.initialized=true;i.elements.inner=WH.ce("div",{className:"lightbox-inner"});i.elements.outer=WH.ce("div",{className:"lightbox-outer",style:{display:"none"}},i.elements.inner);WH.ae(document.body,i.elements.outer);let t=false;let a=false;let n=false;WH.aE(i.elements.inner,"mousedown",(function(){a=true;t=true}));WH.aE(i.elements.inner,"mouseup",(function(){a=false;t=true}));WH.aE(i.elements.outer,"mousedown",(function(){n=true;if(a){a=false;t=true}else{t=false}}));WH.aE(i.elements.outer,"mouseup",(function(a){if(!n){return}n=false;if(!t&&a.target===i.elements.outer){e.hide()}}))}function r(t){if(t.key==="Escape"){e.hide()}}function o(){c();if(i.callbacks.onResize){i.callbacks.onResize()}}function l(){WH.dE(document,"keydown",r);WH.dE(window,"resize",o)}function c(){if(window.innerWidth>=WH.Responsive.BREAKPOINTS.MOBILE_MODE){let t=window.innerHeight-e.BLEED_SIZE;if(i.elements.frame.scrollHeight>t){i.elements.inner.style.maxHeight=t+"px";i.elements.frame.style.maxHeight=t+"px";return}}i.elements.inner.style.maxHeight="";i.elements.frame.style.maxHeight=""}};var LOCALE_ENUS=0;var LOCALE_KOKR=1;var LOCALE_FRFR=2;var LOCALE_DEDE=3;var LOCALE_ZHCN=4;var LOCALE_ESES=6;var LOCALE_RURU=7;var LOCALE_PTBR=8;var LOCALE_ITIT=9;var LOCALE_ZHTW=10;var LOCALE_ESMX=11;var Locale={DEFAULT:LOCALE_ENUS,current:{},locales:{0:{id:LOCALE_ENUS,name:"enus",code:"en",description:"English",descriptionEnglish:"English"},1:{id:LOCALE_KOKR,name:"kokr",code:"ko",description:"한국어",descriptionEnglish:"Korean"},2:{id:LOCALE_FRFR,name:"frfr",code:"fr",description:"Français",descriptionEnglish:"French"},3:{id:LOCALE_DEDE,name:"dede",code:"de",description:"Deutsch",descriptionEnglish:"German"},4:{id:LOCALE_ZHCN,name:"zhcn",code:"zh",description:"简体中文",descriptionEnglish:"Simplified Chinese"},6:{id:LOCALE_ESES,name:"eses",code:"es",description:"Español",descriptionEnglish:"Spanish"},7:{id:LOCALE_RURU,name:"ruru",code:"ru",description:"Русский",descriptionEnglish:"Russian"},8:{id:LOCALE_PTBR,name:"ptbr",code:"pt",description:"Português (Brasil)",descriptionEnglish:"Portuguese (Brazil)"},9:{id:LOCALE_ITIT,name:"itit",code:"it",description:"Italiano",descriptionEnglish:"Italian"},10:{id:LOCALE_ZHTW,name:"zhtw",code:"tw",description:"繁體中文",descriptionEnglish:"Traditional Chinese"},11:{id:LOCALE_ESMX,name:"esmx",code:"mx",description:"Español (México)",descriptionEnglish:"Spanish (Mexico)"}},exists:function(e){return Locale.locales.hasOwnProperty(e)},getAll:function(){var e=[];for(var t in Locale.locales){e.push(Locale.locales[t])}return e},getAllByName:function(){var e=Locale.getAll();e.sort((function(e,t){return WH.stringCompare(e.description,t.description)}));return e},getBySelector:function(e){return WH.getLocaleFromDomain.L[e]},getCode:function(e){return(Locale.locales[e]||Locale.locales[Locale.getId()]).code},getDataEnvForcedLocale:function(e){switch(e){case WH.dataEnv.PTR:case WH.dataEnv.PTR2:case WH.dataEnv.BETA:return LOCALE_ENUS}return undefined},getDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return Locale.locales[e].description},getEnglishDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return Locale.locales[e].descriptionEnglish},getLocalizedDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return WH.GlobalStrings["LFG_LIST_LANGUAGE_"+Locale.getName(e).toUpperCase()]},getId:function(){return Locale.current.id},getIetf:function(e){let t=Locale.getName(e);return t.substr(0,2)+"-"+t.substr(2,2).toUpperCase()},getName:function(e){if(!Locale.locales[e]){e=Locale.getId()}return Locale.locales[e].name},getPathSelectors:function(){return Object.keys(WH.getLocaleFromDomain.L)},getPreferred:function(){if(!WH.Cookies.available()){return}let e=WH.getCookies("prefLocale");if(e==undefined){return}e=parseInt(e);return Locale.exists(e)?e:undefined},get:function(){var e=Locale.getId();return Locale.locales[e]},getSelector:function(e){return WH.findKey(WH.getLocaleFromDomain.L,e)},isLocaleName:function(e){for(var t in Locale.locales){if(Locale.locales.hasOwnProperty(t)&&Locale.locales[t].name===e){return true}}return false},set:function(e){$.extend(Locale.current,Locale.locales[e]);if(e!==LOCALE_ENUS){Menu.sortGlobalMenus()}},setPreferred:function(e){if(!WH.Cookies.available()){return}if(e==null){WH.deleteCookie("prefLocale","/",WH.Cookies.getDomain(),true)}else if(!Locale.exists(e)){WH.error("Invalid locale: ["+e+"]")}else{WH.setCookie("prefLocale",365,e,"/",WH.Cookies.getDomain(),true)}},formatList:function(e,t,a){var i=t==="or"?e.length===2?WH.TERMS.wordspace_punct+WH.TERMS.or_lc+WH.TERMS.wordspace_punct:WH.TERMS.finalenumerationseparatoror_punct:e.length===2?WH.TERMS.and_lc:WH.TERMS.finalenumerationseparator_punct;if(a){var n=Math.max((WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct).length,i.length);var s=(""+e[e.length-1]).length;a-=n+s}var r="";for(var o=0,l=e.length;o<l;o++){if(o>0){r+=o===l-1?i:WH.TERMS.enumerationseparator_punct}r+=e[o];if(a&&r.length>=a&&o<e.length-2){r+=WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct+e[e.length-1];break}}return r},hasSentenceSpaces:function(e){return![LOCALE_ZHCN,LOCALE_ZHTW].includes(e)},hasWordSpaces:function(e){return![LOCALE_ZHCN,LOCALE_ZHTW].includes(e)}};Locale.set(LOCALE_ENUS);function Mapper(e,t){WH.cO(this,e);if(this.parent&&!this.parent.nodeName){this.parent=WH.ge(this.parent)}else{if(!this.parent){return}}var a;this.mouseX=0;this.mouseY=0;this.editable=this.editable||false;this.overlay=this.overlay||false;this.dataEnv=this.dataEnv||WH.getDataEnv();if(WH.Game.getDataEnvs(WH.Game.WOW).includes(this.dataEnv)&&!WH.isRetailTree(this.dataEnv)){this.rootMapDir=`/images/wow/${WH.getDataEnvKey(this.dataEnv)}/maps`}else if(this.legacy){this.rootMapDir="/images/wow/maps/legacy"}else{this.rootMapDir="/images/wow/maps"}this.localeDir=Locale.getName();if(this.dataEnv===WH.dataEnv.PTR){this.localeDir="ptr"}else if(this.dataEnv===WH.dataEnv.PTR2){this.localeDir="ptr2"}else if(this.dataEnv===WH.dataEnv.BETA){this.localeDir="beta"}if(this.editable){this.zoomable=this.toggle=false;this.show=this.mouse=true}else{this.zoomable=this.zoomable==null?true:this.zoomable;this.toggle=this.toggle==null?true:this.toggle;this.show=this.show==null?true:this.show;this.mouse=this.mouse==null?false:this.mouse}this.buttons=this.buttons==null?true:this.buttons;this.zoneLink=this.zoneLink==null?true:this.zoneLink;if(location.href.indexOf("zone=")!=-1){this.zoneLink=false}this.zoom=this.zoom||0;this.zone=this.zone||0;this.level=this.level==null?Mapper.zoneDefaultLevel[this.zone]||0:this.fixLevel(this.level,this.zone);this.phase=0;if(Mapper.zoneDefaultPhase){this.phase=Mapper.zoneDefaultPhase[this.zone]||0}this.pins=[];this.nCoords=0;this.tempWidth=null;this.tempHeight=null;this.parent.className="mapper";this.parent.appendChild(this.span=WH.ce("span",{className:"mapper-map"}));this.overlaySpan=a=WH.ce("div",{className:"mapper-overlay"});this.overlaySpan.appendChild(WH.ce("div",{className:"mapper-overlay-expander"}));this.span.appendChild(a);this.buttonDiv=a=WH.ce("div",{className:"wh-button-group"});a.style.position="absolute";a.style.top=a.style.right="3px";if(this.buttons){this.parent.appendChild(a)}if(this.editable){this.span.onmouseup=this.addPin.bind(this);this.parent.appendChild(WH.ce("span",{className:"mapper-pins-tip"},WH.ct(WH.TERMS.clickmappins_tip)))}else{this.sToggle=a=new WH.Button({"data-variation":WH.getDataTreeKey(),clickHandler:this.toggleShow.bind(this),label:WH.TERMS.hidepins_stc,size:"small",style:"primary"}).getElement();a.style["float"]="right";a.style.display="none";this.buttonDiv.appendChild(a)}if(this.zoomable){this.span.onclick=this.toggleZoom.bind(this);this.span.id="sjdhfkljawelis"+(this.unique!==undefined?this.unique:"");this.zoomTip=WH.ce("span",{className:"mapper-zoom-tip"},WH.ct(WH.TERMS.clickmapzoom_tip));this.span.appendChild(this.zoomTip)}this.sZoneLink=WH.ce("span",{className:"mapper-zone-link",style:{display:"none"}});this.parent.appendChild(this.sZoneLink);if(this.mouse){this.parent.onmouseout=function(){this.timeout=setTimeout(function(){this.sMouse.style.display="none"}.bind(this),1)}.bind(this);this.parent.onmouseover=function(){clearTimeout(this.timeout);this.sMouse.style.display=""}.bind(this);this.span.onmousemove=this.updateMouseCoords.bind(this);this.span.onmousedown=this.updateMouseCoords.bind(this);this.sMouse=WH.ce("span",{className:"mapper-coords",style:{display:"none"}},WH.ct("(0.0, 0.0)"));this.sMouse.onmouseup=WH.sp;this.span.appendChild(this.sMouse)}this.floorPins={};if(e.coords!=null){this.setCoords(e.coords,this.level,e.uiMapId,e.uiMapName)}else{if(e.link!=null){this.setLink(e.link)}}if(e.objectives){this.setObjectives(e.objectives)}if(e.zoneparent&&e.zones){this.setZones(e.zoneparent,e.zones)}this.onlyPhases=false;if(Mapper.multiLevelZones.hasOwnProperty(this.zone)){this.onlyPhases=Mapper.multiLevelZones[this.zone].length==Mapper.multiLevelZones[this.zone].filter((function(e){return e.indexOf("_")!=-1})).length+1}this.updateMap(t)}Mapper.sizes=[[488,325,"normal"],[772,515,"zoom"],[1002,668,"original"],[224,149,"small"]];Mapper.zoneLevelOffset={};Mapper.multiLevelZones={};Mapper.zonePhased={};Mapper.garrisonLevelsToMapTiers={};Mapper.zoneDefaultLevel={};Mapper.remappedLevels={};Mapper.dataReady=false;Mapper.isDataReady=e=>Mapper.dataReady;Mapper.prototype={getMap:function(){return this.parent},update:function(e,t){if(e.zoom!=null){this.zoom=e.zoom}if(e.zone!=null){this.zone=e.zone}if(e.show!=null){this.show=e.show}this.pins=[];this.nCoords=0;for(var a in this.floorPins){if(this.floorPins[a].parentNode){WH.de(this.floorPins[a])}}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}var i=e.level===undefined?0:this.fixLevel(parseInt(e.level),this.zone);if(!e.preservelevel){this.level=i}else{i=this.level}var n=WH.isSet("g_mapperData")?g_mapperData:false;if(n&&n[this.zone]&&!e.coords){var s=n[this.zone];var r=-1;for(var a in s){if(!s.hasOwnProperty(a)){continue}var o=this.fixLevel(parseInt(a),this.zone);if(e.level===undefined&&s[a].count>r){i=parseInt(o);r=s[a].count}if(s[a].coords){this.setCoords(s[a].coords,o,s[a].uiMapId,s[a].uiMapName)}}this.level=i;if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(e.coords!=null){var l=999;for(var a in e.coords){if(!e.coords.hasOwnProperty(a)){continue}var o=this.fixLevel(parseInt(a),this.zone);this.setCoords(e.coords[a],o,e.uiMapId,e.uiMapName);if(o<l){l=o}}if(l!=999&&!e.preservelevel){this.level=l}if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(e.link!=null){this.setLink(e.link)}}}this.updateMap(t)},fixLevel:function(e,t){if(Mapper.remappedLevels[t]&&Mapper.remappedLevels[t].hasOwnProperty(e)){return Mapper.remappedLevels[t][e]}if(Mapper.multiLevelZones.hasOwnProperty(t)){var a=parseInt(Mapper.multiLevelZones[t][0].substr((""+t).length+1));var i;for(var n=1;n<Mapper.multiLevelZones[t].length;n++){i=parseInt(Mapper.multiLevelZones[t][n].substr((""+t).length+1));if(Math.abs(e-i)<Math.abs(e-a)){a=i}}return a}return e},getZone:function(){return this.zone},setZone:function(e,t,a){this.pins=[];this.nCoords=0;if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}this.zone=e;this.level=t||0;this.updateMap(a);return true},getFloorsMenu:function(){if(!Mapper.multiLevelZones[this.zone]){return null}var e=[];var t=Mapper.multiLevelZones[this.zone];var a=function(e){return e[Menu.ITEM_CRUMB]==this.mapName||this.level===undefined&&e[Menu.ITEM_CRUMB]==0}.bind(this);var i,n,s;for(var r=0;n=t[r];r++){var o=0;var l=n.indexOf("-");var c=n.indexOf("_");if(l<0){i=r}else if(c>=0){i=n.substring(l+1,c);o=n.substr(c+1)}else{i=n.substr(l+1)}var u=this.getMapDisplayName(n,this.zone,i,o);s=[n,u,this.setMap.bind(this,n,i,o,true)];s[Menu.ITEM_OPTIONS]={checkedFunc:a};e.push(s)}return e},getMapDisplayName:function(e,t,a,i){var n="";var s;if(g_zone_areas[t]&&g_zone_areas[t].hasOwnProperty(a)){n=g_zone_areas[t][a]}else if(g_zone_playerconditions[t]&&g_zone_playerconditions[t].hasOwnProperty(i)){n=g_zone_playerconditions[t][i]}else if(s){n=s}else{if(this.onlyPhases){n=WH.Strings.sprintf(WH.TERMS.zonePhase_format,i)}else if(Mapper.multiLevelZones[t].filter((function(e){return e.indexOf("-"+a+"_")!=-1})).length+(a==0?1:0)>1){n=WH.Strings.sprintf(WH.TERMS.zoneLevelPhase_format,a,i)}else{n=WH.Strings.sprintf(WH.TERMS.zoneLevel_format,a)}}return n},setMap:function(e,t,a,i){if(t!=this.level){if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}if(this.floorPins[t]){WH.ae(this.span,this.floorPins[t])}this.level=t}this.mapName=e;this.phase=a;let n=WH.isDataEnvRestricted(this.dataEnv)?WH.Url.generatePrivate:WH.Url.generateStatic;let s=(t,a)=>{let i=`${this.rootMapDir}/${t}/${Mapper.sizes[this.zoom][2]}/${e}.${a}`+`?${WH.getDataCacheVersion()}`;return n(i)};this.span.style.background=`url(${s(this.localeDir,"jpg")})`;if(this.overlay){this.overlaySpan.style.background=`url(${s("overlay","png")})`}if(this.sZoneLink&&!this.noZoneName){var r="";var o=parseInt(this.zone);var l=WH.Wow.Area.getName(o)!=null;if(l){if(this.zoneLink){r+=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.ZONE,o)},WH.ct(WH.Wow.Area.getName(o))).outerHTML}if(Mapper.multiLevelZones[o]){if(this.zoneLink){r+=": "}r+=this.getMapDisplayName(e,o,t,a)}this.sZoneLink.innerHTML=r}this.sZoneLink.style.display=l?"":"none"}if(i){this.onMapUpdate&&this.onMapUpdate(this)}},setObjectives:function(e){var t={start:1,end:1,startend:1,sourcestart:1,sourceend:1};for(var a in e){var i=e[a];if(g_mapperData[a]===undefined){g_mapperData[a]={}}for(var n in i.levels){var s=i.levels[n];var r=ShowOnMap.combinePins(s);var o=r[0];g_mapperData[a][n]={count:o.length,coords:[]};for(var l=0;l<o.length;++l){var c=ShowOnMap.buildTooltip(o[l].list);g_mapperData[a][n].coords.push([o[l].coord[0],o[l].coord[1],{type:c[1],url:c[2],menu:c[3],label:c[0]}])}}}},setZones:function(e,t){e=$("#"+e);if(!e||!t||t.length==0||!this.objectives){return}var a=function(e,a,i,n){var s=[false,-1];for(var r=0;r<i.length;++r){if(r>0){d.append(r==i.length-1?WH.TERMS.and_lc:WH.TERMS.comma_punct)}var o=null;if(e.objectives[i[r][0]].mappable>0){o=$("<a/>",{href:"javascript:",text:e.objectives[i[r][0]].zone});o.click(function(t,a){e.update({zone:a});WH.setSelectedLink(t,"mapper")}.bind(e,o[0],i[r][0]));o.isLink=true}else{let t=WH.Entity.getUrl(WH.Types.ZONE,i[r][0]);o=$("<a/>",{href:t,text:e.objectives[i[r][0]].zone});WH.Tooltips.attach(o[0],WH.TERMS.zonelink_tip,"q")}if(t.length>1){var l=n[i[r][0]];if(l.iconType){o.addClass(`quest-${l.iconType}-`+(l.start&&l.end?"startend":l.start?"start":"end"))}else if(l.start&&l.end){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_startend.gif)");o.css("padding-left","20px")}else{if(l.start){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_start.gif)");o.css("padding-left","14px")}else{if(l.end){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_end.gif)");o.css("padding-left","16px")}}}}a.append(o);if(i[r][1]>s[1]){s=[o,i[r][1]]}}return s[0]};var i=function(e,t,a){var i=[];for(var n=0;n<e.length;++n){if(t[e[n][0]][a]){i.push(e[n])}}return i};var n={};var s={start:[],end:[],objective:[]};for(var r in this.objectives){if(n[r]===undefined){n[r]={}}var o=this.objectives[r];for(var l in o.levels){var c=o.levels[l];for(var u=0;u<c.length;++u){if(c[u].point=="start"||c[u].point=="sourcestart"){s.start.push(r);n[r].start=true}else{if(c[u].point=="end"||c[u].point=="sourceend"){s.end.push(r);n[r].end=true}else{if(c[u].point=="requirement"||c[u].point=="sourcerequirement"){s.objective.push(r);n[r].objective=true}}}if(c[u].iconType&&(n[r].start||n[r].end)){n[r].iconType=c[u].iconType}}}}e.append(WH.getMajorHeading(WH.TERMS.relevantlocations,2,3));if(t.length==1&&this.missing==0){var d=$("<span/>",{html:WH.TERMS.questobjectives1zone_tip.replace("$$","<b>"+this.objectives[t[0][0]].zone+"</b>.")});e.append(d);this.update({zone:t[0][0]})}else{if(this.missing>0){var f=function(e,t){if(e.length!=t.length){return false}var a={};for(var i=e.length;i>=0;--i){a[e[i]]=true}for(var n=t.length;n>=0;--n){if(a[t[n]]===undefined){return false}}return true};var d=$("<span/>");var h=false,p=false,m=false;s.objective=WH.arrayUnique(s.objective);s.start=WH.arrayUnique(s.start);s.end=WH.arrayUnique(s.end);var H=s.start.length>0&&f(s.start,s.end);var g=s.start.length>0&&f(s.start,s.objective);var W=s.end.length>0&&f(s.end,s.objective);var E=i(t,n,"objective");var _=i(t,n,"start");var T=i(t,n,"end");let r=WH.getPageData("mapper.objectiveTerms");let o;switch(true){case!!(H&&g):o=WH.TERMS.partofquesthappensin_format.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!(H&&s.objective.length==0):o=r.sex.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!H:o=r.ox_sey.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);break;case!!(g&&s.end.length==0):o=r.osx.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!g:o=r.osx_ey.split("$$");d.text(o[0]);h=a(this,d,E,n);d.append(o[1]);p=a(this,d,T,n);d.append(o[2]);break;case!!(W&&s.start.length==0):o=r.oex.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!W:o=r.oex_sy.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);break;case!!(s.start.length>0&&s.end.length>0&&s.objective.length>0):o=r.ox_sy_ez.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);m=a(this,d,T,n);d.append(o[3]);break;case!!(s.start.length>0&&s.end.length>0):o=r.sx_ey.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,T,n);d.append(o[2]);break;case!!(s.start.length>0&&s.objective.length>0):o=r.ox_sy.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);break;case!!(s.end.length>0&&s.objective.length>0):o=r.ox_ey.split("$$");d.text(o[0]);h=a(this,d,E,n);d.append(o[1]);p=a(this,d,T,n);d.append(o[2]);break;case s.start.length>0:o=r.sx.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case s.end.length>0:o=r.ex.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case s.objective.length>0:o=r.ox.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;default:o=WH.TERMS.partofquesthappensin_format.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break}e.append(d);if(h&&h.isLink){h.click()}else{if(p&&p.isLink){p.click()}else{if(m&&m.isLink){m.click()}}}}else{var v=WH.TERMS.partofquesthappensin_format.split("$$");var d=$("<span/>",{text:v[0]});var h=a(this,d,t,n);d.append(v[1]);e.append(d);if(h&&h.isLink){h.click()}}}},setSize:function(e,t){this.tempWidth=e;this.tempHeight=t;this.updateMap(true)},getZoom:function(){return this.zoom},setZoom:function(e,t){this.zoom=e;this.tempWidth=this.tempHeight=null;this.updateMap(t)},toggleZoom:function(e){this.zoom=1-this.zoom;this.zoom++;this.updateMap(true);if(e){this.updateMouseCoords(e)}if(this.zoomTip){this.zoomTip.style.display=this.zoomTip.style.display==="none"?"":"none"}if(this.zoom){if(window.innerWidth>=900){MapViewer.show({mapper:this,zoom:this.zoom})}}},getShow:function(){return this.show},setShow:function(e){this.show=e;var t=this.show?"":"none";for(var a in this.floorPins){this.floorPins[a].style.display=t}this.sToggle.innerHTML=this.show?WH.TERMS.hidepins_stc:WH.TERMS.showpins_stc},toggleShow:function(){this.setShow(!this.show)},getCoords:function(){var e=[];for(var t in this.pins){if(!this.pins[t].free){e.push([this.pins[t].x,this.pins[t].y])}}return e},clearPins:function(){for(var e in this.pins){this.pins[e].style.display="none";this.pins[e].free=true}},setCoords:function(e,t,a,i){var n;var s,r;if(t===undefined){this.clearPins();if(e.length){r=true;s=0}else{for(let t in e){s=t;break}if(s==null){return}e=e[s]}s=parseInt(s);if(!r){s=this.fixLevel(s,this.zone);this.level=s}}else{s=t;if(!e.length){e=e[s]&&e[s].length?e[s]:[]}}this.nCoords=e.length;a=a||this.uiMapId;i=i||this.uiMapName;for(let t in e){var o=e[t],l=o[2];if(o[0]===undefined||o[1]===undefined){continue}if(o[0]===null||o[1]===null){var c=this.parent.id?this.parent.id.replace(/^mapper-parent-/,""):this.parent;if(WH.Wow.Area.getName(c)){c=WH.Wow.Area.getName(c)}WH.error("Bad coordinates for",c,"-- Pin Coords:",o);continue}n=this.getPin(s);n.x=o[0];n.y=o[1];n.style.left=n.x+"%";n.style.top=n.y+"%";let r=false;if(this.editable&&!(l&&l.locked)){n.a.onmouseup=this.delPin.bind(this,n);r=true}else{if(l&&l.url){n.a.href=l.url;n.a.rel="np"+(l.rel?"&"+l.rel:"");n.a.style.cursor="pointer";r=true}}if(l&&l.tooltip){n.a.tt="";var u=false;for(var d in l.tooltip){if(n.a.tt!=""){n.a.tt+="<br />"}n.a.tt+='<b class="q">'+d+"</b> ($)<br />";for(var f in l.tooltip[d].info){n.a.tt+="<div>"+l.tooltip[d].info[f]+"</div>"}if(!u&&l.tooltip[d].footer){n.a.tt+=l.tooltip[d].footer+"<br />";u=true}}}else{if(l&&l.label){n.a.tt=l.label}else{if(l&&l.fixTooltip){n.a.rel=n.a.rel.replace(/^np&?/,"");WH.dE(n.a,"mouseover",this.pinOver);WH.dE(n.a,"mouseout",WH.Tooltips.hide);n.a.tt="";if(typeof l.fixTooltip=="function"){n.a._fixTooltip=l.fixTooltip}}else{n.a.tt="$";if(!r){n.a.role="button";WH.dE(n.a,"mouseover",this.pinOver);let e={getAllCoords:function(){let e=[];WH.qsa("div.pin a",this.floorPins[s]).forEach((function(t){if(typeof t.tt==="string"){e.push(t.tt.split(", "))}}));return e}.bind(this)};if(a){e.uiMapId=a}if(i){e.uiMapName=i}if(this.name){e.name=this.name}WH.Wow.UiMap.clickToCopyCoordinates(n.a,function(){return this.tt.split(", ")}.bind(n.a),e)}}}}if(l&&l.menu){n.a.menu=l.menu;Menu.add(n.a,n.a.menu,{showAtCursor:true})}if(l&&l.type){n.className+=" pin-"+l.type}if(l&&l.mapicon){n.className+=" pin-object";n.a.style.backgroundPosition=(l.mapicon+2)%8*-16+"px "+Math.floor((l.mapicon+2)/8)*-16+"px"}n.a.tt=WH.stringReplace(n.a.tt,"$",n.x.toFixed(1)+", "+n.y.toFixed(1));if(l&&l.lines){for(var h=0,p=l.lines.length;h<p;++h){if(o[0]==l.lines[h][0]&&o[1]==l.lines[h][1]){continue}for(var m=0,H=Mapper.sizes.length;m<H;++m){var g=Mapper.sizes[m];n=this.line(o[0]*g[0]/100,o[1]*g[1]/100,l.lines[h][0]*g[0]/100,l.lines[h][1]*g[1]/100,l.type);n.className+=" "+g[2];WH.ae(this.floorPins[s],n)}}}if(l&&l.dataset){WH.cO(n.dataset,l.dataset)}}this.onPinUpdate&&this.onPinUpdate(this)},getLink:function(){var e="";for(var t in this.pins){if(!this.pins[t].free&&this.pins[t].floor==this.level){e+=(this.pins[t].x<10?"0":"")+(this.pins[t].x<1?"0":"")+(this.pins[t].x*10).toFixed(0)+(this.pins[t].y<10?"0":"")+(this.pins[t].y<1?"0":"")+(this.pins[t].y*10).toFixed(0)}}return(this.zone?this.zone:"")+(Mapper.multiLevelZones[this.zone]&&this.level!=0?"."+this.level:"")+(e?":"+e:"")},setLink:function(e,t,a){var i=[];e=e.split(":");var n=e[0];var s=0;if(n.indexOf(".")!=-1){var r=n.split(".");n=r[0];s=parseInt(r[1])}s=a&&a!=-1&&!s?a:s;if(!this.setZone(n,s,t)){return false}if(e.length==2){for(var o=0;o<e[1].length;o+=6){var l=e[1].substr(o,3)/10;var c=e[1].substr(o+3,3)/10;if(isNaN(l)||isNaN(c)){break}i.push([l,c])}}this.setCoords(i,s);return true},updateMap:function(e){this.parent.style.width=this.span.style.maxWidth=(this.tempWidth?this.tempWidth:Mapper.sizes[this.zoom][0])+"px";this.span.style.maxHeight=(this.tempHeight?this.tempHeight:Mapper.sizes[this.zoom][1])+"px";this.parent.setAttribute("data-mapsize",Mapper.sizes[this.zoom][2]);if(this.zone=="0"){this.span.style.background="black"}else{var t=this.level;var a=this.phase;var i=this.zone+(t?"-"+t:"");if(Mapper.multiLevelZones[this.zone]&&!Mapper.multiLevelZones[this.zone].includes(i)&&Mapper.multiLevelZones[this.zone][t]){i=Mapper.multiLevelZones[this.zone][t];let e=i.match(/^\d+\-(\d+)$/);if(e){t=parseInt(e[1])}if(!i.match(/_\d+/)&&a!=0){i+="_"+a}}else if(Mapper.garrisonLevelsToMapTiers[this.zone]&&Mapper.garrisonLevelsToMapTiers[this.zone][t]){i=this.zone+"__"+Mapper.garrisonLevelsToMapTiers[this.zone][t]}this.setMap(i,t,a);if(!this.floorButton&&Mapper.multiLevelZones[this.zone]){const e=new WH.Button({"data-variation":WH.getDataTreeKey(),label:Mapper.zonePhased[this.zone]?WH.TERMS.changephase_ellipsis:WH.TERMS.changefloor_ellipsis,size:"small",style:"primary"}).getElement();this.floorButton=e;e.menu=this.getFloorsMenu();if(e.menu&&e.menu.length){Menu.add(e,e.menu,{showAtElement:true})}WH.ae(this.buttonDiv,e)}else{if(this.floorButton){this.floorButton.style.display=Mapper.multiLevelZones[this.zone]?"":"none"}}}if(this.sToggle){this.sToggle.style.display=this.toggle&&this.nCoords?"":"none"}$(".line",this.floorPins[t]).hide();$(".line."+Mapper.sizes[this.zoom][2],this.floorPins[t]).show();this.onMapUpdate&&this.onMapUpdate(this)},cleanPin:function(e,t){var a=this.pins[e];a.style.display="";a.free=false;a.className="pin";for(var i in a.dataset){if(a.dataset.hasOwnProperty(i)){delete a.dataset[i]}}a.a.onmousedown=WH.rf;a.a.onmouseup=WH.rf;a.a.href="javascript:";a.a.style.cursor="default";a.floor=t;return a},getPin:function(e){for(var t=0;t<this.pins.length;++t){if(this.pins[t].free){return this.cleanPin(t,e)}}var a=WH.ce("div"),i=WH.ce("a");a.className="pin";a.appendChild(i);a.a=i;a.floor=e;WH.aE(i,"mouseover",this.pinOver);WH.aE(i,"mouseout",WH.Tooltips.hide);i.onclick=WH.sp;this.pins.push(a);this.cleanPin(this.pins.length-1,e);if(!this.floorPins[e]){this.floorPins[e]=WH.ce("div");this.floorPins[e].style.display=this.show?"":"none";if(e==this.level){WH.ae(this.span,this.floorPins[e])}}WH.ae(this.floorPins[e],a);return a},addPin:function(e){if(!WH.isLeftClick(e)){return}this.updateMouseCoords(e);let t=this.getPin(this.level);t.x=this.mouseX;t.y=this.mouseY;t.style.left=t.x.toFixed(1)+"%";t.style.top=t.y.toFixed(1)+"%";t.a.onmouseup=this.delPin.bind(this,t);t.a.tt=t.x.toFixed(1)+", "+t.y.toFixed(1);this.onPinUpdate&&this.onPinUpdate(this);return false},delPin:function(e,t){e.style.display="none";e.free=true;WH.sp(t);WH.Tooltips.hide();this.onPinUpdate&&this.onPinUpdate(this)},pinOver:function(){WH.Tooltips.show(this,this.tt,undefined,{padX:4})},updateMouseCoords:function(e){let t=WH.getOffset(this.parent);let a=WH.getScroll();this.mouseX=Math.floor((e.clientX+a.x-t.left-3)/Mapper.sizes[this.zoom][0]*1e3)/10;this.mouseY=Math.floor((e.clientY+a.y-t.top-3)/Mapper.sizes[this.zoom][1]*1e3)/10;if(this.mouseX<0){this.mouseX=0}else{if(this.mouseX>100){this.mouseX=100}}if(this.mouseY<0){this.mouseY=0}else{if(this.mouseY>100){this.mouseY=100}}if(this.mouse){WH.st(this.sMouse,"("+this.mouseX.toFixed(1)+", "+this.mouseY.toFixed(1)+")")}},line:function(e,t,a,i,n){var s=Math.min(e,a);var r=Math.max(e,a);var o=Math.min(t,i);var l=Math.max(t,i);var c=r-s;var u=l-o;var d=Math.sqrt(Math.pow(c,2)+Math.pow(u,2));var f=Math.atan2(u,c);var h=$('<span class="line" />').css({top:o.toFixed(2)+"px",left:s.toFixed(2)+"px",width:c.toFixed(2)+"px",height:u.toFixed(2)+"px"}).append($("<var />").css({width:d.toFixed(2)+"px",transform:"rotate("+f+"rad)"}));if(!(e==s&&t==o)&&!(a==s&&i==o)){h.addClass("flipped")}if(n!=null){h.addClass("line-"+n)}return h[0]}};var g_zone_areas={};window.MapViewer=new function(){const e=WH.DOM;const t={desiredScale:undefined,elements:{aCover:undefined,container:undefined,mapDiv:undefined,placeholder:undefined,screen:undefined,temporaryParent:undefined,oldParent:undefined},imageWidth:undefined,imageHeight:undefined,mapper:undefined,oldOnClick:undefined,oldOnUpdate:undefined,scale:undefined,zoom:undefined};this.checkPound=function(){if(location.hash&&location.hash.startsWith("#map")){let e=location.hash.split("=");if(e.length===2){let t=e[1];if(t){MapViewer.show({link:t})}}else{e=location.hash.split(":");let a=WH.ge("sjdhfkljawelis");if(a){a.onclick()}if(e.length===2){if(!a){MapViewer.show({link:e[1]})}let i=e[1].split(".");let n={zone:i[0]};if(i.length===2){n.level=parseInt(i[1])+1}t.mapper.update(n)}}}};this.getZoom=function(){if(typeof t.zoom==="number"){return t.zoom}return 1};this.show=function(e){t.zoom=e.zoom;WH.Track.interactiveEvent({category:"Zone Maps",action:"Show",label:e.link?e.link:"General"});if(e.link){t.elements.temporaryParent=WH.ce("div",{id:"fewuiojfdksl"});WH.ae(document.body,t.elements.temporaryParent);let a=new Mapper({parent:t.elements.temporaryParent.id});a.setLink(e.link,true);a.toggleZoom()}else Lightbox.show("mapviewer",{onShow:s,onHide:n,onResize:o.bind(self,true)},e)};function a(){let e="#map";if(t.elements.temporaryParent){e+="="+t.mapper.getLink()}else if(Mapper.zoneDefaultLevel[t.mapper.zone]){if(Mapper.zoneDefaultLevel[t.mapper.zone]!==t.mapper.level){e+=i(t.mapper)}}else if(t.mapper.level!==0){e+=i(t.mapper)}else if((!window.g_mapperData||!g_mapperData[t.mapper.zone])&&(!window.g_mapper_data||!g_mapper_data[t.mapper.zone])){e+=i(t.mapper)}return e}function i(e){let t=":"+e.zone;if(e.level){t+="."+e.level}return t}function n(){t.mapper.span.onclick=t.oldOnClick||null;t.mapper.onMapUpdate=t.oldOnUpdate||null;t.mapper.span.style.cursor="";t.oldOnClick=null;t.oldOnUpdate=null;if(!t.elements.temporaryParent){WH.de(t.mapper.parent);t.mapper.parent.style.borderWidth="";t.mapper.parent.style.marginTop="";if(t.elements.placeholder){if(!t.elements.placeholder.parentNode){return}t.elements.oldParent.insertBefore(t.mapper.parent,t.elements.placeholder)}else{WH.ae(t.elements.oldParent,t.mapper.parent)}WH.de(t.elements.placeholder);t.elements.oldParent=null}else{WH.de(t.elements.temporaryParent);t.elements.temporaryParent=null}t.mapper.toggleZoom();if(location.hash.indexOf("#show")===-1){WH.clearHash()}else if(window.mapShowObject){mapShowObject.onCollapse()}}function s(e,a,i){t.mapper=i.mapper;t.elements.container=e;if(a){e.classList.add("mapviewer");t.elements.screen=WH.ce("div",{className:"lightbox-content mapviewer-screen",style:{height:Mapper.sizes[MapViewer.getZoom()][1]+"px",width:Mapper.sizes[MapViewer.getZoom()][0]+"px"}});t.elements.aCover=WH.ce("a",{className:"mapviewer-cover",href:"javascript:"});WH.aE(t.elements.aCover,"click",Lightbox.hide);let a=WH.ce("span");let i=WH.ce("b");WH.ae(i,WH.ct(WH.TERMS.close));WH.ae(a,i);WH.ae(t.elements.aCover,a);WH.ae(t.elements.screen,t.elements.aCover);t.elements.mapDiv=WH.ce("div");WH.ae(t.elements.screen,t.elements.mapDiv);WH.ae(e,t.elements.screen);let n=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"});WH.aE(n,"click",Lightbox.hide);WH.ae(n,WH.ct(WH.TERMS.close));WH.ae(e,n)}o()}function r(){if(t.oldOnUpdate){t.oldOnUpdate(t.mapper)}location.replace(a())}function o(e=false){if(e&&t.scale===t.desiredScale&&window.innerHeight>t.elements.container.offsetHeight){return}t.elements.container.style.visibility="hidden";l();if(!e){if(!t.elements.placeholder){t.elements.placeholder=WH.ce("div",{style:{height:"325px",padding:"3px",marginTop:"10px"}})}t.mapper.parent.style.borderWidth="0px";t.mapper.parent.style.marginTop="0px";t.mapper.span.style.cursor="pointer";if(t.mapper.span.onclick){t.oldOnClick=t.mapper.span.onclick}t.mapper.span.onclick=Lightbox.hide;if(t.mapper.onMapUpdate){t.oldOnUpdate=t.mapper.onMapUpdate}t.mapper.onMapUpdate=r;if(!t.elements.temporaryParent){t.elements.oldParent=t.mapper.parent.parentNode;t.elements.oldParent.insertBefore(t.elements.placeholder,t.mapper.parent);WH.de(t.mapper.parent);WH.ae(t.elements.mapDiv,t.mapper.parent)}else{WH.de(t.elements.temporaryParent);WH.ae(t.elements.mapDiv,t.elements.temporaryParent)}if(!location.hash.includes("#show")){location.replace(a())}else if(window.mapShowObject){mapShowObject.onExpand()}}Lightbox.reveal();t.elements.container.style.visibility="visible"}function l(){t.desiredScale=1;t.scale=1;if(t.desiredScale>1){t.desiredScale=1}if(t.scale>1){t.scale=1}t.imageWidth=Math.round(t.scale*Mapper.sizes[MapViewer.getZoom()][0]);t.imageHeight=Math.round(t.scale*Mapper.sizes[MapViewer.getZoom()][1]);let e=Math.max(480,t.imageWidth);Lightbox.setSize(e+Lightbox.UI_WIDTH)}WH.onLoad(this.checkPound)};WH.markup=new function(){this.MODE={COMMENT:1,ARTICLE:2,QUICK_FACTS:3,SIGNATURE:4,REPLY:5};this.CLASS={ADMIN:40,STAFF:30,PREMIUM:20,USER:10,PENDING:1};this.modes={[this.MODE.COMMENT]:"comment",[this.MODE.REPLY]:"reply",[this.MODE.ARTICLE]:"article",[this.MODE.QUICK_FACTS]:"quickfacts",[this.MODE.SIGNATURE]:"signature"};this.globalAttributes={id:{req:false,valid:/^[a-z0-9_-]+$/i},title:{req:false,valid:/[\S ]+/},class:{req:false,valid:/\S+/}};this.regex={anyChars:/.+/,cssUnitOrInt:/\d+(%|px|em)?/,dataEnv:new RegExp("^("+Object.values(WH.dataEnvKey).join("|")+"|wotlk)$"),domain:/^((www|classic|tbc|bc|wrath|wotlk|ptr|ptr2|beta|mop|wod|legion|bfa|shadowlands|sl|d2|d4ptr|d4beta|cata|mists)$|((ko|fr|de|cn|es|ru|pt|it)($|\.(classic|tbc|bc|wrath|wotlk|ptr|ptr2|beta|mop|wod|legion|bfa|shadowlands|sl|d2|d4ptr|d4beta|cata|mists)$)))/,iconSizeOrFalse:/^(false|tiny|small|medium|large)$/,intCsv:/^[\d,]+$/,isInt:/^\d+$/,isItemList:/^(\d+(;\d+(:\d+)*)?)(,(\d+(;\d+(:\d+)*)?))*$/,isEntityList:/^(([a-z0-9-]+:)?\d+(;\d+(:\d+)*)?)(,(([a-z0-9-]+:)?\d+(;\d+(:\d+)*)?))*$/,kebabCase:/^[a-z\d-]+$/,noWhitespace:/^\S+$/};const e=["about-us-team-tables","guide-51","guide-53","guide-61","guide-block-nav","guide-brewfest","guide-children","guide-classes","guide-foundry","guide-hallows","guide-highmaul","guide-hub","guide-irontide","guide-love","guide-lunar","guide-mop","guide-moplaunch","guide-noblegarden","guide-orgrimmar","guide-pilgrim","guide-role","guide-summer","guide-theramore","guide-thunderking","guide-transmog","guide-winter","guide-wodlaunch"];let t="abc";const a=new Set;let i;let n;this.mode=this.MODE.ARTICLE;this.allow=this.CLASS.STAFF;this.root=undefined;this.dbPage=false;this.isPreview=false;this.inNewsType=0;this.mediaUid=t;this.tags={};this.disabledEnvironments={BETA:false,PTR:false,PTR2:false,D4PTR:false,D4BETA:false,CLASSICPTR:false};this.collectTags=new Set;this.tooltipTags={};this.tooltipTagsWithRawText={};this.applyCommonAttributes=function(e,t){if(WH.markup.allow<this.CLASS.STAFF){return}if(t.id){e.id=t.id}if(t.title){e.title=t.title}if(t["class"]){if(e.className){e.className+=" "+t["class"]}else{e.className=t["class"]}}if(t.style){var a=e.getAttribute("style");if(a){e.setAttribute("style",a+"; "+t.style)}else{e.setAttribute("style",t.style)}}if(t["data-highlight"]){e.setAttribute("data-highlight",t["data-highlight"])}};this.attachMarkupTooltip=function(e,t,a,i){let n=()=>{let e={className:WH.markup.tooltipTagsWithRawText[t]?undefined:"q",content:WH.markup.tooltipTags[t],content2:a&&WH.markup.tooltipTags[a]||undefined};if(!e.content){e.content='Markup tooltip named "'+t+'" not found.';e.className="q10"}return e};if(i){WH.aE(e,"mouseover",(()=>{let t=n();WH.Tooltips.show(e,t.content,t.className,{finalContent2:t.content2})}));WH.aE(e,"mouseout",WH.Tooltips.hide)}else{WH.aE(e,"mouseover",(e=>{let t=n();WH.Tooltips.showAtCursor(e,t.content,t.className,{finalContent2:t.content2})}));WH.aE(e,"mousemove",WH.Tooltips.cursorUpdate);WH.aE(e,"mouseout",WH.Tooltips.hide)}};this.assembleDomNode=function(e,t){if(e===null){return document.createDocumentFragment()}if(!(e instanceof Node)){WH.Track.nonInteractiveEvent({category:"Markup",action:"Legacy HTML",label:JSON.stringify(e)});if(g_user.roles&U_GROUP_ADMIN&&!this.convertToDomNodeWarned){this.convertToDomNodeWarned=true;alert("Some markup on this page returned something other than a node!")}let t=document.createDocumentFragment();t.appendChild(WH.ct(e));return t}if(t){let a;if(e instanceof Element&&e.dataset.markupContentTarget){a=e}else if(e.querySelector&&e.querySelector("[data-markup-content-target]")){a=e.querySelector("[data-markup-content-target]")}else{a=e;while(a.hasChildNodes()&&a.firstChild instanceof Element){a=a.firstChild}}a.appendChild(t)}return e};this.finalizeUrl=function(e,t,a){const i=WH.Url;if(!e){return""}if(e==="#"){return"javascript:"}e=e.replace(/&amp;/g,"&");if(/^([a-z.]+\.)?wowhead\.com/.test(e)){e="https://"+e}if(!i.isRelative(e)||e.startsWith("javascript:")||e.startsWith("#")){return e}if(e.startsWith("?")){e="/"+e.replace(/^\?+/,"")}else{e=i.ensurePathSlash(e)}if(!i.hasPathPrefixes(e)||t||typeof a==="number"){e=i.generate(e,{dataEnv:t,locale:a})}else{let t=i.parsePathPrefixes(e);e=i.generate(e,{dataEnv:t.dataEnv,locale:t.locale})}return e};this.generateTocId=e=>{e=e||"section";let t=e;let i=1;while(a.has(e)||WH.ge(e)){e=`${t}-${++i}`}a.add(e);return e};this.getDatabaseDomainInfo=function(e){var t=function(e){var t={};e=(e||"").split(".");if(e.length>2){WH.warn("Markup trying to parse long domain",e)}var a=e.length?e[e.length-1]:"";if(a){for(let e in WH.dataEnv){if(!WH.dataEnv.hasOwnProperty(e)||!WH.dataEnvKey.hasOwnProperty(WH.dataEnv[e])){continue}if(a===WH.dataEnvKey[WH.dataEnv[e]]){t.dataEnv=WH.dataEnv[e];break}if(a==="bc"){t.dataEnv=WH.dataEnv.TBC;break}if(a==="wotlk"){t.dataEnv=WH.dataEnv.WRATH;break}}}var i=e[0];if(i){if(WH.getLocaleFromDomain.L.hasOwnProperty(i)){t.locale=WH.getLocaleFromDomain.L[i]}else if(i==="www"){t.locale=LOCALE_ENUS}if(!t.hasOwnProperty("dataEnv")){t.dataEnv=WH.dataEnv.MAIN}}return t};var a=t(e.domain||e.site);var s=a.locale;if(s===undefined&&n!==undefined){s=n}if(s===null){s=Locale.getId()}var r=a.dataEnv||i||WH.getDataEnv();if(r===WH.dataEnv.PTR&&WH.markup.disabledEnvironments.PTR){r=WH.dataEnv.MAIN}if(r===WH.dataEnv.PTR2&&WH.markup.disabledEnvironments.PTR2){r=WH.dataEnv.MAIN}if(r===WH.dataEnv.BETA&&WH.markup.disabledEnvironments.BETA){r=WH.dataEnv.MAIN}if(r===WH.dataEnv.D4PTR&&WH.markup.disabledEnvironments.D4PTR){r=WH.dataEnv.D4}if(r===WH.dataEnv.D4BETA&&WH.markup.disabledEnvironments.D4BETA){r=WH.dataEnv.D4}if(r===WH.dataEnv.CLASSICPTR&&WH.markup.disabledEnvironments.CLASSICPTR){r=WH.dataEnv.CLASSIC}let o=Locale.getDataEnvForcedLocale(r);if(o!==undefined){s=o}return{host:WH.Url.generate("",{dataEnv:r,locale:s}).replace(/\/$/,""),nameKey:"name_"+Locale.getName(s),subdomain:"www",dataEnv:r,localeId:s}};this.getDataEnvFromSiteAttr=function(e){return WH.getDataEnvFromKey(e)||WH.Game.getDataEnvBySelector(e)};this.getEscapedHtml=function(e){e=e.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"–").replace(/&mdash;/g,"—");return WH.Strings.escapeHtml(e)};this.getDomFragment=function(t,a){if(!a){a={}}if(!a.allow){if(a.roles){a.allow=this.rolesToClass(a.roles)}else{a.allow=this.CLASS.STAFF}}try{var i=o(t,a);var n=i.toNode()}catch(e){var n=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error!"));WH.ae(n,WH.ce("br"));WH.ae(n,WH.ct(e));WH.error(e)}if(n.querySelector("."+e.join(",."))){e.filter((function(e){return!!n.querySelector("."+e)})).forEach((function(t){let a=WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"markup/"+t+".css";if(WH.PageMeta.scriptVersionQueryString){a+="?"+WH.PageMeta.scriptVersionQueryString}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:a}));let i=e.indexOf(t);if(i>=0){e.splice(i,1)}}))}if(a.prepend){$(n).prepend($.parseHTML(a.prepend))}if(a.append){$(n).append($.parseHTML(a.append))}s(n);return n};this.getMarkupFromHtml=function(e,t){let a=e.replace(/\n+/g,"");a=a.replace(/\s+/g," ");a=a.replace(/> </g,"><");a=a.replace(/&amp;/gi,"&");a=a.replace(/(&#160;|$nbsp;)/gi," ");Object.values(WH.markup.tags).filter((e=>e.fromHtml)).forEach((e=>a=e.fromHtml(a,t)));a=a.replace(/<style\b[\s\S]*?>[\s\S]*?<\/style>/g,"");a=a.replace(/<\/?[a-z][a-z0-9]*\b[\s\S]*?>/g," ");a=a.replace(/<!--(.*?)-->/g,"");a=a.replace(/\n[\n]+/g,"\n\n");a=a.replace(/[ ]+/g," ");a=a.replace(/\t/g,"  ");return WH.trim(a)};this.insertEntityTag=function(e,t,a){let i=prompt(WH.term("enterEntityId_format",t));if(i!=null){WH.insertTag(e,"["+a+"="+(parseInt(i)||0)+"]")}};this.isUrlExternal=function(e){if(!e){return false}var t=WH.ce("a");t.href=e;return!(!t.hostname||/(^|\.)wowhead\.com$/.test(t.hostname))};this.isUrlSafe=function(e,t){if(!e){return true}if(e==="javascript:"){return true}var a=e.match(/^([^:\\./]+):/i);if(a&&a[1]){var i=a[1];if(i==="http"||i==="https"){return true}if(t&&(i==="mailto"||i==="irc")){return true}return false}return true};this.matchOuterTags=function(e,t,a,i){var n=i.indexOf("g")>-1,s=i.replace(/g/g,""),r=new RegExp(t+"|"+a,"g"+s),o=new RegExp(t,s),l=[],c,u,d,f;do{c=0;while(d=r.exec(e)){if(o.test(d[0])){if(!c++){u=r.lastIndex;f=d}}else if(c){if(! --c){l.push([e.slice(u,d.index),f[0],d[0]]);if(!n){return l}}}}}while(c&&(r.lastIndex=u));return l.length?l:false};this.printHtml=function(e,t,a){let i=WH.ge(t);if(a&&a.removeTableTags){e=e.replace(/\[\/?(td|tr|table)[^\]]*]/g,"")}$(i).empty().append(WH.markup.getDomFragment(e,a))};this.rolesToClass=function(e){if(e&(U_GROUP_ADMIN|U_GROUP_VIP|U_GROUP_DEV)){return this.CLASS.ADMIN}else if(e&U_GROUP_STAFF){return this.CLASS.STAFF}else if(e&(U_GROUP_PREMIUM|U_GROUP_BLIZZARD)){return this.CLASS.PREMIUM}else if(e&U_GROUP_PENDING){return this.CLASS.PENDING}else{return this.CLASS.USER}};this.setDataEnv=function(e){switch(e){case WH.dataEnvKey[WH.dataEnv.PTR]:i=WH.markup.disabledEnvironments.PTR?WH.dataEnv.MAIN:WH.dataEnv.PTR;break;case WH.dataEnvKey[WH.dataEnv.PTR2]:i=WH.markup.disabledEnvironments.PTR2?WH.dataEnv.MAIN:WH.dataEnv.PTR2;break;case WH.dataEnvKey[WH.dataEnv.BETA]:i=WH.markup.disabledEnvironments.BETA?WH.dataEnv.MAIN:WH.dataEnv.BETA;break;case"bc":i=WH.dataEnv.TBC;break;case"wotlk":i=WH.dataEnv.WRATH;break;case WH.dataEnvKey[WH.dataEnv.D4PTR]:i=WH.markup.disabledEnvironments.D4PTR?WH.dataEnv.D4:WH.dataEnv.D4PTR;break;case WH.dataEnvKey[WH.dataEnv.D4BETA]:i=WH.markup.disabledEnvironments.D4BETA?WH.dataEnv.D4:WH.dataEnv.D4BETA;break;case WH.dataEnvKey[WH.dataEnv.CLASSICPTR]:i=WH.markup.disabledEnvironments.CLASSICPTR?WH.dataEnv.CLASSIC:WH.dataEnv.CLASSICPTR;break;default:i=WH.getDataEnvFromKey(e)??WH.dataEnv.MAIN}};this.stripTags=function(e,t){let a=o(e,t);return a.toHtml()};function s(e){Array.from(e.childNodes).forEach((e=>{switch(e.nodeType){case Node.ELEMENT_NODE:if(e.hasChildNodes()&&!["SCRIPT","STYLE"].includes(e.nodeName)){s(e)}break;case Node.TEXT_NODE:let t=e.nodeValue.split("/");if(t.length>1){let a=document.createDocumentFragment();for(let e=0;e<t.length;e++){let i=t[e];if(e<t.length-1){i+="/";let a=e+1;while(t[a]===""&&a+1!==t.length){i+="/";e++;a++}}WH.ae(a,WH.ct(i));if(e<t.length-1){WH.ae(a,WH.ce("wbr"))}}e.parentNode.replaceChild(a,e)}break}}))}function r(){$((function(){$("body").delegate("[data-highlight]","mouseenter",(function(){var e=$(this).attr("data-highlight").split(":");if(e.length!=2){return}var t=$("#"+e[0]).get(0),a=parseInt(e[1]),i=$(t).val();if(!t||!a||!i){return}var n=$(t).val(i.substr(0,a))[0].scrollHeight;$(t).val(i).animate({scrollTop:n},250);t.selectionStart=a;t.selectionEnd=a}))}))}function o(e,a){n=undefined;if(a&&a.hasOwnProperty("locale")){n=a.locale}var s=(e||"").replace(/\r/g,"");if(!a)a={};if(!a.skipReset){WH.markup.mediaUid=a.uid||t;WH.markup.root=a.root;WH.markup.isPreview=a.isPreview||false;WH.markup.dbPage=a.dbPage||false;i=WH.getDataEnv();if(Locale.getDataEnvForcedLocale(i)!==undefined){n=Locale.getDataEnvForcedLocale(i)}WH.markup.disabledEnvironments={BETA:(!WH.isBetaActive()||a.disabledEnvironments&&a.disabledEnvironments.beta)&&!WH.isBeta(),PTR:(!WH.isPtrActive()||a.disabledEnvironments&&a.disabledEnvironments.ptr)&&!WH.isPtr(),PTR2:(!WH.isPtr2Active()||a.disabledEnvironments&&a.disabledEnvironments.ptr2)&&!WH.isPtr2(),D4PTR:(!WH.isDataEnvActive(WH.dataEnv.D4PTR)||a.disabledEnvironments?.d4ptr)&&WH.getDataEnv()!==WH.dataEnv.D4PTR,D4BETA:(!WH.isDataEnvActive(WH.dataEnv.D4BETA)||a.disabledEnvironments?.d4beta)&&WH.getDataEnv()!==WH.dataEnv.D4BETA};if(WH.markup.mediaUid!=t){g_screenshots[WH.markup.mediaUid]=[]}}if(a.roles&&a.roles&(U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER)&&a.mode!=WH.markup.MODE.SIGNATURE){a.mode=WH.markup.MODE.ARTICLE}WH.markup.mode=a.mode||WH.markup.MODE.ARTICLE;WH.markup.allow=a.allow||WH.markup.CLASS.STAFF;WH.markup.inNewsType=a.inNewsType?a.inNewsType:0;if(a.stopAtBreak){var r=s.indexOf("[break]");if(r!=-1){s=s.substring(0,r)}}else{s=s.replace("[break]","")}var o=new WH.markup.Tree;s=s.trim();Object.keys(WH.markup.tags).filter((e=>WH.markup.tags[e].post&&s.includes(`[${e}`))).map((e=>WH.markup.tags[e])).forEach((e=>{if(!(e.allowedModes&&e.allowedModes[WH.markup.modes[a.mode]]==null)){(e.collect||[]).forEach((e=>WH.markup.collectTags.add(e)))}}));s=s.replace(/\n(\s*)\n/g,"\n\n");var l=s.length;var c=0,u=0,d=-1,f=-1,h=true,p=false;var m=function(e){var t,a,i;if(e.charAt(0)=='"'||e.charAt(0)=="'"){t=e.charAt(0);var n=e.indexOf(t,1);if(n>-1){i=e.substring(1,n);e=e.substring(n+1).trim();return{value:i,str:e}}}a=e.indexOf(" ");if(a>-1){i=e.substring(0,a);e=e.substring(a+1).trim()}else{i=e;e=""}return{value:i,str:e}};var H=/^\s*[a-z0-9-]+\s*=/;while(u<l){d=s.indexOf("[",u);if(d>-1){u=d+1;if(d>0&&s.charAt(d-1)=="\\"){h=false;d=-1}else{f=s.indexOf("]",u)}}else{u=l}var g,W={};if(a.highlight&&$(a.highlight)){W["data-highlight"]=a.highlight+":"+d}if(f>-1){var E=s.substring(d+1,f);if(E.charAt(0)=="/"){p=true;g=E.substr(1).trim().toLowerCase()}if(!p){var _=E.indexOf(" "),T=E.indexOf("=");var v;if((T<_||_==-1)&&T>-1){g=E.substring(0,T).toLowerCase();E=E.substring(T+1).trim();var S=m(E);E=S.str;if(WH.markup.tags[g]==undefined||WH.markup.tags[g].attr==undefined||WH.markup.tags[g].attr.unnamed==undefined){h=false}else{W.unnamed=S.value}}else if(_>-1){g=E.substring(0,_).toLowerCase();E=E.substring(_+1).trim();if(E.indexOf("=")==-1){if(WH.markup.tags[g]==undefined||WH.markup.tags[g].attr==undefined||WH.markup.tags[g].attr.unnamed==undefined){h=false}else{W.unnamed=E}E=""}}else{g=E.toLowerCase();E=""}if(WH.markup.tags[g]==undefined){h=false}else if(h){var b=WH.markup.tags[g];while(E!=""){var y="";if(!H.test(E)){let[e,...t]=E.split(" ");if(b?.attr?.[e]?.empty){W[e]="";E=t.join(" ");continue}else{y="unnamed"}}else{T=E.indexOf("=");if(T==-1){h=false;break}y=E.substring(0,T).trim().toLowerCase();E=E.substring(T+1).trim()}var S=m(E);E=S.str;if(b.attr==undefined||b.attr[y]==undefined){if(WH.markup.globalAttributes[y]==undefined||WH.markup.globalAttributes[y].valid!=undefined&&!WH.markup.globalAttributes[y].valid.test(S.value)){h=false;break}}W[y]=S.value}if(h&&b.attr){for(var I in b.attr){if(b.attr[I].req&&W[I]==undefined){h=false;break}else if(W[I]==undefined){continue}if(b.attr[I].valid!=undefined&&!b.attr[I].valid.test(W[I])){h=false;break}}if(h&&b.validate!=undefined){h=b.validate(W)}}}}else if(WH.markup.tags[g]==undefined){h=false}}else{h=false}if(h){if(c!=d){var A=s.substring(c,d).replace(/\\\[/g,"[");var R={_rawText:A};o.openTag("<text>",R)}if(p){h=o.closeTag(g)}else{h=o.openTag(g,W)}if(h){c=u=f+1}else{c=d}}h=true;p=false;d=f=-1}if(c<l){var A=s.substr(c).replace(/\\\[/g,"[");var R={_rawText:A};o.openTag("<text>",R)}return o}r()};WH.markup.entityTag=function(e,t){t=t||{};let a=t.tag||WH.Types.getStringId(e);WH.markup.tags[a]={entityType:e,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){return!((e.domain||e.site)&&WH.markup.dbPage)},toNode:WH.markup.entityTagToNode.bind(WH.markup,e),toText:WH.markup.entityTagToText.bind(WH.markup,e)};if(WH.Tooltips.isTypeSupported(e)){WH.markup.tags[a].attr.tooltip={req:false,empty:true}}if(t.icons){WH.markup.tags[a].attr.icon={req:false,valid:WH.markup.regex.iconSizeOrFalse}}return WH.markup.tags[a]};WH.markup.entityTagToNode=function(e,t,a,i){const n=WH.Gatherer;const s=WH.Icon;const r=WH.Types;const o=WH.Entity;const l=WH.Game;var c=t.unnamed;var u=WH.markup.getDatabaseDomainInfo(t);let d=u.dataEnv;{const t=r.getRequiredTrees(e)??[];if(t.length&&!t.includes(WH.getDataTree(d))){d=WH.Game.getEnv(WH.Game.getByTree(t[0]))}}let f=l.getByTree((r.getRequiredTrees(e)||[])[0]||d&&WH.getDataTree(d));if(typeof i==="undefined"){i=[]}let h=undefined;if(t.spec){i.push("spec="+t.spec)}if(i.length){h=i.join("&")}if(t.diff){i.push("diff="+t.diff)}if(t.diffnew){i.push("diffnew="+t.diffnew)}var p=WH.ce("a");if(i.length){p.rel=i.join("&")}var m=parseInt(c,10);var H=null;var g=g_gathered_types[e]||{};const W=n.get(e,m,u.dataEnv);let E=W?n.getPlainNameFromEntity(W,u.dataEnv,u.localeId):undefined;if(E){if(W.hasOwnProperty("fromDataEnv")){d=W.fromDataEnv;f=l.getByTree(WH.getDataTree(d))||f}if(W.hasOwnProperty("inventoryColor")){p.classList.add(l.getKey(l.DI)+"-ic"+W.inventoryColor)}else if(W.hasOwnProperty("dropRank")){p.classList.add(l.getKey(l.DI)+"-q"+W.dropRank)}else if(W.hasOwnProperty("quality")){var _=W.quality;if(t.quality){_=t.quality}let e=f===l.WOW?"":`${l.getKey(f)}-`;p.classList.add(`${e}q${_}`)}let a=E.indexOf(" / ");if(a!==-1){if(/\.1$/.test(c)){E=E.substring(0,a)}else if(/\.2$/.test(c)){E=E.substring(a+3)}}if(e===r.ITEM&&!W.icon){W.icon=s.UNKNOWN}if(e===r.RACE){W.icon=WH.Wow.Race.getIcon(m,WH.Wow.Gender.tryFrom(t.gender))}let h=undefined;let T=!t.icon||t.icon!=="false";let v=W.icon||W.iconImageHash||typeof g.getIcon==="function";if(T&&v){h=W.icon||W.iconImageHash;switch(e){case r.ITEM:h=g.getIcon(m,undefined,undefined,u.dataEnv)||h;break;case r.PLAYER_CLASS:case r.CURRENCY:h=g.getIcon(m)||h;break}}let S=e===r.ITEM&&W.qualityTier>0;let b=t=>{if(!W.displayName&&!S){p.classList.add("icontiny")}p.dataset.game=l.getKey(f);p.dataset.type=r.getStringId(e);WH.ae(p,WH.ce("img",{alt:E,src:typeof t==="string"&&t.includes("/")?t:s.getIconUrl(t,s.TINY,d),style:{verticalAlign:"middle"},loading:"lazy"}));if(f===l.DI&&W.gridType){p.dataset.gridType=W.gridType}};if(t.icon&&s.isValidSize(t.icon)){if(t.icon===s.TINY){b(h||s.getIconUrl(s.UNKNOWN,t.icon))}else{if(!h){return WH.ce("span",{className:"q10"},WH.ct(o.getPlaceholderName(e,c+WH.TERMS.wordspace_punct+WH.TERMS.icon)))}let a=o.createIcon(W,e,{dataEnv:d,id:c,game:f,size:t.icon,span:true,type:e});if(i.length){let e=a.nodeName==="A"?a:WH.qs("a",a);if(e){e.rel=i.join("&")}}return a}}else{if(h){b(h);WH.ae(p,WH.ct(" "))}let e=WH.ce("span",{className:"tinyicontxt"});let t=W?n.getHtmlNameFromEntity(W,u.dataEnv,u.localeId):undefined;if(t){e.innerHTML=t}else{WH.ae(e,WH.ct(E))}WH.ae(p,e)}if(S){WH.ae(p,WH.ct(WH.TERMS.wordspace_punct));WH.ae(p,WH.ce("img",{src:`${WH.STATIC_URL}/images/wow/TextureAtlas/${WH.getDataEnvKey()}/professions-chaticon-quality-tier${W["qualityTier"]}.png`,style:{maxHeight:"1.4em",verticalAlign:"bottom"}}))}H=E}else{WH.st(p,t.tempname||o.getPlaceholderName(e,c))}p.dataset.entity=WH.Types.getStringId(e);p.href=o.getUrl(e,c,H,h,d,u.localeId);WH.markup.applyCommonAttributes(p,t);if(t.tooltip!=null){p=WH.markup.replaceNodeWithTooltip(p,e,t,i)}return p};WH.markup.entityTagToText=function(e,t){const a=WH.Gatherer;var i=t.unnamed;var n=WH.markup.getDatabaseDomainInfo(t);const s=a.get(e,i,n.dataEnv);if(s){let e=a.getPlainNameFromEntity(s,n.dataEnv,n.localeId);if(e){return WH.markup.getEscapedHtml(e)}}return WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+i};WH.markup.replaceNodeWithTooltip=(e,t,a,i)=>{const n=WH.DOM;const s=WH.Entity;const r=WH.Game;let o=WH.ce("span",{dataset:{markupTooltipContainer:"true"}},e);let l=WH.markup.getDatabaseDomainInfo(a).dataEnv;let c=WH.Types.getRequiredTrees(t)??[];if(c.length&&!c.includes(WH.getDataTree(l))){l=WH.dataTreeToRoot[c[0]]}WH.Tooltips.replaceWithTooltip(o,t,a.unnamed,l,undefined,WH.Tooltips.relToParams(i),(e=>{let n=WH.ce("div",{innerHTML:e});let o=c.length?r.getByTree(c[0]):null;let l;switch(o){case r.D4:l=WH.qs(".whtt-name",n);break;case r.DI:l=WH.qs(".whtt-name",n);break;default:l=WH.qs("b",n)}if(l){let e=WH.ce("a",{href:s.getUrl(t,a.unnamed,undefined,i.join("&")),dataset:{disableWowheadTooltip:"true"}},[...l.childNodes]);WH.ae(l,e)}return n.innerHTML}));if(a.tooltip){let e;switch(a.tooltip){case"tiny":e=1-1/3;break;case"small":e=1-1/6;break;case"medium":break;case"large":e=1+1/3;break;case"true":break;default:WH.warn("Invalid tooltip size requested.",a.tooltip,WH.Types.getUpperSingular(t),a.unnamed)}if(e){WH.onMutate(o,(()=>{let t=o.firstChild;if(t?.classList?.contains("wowhead-tooltip")&&n.getData(t,"tooltipScaled")!==true){n.setData(t,"tooltipScaled",true);n.scaleElementInParent(t,e)}}))}}o.dataset.contiguous="true";return o};WH.markup.Tree=function(){const e=WH.Strings;const t={collection:{},currentNode:null,excludeTags:{},guid:e.guid(),nextCollectionIndex:0,nodes:[],postNodes:[]};this.closeTag=function(e){if(WH.markup.tags[e].empty||WH.markup.tags[e].post){return false}if(!t.currentNode){return false}if(t.currentNode.name===e){if(t.currentNode.nodes.length>0){let e=t.currentNode.nodes.length-1;if(WH.markup.tags[t.currentNode.name].itrim&&t.currentNode.nodes[e].name==="<text>"){let a=t.currentNode.nodes[e];a.attr=WH.markup.utility.rtrimText(a.attr);t.currentNode.nodes[e]=a}}t.currentNode=t.currentNode.parent;return true}if(WH.markup.tags[t.currentNode.name].allowedChildren&&WH.markup.tags[t.currentNode.name].allowedChildren[e]===undefined){return false}{let a=t.currentNode;while(a){if((WH.markup.tags[a.name].blockedDescendants||[]).includes(e)){return false}a=a.parent}}let a=function(t){for(let a=t.length-1;a>=0;a--){if(t[a].name===e){return a}}return-1};let i=t.currentNode.parent?a(t.currentNode.parent.nodes):a(t.nodes);if(i===-1){return false}return true};this.openTag=function(e,a){let i=WH.markup.tags[e];if(e!=="<text>"&&i&&!i.allowedClass){i.allowedClass=WH.markup.CLASS.PENDING}if(!i){return false}else if(i.allowedModes&&i.allowedModes[WH.markup.modes[WH.markup.mode]]===undefined){return false}else if(i.allowedClass&&i.allowedClass>WH.markup.allow){return false}if(WH.markup.mode===WH.markup.MODE.REPLY&&!i.allowInReplies){return false}let n={attr:a,name:e,nodes:[],parent:null};Object.keys(n.attr).forEach((function(e){if(typeof n.attr[e]==="string"){n.attr[e]=n.attr[e].replace(/^http:\/\/([^\/:@]+\.)?(zamimg|wowhead)\.com\//,"https://$1$2.com/")}}));if(t.currentNode){n.parent=t.currentNode}if(i.allowedParents){if(n.parent!=null){if(i.allowedParents[n.parent.name]===undefined){return false}}else if(WH.markup.root===undefined||i.allowedParents[WH.markup.root]===undefined){return false}}if(n.parent&&WH.markup.tags[n.parent.name].allowedChildren&&WH.markup.tags[n.parent.name].allowedChildren[e]===undefined){return false}{let t=n.parent;while(t){if((WH.markup.tags[t.name].blockedDescendants||[]).includes(e)){return false}t=t.parent}}if(t.currentNode){if(t.currentNode.nodes.length===0&&n.name==="<text>"&&WH.markup.tags[t.currentNode.name].itrim){n.attr=WH.markup.utility.ltrimText(n.attr)}else if(t.currentNode.nodes.length>0){let e=t.currentNode.nodes.length-1;let a=WH.markup.utility.checkSiblingTrim(t.currentNode.nodes[e],n);t.currentNode.nodes[e]=a[0];n=a[1]}if(n.name==="<text>"){if(n.attr._rawText.length>0){t.currentNode.nodes.push(n)}}else{t.currentNode.nodes.push(n)}}else{if(t.nodes.length>0){let e=t.nodes.length-1;let a=WH.markup.utility.checkSiblingTrim(t.nodes[e],n);t.nodes[e]=a[0];n=a[1]}if(n.name==="<text>"){if(n.attr._rawText.length>0){t.nodes.push(n)}}else{t.nodes.push(n)}}if(!i.empty&&!i.post){t.currentNode=n}return true};this.toHtml=function(){let e=WH.ce("div");WH.ae(e,i(t.nodes));return e.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')};this.toNode=function(){t.postNodes=[];WH.markup.collectTags.forEach((e=>t.collection[e]=[]));i(t.nodes,true);t.excludeTags={};Object.keys(WH.markup.tags).filter((e=>WH.markup.tags[e].exclude)).forEach((e=>{const a=WH.markup.tags[e];Object.keys(a.exclude).forEach((i=>{t.excludeTags[i]??={};t.excludeTags[i][e]??=new Set;a.exclude[i].forEach((a=>t.excludeTags[i][e].add(a)))}))}));let e=a(t.nodes,0,{});for(let a=0;a<t.postNodes.length;a++){let i=e.querySelector("#postNode-replace-"+a);let n=t.postNodes[a];let s=WH.markup.tags[n.name].postParseNode(n.attr,t.collection);s=WH.markup.assembleDomNode(s);i.parentNode.replaceChild(s,i)}let n=Object.entries(WH.markup.disabledEnvironments).filter((([e,t])=>t)).map((([e,t])=>({subdomains:{PTR:/(^|\.)ptr\./,PTR2:/(^|\.)ptr-2\./,BETA:/(^|\.)(?:beta|shadowlands|sl|bfa|legion|wod|mop)\./,D4PTR:/(^|\.)diablo-4-ptr\./,D4BETA:/(^|\.)diablo-4-beta\./}[e],pathPrefixes:{PTR:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)ptr\//,PTR2:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)ptr-2\//,BETA:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)beta\//,D4PTR:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)diablo-4-ptr\//,D4BETA:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)diablo-4-beta\//}[e]})));let s=e.querySelectorAll("a[href]");for(let e=0;e<s.length;e++){let t=s[e];let a=t.href.match(/^http(s)?:\/\/([^\/:@]+\.)?wowhead\.com[\/:]/);if(!a){continue}if(!a[1]){t.href=t.href.replace(/^http:/,"https:")}n.forEach((e=>{let i=a[2]||"";if(e.subdomains?.test(i)){t.href=t.href.replace(i,i.replace(e.subdomains,"$1")||"www.")}t.href=t.href.replace(e.pathPrefixes??/^$/,"$1")}))}return e};function a(e,i,n){let s=document.createDocumentFragment();let r;if(i===0){t.nextCollectionIndex=0}for(let o=0;o<e.length;o++){let l=e[o];if(WH.markup.tags[l.name].block&&i===0&&o===0||l.parent&&WH.markup.tags[l.parent.name].block&&i>0&&o===0){l.attr.first=true}if(WH.markup.tags[l.name].block&&o===e.length-1){l.attr.last=true}if(t.excludeTags[l.name]){n[l.name]=(n[l.name]||0)+1}for(let e in n){for(let a in t.excludeTags[e]){if(t.excludeTags[e][a].has(l.name)){l.attr[a]="false"}}}if(WH.markup.collectTags.has(l.name)){l.collectionIndex=t.nextCollectionIndex++;t.collection[l.name].push(l)}if(WH.markup.tags[l.name].post){let e=document.createElement("div");e.id="postNode-replace-"+t.postNodes.length;s.appendChild(e);t.postNodes.push(l)}else if(WH.markup.tags[l.name].empty){if(l.parent&&WH.markup.tags[l.parent.name].rawText){try{r=WH.markup.tags[l.name].toNode(l.attr,{needsRaw:true,treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}}else{try{r=WH.markup.tags[l.name].toNode(l.attr,{noLink:l.parent&&l.parent.name==="url",treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}}s.appendChild(WH.markup.assembleDomNode(r))}else{let e=a(l.nodes,i+1,n);l.attr._contents=e;l.attr._nodes=l.nodes;try{r=WH.markup.tags[l.name].toNode(l.attr,{treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}s.appendChild(WH.markup.assembleDomNode(r,e))}if(n[l.name]){n[l.name]--;if(n[l.name]===0){delete n[l.name]}}}return s}function i(e,a){let n=document.createDocumentFragment();for(let s=0;s<e.length;s++){let r=e[s];let o=i(r.nodes,a);if(a){r.attr._textContents=o.textContent}else{r.attr._contents=o}if(r.name==="<text>"){n.appendChild(WH.markup.assembleDomNode(WH.markup.tags[r.name].toNode(r.attr,{noLink:true,noNbsp:true,treeGuid:t.guid})))}else if(WH.markup.tags[r.name].toText){n.appendChild(document.createTextNode(WH.markup.tags[r.name].toText(r.attr)))}if(!WH.markup.tags[r.name].invisibleContent){n.appendChild(o)}}return n}};WH.markup.utility=new function(){this.ltrimText=function(e){e._rawText=e._rawText.trimStart();return e};this.rtrimText=function(e){e._rawText=e._rawText.trimEnd();return e};this.checkSiblingTrim=function(e,t){if(t.name=="<text>"&&(WH.markup.tags[e.name].rtrim||WH.markup.tags[e.name].trim)){t.attr=WH.markup.utility.ltrimText(t.attr)}else if(e.name=="<text>"&&(WH.markup.tags[t.name].ltrim||WH.markup.tags[t.name].trim)){e.attr=WH.markup.utility.rtrimText(e.attr)}return[e,t]}};WH.MD5=new function(){function e(e,t){var r=e[0],o=e[1],l=e[2],c=e[3];r=a(r,o,l,c,t[0],7,-680876936);c=a(c,r,o,l,t[1],12,-389564586);l=a(l,c,r,o,t[2],17,606105819);o=a(o,l,c,r,t[3],22,-1044525330);r=a(r,o,l,c,t[4],7,-176418897);c=a(c,r,o,l,t[5],12,1200080426);l=a(l,c,r,o,t[6],17,-1473231341);o=a(o,l,c,r,t[7],22,-45705983);r=a(r,o,l,c,t[8],7,1770035416);c=a(c,r,o,l,t[9],12,-1958414417);l=a(l,c,r,o,t[10],17,-42063);o=a(o,l,c,r,t[11],22,-1990404162);r=a(r,o,l,c,t[12],7,1804603682);c=a(c,r,o,l,t[13],12,-40341101);l=a(l,c,r,o,t[14],17,-1502002290);o=a(o,l,c,r,t[15],22,1236535329);r=i(r,o,l,c,t[1],5,-165796510);c=i(c,r,o,l,t[6],9,-1069501632);l=i(l,c,r,o,t[11],14,643717713);o=i(o,l,c,r,t[0],20,-373897302);r=i(r,o,l,c,t[5],5,-701558691);c=i(c,r,o,l,t[10],9,38016083);l=i(l,c,r,o,t[15],14,-660478335);o=i(o,l,c,r,t[4],20,-405537848);r=i(r,o,l,c,t[9],5,568446438);c=i(c,r,o,l,t[14],9,-1019803690);l=i(l,c,r,o,t[3],14,-187363961);o=i(o,l,c,r,t[8],20,1163531501);r=i(r,o,l,c,t[13],5,-1444681467);c=i(c,r,o,l,t[2],9,-51403784);l=i(l,c,r,o,t[7],14,1735328473);o=i(o,l,c,r,t[12],20,-1926607734);r=n(r,o,l,c,t[5],4,-378558);c=n(c,r,o,l,t[8],11,-2022574463);l=n(l,c,r,o,t[11],16,1839030562);o=n(o,l,c,r,t[14],23,-35309556);r=n(r,o,l,c,t[1],4,-1530992060);c=n(c,r,o,l,t[4],11,1272893353);l=n(l,c,r,o,t[7],16,-155497632);o=n(o,l,c,r,t[10],23,-1094730640);r=n(r,o,l,c,t[13],4,681279174);c=n(c,r,o,l,t[0],11,-358537222);l=n(l,c,r,o,t[3],16,-722521979);o=n(o,l,c,r,t[6],23,76029189);r=n(r,o,l,c,t[9],4,-640364487);c=n(c,r,o,l,t[12],11,-421815835);l=n(l,c,r,o,t[15],16,530742520);o=n(o,l,c,r,t[2],23,-995338651);r=s(r,o,l,c,t[0],6,-198630844);c=s(c,r,o,l,t[7],10,1126891415);l=s(l,c,r,o,t[14],15,-1416354905);o=s(o,l,c,r,t[5],21,-57434055);r=s(r,o,l,c,t[12],6,1700485571);c=s(c,r,o,l,t[3],10,-1894986606);l=s(l,c,r,o,t[10],15,-1051523);o=s(o,l,c,r,t[1],21,-2054922799);r=s(r,o,l,c,t[8],6,1873313359);c=s(c,r,o,l,t[15],10,-30611744);l=s(l,c,r,o,t[6],15,-1560198380);o=s(o,l,c,r,t[13],21,1309151649);r=s(r,o,l,c,t[4],6,-145523070);c=s(c,r,o,l,t[11],10,-1120210379);l=s(l,c,r,o,t[2],15,718787259);o=s(o,l,c,r,t[9],21,-343485551);e[0]=f(r,e[0]);e[1]=f(o,e[1]);e[2]=f(l,e[2]);e[3]=f(c,e[3])}function t(e,t,a,i,n,s){t=f(f(t,e),f(i,s));return f(t<<n|t>>>32-n,a)}function a(e,a,i,n,s,r,o){return t(a&i|~a&n,e,a,s,r,o)}function i(e,a,i,n,s,r,o){return t(a&n|i&~n,e,a,s,r,o)}function n(e,a,i,n,s,r,o){return t(a^i^n,e,a,s,r,o)}function s(e,a,i,n,s,r,o){return t(i^(a|~n),e,a,s,r,o)}function r(t){var a=t.length,i=[1732584193,-271733879,-1732584194,271733878],n;for(n=64;n<=t.length;n+=64){e(i,o(t.substring(n-64,n)))}t=t.substring(n-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)s[n>>2]|=t.charCodeAt(n)<<(n%4<<3);s[n>>2]|=128<<(n%4<<3);if(n>55){e(i,s);for(n=0;n<16;n++)s[n]=0}s[14]=a*8;e(i,s);return i}function o(e){var t=[],a;for(a=0;a<64;a+=4){t[a>>2]=e.charCodeAt(a)+(e.charCodeAt(a+1)<<8)+(e.charCodeAt(a+2)<<16)+(e.charCodeAt(a+3)<<24)}return t}var l="0123456789abcdef".split("");function c(e){var t="",a=0;for(;a<4;a++)t+=l[e>>a*8+4&15]+l[e>>a*8&15];return t}function u(e){for(var t=0;t<e.length;t++)e[t]=c(e[t]);return e.join("")}function d(e){return u(r(e))}function f(e,t){return e+t&4294967295}if(d("hello")!="5d41402abc4b2a76b9719d911017c592"){function f(e,t){var a=(e&65535)+(t&65535),i=(e>>16)+(t>>16)+(a>>16);return i<<16|a&65535}}this.hash=function(e){return d(e)}};var Menu=new function(){const e=this;const t=WH.Device;const a=WH.DOM;this.CRUMB_DATABASE="0";this.CRUMB_TOOLS="1";const i="menu-item-heading";const n="menu-item-spacer";const s="unlinked";var r=100;var o=333;const l=0;const c=1;const u=2;const d=3;const f=4;this.ITEM_CRUMB=l;this.ITEM_LABEL=c;this.ITEM_URL=u;this.ITEM_SUBMENU=d;this.ITEM_OPTIONS=f;var h=520;var p=4;var m=2;var H=26;var g=6;var W=6;var E=["icons"];var _=[{menu:"classHalls",paths:[[30]]},{menu:"forums",paths:[["classes"]]},{menu:"items",paths:[[4,1],[4,2],[4,3],[4,4],[1],[0],[16],[7],[6],[9],[-2,0,"*"],[-2,1,"*"],[-2,2],[-2,16],[-2,4],[-2,5],[-2,6],[-2,7],[-3]]},{menu:"spells",paths:[[7],[-17],[-18],[-13],[-16],[-12],[-2],[50],[52],[54],[-3],[-3,"*"],[-7],[11],[9]]},{menu:"zones",paths:[[9],["classHalls"]]}];const T={asyncDataCallbacks:[],asyncDataLoaded:false,currentMenu:null,divCache:{},menuItemsCache:{},menuOpener:null,nextUniqueId:0,openLinks:{},showingHeaderMenu:false,timer:{hideMenu:null,showMenu:null},visibleMenus:[]};this.add=function(t,i,n,s){n=n||{};if(typeof t==="string"){t=WH.qs(t)}else if(t instanceof jQuery){if(!t.length){WH.error("Tried to add a menu to an empty jQuery object.");return}t=t.get(0)}if(!t){WH.error("Tried to add a menu to an invalid target.");return}if(e.hasMenu(t)){WH.error("A menu has already been attached to this element.",[t.textContent,t.id,t.className].filter(Boolean).join(", "));return}if(n.onShow){i.onShow=n.onShow}if(n.onHide){i.onHide=n.onHide}if(n.openingMenuItem){i.openingMenuItem=n.openingMenuItem}if(n.padded){i.padded=n.padded}if(n.trackingLabel){i.trackingLabel=n.trackingLabel}a.setData(t,"menu",i);v(t,n);if(n.showImmediately){if(n.showAtCursor){ee.call(this,s)}else{ie.call(this,s)}}};this.addButtons=function(a,i,n){var s=$(a);if(!s.length){return}var r=$('<span class="menu-buttons"></span>');$.each(i,(function(a,s){if(V(s)){return}if(!z(s)){return}var o=$("<a></a>");var l=$("<span></span>",{text:e.getLabel(s,true)}).appendTo(o);e.linkifyItem(s,o,false,i.trackingLabel);o.data("parentMenu",i).data("menuItem",s);if(s[f]&&s[f].rel){o.attr("rel",s[f].rel)}var c=e.getSubmenu(s);if(c){l.addClass("hassubmenu");if(t.isTouch()){Ee.add(o.get(0),c)}else{e.add(o,c,{padded:n&&n.padded,showAtElement:n&&n.menusOnClick})}}r.append(o)}));s.append(r)};this.addToSubmenu=function(t,a){var i=e.getSubmenu(t);if(i){i.push(a)}else{t[d]=[a]}};this.createItem=function(t){let a=[];["crumb","label","url","submenu","options"].forEach((function(i){if(t.hasOwnProperty(i)){a[e["ITEM_"+i.toUpperCase()]]=t[i]}}));if(a[l]==null){a[l]=""}return a};this.createHeading=function(t){let a=[];["crumb","label","url","submenu","options"].forEach((function(i){if(t.hasOwnProperty(i)){a[e["ITEM_"+i.toUpperCase()]]=t[i]}}));if(!a[f]){a[f]={}}a[f].heading=true;return a};this.createSpacer=function(){return[null,null,null,null,{spacer:true}]};this.findItem=function(t,a){return e.getFullPath(t,a).pop()};this.finishMenuInit=()=>{if(T.asyncDataLoaded){return}T.asyncDataLoaded=true;let e;while(e=T.asyncDataCallbacks.shift()){e()}};this.getFeaturedNavigationMenu=function(){let t=WH.getPageData("menu.featuredNav.name");let a=t&&e.getMenu(t)||e.getMenu("featuredNav_"+WH.getDataTreeKey())||[];let i;if(WH.isRetailTree()&&(i=e.findItem(a,["classes"]))){let e=[];while(e.length<2){let t=Math.floor(Math.random()*12)+1;if(e.indexOf(t)===-1){e.push(t)}}Menu.setItemOption(i,"className","header-nav-classes first-"+e[0]+" second-"+e[1])}return a};this.getFullPath=function(t,a){var i=[];let n=(a,i)=>{if(!t){return null}let s=L(t,a);if(s!==-1){var r=[];let a=t[s];if(a[f]&&a[f].breadcrumbParent){let e=n(a[f].breadcrumbParent,true);if(e){r.push(e.pop())}}a.parentMenu=t;if(!i){t=e.getSubmenu(a)}r.push(a);return r}return null};for(var s=0;s<a.length;++s){if(!["string","number"].includes(typeof a[s])){WH.error("Breadcrumb path includes an invalid crumb.",a[s],s,a);break}let e=n(a[s]);if(e){i=i.concat(e)}else{break}}return i};this.getItemCrumb=function(e){return e[l]};this.getItemOptions=function(e){if(!e[f]){e[f]={}}return e[f]};this.getItemUrl=function(e){var t=e[u];if(!t){return null}if(e.modifyUrl){t=WH.modifyUrl(t,e.modifyUrl.params,e.modifyUrl.opt,e)}return t};this.getLabel=function(e,t){let a=e[c];if(e[f]){let i=e[f];if(i.generateText){a=i.generateText(e)}if(t===true){if(i.breadcrumb){a=i.breadcrumb}}else{if(typeof i.prefix==="string"){a=i.prefix+a}else if(typeof i.prefix==="object"){let e=i.prefix[0];for(let t in i.prefix.replacements){if(i.prefix.replacements.hasOwnProperty(t)){e=e.replace(t,i.prefix.replacements[t])}}a=e+a}}if(i.replacements){for(let e in i.replacements){if(i.replacements.hasOwnProperty(e)){a=a.replace(e,i.replacements[e])}}}}return a};this.getLabelNote=function(e){return e[f]&&e[f].note};this.getMenu=function(e,t){if(e===undefined){e="path"}const a=WH.getPageData(`menu.def.${e}`);if(!a&&!T.asyncDataLoaded&&!t){WH.error(`Attempted to load menu ${e} before async data finished loading.`)}return a};this.getOpener=function(){return K()?T.menuOpener:null};this.getSubmenu=function(t){var a=t[d];if(typeof a==="string"){a=e.getMenu(a)}return a&&a.length?a:null};this.hasMenu=e=>!!a.getData(e,"menu");this.hasSubmenuContent=function(t){return q(e.getSubmenu(t))};this.hide=function(e){ue(false);if(t.isTouch()){Ee.closeAllMenus();return}ae(null,e);j()};this.isHeading=function(e){return V(e)};this.isFinishedLoading=()=>T.asyncDataLoaded;this.linkifyItem=(t,a,i,n)=>{let r=a[0];let o=e.getItemOptions(t);if(o.className){a.addClass(o.className)}if(o.tooltipContent){WH.Tooltips.attach(r,o.tooltipContent)}else{if(o.onMouseOver){a.mouseover(o.onMouseOver)}if(o.onMouseOut){a.mouseout(o.onMouseOut)}}if(!t[u]){a.attr("href","javascript:");a.addClass(s);a.attr("role","button");if(o.tooltip){a.attr("href",o.tooltip);a.click(WH.rf)}return false}if(typeof t[u]=="function"){a.attr("href","javascript:");a.click(Y);if(o.tooltip){a.attr("href",o.tooltip);a.click(((e,a,n)=>{if(a){Menu.logLinkClick(t,i,a)}e(n);return false}).bind(null,t[u],n))}else{a.click(((e,a,n)=>{if(a){Menu.logLinkClick(t,i,a)}e(n)}).bind(null,t[u],n))}if(o.rel){a.attr("rel",o.rel)}}else{var l=e.getItemUrl(t);a.attr("href",l);if(n){WH.aE(r,"click",(()=>Menu.logLinkClick(t,i,n)))}if(o.newWindow||WH.isExternalUrl(l)){a.attr("target","_blank")}if(o.rel){a.attr("rel",o.rel)}else if(typeof l==="string"&&(l.indexOf("/guides/")===0||l.indexOf("/guide=")===0||l.indexOf("/guide/")===0)){a.attr("rel","np")}}return true};this.logLinkClick=(t,a,i)=>{let n=e=>`${e} menu item clicked`;let s=a?x():null;if(s){s.path.push(k(t));WH.Track.linkClick({href:e.getItemUrl(t)},{category:n(s.label),label:s.path.join(" → ")})}else if(i){WH.Track.linkClick({href:e.getItemUrl(t)},{category:n(i),label:k(t)})}};this.map=function(t,a,i){a.className+=" menu-map";for(var n=0,s;s=t[n];n++){if(s[f]&&s[f].menuMapHide){continue}let t=e.getLabel(s);WH.ae(a,WH.getMajorHeading(typeof s[u]=="string"?'<a href="'+e.getItemUrl(s)+'">'+t+"</a>":t,2));var r=e.getSubmenu(s);if(r instanceof Array){var o=WH.ce("div",{className:"menu-map-section"});let t=null;var l=WH.ce("div",{className:"menu-map-submenu-group"});for(var c=0,d=r.length;c<d;c++){var h=r[c];if(h[f]&&h[f].menuMapHide){continue}if(V(h)){WH.ae(o,l);l=WH.ce("div",{className:"menu-map-submenu-group"});t=e.getLabel(h);WH.ae(o,WH.getMajorHeading(typeof h[u]=="string"?'<a href="'+e.getItemUrl(h)+'">'+t+"</a>":t,3));continue}var p=e.getSubmenu(h);if(i&&i.noEmptySubmenus&&!p){continue}let a=e.getLabel(h);var m=WH.getMajorHeading(typeof h[u]=="string"?'<a href="'+e.getItemUrl(h)+'">'+a+"</a>":a,4);var H=WH.ce("div",{className:"menu-map-submenu"},m);if(a===t){H.setAttribute("data-duplicate-heading","true")}if(p){e.addButtons(H,p,{menusOnClick:true})}WH.ae(l,H)}WH.ae(o,l);WH.ae(a,o)}}};this.modifyUrl=function(e,t,a){var i={params:t,opt:a};We(e,(function(e){e.modifyUrl=i}));WH.Layout.updateBreadcrumb()};this.onLoad=(e,...t)=>{if(T.asyncDataLoaded){e(...t)}else{T.asyncDataCallbacks.push((()=>e(...t)))}};this.prepareForZul=function(e,t){return se(e,t)};this.processExtraInstructions=()=>{if(!T.asyncDataLoaded){e.onLoad(e.processExtraInstructions);return}["extraMenus.page","extraMenus.account"].forEach((e=>{(WH.getPageData(e)||[]).forEach((e=>{let t=Menu.getMenu(e.target);if(!t){return}if(e.action==="copyMenuItems"){(Menu.getMenu(e.source)||[]).forEach((e=>t.push(e)))}else if(e.action==="generateAppend"){let a=e.source.split(".");if(a[0]!=="WH"){WH.error(`Illegal function reference "${e.source}"`)}else{let e=window;while(a.length&&e){e=e[a.shift()]}if(typeof e==="function"){(e()||[]).forEach((e=>t.push(e)))}}}}))}))};this.render=function(e,t){return le(e,0,true,t)};this.replace=(t,i,n)=>{n=n||{};if(!e.hasMenu(t)){WH.error("This element does not have a menu to replace.",[t.textContent,t.id,t.className].filter(Boolean).join(", "));return}if(n.onShow){i.onShow=n.onShow}if(n.onHide){i.onHide=n.onHide}if(n.openingMenuItem){i.openingMenuItem=n.openingMenuItem}if(n.padded){i.padded=n.padded}if(n.trackingLabel){i.trackingLabel=n.trackingLabel}a.setData(t,"menu",i)};this.setItemUrl=function(e,t){e[u]=t};this.setItemOption=function(e,t,a){if(!e[f]){e[f]={}}e[f][t]=a};this.setSubmenu=function(e,t){e[d]=t};this.show=function(e,a){if(t.isTouch()){Ee.onRootNodeClick.call(a,null,e)}else{ue(WH.closest(a,".header")!==undefined);de(e,a)}};this.showAtCursor=function(e,a){if(t.isTouch()){Ee.onNodelessClick(e,a);return}T.currentMenu=e;fe(e,a.target,a.pageX,a.pageY)};this.sort=function(e,t){if(WH.inArray(e,true,V)!==-1){pe(e,t)}else{he(e,t)}};this.sortGlobalMenus=function(){if(Locale.getId()===LOCALE_ENUS){return}E.forEach((t=>e.sort(e.getMenu(t)||[])));for(var t=0,a=_.length;t<a;t++){me(_[t].menu,_[t].paths)}};this.updateItem=function(t){var a=t.$a;if(!a){return}var i=e.getItemOptions(t);a.removeClass("checked tinyicon icon");a.css("background-image","");if(t.checked){a.addClass("checked fonticon");a.prepend('<i class="fa fa-check fa-size-s fa-color-white fonticon-icon"/>')}else{var n=false;var s=function(e){switch(typeof e){case"string":return e;break;case"function":var a=e(t);if(typeof a=="string"){return a}break}return false};if(!n&&i.armory){var r=s(i.armory);if(r){n=true;a.addClass("armoryicon");a.css("background-image","url("+r+")")}}if(!n&&i.fontIcon){var o=s(i.fontIcon);if(o){n=true;a.addClass("fonticon");const e=WH.ce("i",{className:"fonticon-icon"});if(["bluesky","discord","facebook","reddit-alien","twitter"].includes(o)){WH.React.initComponent(e,"modules/FontIcon",{faIcon:{prefix:"fab",name:o}})}else{e.classList.add("fa",`fa-${o}`)}a.prepend(e)}}if(!n&&i.tinyIcon){var l=s(i.tinyIcon);if(l){n=true;a.addClass("tinyicon");a.css("background-image","url("+WH.getTinyIconUrl(l)+")")}}if(!n&&i.icon){var c=s(i.icon);if(c){n=true;a.addClass("icon");a.css("background-image","url("+c+")")}}if(!n&&i.socketColor){var u=s(i.socketColor);if(u&&g_file_gems[u]){n=true;a.addClass("socket-"+g_file_gems[u])}}}if(i.np){a.attr("rel","np")}var d=i["class"]||i.className;if(d){a.addClass(d)}if(i.attributes){for(var f in i.attributes){if(i.attributes.hasOwnProperty(f)){a.attr(f,i.attributes[f])}}}};function v(e,a){if(a.noEvents){return}if(t.isTouch()){WH.aE(e,"click",Ee.onRootNodeClick);return}if(a.showAtCursor){if(a.leftAndRightClick){e.oncontextmenu=WH.rf;WH.aE(e,"click",(function(e){if(e.which===2){return}ee.call(this,e);e.preventDefault()}));WH.aE(e,"mouseup",te.bind(this,ee))}else if(a.rightClick){e.oncontextmenu=WH.rf;WH.aE(e,"mouseup",te.bind(this,ee))}else{WH.aE(e,"click",ee)}}else if(a.showAtElement){if(a.leftAndRightClick){e.oncontextmenu=WH.rf;WH.aE(e,"click",(function(e){if(e.which===2){return}ie.call(this,e);e.preventDefault()}));WH.aE(e,"mouseup",te.bind(this,ie));WH.aE(e,"mouseleave",ae)}else if(a.rightClick){e.oncontextmenu=WH.rf;WH.aE(e,"mouseup",te.bind(this,ie));WH.aE(e,"mouseleave",ae)}else{WH.aE(e,"click",(function(e){if(e.button===1){return}if(this.classList.contains("open")){Y();return}ie.call(this,e);e.preventDefault()}));WH.aE(e,"mouseleave",ae)}}else{WH.aE(e,"mouseenter",ie);WH.aE(e,"mouseleave",ae)}}function S(){WH.aE(window,"keyup",(e=>{if(e.key==="Escape"){Y()}}));WH.aE(document,"bodyAvailable",(()=>{let t=le([e.createItem({label:"ohai",url:"/asdf"})],0,true)[0];t.style.left="-1000px";t.style.top="-1000px";WH.ae(document.body,t);let a=WH.qs(".menu-item",t).offsetHeight;WH.de(t);if(a&&!isNaN(a)&&a!==H){H=a}}));if(WH.getPageData("menu.asyncFinished")){e.finishMenuInit()}}function b(t){var a=e.getItemOptions(t);if(typeof a.regenerateMenuItem==="function"){WH.cO(t,a.regenerateMenuItem(t))}if(a.checkedUrl&&location.href.match(a.checkedUrl)){t.checked=true}if(typeof a.checkedFunc=="function"){t.checked=a.checkedFunc(t)}}function y(t){if(t.onBeforeShow){t.onBeforeShow(t)}for(var a=0,i=t.length;a<i;a++){if(!(t[a]instanceof Array)){return}var n=e.getItemOptions(t[a]);if(n.onBeforeShow){n.onBeforeShow(t[a])}}}function I(e){while(T.openLinks[e]){T.openLinks[e].classList.remove("open");T.openLinks[e]=null;e++}}function A(e,t,a,i){var n;if(!isNaN(t)&&T.divCache[t]){n=T.divCache[t];n.children().detach();n.css({left:0,top:0});ce(n[0],e);if(a.padded&&WH.isRetailTree()){n.addClass("menu-padded")}return n}n=$("<div></div>").data("depth",t).mouseenter(J.bind(null,t)).mouseleave(Q).delegate("a","mouseenter",{depth:t},X).delegate("a","click",Z);ce(n[0],e);if(a.padded&&WH.isRetailTree()){n.addClass("menu-padded")}if(i!==true&&!isNaN(t)){T.divCache[t]=n}return n}function R(e,t){var a=e.length;var n=$(window).height()-m*2-g;var s=Math.floor(Math.max(0,n)/H);var r=Math.floor(h/H);var o;var l=false;if(a>0){o=e[0].find("a").first();if(r<s&&!o.data("noSoftColumns")){l=true;s=r}}var c=[];var u=-1;if(a>0){if(o.data("column")){e.each((function(){var e=$(this).find("a").first().data("column");if(e){u=e-1}if(!c[u]){c[u]=$("<td/>",{class:"menu-column"})}c[u].append(this)}))}else if(s<a){var d=Math.min(p,Math.ceil(a/s));var f=Math.ceil(a/d);var W=0;var E=a;var _=0;while(E>0){u++;var T=Math.min(E,f);var v=W;var S=v+T;if(l){if(_!=0){S+=_;T+=_;_=0}if(e[S-1]&&e[S-1].hasClass(i)){S--;T--;_=1}if(e[S]&&!e[S].hasClass(i)){if(e[S-2]&&e[S-1]&&e[S]&&e[S-2].hasClass(i)&&!e[S-1].hasClass(i)){if(e[S+1]&&e[S+2]&&!e[S+1].hasClass(i)&&e[S+2].hasClass(i)){S+=2;T+=2}else{S-=2;T-=2;_=2}}if(e[S]&&e[S+1].hasClass(i)){S+=1;T+=1}if(e[S+1]&&e[S+2]&&!e[S+1].hasClass(i)&&e[S+2].hasClass(i)){S+=2;T+=2}}}e.slice(v,S).each((function(){if(!c[u]){c[u]=$("<td/>",{class:"menu-column"})}c[u].append(this)}));W+=T;E-=T}}}if(c.length){var b=WH.ce("div",{className:"menu-outer"});var y=WH.ce("div",{className:"menu-inner"});var I=WH.ce("table",{className:"menu-columns"});var A=WH.ce("tbody");var R=$("<tr/>");WH.ae(b,y);WH.ae(y,I);WH.ae(I,A);c.forEach((e=>R.append(e)));R.appendTo(A);return{columns:c.length,menu:b,padded:t}}var N=$('<div class="menu-outer"></div>');var w=$('<div class="menu-inner"></div>');e.each((function(){w.append(this)}));N.append(w);return{menu:N,padded:t}}function N(t,a){b(t);var r=$("<div/>",{class:"menu-item"});var o=$("<a/>").appendTo(r);let l=o[0];t.$a=o;o.data("menuItem",t);let c=e.getLabel(t);let u=true;if(t[f]&&t[f].spacer){o.addClass(n);o.addClass(s);u=false}else{if(V(t)){o.addClass(i);o.text(c);u=false}e.linkifyItem(t,o,true,a)}e.updateItem(t);if(t[f]){if(t[f].ariaLabel){l.ariaLabel=t[f].ariaLabel}if(t[f].column){o.data("column",t[f].column)}if(t[f].noSoftColumns){o.data("noSoftColumns",t[f].noSoftColumns)}if(t[f].modifyTooltip){o.get(0)._fixTooltip=t[f].modifyTooltip}if(t[f].modifyTooltip2){o.get(0)._fixTooltip2=t[f].modifyTooltip2}if(t[f].extraActions){for(var d=0,h=t[f].extraActions.length;d<h;d++){var p=t[f].extraActions[d];var m=WH.ce("a");if(p.fontIcon){m.classList.add("fa");if(p.fontIcon.indexOf(" ")!==-1){var H=p.fontIcon.split(" ");for(var g=0,W=H.length;g<W;g++){m.classList.add("fa-"+H[g])}}else{m.classList.add("fa-"+p.fontIcon)}}else{m.classList.add("fa");m.classList.add("fa-circle");m.classList.add("fa-size-s")}if(typeof p.url==="string"){m.href=p.url}else if(typeof p.callback==="function"){WH.aE(m,"click",p.callback)}if(typeof p.tooltipText!=="undefined"){WH.Tooltips.attach(m,p.tooltipText,typeof p.tooltipClass!=="undefined"?p.tooltipClass:"q2")}for(var E in p){if(!p.hasOwnProperty(E)){continue}switch(E){case"callback":case"fontIcon":case"tooltipClass":case"tooltipText":case"url":break;default:m.setAttribute(E,p[E])}}r.append(m)}}}if(u){let a;if(typeof c=="object"&&c!=null&&"tagName"in c&&c.tagName.toLowerCase()==="span"){let e;while(e=c.getElementsByTagName("span")[0]){let t=document.createElement("div");t.className=e.className;$.extend(t.style,e.style);t.style.display="inline";let a;while(a=e.firstChild){a.parentNode.removeChild(a);t.appendChild(a)}e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}a=$(c).clone()}else{a=$("<span></span>");a.text(c);let i=e.getLabelNote(t);if(i){a.append(WH.ce("section",{className:"option-label-note"},WH.ct(i)))}}a.appendTo(o);if(e.getSubmenu(t)){a.addClass("hassubmenu")}}return r}function w(e,t,a){let i=(t===0?e:T.visibleMenus[0]?.menu??[]).trackingLabel;var n=U(e);if(T.menuItemsCache[n]){return T.menuItemsCache[n]}let s;let r=[];$.each(e,(function(e,t){if(!(t instanceof Array)){t=["","Error: Invalid menu item",null,null,{className:"q10"}];WH.error("Trying to render an invalid menu item.",typeof t)}oe(t);if(!z(t)){return}let n=N(t,i);if(!a&&V(t)){s=n;return}if(s){r.push(s);s=null}r.push(n)}));var o=$(r);T.menuItemsCache[e]=o;return o}function C(e,t,a,i){I(0);M(e,0,t,undefined,a,i);B(1)}function M(e,t,a,i,n,s,r){if(typeof e=="function"){e=e()}y(e);var o=le(e,t);o.appendTo(document.body);var l=!K(t);T.visibleMenus[t]={div:o[0],$div:o,menu:e,openingElement:a,openingMenuItem:e.openingMenuItem||i};T.visibleMenus.forEach(((e,a)=>{e.div.dataset.reverseTier=`${t-a+1}`}));let c=t===0?D(o,t,T.showingHeaderMenu,n,s):P(o,t,T.showingHeaderMenu,r);o.css({position:T.showingHeaderMenu?"fixed":"absolute",left:c.x+"px",top:c.y+"px"});o[0].dataset.animateReveal=JSON.stringify(l);if(T.menuOpener){T.menuOpener.dataset.animateReveal=JSON.stringify(l)}He();o.show()}function O(t,a){t.splice(0,t.length);a.forEach((function(a){if(a[c]){t.push(e.createHeading({crumb:a[l],label:a[c],url:a[u],options:a[f]}))}let i=e.getSubmenu(a);if(i){i.forEach((function(e){t.push(e)}))}}))}function L(e,t){t=t.toString();return e.findIndex((e=>(e[l]==null?"":e[l].toString())===t))}function D(e,t,a,i,n){var s=WH.getViewport();var r=e.width();var o=e.height();var l=r+W;var c=o+g;var u=i!=null&&n!=null;if(u){if(n+c>s.b){n=Math.max(s.t,s.b-c)}}else{let e=WH.getOffset(T.menuOpener,a);i=e.left;n=e.top+T.menuOpener.offsetHeight;if(T.menuOpener.classList.contains("imitation-select")){i-=2}if(!T.menuOpener.closest(".menu-buttons")&&n+c>s.b&&e.top>=c){n=e.top-c}}if(i+l>s.r){i=Math.max(s.l,s.r-l)}return{x:i,y:n}}function k(t){if(!t){return"(no menu item)"}let a=e.getLabel(t);if(a){return a}let i=e.getItemCrumb(t);return i?`(invalid menu item with crumb ${i})`:"(invalid menu item)"}function P(e,t,a,i){var n=WH.getViewport();var s=e.width();var r=e.height();var o=s+W;var l=r+g;let c=T.openLinks[t-1];let u=WH.getOffset(c,a);var d=u.left+c.offsetWidth-5;var f=u.top-2;if(d+o>n.r){d=Math.max(n.l,u.left-s)}if(f+l>n.b){f=Math.max(n.t,n.b-l)}return{x:d,y:f}}function x(){let e=T.visibleMenus[0]?.menu?.trackingLabel;if(!e){return null}return{label:e,path:T.visibleMenus.map(((e,t)=>!e.openingMenuItem&&t===0?"(Opening element)":k(e.openingMenuItem)))}}function U(e){if(e.uniqueId==null){e.uniqueId=T.nextUniqueId++}return e.uniqueId}function F(t){var a=e.getItemOptions(t);if(a&&a.requiredAccess&&!WH.User.hasRole(a.requiredAccess)){return false}return true}function q(e){if(!e||!e.length){return false}for(let t=0,a=e.length;t<a;t++){if(!V(e[t])&&z(e[t])){return true}}return false}function Y(){ue(false);if(t.isTouch()){Ee.closeAllMenus();return}if(T.menuOpener){T.menuOpener.classList.remove("open")}B(0)}function B(e){while(T.visibleMenus.length>e){T.visibleMenus.pop()?.$div.stop().hide()}if(!T.visibleMenus[0]){j();WH.WAS.restoreHidden()}}function G(e){var t=[];var a;if(!V(e[0])){a=[];t.push([0,"",null,a])}$.each(e,(function(e,i){if(V(i)){a=[];t.push([i[l],i[c],i[u],a,i[f]])}else{if(a){a.push(i)}else{t.push(i)}}}));return t}function V(e){return e[l]==null||e[f]&&e[f].heading}function z(t){if(!(t instanceof Array)){return false}if(!F(t)){return false}if(t[f]){if(t[f].hide){return false}if(t[f].requiredTrees&&!t[f].requiredTrees.includes(WH.getDataTree())){return false}if(typeof t[f].condition==="function"){if(!t[f].condition()){return false}}}if(!t.checkingVisibility){var a=e.getSubmenu(t);if(a&&!e.getItemUrl(t)){t.checkingVisibility=true;var i=q(a);delete t.checkingVisibility;if(!i){return false}}}return true}function K(e){return T.visibleMenus[e||0]!=null}function j(){if(T.currentMenu&&T.currentMenu.onHide){T.currentMenu.onHide.call(T.menuOpener,T.currentMenu)}T.currentMenu=null;T.menuOpener=null}function Z(t){var a=$(this);var i=a.data("menuItem");if(!i){return}var n=e.getItemOptions(i);if(n.onClick){n.onClick(t)}}function X(t){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);var a=t.data.depth;I(a);let i=this;let n=$(i).data("menuItem");if(n){var s=e.getSubmenu(n);if(s){i.classList.add("open");T.openLinks[a]=i;var o=function(e,t,a){let i=a.closest(".menu-item")?.matches(":first-child")??false;M(e,t+1,T.openLinks[t],n,undefined,undefined,i);B(t+2)};if(!K(a+1)){T.timer.showMenu=setTimeout(o.bind(i,s,a,i),r)}else{o(s,a,i)}return}}B(a+1)}function Q(){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);T.timer.hideMenu=setTimeout(Y,o)}function J(e,t){clearTimeout(T.timer.hideMenu);var a=!t.target.className;if(!a){var i=t.target.className.split(" ");a=i.indexOf("open")==-1&&i.indexOf("hassubmenu")==-1&&i.indexOf("fonticon-icon")==-1}if(a){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);I(e);B(e+1)}}function ee(t){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);let i=a.getData(this,"menu");ue(WH.closest(this,".header")!==undefined);T.menuOpener=this;T.currentMenu=i;e.showAtCursor(i,t);ne(this,i,t)}function te(e,t){if(t.button===2||t.shiftKey||t.ctrlKey){e.call(this,t)}}function ae(e,t){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);if(K()){if(t===true){Y()}else{T.timer.hideMenu=setTimeout(Y,o)}}}function ie(e){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);let t=function(e){let t=a.getData(this,"menu");ue(WH.closest(this,".header")!==undefined);de(t,this);ne(this,t,e)}.bind(e.currentTarget||e.target,e);if(K()){t()}else{T.timer.showMenu=setTimeout(t,r)}}function ne(e,t,a){if(t.onShow){t.onShow.call(e,t,a)}}function se(e,t){if(!(e instanceof Array)){return null}var a=[];let i;for(let n=0,s;s=e[n];n++){let e=re(s,t);if(!e){continue}if(V(s)){i=e;continue}if(i){a.push(i);i=null}a.push(e)}return a}function re(t,a){var i=t[f]||{};if(i.zulHide){return null}if(t[f]&&t[f].requiredAccess&&!WH.User.hasRole(t[f].requiredAccess)){return null}oe(t);if(typeof t[f]?.condition==="function"){if(!t[f].condition()){return null}}var n={type:"link"};var s="";if(V(t)){n.heading=true}n.text=e.getLabel(t);if(typeof n.text!="string"){n.text=""}n.name="null";if(t[f]&&t[f].hasOwnProperty("zulName")){n.name=t[f].zulName}if(i.zulNoHref){}else if(typeof i.zulHref=="function"){n.href=i.zulHref}else{switch(typeof t[u]){case"string":n.href=e.getItemUrl(t);break;case"function":n.click=t[u];break}}if(t[f]){if(i.zulGetMobileMenu){if(!n.menu){n.menu={}}n.menu.mobile=i.zulGetMobileMenu}if(i.fontIcon){n.fontIcon=i.fontIcon}if(i.icon){n.imageIcon={url:i.icon,enlargeIcon:true}}if(i.tinyIcon){n.imageIcon={url:WH.getTinyIconUrl(i.tinyIcon),enlargeIcon:true}}if(i.armory){n.imageIcon={url:i.armory,enlargeIcon:true};s=(s?" ":"")+"zul-bar-icon-armory"}if(typeof n.imageIcon=="object"&&typeof n.fontIcon!="undefined"){delete n.fontIcon}if(t.checked){n.checked=true}else if(i.checkedUrl&&location.href.match(i.checkedUrl)){n.checked=true}else if(typeof i.checkedFunc=="function"){n.checked=i.checkedFunc(t)}else if(i.checked){n.checked=true}}var r=e.getSubmenu(t);if(r){if(!n.menu){n.menu={}}n.menu.mobile=se(r)}if(s){n.className=s}if(a){n.condition=a}else if(i.zulCondition){n.condition=i.zulCondition}return n}function oe(e){const t="callback:";const a=e[u];if(typeof a!=="string"||!a.startsWith(t)){return}const i=a.substring(t.length);let n=i.split(".");if(n[0]!=="WH"){WH.error(`Illegal callback reference "${i}"`);return}let s=window;while(n.length&&s){s=s[n.shift()]}if(typeof s!=="function"){return}const r=s();if(["string","function"].includes(typeof r)){e[u]=r}else if(typeof r==="object"){if(r.hasOwnProperty("crumb")){e[l]=r.crumb}if(r.hasOwnProperty("label")){e[c]=r.label}if(r.hasOwnProperty("url")){e[u]=r.url}if(r.hasOwnProperty("submenu")){e[d]=r.submenu}if(r.hasOwnProperty("options")){e[f]=r.options}}}function le(e,t,a,i){var n=t===0?e.padded:false;if(!e||e.length===0){e=[["","Error: Menu is empty",null,null,{className:"q10"}]];WH.error("Trying to render an empty menu.")}let s=w(e,t,i);var r=R(s,n);let o=A(e,t,r,a);o.append(r.menu);return o}function ce(e,t){e.className="menu";if(t.classes){for(let a=0,i=t.classes.length;a<i;a++){e.classList.add(t.classes[a])}}}function ue(e){if(T.showingHeaderMenu===e){return}T.showingHeaderMenu=e;document.body.dataset.showingHeaderMenu=JSON.stringify(e)}function de(e,t){if(T.menuOpener){T.menuOpener.classList.remove("open")}T.currentMenu=e;T.menuOpener=t;t.classList.add("open");C(e,t)}function fe(e,t,a,i){clearTimeout(T.timer.hideMenu);clearTimeout(T.timer.showMenu);C(e,t,a,i)}function he(t,a){if(!(t instanceof Array)){WH.error("Trying to do a menu sort on a non-array.",typeof t,t);return}t.sort(((t,a)=>WH.stringCompare(e.getLabel(t),e.getLabel(a))));if(a){for(var i=0,n;n=t[i];i++){var s=e.getSubmenu(n);if(s){e.sort(s,a)}}}}function pe(t,a){let i=G(t);$.each(i,(function(t,i){var i=e.getSubmenu(i);if(i){he(i,a)}}));O(t,i)}function me(t,a){const i=e.getMenu(t);if(!i||i.length===0){return}$.each(a,(function(t,n){var s;if(n[n.length-1]==="*"){if(n.length>1){var r=e.findItem(i,n.slice(0,n.length-1));s=e.getSubmenu(r)}else{s=i}if(s instanceof Array){for(var o=0,l;l=s[o];o++){var c=e.getSubmenu(l);if(c){e.sort(c)}}}else{WH.error("Could not find submenus to sort.",i,a)}}else{s=e.findItem(i,n);if(s){var c=e.getSubmenu(s);if(c){e.sort(c)}}}}))}function He(){let e=x();if(e){WH.Track.interactiveEvent({action:"Menu Opened",category:`${e.label} menu opened`,label:e.path.join(" → ")})}}function ge(e,t){$.each(e,(function(e,a){We(a,t)}))}function We(t,a){a(t);var i=e.getSubmenu(t);if(i){ge(i,a)}}var Ee=new function(){var t={container:null,containerArrow:null,currentMenu:null,menuOpener:null,path:[]};this.add=function(e,t){if(a.getData(e,"menu")){WH.error("A touch menu has already been attached to this element.",e.textContent);return}a.setData(e,"menu",t);WH.aE(e,"click",Ee.onRootNodeClick)};this.closeAllMenus=function(){$(".header-nav dt > a.active").removeClass("active");$("#header-nav-subnav").removeClass("touch-menu").empty();if(t.container){t.container.empty().css({display:"none"})}t.currentMenu=null;t.path=[];t.containerArrow=null;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active")}t.menuOpener=null;j()};this.onNodelessClick=function(e,a){T.currentMenu=e;T.menuOpener=null;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active");t.menuOpener=null}t.currentMenu=e;ue(false);u(e,{atPosition:[a.pageX,a.pageY+5]});ne(null,e,a);if(a){a.preventDefault();a.stopPropagation()}};this.onRootNodeClick=function(e,i){var n=$(this);if(this.classList.contains("active")||this.classList.contains("touch-menu-active")){Ee.closeAllMenus();if(e){e.preventDefault();e.stopPropagation()}return}var s=n.data("menuItem");ue(WH.closest(this,".header")!==undefined);if(!i){i=a.getData(this,"menu")}if(typeof i==="function"){i=i()}T.currentMenu=i;T.menuOpener=this;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active");t.menuOpener=null}if(this.parentNode.tagName==="DT"){Ee.closeAllMenus();this.classList.add("active");t.currentMenu=null;t.path=[s[l]];u(i)}else{t.menuOpener=n;t.menuOpener.addClass("touch-menu-active");t.currentMenu=i;t.path=s?[s[l]]:[null];u(i,{atElement:n})}ne(this,i,e);if(e){e.preventDefault();e.stopPropagation()}};function i(a,i,n){let s=a.menu||e.getMenu();var r,o,c,u;if(n){for(c in t.path){r=t.path[c];for(u in s){o=s[u];if(o[l]===r){s=e.getSubmenu(o);break}}}t.path=t.path.concat(i)}var f,h,p;for(c in i){r=i[c];f=null;for(u in s){o=s[u];if(o[l]===r){f=o;break}}if(!f){break}h=WH.ce("li");p=WH.ce("a");p.href="javascript:";e.linkifyItem(f,$(p),false,s.trackingLabel);p.innerHTML=e.getLabel(f,true);p.onclick=d;WH.ae(h,p);WH.ae(a,h)}}function n(e,t){var a=null,i;for(var n in t){i=t[n];if(!z(i)){continue}if(V(i)){s(e,i,t.trackingLabel);a=r(e);continue}if(!a){a=r(e)}WH.ae(a,o(i,t.trackingLabel))}}function s(t,a,i){let n=WH.ce("a");let s=$(n);a.$a=s;s.data("menuItem",a);e.linkifyItem(a,s,true,i);e.updateItem(a);s.text(e.getLabel(a));WH.ae(t,WH.getMajorHeading(s.get(0),2))}function r(e){var t=WH.ce("ul");WH.ae(e,t);return t}function o(t,a){N(t,a);b(t);var i=$("<a></a>");t.$a=i;i.data("menuItem",t);let n=e.linkifyItem(t,i,true,a);e.updateItem(t);var s;var r=e.getLabel(t),o,l,u;if(typeof r=="object"&&"tagName"in r&&r.tagName.toLowerCase()=="span"){while(o=r.getElementsByTagName("span")[0]){l=document.createElement("div");l.className=o.className;$.extend(l.style,o.style);l.style.display="inline";while(u=o.firstChild){u.parentNode.removeChild(u);l.appendChild(u)}o.parentNode.insertBefore(l,o);o.parentNode.removeChild(o)}s=$(r)}else{s=$("<span></span>");s.text(e.getLabel(t))}s.appendTo(i);var d=WH.ce("li");i.appendTo(d);if(e.getSubmenu(t)){if(n){i.addClass("has-sub");s.addClass("has-sub");var f=WH.ce("a");f.className="view-sub";f.href="javascript:";f.onclick=c;$(f).data("menuItem",t);WH.ae(d,f)}else{i.addClass("only-sub").data("menuItem",t).click(c);s.addClass("only-sub")}}return d}function c(){var a=$(this).data("menuItem");var n=$(".touch-menu-breadcrumb");if(n.length){i(n.get(0),[a[l]],true)}else{t.path.push(null)}f(e.getSubmenu(a),{animate:this})}function u(a,n){if(!n){n={}}var s;if(n.atElement||n.atPosition){var r=false;if(!t.container){t.container=$("<div/>",{class:"floating-touch-menu-container",css:{display:"none"}});t.container.appendTo("body")}else{var o=t.container.offset();r=o.top}t.container.empty();s=$("<div/>",{class:"floating-touch-menu"});t.containerArrow=$("<div/>",{class:"floating-touch-menu-arrow"});s.append(t.containerArrow).appendTo(t.container);var l=$("<a/>",{class:"floating-touch-menu-closer"});l.click(Ee.closeAllMenus);t.container.append(l);var c=n.atElement?n.atElement.offset():{left:n.atPosition[0],top:n.atPosition[1]};var u=c.top;if(n.atElement){u+=n.atElement.outerHeight()}var d=parseInt(u+7);var h=d!=r;t.container.css({display:"block",top:(h?d-10:d)+"px"});var p=c.left;if(n.atElement){p+=n.atElement.outerWidth()/2}t.containerArrow.css({display:"block",left:parseInt(p-10)+"px"});if(h){t.container.css({opacity:"0"});setTimeout((function(){t.container.animate({opacity:"1",top:"+=10px"})}),0)}}else{t.container=null;t.containerArrow=null;s=$("#header-nav-subnav");if(!s.length){s=$("<div/>",{class:"header-nav-subnav",id:"header-nav-subnav"});s.insertAfter(".header-nav")}s.empty()}var m=false;if(!n.atElement&&!n.atPosition||n.atElement&&n.atElement.data("menuItem")){m=true}if(m){if(t.container){t.container.addClass("has-breadcrumb")}var H=WH.ce("ul");H.className="touch-menu-breadcrumb";if(n.atElement){var g=$(n.atElement);if(g.data("parentMenu")){H.menu=$(n.atElement).data("parentMenu")}else if(g.html()){H.menu=[g[0].whMenuItem||e.createItem({crumb:0,label:g.html(),submenu:a})]}}i(H,t.path)}else if(t.container){t.container.removeClass("has-breadcrumb")}if(t.container){if(n.atElement&&n.atElement.parents("nav.breadcrumb").length){t.container.addClass("from-breadcrumb")}else{t.container.removeClass("from-breadcrumb")}}var W=WH.ce("div");W.className="touch-menu-items";W.style.left="0%";f(a,{target:W});var E=WH.ce("div");E.className="touch-menu-items-wrapper";WH.ae(E,W);if(m){s.append(H)}s.append(E).attr("class","touch-menu")}function d(){var a=$(this).parent();if(a.is(":last-child")){return true}var i=a.index();let n=e.getMenu();for(var s=0;s<=i;s++){for(var r in n){if(n[r][l]===t.path[s]){n=e.getSubmenu(n[r]);break}}}a.nextAll().remove();f(n,{reverse:t.path.length-i-1,targetPathIndex:i});t.path=t.path.slice(0,i+1);return false}function f(e,a){if(a.animate){var i=$(".touch-menu-items");$(a.animate).parent().addClass("chosen");i.addClass("chosen");setTimeout((function(){var a=WH.ce("div");a.className="touch-menu-items";var s=(t.path.length-2)*-10+2;a.style.left=s+"%";n(a,e);var r=$(a);var o=i.last();o.after(r);var l=o.height();i.each((function(){var e=$(this);if(e.data("height")){e.css({height:"1px"}).animate({left:"-=12%"})}else{e.data("height",e.height()).css("height",e.height()+"px").animate({left:"-=12%",height:"1px"})}}));var c=r.height();r.css("height",l+"px").animate({left:"-=12%",height:c+"px"})}),100)}else if(a.reverse){var s=$(".touch-menu-items");var r=$(s.get(a.targetPathIndex));var o=a.reverse*12;var l=s.last();r.css({height:l.height()+"px"}).animate({left:"+="+o+"%",height:r.data("height")+"px"},{complete:function(){$(this).css("height","")}});l.css({height:"1px"});s.not(r).animate({left:"+="+o+"%"},{complete:function(){r.removeClass("chosen");$(".chosen",r).removeClass("chosen");r.nextAll().stop().remove()}})}else if(a.target){$(a.target).empty();n(a.target,e)}}};this.addTouch=Ee.add;S()};WH.ModelViewer=new function(){const e=this;const t=[1796891,1807633,1819228];const a={screenshotsAllowed:false};this.canTakeScreenshots=function(){return!!a.screenshotsAllowed};function i(){a.screenshotsAllowed=(g_user.roles&U_GROUP_STAFF)>0||t.includes(g_user.id)}i()};WH.NewsletterCta=new function(){const e=WH.LocalStorage;const t=Date.now();const a=e.KEY_NEWSLETTER_CTA_POPOVER_SETTINGS;const i=e.KEY_NEWSLETTER_CTA_POPOVER_VISITS;let n=null;this.dismiss=function(){h({dismissedUntil:Date.now()+30*WH.Time.MS_DAY});l();WH.dE(document,"keydown",d)};this.noThanks=function(){h({noThanks:true});l()};function s(e){if(!n&&e){n=WH.qs(".newsletter-cta-overlay",e);if(!n){n=WH.ce("div",{className:"newsletter-cta-overlay"});n.style.display="none";e.appendChild(n);WH.aE(n,"click",(()=>{WH.NewsletterCta.dismiss();l()}))}}return n}function r(){try{return e.get(a)||{}}catch(e){return{}}}function o(){return parseInt(e.get(i)||"0",10)}function l(){c();const e=WH.ge("newsletter-cta-wrapper");if(e){const t=WH.qs(".newsletter-cta-popover",e);t?.remove()}}function c(){if(n){n.style.display="none"}}function u(){f();if(!m()){return}const e=WH.ge("newsletter-cta-wrapper");if(!e){return}const t=WH.User.isLoggedIn();void WH.React.initComponent(e,"modules/newsletter/cta-popover",{loggedIn:t});H(e);WH.aE(document,"keydown",d)}function d(e){if(e.key==="Escape"){WH.NewsletterCta.dismiss()}}function f(){p(o()+1)}function h(t){e.set(a,t)}function p(t){e.set(i,t)}function m(){if(WH.getPageData("user.newsletter.noPopup")){return false}const e=r();const a=o();if(e.noThanks){return false}if(e.dismissedUntil&&t<e.dismissedUntil){return false}if(WH.User.isLoggedIn()){const e=WH.getPageData("user.newsletter.popupDataEnvs")??[];if(!e.includes(WH.getDataEnv())){return false}}return a>=3}function H(e){const t=s(e);if(t){t.style.display="block"}}document.addEventListener("DOMContentLoaded",u)};WH.Notifications=new function(){const e=this;const t=WH.LocalStorage;this.GA_ACTION_GENERAL="General";this.GA_ACTION_DELIVERY_WEB_PUSH="Web Push Delivery Method";this.GA_ACTION_EVENT_NEWS_PUBLISHED="News Published Events";this.GA_CATEGORY="Notifications";const a="notifications-dialog";const n=1;const s="/js-local/WH/ServiceWorkers/Notifications/WebPush.js";const r={newSubInfo:null,postSubscriptionCallback:null};this.browserSupportsNotifications=function(){return!!(window.Promise&&navigator.serviceWorker&&window.PushManager)};this.getNewsGroupsOptions=function(e,t){let a=document.createDocumentFragment();WH.getPageData("notifications.newsGroups").forEach((n=>{let s=n.id;let r=t.indexOf(s)!==-1;let o=WH.ce("input",{name:"newsGroups["+e+"]["+s+"]",type:"checkbox",checked:r});o.dataset.subId=e.toString();o.dataset.group=s.toString();WH.aE(o,"click",u.bind(null,e));if(i!==0){WH.ae(a,WH.ce("br"))}let l=WH.ce("label",undefined,o);WH.ae(l,WH.ct(n.name));WH.ae(a,l)}));return a};this.isBrowserDenied=function(){return Notification.permission==="denied"};this.getNewSubInfo=function(){return r.newSubInfo};this.getSubscription=function(){return navigator.serviceWorker.getRegistrations().then((function(e){for(let t=0;t<e.length;t++){let a=e[t];WH.debug(a,new RegExp(s));if(a.active.scriptURL.match(new RegExp(s))){return a.pushManager.getSubscription()}}return null}))};this.enableNewsNotifications=function(){p()};this.setPostSubscriptionCallback=function(e){r.postSubscriptionCallback=e};this.showSubscriptionListError=function(){H("subscription-list-error",WH.TERMS.notificationsSubscriptionListFailed_tip)};function o(e){let t="."+a+"-buttons";let i=WH.qsa(t+" .btn");for(let e=0;e<i.length;e++){i[e].disabled=true}let n=WH.qs(t+"-"+e);if(n){n.classList.add("working")}}function l(){t.remove(t.KEY_NOTIFICATIONS_ERROR_SHOWN)}function c(){WH.de("."+a)}function u(e,t){if(t.target.checked===false){return}let a=WH.qsa('input[data-sub-id="'+e+'"]');let i=parseInt(t.target.dataset.group)===n;for(let e=0;e<a.length;e++){let t=parseInt(a[e].dataset.group);if(i&&t!==n){a[e].checked=false}else if(!i&&t===n){a[e].checked=false}}}function d(){if(WH.PageMeta.page==="account"){WH.debug("Notifications onboarding disabled on this page (legacy mechanism).");return}if(WH.getPageData("notifications.disable-onboarding")){WH.debug("Notifications onboarding disabled on this page.");return}if(!t.isSupported()){WH.debug("This browser does not support local storage.");return}if(!e.browserSupportsNotifications()){WH.debug("This browser does not support notifications.");return}if(WH.Notifications.Onboarding.isComplete()){WH.debug("Notifications onboarding already complete.");return}if(!window.Notification||Notification.permission==="denied"){WH.debug("Stage 2 is denied.");WH.Notifications.Onboarding.setComplete();return}if(WH.Notifications.Onboarding.isStage1Denied()){WH.debug("Stage 1 is denied.");return}if(WH.Notifications.Onboarding.isStage1Granted()){WH.debug("Stage 1 is granted.");m();return}_()}function f(){WH.debug("Sleeping stage 1.");WH.Track.interactiveEvent({category:e.GA_CATEGORY,action:e.GA_ACTION_EVENT_NEWS_PUBLISHED,label:"Temporarily closed notifications request"});c();WH.Notifications.Onboarding.stage1Sleep()}function h(){WH.debug("Denying stage 1.");WH.Track.interactiveEvent({category:e.GA_CATEGORY,action:e.GA_ACTION_EVENT_NEWS_PUBLISHED,label:"Declined notifications request"});c();WH.Notifications.Onboarding.stage1Deny();WH.Notifications.Onboarding.setComplete()}function p(t){WH.debug("Granting stage 1.");l();WH.Notifications.Onboarding.stage1Grant();if(t===true){WH.Track.interactiveEventOutgoing({category:e.GA_CATEGORY,action:e.GA_ACTION_EVENT_NEWS_PUBLISHED,label:"Accepted notifications request"});o("accept");if(WH.getDataEnv()!==WH.dataEnv.MAIN||Locale.getId()!==LOCALE_ENUS){WH.Notifications.Onboarding.setComplete();let e=WH.Url.generate("/notifications/settings",{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS});if(Locale.getId()!==LOCALE_ENUS){e+="?locale="+Locale.getId()}let t=WH.ce("form",{action:e,method:"POST"});let a=WH.ce("input",{type:"hidden",name:"accept",value:"1"});WH.ae(t,a);WH.ae(document.body,t);t.submit();return}}m()}function m(){var t=false;e.getSubscription().then((function(e){t=e===null;return navigator.serviceWorker.register(s)})).then((function(e){let a=e.installing||e.waiting||e.active;if(a){if(a.state==="activated"){v(e,t)}else{a.addEventListener("statechange",(function(a){if(a.target.state==="activated"){v(e,t)}}))}}}))["catch"]((function(t){c();WH.Track.nonInteractiveEvent({category:e.GA_CATEGORY,action:e.GA_ACTION_DELIVERY_WEB_PUSH,label:"Failed to register service worker"});WH.error("Could not register push notifications service worker.",t);T()}))}function H(t,i){WH.debug("show message",t,i);c();let n=WH.ce("div",{className:a});n.dataset.dialog=t;let s=WH.ce("div",{className:a+"-message"},WH.ct(i));WH.ae(n,s);let r=WH.ce("div",{className:a+"-buttons"});WH.ae(n,r);WH.ae(r,WH.ce("button",{className:"btn btn-site "+a+"-buttons-close",onclick:function(){WH.Track.interactiveEvent({category:e.GA_CATEGORY,action:e.GA_ACTION_DELIVERY_WEB_PUSH,label:"Closed "+t+"message"});c()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,n)}function g(t){WH.debug("Saving subscription...");return $.ajax({url:WH.Url.generatePath("/notifications/subscribe"),method:"POST",type:"json",data:{subscription:JSON.parse(JSON.stringify(t)),platform:window.navigator.platform,userAgent:window.navigator.userAgent},success:function(t){WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Saved push subscription on backend");WH.debug("Save successful.");r.newSubInfo=t;WH.Notifications.Onboarding.setComplete()}})}function W(e,t){$.ajax({url:WH.Url.generatePath("/notifications/save-subscription-settings"),method:"post",data:{id:r.newSubInfo.id,endpointUrl:r.newSubInfo.endpoint,name:e,newsGroups:t},complete:function(){WH.debug("Saved the sub name as",e);c();r.newSubInfo.name=e;r.newSubInfo.groups=t;S()}})}function E(){WH.debug("Showing ask-for-name popup");WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Requesting device name after subscribing");c();let t=WH.ce("div",{className:a});t.dataset.dialog="ask-for-name";let i=WH.TERMS.notificationsDeviceName_tip;let s=WH.ce("div",{className:a+"-message"},WH.ct(i));WH.ae(t,s);let r=WH.ce("div",{className:a+"-form"});WH.ae(t,r);let l=WH.ce("input",{name:"name",placeholder:WH.TERMS.name,type:"text"});WH.ae(r,l);let u=WH.ce("div",{style:{verticalAlign:"top"}});WH.ae(u,WH.ct(WH.TERMS.newsGroup+WH.TERMS.colon_punct));WH.ae(u,WH.ce("br"));WH.ae(u,e.getNewsGroupsOptions(0,[n]));WH.ae(r,u);let d=WH.ce("div",{className:a+"-buttons"});WH.ae(t,d);let f=function(){WH.Track.interactiveEvent({category:e.GA_CATEGORY,action:e.GA_ACTION_DELIVERY_WEB_PUSH,label:"Saved device name after subscribing"});let t=[];let a=WH.qsa('input[name*="newsGroups"]',u);for(let e=0;e<a.length;e++){let i=a[e];if(i.checked){t.push(parseInt(i.dataset.group))}}W(l.value,t);o("save")};WH.aE(l,"keydown",(function(e){if(e.key==="Enter"){f()}}));let h=WH.ce("button",{className:"btn btn-site "+a+"-buttons-save",onclick:f,type:"button"},WH.ct(WH.TERMS.save));WH.ae(d,h);WH.ae(d,WH.ce("button",{className:"btn "+a+"-buttons-close",onclick:function(){WH.Track.interactiveEvent({category:e.GA_CATEGORY,action:e.GA_ACTION_DELIVERY_WEB_PUSH,label:"Closed device settings dialog after news sub"});c();S()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,t);l.focus()}function _(){if(WH.Notifications.Onboarding.isStage1Sleeping()){WH.debug("Stage 1: sleeping");return}WH.debug("Showing stage1 popup");WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Showing notifications request to user");let t=WH.ce("div",{className:a});t.dataset.dialog="stage-1";let i=WH.ce("div",{className:a+"-message"},WH.ct(WH.TERMS.enableNewsNotifications_tip));WH.ae(t,i);let n=WH.ce("div",{className:a+"-buttons"});WH.ae(t,n);let s=p.bind(null,true);WH.ae(n,WH.ce("button",{className:a+"-buttons-accept btn btn-site",onclick:s,type:"button"},WH.ct(WH.TERMS.accept)));WH.ae(n,WH.ce("button",{className:a+"-buttons-decline btn",onclick:h,type:"button"},WH.ct(WH.TERMS.decline)));WH.ae(n,WH.ce("button",{className:a+"-buttons-maybe-later btn",onclick:f,type:"button"},WH.ct(WH.TERMS.maybeLater)));WH.ae(document.body,t)}function T(){if(t.get(t.KEY_NOTIFICATIONS_ERROR_SHOWN)){return}H("subscription-error",WH.TERMS.notificationsSubscriptionFailed_tip);t.set(t.KEY_NOTIFICATIONS_ERROR_SHOWN,true)}function v(t,a){WH.debug("Subscribing with reg:",t);t.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:WH.getPageData("notifications.public-key")}).then((function(e){if(!e){throw"Did not find subscription"}WH.debug("Got subscription:",e,JSON.stringify(e));return g(e)})).then((function(e){c();if(e&&WH.User.isLoggedIn()&&a){E()}else{S()}}))["catch"]((function(t){c();WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to subscribe");WH.error("Could not subscribe user to push notifications.",t);T()}))}function S(){if(r.postSubscriptionCallback){r.postSubscriptionCallback()}}WH.onLoad(d)};WH.Notifications.Onboarding=new function(){const e=WH.LocalStorage;const t={complete:false,stage1SleepTime:0};const a="denied";const i="granted";this.isComplete=function(){if(WH.getCookies("notifications")==="1"||n().complete){WH.debug("Onboarding already complete, so setting both cookie and LS.");this.setComplete()}return n().complete};this.isStage1Denied=function(){return n().stage1Status===a};this.isStage1Granted=function(){return n().stage1Status===i};this.isStage1Sleeping=function(){return n().stage1SleepTime>WH.Time.unix()};this.setComplete=function(){WH.debug("Marking onboarding complete.");let e=n();e.complete=true;s(e);if(!WH.getCookies("notifications")){WH.setCookie("notifications",365,"1","/",".wowhead.com")}};this.stage1Deny=function(){let e=n();e.stage1Status=a;s(e)};this.stage1Grant=function(){let e=n();e.stage1Status=i;s(e)};this.stage1Sleep=function(){let e=n();e.stage1SleepTime=WH.Time.unix()+WH.Time.SEC_DAY*3;s(e)};this.stage1Wake=function(){let e=n();e.stage1SleepTime=0;s(e)};function n(){return e.get(e.KEY_NOTIFICATIONS_ONBOARDING)||t}function s(t){e.set(e.KEY_NOTIFICATIONS_ONBOARDING,t)}};WH.Page=new function(){const e=Object.seal({callbacks:[]});this.init=function(){while(e.callbacks.length){e.callbacks.shift()()}};this.commentsLocked=function(){return t().commentsLocked===true};this.getId=function(){return t().entityId};this.getType=function(){return t().entityType};this.registerInit=t=>{e.callbacks.push(t)};function t(){return WH.getPageData("page.info")||{}}};WH.Paperdoll=new function(){this.BONUS_INDEX_START=11;this.EQUIPSET_MAX_BONUSES=16;this.TIMEWALKER_LEVEL_INDEX=28};WH.convertRawItemDataForPaperdoll=function(e){var t={};t.slotId=e[0];t.itemId=e[1];t.transmogId=e[9];t.hidden=e[10];t.rawBonuses=e.slice(WH.Paperdoll.BONUS_INDEX_START,WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES);t.bonuses=[];for(var a in t.rawBonuses){if(t.rawBonuses.hasOwnProperty(a)&&t.rawBonuses[a]){t.bonuses.push(t.rawBonuses[a])}}return t};WH.convertPaperdollItemDataToRaw=function(e){var t=[];for(var a=0;a<WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES;a++){t[a]=0}t[0]=e.slotId;t[1]=e.itemId;t[9]=e.transmogId?e.transmogId:0;t[10]=e.hidden?e.hidden:0;t[WH.Paperdoll.BONUS_INDEX_START]=e.itemBonus?e.itemBonus:0;return t};var PoundChecker=new function(){var e=null;var t=null;var a=1e3;var i=function(){if(!t){PoundChecker.stop();return}if(location.hash)t()};this.start=function(n,s){if(t){if(WH.isDev())alert("Multiple pound checkers are bad, mmkay?");return}t=n;if(s)a=s;e=setInterval(i,a)};this.stop=function(){clearInterval(e);e=t=null;a=1e3};this.pause=function(){clearInterval(e)};this.resume=function(){if(t)e=setInterval(t,a)}};WH.Profiler=new function(){const e=this;const t=1;const a=2;this.create=function(t,a,i,n,s){if(!t||typeof t!=="string"||!a||typeof a!=="string"||!i||typeof i!=="string"){if(n===true){alert(WH.TERMS.filloutdetails_tip)}if(s){return}(new Dialog).show("fetchlist",{data:{region:t,realm:a,character:i},onSubmit:function(t){e.create(t.region,t.realm,t.character,true,false);return false}});return}location.href=WH.Url.generatePath("/list/"+WH.Strings.slug(t+"-"+a+"-"+i,true))};this.getAvatarUrl=function(e){if(e.region){if(e.thumbnail){return WH.BlizzardApi.getCharacterThumbnailUrl(e.region,e.thumbnail)}else if(e.race&&(e.gender===0||e.gender===1)){return"https://"+e.region.toLowerCase()+".battle.net/wow/static/images/2d/avatar/"+e.race+"-"+e.gender+".jpg"}}return null};this.getFavorite=function(e){var t=null;if(g_user.lists instanceof Array){for(var a=0,i=g_user.lists.length;a<i;a++){if(this.isMain(g_user.lists[a].pinned)){t=g_user.lists[a];break}if(!e&&g_user.lists[a].pinned&&(t===null||new Date(g_user.lists[a].updated)>new Date(t.updated))){t=g_user.lists[a]}}}return t};this.getMenuItem=function(e,t){var a={className:e.mode!=1||e.armory&&!e.errcode?"listmanager-mode"+e.mode:"q10"};if(t&&e.region){var i=WH.Profiler.getAvatarUrl(e);if(i){a.armory=i}}if(!a.armory&&e.mode==1&&e.pinned){a.fontIcon=this.isMain(e.pinned)?"star":"thumb-tack"}return[e.id,e.name,WH.Profiler.getPath(e),null,a]};this.getPath=function(e){return WH.Url.generatePath("/list="+e.id+(e.url?"/"+e.url:""))};this.isMain=e=>e===a;this.isPinned=e=>e===t;this.resyncAll=function(e){if(!WH.User.isPremium()){return}WH.fetch(WH.Url.generatePath("/profiler/resync-all"),{success:e})};function i(){Menu.onLoad((()=>{const t=Menu.getMenu("lists");if(t){Menu.setItemUrl(Menu.findItem(t,[101]),e.create)}}))}i()};function li_onSaveTab(xhr,opt){var text=xhr.responseText;if(text.charAt(0)!="{"||text.charAt(text.length-1)!="}"){return}var list=null;try{list=JSON&&JSON.parse(text)||eval(text)}catch(e){return}if(!list||!list.id){return}return list}function li_getCurrentUserList(e){if(g_user.lists&&g_user.lists.length){for(var t in g_user.lists){if(g_user.lists[t].id==e){return g_user.lists[t]}}}return null}function li_getListStatus(id,onSuccess){new Ajax("/list&status="+id+"&t="+Math.random(),{method:"POST",onSuccess:function(xhr,opt){var response=eval(xhr.response)[0];if(!response.id)return;li_setButtonStatus(WH.ge("list-status"),response);if(response.refresh){setTimeout(li_getListStatus,response.refresh,id,onSuccess);return}if(response.status==3&&onSuccess)onSuccess()}})}function li_setButtonStatus(e,t){var a=t.statusText;var i=$("#list-delete");i.hide();if(t.errcode>0){a=WH.term("parens_format",t.errorText,"#"+t.errcode);i.show()}var n="";if(t.status==1||t.status==2){e.blur();n=" fa-spin";if(t.position===0){a+=WH.TERMS.colon_punct+WH.TERMS.nextInLine}else{a+=WH.TERMS.colon_punct+WH.sprintf(WH.TERMS.inline_format,WH.numberFormat(t.position))}}if(e){var s=" btn-";switch(t.status){case 1:case 2:s+="warning";break;case 3:s+="success";break;case 4:s+="danger";break;case 0:default:s+="primary"}e.className=e.className.replace(/ +btn-[^ ]+\b/,s).replace(/( fa-spin)?( +status-[^ ]+\b)?/,n+" status-"+t.status);e.innerHTML=a;if(t.errcode==104){WH.ae(e,WH.ce("div",{style:{padding:"1em",textAlign:"left"}},WH.BlizzardApi.getNotFoundMessage()))}}}function li_updateRealmSelect(e,t){WH.ee(t);var a=WH.Wow.Realm.getAll();if(!a){WH.ae(t,WH.ce("option",{},WH.ct(WH.TERMS.loading_ellipsis)));a={};WH.Wow.Realm.fetchData(li_updateRealmSelect.bind(null,e,t))}WH.ae(t,WH.ce("option"));if(!a[e]){return}var i=[];for(var n in a[e]){if(!a[e].hasOwnProperty(n)){continue}i.push(a[e][n])}i.sort((function(e,t){return e.name.localeCompare(t.name)}));for(var s,r=0;s=i[r];r++){if(s.name.indexOf(s.name_enus)>=0){continue}var o=WH.ce("option");o.value=s.name_enus;WH.st(o,s.name);WH.ae(t,o)}i.sort((function(e,t){return e.name_enus.localeCompare(t.name_enus)}));for(var s,r=0;s=i[r];r++){var o=WH.ce("option");o.value=s.name_enus;WH.st(o,s.name_enus);WH.ae(t,o)}}Dialog.templates.createlist={title:WH.TERMS.createnewlist,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"name",label:WH.TERMS.name,required:1,type:"text"}]};Dialog.templates.fetchlist={title:WH.TERMS.lookupblizzardbattlenetprofile,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"region",label:WH.TERMS.region,required:1,type:"select",options:{US:"US",EU:"EU",KR:"KR",TW:"TW"},compute:function(e,t,a,i,n,s){e.id="dialog-region";$(e).change((function(){li_updateRealmSelect($(this).val(),$("#dialog-realm").get(0))}))}},{id:"realm",label:WH.TERMS.realm,required:1,type:"select",options:[],compute:function(e,t,a,i,n,s){e.id="dialog-realm";li_updateRealmSelect($("#dialog-region").val(),e)}},{id:"character",label:WH.TERMS.character,required:1,type:"text"}]};var ProgressBar=function(e){this.opts={text:"",hoverText:"",color:"rep6",width:0,progress:0};this.elements={text:null,hoverText:null,textContainer:null,progress:null,container:null};WH.cO(this.opts,e);this.build()};ProgressBar.prototype.build=function(){var e=$("<a/>",{class:"progressbar",href:"javascript:"});if(this.opts.width>0)e.css("width",this.opts.width+"px");else e.css("width","auto");var t=$("<div/>",{class:"progressbar-text"});if(this.opts.text){this.elements.text=$("<del/>",{text:this.opts.text});t.append(this.elements.text)}if(this.opts.hoverText){this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});t.append(this.elements.hoverText)}e.append(t);var a=$("<div/>",{class:"progressbar-"+this.opts.color,css:{width:this.opts.progress+"%"},text:WH.Strings.nbsp});e.append(a);if(this.opts.text)t.append($("<div/>",{class:"progressbar-text progressbar-hidden",text:this.opts.text}));this.elements.container=e;this.elements.progress=a;this.elements.textContainer=t;return e};ProgressBar.prototype.setText=function(e){this.opts.text=e;if(this.elements.text)this.elements.text.text(this.opts.text);else{this.elements.text=$("<del/>",{text:this.opts.text});if(this.opts.hoverText)this.opts.hoverText.before(this.elements.text);else this.elements.textContainer.append(this.elements.text)}};ProgressBar.prototype.setHoverText=function(e){this.opts.hoverText=e;if(this.elements.hoverText)this.elements.hoverText.text(this.opts.hoverText);else{this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});this.elements.textContainer.append(this.elements.hoverText)}};ProgressBar.prototype.setProgress=function(e){this.opts.progress=e;this.elements.progress.css("width",this.opts.progress+"%")};ProgressBar.prototype.setWidth=function(e){this.opts.width=e;if(this.opts.width>0)this.elements.container.css("width",this.opts.width+"px");else this.elements.container.css("width","auto")};ProgressBar.prototype.getText=function(){return this.opts.text};ProgressBar.prototype.getHoverText=function(){return this.opts.hoverText};ProgressBar.prototype.getWidth=function(){return this.opts.width};ProgressBar.prototype.getContainer=function(){return this.elements.container};WH.Raidbots=new function(){this.createForm=function(i){var n=WH.ce("form",{action:"https://www.raidbots.com/simbot/"+i,method:"get",className:"raidbots-form exclude-units"});var s=WH.ce("select",{name:"region"});WH.ae(s,e(WH.TERMS.region));var r=WH.ce("select",{name:"realm"});WH.ae(r,e(WH.TERMS.realm));WH.ae(r,e(WH.TERMS.selectRegion_tip,false));WH.aE(s,"change",t.bind(this,r,s));var o=WH.ce("input",{type:"text",name:"name",placeholder:WH.TERMS.characterName,required:true});WH.aE(r,"change",(function(){o.focus()}));var l=WH.ce("button",{className:"fa fa-external-link",type:"submit"});WH.st(l,WH.TERMS.submit);WH.ae(n,s);WH.ae(n,r);WH.ae(n,o);WH.ae(n,l);WH.Wow.Realm.fetchData(a.bind(this,s,r));return n};function e(e,t){var a=WH.ce("option",{disabled:true,selected:typeof t==="boolean"?t:true,required:true});WH.st(a,e);return a}function t(a,i,n){var s=WH.Wow.Realm.getAll();if(!s){WH.Wow.Realm.fetchData(t.bind(this,a,i));return}WH.ee(a);var r=i.options&&i.options[i.selectedIndex]?i.options[i.selectedIndex].value:null;if(r===null){WH.ae(a,e("Invalid region",false));return}if(!s[r]){WH.ae(a,e("No realms found for that region ("+r+")",false));return}WH.ae(a,e(WH.Strings.sprintf(WH.TERMS.realms_format,r)));var o=[];for(var l in s[r]){if(s[r].hasOwnProperty(l)&&s[r][l]){o.push(s[r][l])}}o.sort((function(e,t){return e.name.localeCompare(t.name)}));for(var c=0,u=o.length;c<u;c++){var d=o[c];var f=WH.ce("option",{value:d.slug});WH.st(f,d.name);WH.ae(a,f)}if(typeof n==="undefined"||n){a.focus()}}function a(i,n){var s=WH.Wow.Realm.getAll();if(!s){WH.Wow.Realm.fetchData(a.bind(this,i,n));return}WH.ee(i);WH.ae(i,e(WH.TERMS.region));var r=[];for(var o in s){r.push(o)}r.sort();for(var l=0,c=r.length;l<c;l++){var u=WH.ce("option",{value:r[l],selected:r[l].toUpperCase()==="US"});WH.st(u,r[l]);WH.ae(i,u)}t(n,i,false)}};WH.Responsive=new function(){const e=this;const t=WH.Device;this.BREAKPOINTS={MOBILE_MODE:767};this.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT=768;this.SIDEBAR_REMOVAL_BREAKPOINT=1200;this.COLLAPSED_NAVIGATION_WIDTH_MAX=1600;this.COLLAPSED_NAVIGATION_HEIGHT_MAX=900;this.BREAKPOINT_RIGHT_RAIL=1366;this.BREAKPOINT_NO_RAILS=1199;this.BREAKPOINT_NO_BILLBOARD=700;this.BREAKPOINT_XL_DESKTOP=2560;this.BREAKPOINT_LG_DESKTOP=1920;this.BREAKPOINT_SM_DESKTOP=1213;this.BREAKPOINT_TABLET=744;const a={height:250,width:970};const i={height:90,width:728};const n={height:250,width:300};const s=1340;const r=1098;const o=768;const l=370;const c={testCount:0};this.adjustByScrollSize=function(e,t,a,i){const n=0;const s=Number.MAX_SAFE_INTEGER;const r=1;const o=2;let l=n;let c=s;let u=i?"clientHeight":"clientWidth";let d=i?"scrollHeight":"scrollWidth";let f;let h;let p=()=>h=h||requestAnimationFrame((()=>{h=null;let i=e[u];if(i<=l){if(f!==r){t();f=r}return}if(f!==o){a();f=o}if(i>=c){return}if(e[d]>i){t();f=r;l=i}else{c=Math.min(c,i)}}));let m=()=>{WH.aE(e,"resize",p);WH.qsa(":scope > *",e).forEach((e=>WH.aE(e,"resize",(()=>{l=n;c=s;p()}))));p()};if(document.fonts.status==="loaded"){m()}else{document.fonts.ready.then(m)}};this.canResponsiveRowFitVideo=()=>d.canFitVideo();this.test=()=>{c.testCount++;u.test();d.test()};var u=new function(){var a;this.test=function(){if(!a&&(document.readyState!=="complete"||c.testCount<5)){a=WH.ge("infobox-alternate-position")}var e=$(".infobox");i(e);n(e)};function i(t){if(!a||!t.length){return}var i=t.closest(".interior-sidebar");const n=WH.ge("main-contents");const s=n?n.getBoundingClientRect().width:window.innerWidth;if(i.length){if(s<e.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){i.appendTo(a)}else if(!i.parent().hasClass("interior-sidebar-parent")){$(".interior-sidebar-parent").prepend(i)}}else{if(s<=e.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){t.appendTo(a)}else if(t.parent().attr("id")!=="infobox-original-position"){$("#infobox-original-position").append(t)}}}function n(e){let a=window.innerWidth-54;if(!t.isTouch()){a-=20}$(".icon-db-link div",e).each((function(){this.style.width="auto";window.requestAnimationFrame(function(){this.style.width=Math.min(a,this.parentNode.offsetWidth)+"px"}.bind(this))}))}};let d=new function(){const e={currentAdBreakpoint:undefined,elements:Object.seal({row:undefined})};this.canFitVideo=()=>{let e=t();if(!e){return true}return e.getBoundingClientRect().width>o};this.test=function(){if(!WH.WAS.showAds()){return}if(!e.currentAdBreakpoint){i();n()}else{let t=e.currentAdBreakpoint;i();if(t!==e.currentAdBreakpoint){n()}}};function t(){e.elements.row??=WH.qs("#main > .blocks");if(!e.elements.row){WH.error("Attempted to get the responsive row before it was available.")}return e.elements.row}let i=function(){let i=t();if(!i){return}let n=i.getBoundingClientRect().width;let c=n;let u=WH.WAS.hasVideo();if(!u){n+=l}if(c<=o){e.currentAdBreakpoint=o}else if(n<r){e.currentAdBreakpoint=r}else if(n<s){e.currentAdBreakpoint=s}else{e.currentAdBreakpoint=s+1}if(e.currentAdBreakpoint<=s&&n>=a.width&&u&&WH.WAS.isSkinned()){WH.WAS.removeVideo(false);e.currentAdBreakpoint=s+1}};let n=function(e){let a=t();if(!a){if(e<=10){WH.onLoad((()=>n((e??0)+1)))}else{WH.error("Could not configure the responsive row.")}return}}}};$(window).resize(WH.Responsive.test);WH.Screenshots=new function(){const e=WH.User;const t=this;const a=Object.seal({warnedAboutStaffOnlyScreenshots:false});this.showStaffOnlyWarning=function(){if(!e.hasCapability(t.CAP_STAFF_ONLY_SCREENSHOTS)||a.warnedAboutStaffOnlyScreenshots){return}const i=WH.Admin.Debug;i.warn(i.TYPE_MESSAGE,"Markup on this page contains staff-only screenshots which the public cannot see.");a.warnedAboutStaffOnlyScreenshots=true}};function ss_submitAScreenshot(){tabsContribute.focus(1)}function ss_validateForm(e){if(!e.elements["screenshotfile"].value.length){alert(WH.TERMS.selectscreenshot_tip);return false}return true}function ss_appendSticky(){let e=WH.ge("infobox-sticky-ss");if(!e){return}let t=WH.inArray(lv_screenshots,1,(function(e){return e.sticky}));if(t<0&&lv_screenshots.length){t=0;for(let e=1;e<lv_screenshots.length;e++){if(Date.parse(lv_screenshots[e].date)>Date.parse(lv_screenshots[t].date)){t=e}}}if(t!=-1){e.className="has-thumb";let a=lv_screenshots[t];let i=WH.ce("a");i.href="#screenshots:id="+a.id;i.onclick=function(e){ScreenshotViewer.show({screenshots:lv_screenshots,pos:t});return WH.rfWithoutControlKey(e)};let n=[300,300];let s=WH.ce("img");let r=Math.min(n[0]/a.width,n[1]/a.height);s.src=WH.getScreenshotUrl(a.id,"small",{imageType:a.imageType});s.width=Math.round(r*a.width);s.height=Math.round(r*a.height);s.className="border";WH.ae(i,s);WH.ae(e,i);$("#infobox-screenshots").append(" ("+lv_screenshots.length+")").wrapInner($('<a href="#screenshots"></a>').click((function(){tabsRelated.focus(tabsRelated.getTabById("screenshots"));return false})))}else{let t=WH.ce("div");let a=WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.submitone_stc));if(!g_user.id){a.href=WH.Url.generatePath(WH.Url.getLoginPath())}t.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,a.outerHTML);if(g_user.id>0){a=t.querySelector("a");WH.aE(a,"click",(function(){ss_submitAScreenshot()}))}WH.ae(e,t);let i=WH.Wow.ModelViewer.getModelScreenshotUrl();if(i){let t=WH.ce("img",{src:i,width:300,height:300,className:"border",style:{display:"none"},id:"sticky-screenshot-model-substitute"});WH.aE(t,"load",(function(){t.style.display="";e.classList.add("has-thumb-substitute")}));WH.aE(t,"error",(function(){t.style.display="none";e.classList.remove("has-thumb-substitute")}));WH.ae(e,t)}}ss_appendSticky=function(){}}var g_screenshots={};window.ScreenshotViewer=new function(){const e=WH.Device;const t=WH.DOM;const a=170-Lightbox.BLEED_SIZE;const i=20;const n=50;var s,r,o,l,c,u,d,f=0,h,p,m,H,g,W,E,_,T,v,S,b,y,I="screenshots";let A;let R;function N(e){var t=s[e],a="#"+I;if(f==0)a+=t?":id="+t.id:"";else a+=":"+h+":"+(t?e+1:e+.5);return a}function w(e){var t="";if(typeof g_gathered_types=="object"&&g_gathered_types[e.type]&&g_gathered_types[e.type][e.typeId]&&g_gathered_types[e.type][e.typeId]["name_"+Locale.getName()]){t=g_gathered_types[e.type][e.typeId]["name_"+Locale.getName()]}else if(typeof g_pageInfo=="object"&&g_pageInfo.type&&g_pageInfo.typeId&&g_pageInfo.name){t=g_pageInfo.name}if(e.caption){if(t){t+=WH.TERMS.hyphen_punct+e.caption}else{t=e.caption}}return t}function C(t){clearTimeout(y);q();if(t&&!u&&window.innerHeight>p.offsetHeight+Lightbox.BLEED_SIZE){return}p.style.visibility="hidden";var a=s[r];var i=w(a);var n=a.url||WH.getScreenshotUrl(a.id,"normal",{description:i,imageType:a.imageType,staffOnly:a.staffOnly});var d='<img src="'+n+'"'+' width="'+l+'"'+' height="'+c+'"'+">";H.innerHTML=d+'<div class="screenshotviewer-image-inner" style="padding-top:'+c/l*100+'%"></div>';if(!t){WH.Track.interactiveEvent({category:"Screenshots",action:"Show",label:a.id+(a.caption&&a.caption.length?` (${a.caption})`:"")});if(a.staffOnly){_.href="javascript:";R=n}else{_.href=n;R=null}_.style.display="block";if(A){A.dataset.screenshot=a.id}if(!a.user&&typeof g_pageInfo=="object")a.user=g_pageInfo.username;var f=a.date&&a.user,h=s.length>1;if(f){var m=new Date(a.date),S=(WH.getServerTime()-m)/1e3;var b=T.firstChild.childNodes[1];b.href=WH.Url.generatePath("/user="+a.user);b.innerHTML=a.user;var I=T.firstChild.childNodes[3];WH.ee(I);I.removeAttribute("class");I.removeAttribute("title");WH.formatDate(I,S,m);T.firstChild.title=WH.TERMS.from+a.user+" "+WH.formatDate(null,S,m);T.firstChild.style.display=""}else T.firstChild.style.display="none";var I=T.childNodes[1];WH.ee(I);if(a.user){if(f)WH.ae(I,WH.ct(" "+WH.TERMS.dash_punct+" "));var b=WH.ce("a");b.href="javascript:";b.onclick=ContactTool.show.bind(ContactTool,{mode:3,screenshot:a});b.className="fa fa-exclamation-triangle fa-size-s";WH.Tooltips.attach(b,WH.TERMS.reportingoptions_tip,"q2");WH.ae(b,WH.ct(WH.TERMS.report));WH.ae(I,b)}I=T.childNodes[2];if(h){var C="";if(a.user)C=WH.TERMS.dash_punct;if(r%1!=0){C+=WH.sprintf(WH.TERMS.advertisementbetweenimages_tip,r+.5,r+1.5,s.length)}else{C+=r+1+WH.TERMS.of_lc+s.length}I.innerHTML=C;I.style.display=""}else I.style.display="none";T.style.display=f||h?"":"none";if(Locale.getId()!=LOCALE_ENUS&&a.caption)a.caption="";var O=a.caption!=null&&a.caption.length;var L=a.subject!=null&&a.subject.length&&a.type&&a.typeId;if(O||L){d="";if(L){var D=WH.ce("div");WH.ae(D,WH.ct(WH.Types.getUpperSingular(a.type)+WH.TERMS.colon_punct));WH.ae(D,WH.ce("a",{href:WH.Entity.getUrl(a.type,a.typeId)},WH.ct(a.subject)));d+=D.innerHTML}var k=document.createDocumentFragment();if(O){if(L){d+=WH.TERMS.dash_punct}k=a.noMarkup?document.createTextNode(a.caption):WH.markup.getDomFragment(a.caption,{mode:WH.markup.MODE.SIGNATURE})}$(v).html(d).append(k);v.style.display=""}else v.style.display="none";if(s.length>1){W.href=N(M(-1));E.href=N(M(1));W.style.display=E.style.display=""}else{W.style.display=E.style.display="none"}if(r!==o||e.isTouch()){g.style.display="none"}location.replace(N(r))}Lightbox.reveal();p.style.visibility="visible"}function M(e){var t=r;t+=e;if(t<0)t=s.length-1;else if(t>=s.length)t=0;return t}function O(e){r=M(e);x();return false}function L(e){switch(e.keyCode){case 37:O(-1);break;case 39:O(1);break}}function D(){C(1)}function k(){U();if(s.length>1)WH.dE(document,"keyup",L);if(d&&f==0){if(d.indexOf(":id=")!=-1)d="#"+I;WH.setHash(d)}else WH.clearHash()}function P(e,t,a){if(typeof a.screenshots=="string"){s=g_screenshots[a.screenshots];f=1;h=a.screenshots}else{s=a.screenshots;f=0;h=null}p=e;r=0;if(a.pos&&a.pos>=0&&a.pos<s.length)r=a.pos;o=r;if(t){e.className+=" has-lightbox-caption screenshotviewer";m=WH.ce("div");m.className="lightbox-content screenshotviewer-screen";g=WH.ce("div");g.className="screenshotviewer-keystip";g.innerHTML=WH.TERMS.sceenshotviewerkeys_tip;WH.ae(e,g);var i=WH.ce("div");var n=WH.ce("div");i.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";n.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";W=WH.ce("a",{ariaLabel:WH.TERMS.previous,className:"screenshotviewer-prev",dataset:{disableWowheadTooltip:"true"},href:"javascript:"});E=WH.ce("a",{ariaLabel:WH.TERMS.next,className:"screenshotviewer-next",dataset:{disableWowheadTooltip:"true"},href:"javascript:"});var l=WH.ce("span");l.className="fa fa-chevron-left";WH.ae(W,l);l=WH.ce("span");l.className="fa fa-chevron-right";WH.ae(E,l);WH.aE(W,"click",O.bind(W,-1));WH.aE(W,"tap",O.bind(W,-1));WH.aE(E,"click",O.bind(E,1));WH.aE(E,"tap",O.bind(E,1));WH.ae(i,W);WH.ae(n,E);WH.ae(m,i);WH.ae(m,n);H=WH.ce("div",{className:"screenshotviewer-image",innerHTML:'<div class="screenshotviewer-image-inner"></div>'});WH.ae(m,H);WH.ae(e,m);var c=WH.ce("a");c.className="dialog-option fa fa-times";c.href="javascript:";c.onclick=Lightbox.hide;WH.ae(c,WH.ct(WH.TERMS.close));WH.ae(e,c);_=WH.ce("a");_.className="dialog-option fa fa-external-link";_.href="javascript:";_.target="_blank";WH.ae(_,WH.ct(WH.TERMS.original));WH.ae(e,_);WH.aE(_,"click",(e=>{if(!R){return}e.preventDefault();let t=WH.ce("form",{action:R,method:"POST",style:{display:"none"}});WH.ae(document.body,t);t.submit()}));if(WH.User.hasRole(WH.User.ROLE_GROUP_STAFF)){A=WH.ce("a",{className:"dialog-option fa fa-copy",href:"javascript:"},WH.ct(WH.TERMS.markuptag));WH.ae(e,A);WH.clickToCopy(A,(()=>`[screenshot id=${A.dataset.screenshot} width=250 size=normal][/screenshot]`))}var u=WH.ce("div",{className:"lightbox-caption"});T=WH.ce("div");T.className="screenshotviewer-from";var S=WH.ce("span");WH.ae(S,WH.ct(WH.TERMS.from));WH.ae(S,WH.ce("a"));WH.ae(S,WH.ct(" "));WH.ae(S,WH.ce("span"));WH.ae(T,S);WH.ae(T,WH.ce("span"));WH.ae(T,WH.ce("span"));WH.ae(u,T);v=WH.ce("div");v.className="screenshotviewer-caption";WH.ae(u,v);WH.ae(e,u)}d=location.hash;if(s.length>1)WH.aE(document,"keyup",L);x()}function x(){var e=s[r];if(e&&(!e.width||!e.height)){if(S){S.onload=null;S.onerror=null}else{p.className="";b=[];while(p.firstChild){b.push(p.firstChild);WH.de(p.firstChild)}}clearTimeout(y);y=setTimeout((function(){e.width=126;e.height=22;q();e.width=null;e.height=null;var t=WH.ce("div");t.className="screenshotviewer-loading";var a=WH.ce("img");a.src=WH.staticUrl+"/images/ui/misc/progress-anim.gif";a.width=126;a.height=22;WH.ae(t,a);WH.ae(p,t);Lightbox.reveal();p.style.visiblity="visible"}),150);S=new Image;S.onload=function(e,t){clearTimeout(t);e.width=this.width;e.height=this.height;S=null;F();C()}.bind(S,e,y);S.onerror=function(e){clearTimeout(e);S=null;Lightbox.hide();F()}.bind(S,y);S.src=e.url||WH.getScreenshotUrl(e.id,"normal",{description:w(e),imageType:e.imageType,staffOnly:e.staffOnly})}else C()}function U(){if(!S)return;S.onload=null;S.onerror=null;S=null;F()}function F(){if(!b)return;WH.ee(p);p.className="lightbox-frame has-lightbox-caption screenshotviewer";for(var e=0;e<b.length;++e)WH.ae(p,b[e]);b=null}function q(){let e=s[r];l=e.width;c=e.height;let o=l;let d=window.innerWidth-Lightbox.BLEED_SIZE-a-i;let f=Math.min(l,d);u=false;if(f<l){u=true;o=f}let h=f*(c/l);let p=h+Lightbox.BLEED_SIZE+n;if(p>window.innerHeight){u=true;let e=window.innerHeight-Lightbox.BLEED_SIZE-n-10;o=e*(l/c)}Lightbox.setSize(Math.floor(o+i));t.setRelativeHeight(WH.qs(".screenshotviewer-image-inner",H),l,c)}this.getScreenshotDescription=function(e){return w(e)};this.checkPound=function(){if(location.hash&&location.hash.indexOf("#"+I)==0){if(!g_listviews[I]){var e=location.hash.split(":");if(e.length==3){var t=g_screenshots[e[1]],a=parseInt(e[2]);if(t&&a>=1&&a<=t.length){ScreenshotViewer.show({screenshots:e[1],pos:a-1,hashname:I})}}}}};this.show=function(e){if("hashname"in e){I=e.hashname;delete e.hashname}Lightbox.show("screenshotviewer",{onShow:P,onHide:k,onResize:D},e)};$(document).ready(this.checkPound)};WH.ScrollFade=function(e){const t={elements:{container:e}};const a=()=>{const e=WH.ce("div",{className:"vertical-scroll-shadow"});const a=WH.ce("div",{className:"horizontal-scroll-shadow"});WH.ae(t.elements.container,e);WH.ae(t.elements.container,a);i(a,e);t.elements.container.addEventListener("scroll",(()=>i(a,e)));t.elements.container.addEventListener("wheel",(e=>{if(t.elements.container.scrollWidth>t.elements.container.clientWidth&&t.elements.container.scrollHeight<=t.elements.container.clientHeight){e.preventDefault();const a=.3;const i=e.deltaY*a;t.elements.container.scrollLeft+=i}}));WH.aE(t.elements.container,"resize",(()=>i(a,e)))};const i=(e,a)=>{const i=t.elements.container.scrollLeft;const n=t.elements.container.scrollWidth-t.elements.container.clientWidth-5;const s=t.elements.container.scrollTop;const r=t.elements.container.scrollHeight-t.elements.container.clientHeight-5;if(t.elements.container.scrollWidth<=t.elements.container.clientWidth){e.classList.remove("shadow-left","shadow-right")}else{e.classList.toggle("shadow-left",i>0);e.classList.toggle("shadow-right",i<n)}if(t.elements.container.scrollHeight<=t.elements.container.clientHeight){a.classList.remove("shadow-top","shadow-bottom")}else{a.classList.toggle("shadow-top",s>0);a.classList.toggle("shadow-bottom",s<r)}};a(e)};WH.Seo=new function(){const e={[WH.dataEnv.MAIN]:"live",[WH.dataEnv.PTR]:"ptr",[WH.dataEnv.PTR2]:"ptr",[WH.dataEnv.BETA]:"beta",[WH.dataEnv.CLASSIC]:"classicSeasonOfDiscovery",[WH.dataEnv.TBC]:"tbcClassic",[WH.dataEnv.D2]:"diablo2",[WH.dataEnv.DI]:"diabloImmortal",[WH.dataEnv.WRATH]:"wrathClassic_short",[WH.dataEnv.D4]:"diablo4_seo",[WH.dataEnv.CATA]:"cataClassic",[WH.dataEnv.MISTS]:"mistsClassic_seo",[WH.dataEnv.D4PTR]:"diablo4ptr_seo",[WH.dataEnv.D4BETA]:"diablo4beta_seo",[WH.dataEnv.CLASSICPTR]:"classicptr"};this.addJsonLdBreadcrumb=function(e){var t=WH.Url.getCanonicalPath().replace(/[?&].*$/,"");var a=false;var i={"@context":"http://schema.org","@type":"BreadcrumbList",itemListElement:[]};var n=function(e,n){var s={"@type":"ListItem",position:e+1,item:{name:n.name}};if(n.url){s.item["@id"]=n.url;if(WH.Url.getPathFromUrl(n.url).indexOf(t)>=0){a=true}}if(n.image){s.item.image=WH.ensureUrlProtocol(n.image)}i.itemListElement.push(s)};for(var s=0,r=e.length;s<r;s++){n(s,e[s])}var o=WH.ge("json-ld-breadcrumbs");if(o){WH.de(o)}if(i.itemListElement.length){if(!a){var l=window.g_pageInfo?g_pageInfo.name:undefined;if(!l){var c=WH.qsa(".heading-size-1");if(c.length===1){l=c[0].textContent}}if(l){n(s,{name:l,url:WH.Url.getCanonical(),image:undefined})}}WH.ae(document.head,WH.ce("script",{id:"json-ld-breadcrumbs",text:JSON.stringify(i),type:"application/ld+json"}))}};this.getDataEnvName=t=>WH.TERMS[e[t]];this.slugId=function(e,t){let a=WH.Strings.slug(t);return(a?a+"-":"")+e.toString()};function t(){var e=WH.qsa('script[type="application/ld+json"]')||[];for(var t=0,a=e.length;t<a;t++){try{var i=JSON.parse(e[t].textContent)}catch(e){continue}if(i.mainEntityOfPage&&i.image&&i.image.url){return i.image.url}}return undefined}function a(){if(!WH.User.hasCapability(WH.User.CAP_SEO_INFO)&&!WH.isDev()){return}if(WH.PageMeta.skipSeoValidation){return}WH.onLoad(i)}function i(){if(!document.title){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No page title!")}$((function(){setTimeout((function(){if(!WH.PageMeta.skipSeoHeadingValidation&&!WH.qs("h1")){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No H1!")}}),1e3)}));var e=$('meta[name="description"]').attr("content");if(e){var t='[span class="q0"]SEO Description:[/span] '+e.replace("[","\\[");var a=false;if(e.length<130){t+=' [span class="q0"](short)[/span]';a=true}else if(e.length>160){t+=' [span class="q0"](long)[/span]';a=true}if(WH.Strings.hasReplacementValues(e)){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,t,true)}else if(a){WH.Admin.Debug.warn(WH.Admin.Debug.TYPE_SEO,t,true)}}else{WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No SEO description!")}}requestAnimationFrame(a)};WH.ShareServices=new function(){const e=this;this.getShareServices=function(e,a){let i=[];let n=["vkontakte","bluesky","facebook","reddit","permalink"];for(let s=0,r=n.length;s<r;s++){let r=n[s];if(r==="vkontakte"&&Locale.getId()!==LOCALE_RURU){continue}let o=WH.ShareServices.getShareUrl(r,e,a);if(o===""){continue}i.push({type:r,name:WH.TERMS[r],url:o,fontIcon:t(r)})}return i};this.getShareUrl=function(e,t,a){let i=encodeURIComponent(t);switch(e){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u="+i;case"reddit":if(a===undefined){return""}return"//www.reddit.com/r/"+a+"/submit?url="+i;case"bluesky":return"https://bsky.app/intent/compose?text="+i;case"vk":return"https://vk.com/share.php?url="+i;case"permalink":return t}WH.error("Tried to get the URL to share to an unknown service.",e);return""};this.getSubredditByGame=e=>{switch(e){case WH.Game.D2:return"diablo2";case WH.Game.DI:return"DiabloImmortal";case WH.Game.D4:return"diablo4";default:return"wow"}};this.getSubredditByNewsType=function(e){switch(e){case 14:return"diablo2";case 15:return"DiabloImmortal";case 6:case 16:return"diablo4";case 7:return"overwatch";case 11:return"hearthstone";case 12:return"heroesofthestorm";case 13:return"starcraft";case 1:case 2:case 3:case 4:case 5:case 8:case 9:case 10:case 17:case 20:case 21:case 22:return"wow";case 18:return"warcraftrumble";default:return null}};function t(e){return{bluesky:{prefix:"fab",name:"bluesky"},facebook:{prefix:"fab",name:"facebook"},permalink:{prefix:"fas",name:"link"},reddit:{prefix:"fab",name:"reddit-alien"},vkontakte:{prefix:"fab",name:"vk"}}[e]||e}};var ShowOnMap=function(e,t,a){const i=this;i.data=e;i.currentPath=[];if(t==null)t=myMapper;i.mapper=t;i._legend=null;i._legendLabel=null;i._legendContents=null;i._legendHorde=null;i._legendAlliance=null;i._menu=[];i._trackingIcons=[];i._controlsdiv=a?$(typeof a=="string"?"#"+a:a):$("#lenrlkn4");i.construct()};ShowOnMap.prototype.onExpand=function(){this.expanded=true;location.replace(this.pound+".map")};ShowOnMap.prototype.onCollapse=function(){this.expanded=false;var e=WH.getHash();if(e.indexOf("#show")==0&&e.indexOf(".map")>0){this.pound=e.substr(0,e.indexOf(".map"));location.replace(this.pound)}};ShowOnMap.prototype.construct=function(){if(!this.data)return;var e=this._controlsdiv;var t=function(e,t){return WH.stringCompare(e[1],t[1])};var a=[];var i=[];for(var n in this.data){if(this.data[n].length===undefined){var s=[];var r=[];var o={};var l=this.data[n];for(var c in l){var u=false;for(var d=0,f=l[c].length;d<f;++d){if(l[c][d].paths){u=true;break}}var h=WH.Strings.slug(c);if(l[c][0].name_enus!==undefined){h=WH.Strings.slug(l[c][0].name_enus)}var p={};var m={};var H=[h];var g=ShowOnMap.combinePins(l[c],false,u);var W=g[0];var E=g[1];var _=0;for(var d=0;d<W.length;++d){var T=W[d];var v=ShowOnMap.buildTooltip(T.list);var S=v[2];var b=null;if(S=="javascript:")b=v[3];if(T.list.length==1){S=WH.Types.getDetailPageName(T.list[0].type)&&T.list[0].id?WH.Entity.getUrl(T.list[0].type,T.list[0].id):""}if(n=="rare"||n=="herb"||n=="vein")v[1]=s.length+1;if(p[T.level]==undefined)p[T.level]=[];p[T.level].push([T.coord[0],T.coord[1],{url:S,label:v[0],menu:b,type:v[1],lines:T.list[0].paths}]);_++}if(_>0){var S=WH.Types.getDetailPageName(l[c][0].type)&&l[c][0].id?WH.Entity.getUrl(l[c][0].type,l[c][0].id):"";m[s.length+1]=[c,S];H.push(c+WH.sprintf(WH.TERMS._paren,E));H.push(this.showStuff.bind(this,p,[n,h],m));s.push(H);for(var y in p){if(r[y])r[y]=r[y].concat(p[y]);else r[y]=p[y]}o[s.length]=[c,S]}}if(s.length>0){s.sort(t);var H=[n,ShowOnMap.getPinTypeName(n),this.showStuff.bind(this,r,[n],o),s];this._menu.push(H);var I=[[null,ShowOnMap.getPinTypeName(n)],["all",WH.TERMS.all,H[2]]];for(x=0;x<s.length;x++)I.push(s[x]);this._trackingIcons.push([n,undefined,o,I])}}else{if(this.data[n].length==0)continue;var u=false;for(var d=0,f=this.data[n].length;d<f;++d){if(this.data[n][d].paths){u=true;break}}var H=[n];var p={};var A={},R={};var N={},w={};var m={};var C={};var M={};var g=ShowOnMap.combinePins(this.data[n],false,u);var E=g[1];var _=0,O=0,L=0,D=0,k=0;var P=function(e,t){for(var a=0;a<t.length;++a){var i=t[a];var s=e;i.list.key=n;var r=ShowOnMap.buildTooltip(i.list,e=="hordedailyquests"||e=="alliancedailyquests"?true:false);var o=r[2];var l=null;if(o=="javascript:")l=r[3];if(i.list.length==1)o=WH.Types.getDetailPageName(i.list[0].type)&&i.list[0].id?WH.Entity.getUrl(i.list[0].type,i.list[0].id):"";var c=[i.coord[0],i.coord[1],{url:o,label:r[0],menu:l,type:r[1],lines:i.list[0].paths}];if(p[i.level]==undefined){p[i.level]=[];A[i.level]=[];R[i.level]=[];N[i.level]=[];w[i.level]=[]}if(i.list[0].mapicon){c[2].mapicon=i.list[0].mapicon}if(s!="mailbox"&&s!="vignettes"&&s!="rare"&&s!="spirithealer"&&s!="book"&&s!="forge"&&s!="treasure"&&s!="anvil"&&s!="hordequests"&&s!="alliancequests"&&s!="hordedailyquests"&&s!="alliancedailyquests"&&s!="boss"){if(r[1]==2||r[1]==0){if(r[1]==2)C[2]=[WH.TERMS.horde,null];else C[0]=[WH.TERMS.neutral,null];A[i.level].push(c);O++}if(r[1]==3||r[1]==0){if(r[1]==3)M[3]=[WH.TERMS.alliance,null];else M[0]=[WH.TERMS.neutral,null];N[i.level].push(c);D++}}else if(s=="hordequests"){s="quest";if(r[1]==2)C[2]=[WH.TERMS.horde,null];else C[0]=[WH.TERMS.neutral,null];A[i.level].push(c);O++}else if(s=="hordedailyquests"){s="daily";if(r[1]==2)C[2]=[WH.TERMS.horde,null];else C[0]=[WH.TERMS.neutral,null];R[i.level].push(c);L++}else if(s=="alliancequests"){s="quest";if(r[1]==3)M[3]=[WH.TERMS.alliance,null];else M[0]=[WH.TERMS.neutral,null];N[i.level].push(c);D++}else if(s=="alliancedailyquests"){s="daily";if(r[1]==3)M[3]=[WH.TERMS.alliance,null];else M[0]=[WH.TERMS.neutral,null];w[i.level].push(c);k++}else{p[i.level].push(c);_++}}return s};var U=P(n,g[0]);if(n=="alliancequests"){var F=ShowOnMap.combinePins(this.data[n],true);if(F[1]>0)P("alliancedailyquests",F[0])}else if(n=="hordequests"){var q=ShowOnMap.combinePins(this.data[n],true);if(q[1]>0)P("hordedailyquests",q[0])}if(U=="rare")E=this.data[U].length;else if(U=="forge"||U=="anvil"||U=="treasure"||U=="mailbox")E=g[0].length;if(_>0){var H=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,E),this.showStuff.bind(this,p,[U],m)];this._menu.push(H);this._trackingIcons.push([U,p,m])}if(O>0){var H=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,O),this.showStuff.bind(this,A,["horde",U],C),null];if(U=="quest"){H.push({tinyIcon:"quest_start"});if(L>0){i.push(H);H=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,L),this.showStuff.bind(this,R,["horde","daily"],C),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",R,C])}}i.push(H);this._trackingIcons.push([U,A,C])}if(D>0){var H=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,D),this.showStuff.bind(this,N,["alliance",U],M),null];if(U=="quest"){H.push({tinyIcon:"quest_start"});if(k>0){a.push(H);H=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,k),this.showStuff.bind(this,w,["alliance","daily"],M),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",w,M])}}a.push(H);this._trackingIcons.push([U,N,M])}}}a.sort(t);i.sort(t);this._menu.sort(t);if(i.length>0)this._menu.unshift(["horde",WH.TERMS.horde,"",i,{tinyIcon:"side_horde"}]);if(a.length>0)this._menu.unshift(["alliance",WH.TERMS.alliance,"",a,{tinyIcon:"side_alliance"}]);var Y=[-1,WH.TERMS.nothing,this.showStuff.bind(this,[],[-1],{})];Y.checked=true;this._menu.push(Y);var B=WH.createButton(WH.TERMS.showonmap_ellipsis,null,{class:"mapper-som-button fa fa-search"});Menu.add(B,this._menu,{showAtElement:true});e.append(B);var G;if(!this._legend){this._legend=$("<div/>",{class:"mapper-legend",css:{display:"none"}});var V=$("<div/>",{class:"mapper-legend-container"});this._legendLabel=WH.ce("b",undefined,WH.ct(WH.TERMS.symbolLegend));V.append(this._legendLabel);this._legendContents=$("<div/>",{css:{float:"right"}});V.append(this._legendContents);var G=$("<div/>",{css:{clear:"right"}});V.append(G);this._legend.append(V)}e.append(this._legend);G=$("<div/>",{css:{clear:"left"}});e.append(G);this.setTrackingIcons();var z=[];var K=WH.getHash();if(K.indexOf("#show:")!=-1){z=K.split(".")}else if(this.data.instance){z.push("#show:boss")}if(z.length>0){if(z.length==2&&z[1]=="map"){this.expanded=true;this.mapper.toggleZoom()}var j=z[0].split(":");if(j.length<2)return;var Z=this._menu;for(var d=1;d<j.length;++d){var X=j.length-1;for(var c=0;c<Z.length;++c){if(Z[c][0]==j[d]){if(Z[c][3]&&d<X)Z=Z[c][3];else Z=Z[c];break}}}if(Z&&Z[2]&&jQuery.isFunction(Z[2]))Z[2]()}};ShowOnMap.prototype.setTrackingIcons=function(){var e=this.mapper.parent;var t={repair:"repair",auctioneer:"auctioneer",banker:"banker",battlemaster:"battlemaster",innkeeper:"inn",guildmaster:"guild",stablemaster:"stablemaster",flightmaster:"flightmaster",trainer:"trainer-profession",vendor:"vendor-food",quest:"quest",daily:"daily",anvil:"blacksmithing",herb:"herbalism",vein:"mining",book:"trainer-class",forge:"smelting",spirithealer:"spirithealer",boss:"boss",rare:"hostile-npc",vignettes:"resource",treasure:"treasure",mailbox:"mailbox"};var a=[{name:WH.Types.getUpperPlural(WH.Types.NPC),icons:["repair","auctioneer","banker","battlemaster","innkeeper","guildmaster","stablemaster","flightmaster","trainer","vendor","spirithealer","boss","rare"],elements:[]},{name:WH.Types.getUpperPlural(WH.Types.QUEST),icons:["quest","daily"],elements:[]},{name:WH.GlobalStrings.TRADE_SKILLS,icons:["anvil","herb","vein","book","forge"],elements:[]},{name:WH.TERMS.loot,icons:["vignettes","treasure"],elements:[]},{name:WH.TERMS.other,icons:["mailbox"],elements:[]}];var i=this._trackingIcons;i.sort((function(e,t){return WH.stringCompare(e[0],t[0])}));for(var n=1;n<i.length;n++){if(i[n][0]==i[n-1][0]){var s={};for(var r in i[n][1]){if(!i[n][1].hasOwnProperty(r))continue;s[r]=i[n][1][r]}for(r in i[n-1][1]){if(!i[n-1][1].hasOwnProperty(r))continue;if(!s.hasOwnProperty(r))s[r]=i[n-1][1][r];else s[r]=s[r].concat(i[n-1][1][r])}i[n-1][1]=s;var o={};for(var l in i[n][2]){if(!i[n][2].hasOwnProperty(l))continue;o[l]=i[n][2][l]}for(l in i[n-1][2]){if(!i[n-1][2].hasOwnProperty(l))continue;o[l]=i[n-1][2][l]}i[n-1][2]=o;i.splice(n--,1)}}i.sort((function(e,t){return WH.stringCompare(ShowOnMap.getPinTypeName(e[0]),ShowOnMap.getPinTypeName(t[0]))}));var c=WH.ce("div",{className:"mapper-legend-icons"});for(var u=0,d;d=i[u];u++){if(!t.hasOwnProperty(d[0]))continue;var f=WH.ce("div");f.className="mapper-legend-icon "+t[d[0]];f.setAttribute("data-legend-icon",d[0]);f.onmousedown=WH.rf;if(d[1]){var h=[d[0]];if(d[0]!="vignettes"&&d[0]!="treasure"){h.splice(0,0,-2)}WH.aE(f,"click",this.showStuff.bind(this,d[1],h,d[2],f))}if(d[3]){Menu.add(f,d[3],{showAtElement:true})}WH.Tooltips.attachNonTouch(f,ShowOnMap.getPinTypeName(d[0]));var p=false;for(var m=0,H;H=a[m];m++){if(H.icons.indexOf(d[0])>-1){p=true;a[m].elements.push(f);break}}if(!p){WH.error("Could not find group for map icon.",d[0])}}for(var g=0,W;W=a[g];g++){if(W.elements.length){var E=WH.ce("div",{className:"mapper-legend-icons-group"});var _=WH.ce("div",{className:"mapper-legend-icons-heading",innerHTML:W.name});var T=WH.ce("div",{className:"mapper-legend-icons-icons"});if(W.style){for(var v in W.style){if(W.style.hasOwnProperty(v)){E.style[v]=W.style[v]}}}for(var S=0,b;b=W.elements[S];S++){WH.ae(T,b)}WH.ae(E,_);WH.ae(E,T);WH.ae(c,E)}}var y=WH.ce("div",{className:"mapper-legend-icons-tip",innerHTML:WH.TERMS.clickicontoshowonmap_tip});$("> span:first-child",this.mapper.parent).append(y);WH.ae(e,c);e.className+=" mapper-autoheight"};ShowOnMap.prototype.setLegend=function(e){this._legendContents.empty();var t=$("<div/>");var a=0;for(var i in e){var n=$("<span/>",{class:"mapper-pin mapper-pin-"+i+" mapper-legend-pin"});if(e[i][1]){var s=$("<a/>",{href:e[i][1],text:e[i][0]});n.append(s)}else n.text(e[i][0]);t.append(n);if(++a%4==0)t.append($("<br/>"))}this._legendContents.append(t)};ShowOnMap.prototype.showStuff=function(e,t,a){if(WH.isEqualSimpleObject(t,this.currentPath)){this.showStuff.call(this,[],[-1],{});return}Menu.hide();var i=false;for(var n=0,s;s=t[n];n++){if(typeof s!="string"){continue}let e=$('[data-legend-icon="'+s+'"]',this.mapper.parent);if(e.length){e.parents(".mapper-legend-icons").find(".mapper-legend-icon").removeClass("active");e.addClass("active");i=true;break}}if(!i){$(".mapper-legend-icon",this.mapper.parent).removeClass("active")}var r={coords:e,preservelevel:true};if(typeof g_pageInfo!="undefined"&&g_pageInfo.hasOwnProperty("id"))r.zone=g_pageInfo.id;this.mapper.update(r);this.setLegend(a);this.checkMenu(t);this.currentPath=t;if(t.length==1&&t[0]==-1||t[0]==-2){this.pound="";WH.clearHash();return}this.pound="#show:"+t.join(":");if(this.pound!="#show:boss")location.replace(this.pound+(this.expanded?".map":""))};ShowOnMap.prototype.clearChecks=function(e){for(var t=0;t<e.length;++t){e[t].checked=false;if(e[t][3]&&e[t][3].length>0)this.clearChecks(e[t][3])}this._legend.hide()};ShowOnMap.prototype.checkMenu=function(e){this.clearChecks(this._menu);if(e[0]!=-1)this._legend.show();else this._legend.hide();var t=this._menu;var a=[];for(var i=0;i<e.length;++i){for(var n=0;n<t.length;++n){if(t[n][0]==e[i]){t[n].checked=true;a.push([t[n][0],t[n][1]]);t=t[n][3];break}}}if(e[0]==-2){a.push([e[1],ShowOnMap.getPinTypeName(e[1])])}var s=a.length-1;var r="";var o={rare:true,herb:true,vein:true};for(var i=0;i<a.length;++i){if(i>0&&o[a[0][0]]){var l=$("span",this._legendContents);l.removeClass("mapper-legend-pin");l.append($("<b/>",{text:" "+a[i][1].substr(a[i][1].lastIndexOf("("))}))}else{if(i==s)r+="<span>";else r+='<span class="breadcrumb-arrow">';r+=a[i][1]+"</span>"}}this._legendLabel.innerHTML=r};ShowOnMap.combinePins=function(e,t,a){var i={};var n=null,s=null;var r,o;var l=0;var c=function(e,t){var a=Math.floor(e[0]);var n=Math.floor(e[1]);if(!t){if(a%2==1)a+=1;if(n%2==1)n+=1}if(i[a]===undefined)i[a]={};if(i[a][n]===undefined)i[a][n]=[];return[a,n]};for(var u=0;u<e.length;++u){var d=e[u];if(t){if(!d.quests)continue;var f=true;for(var h=0;h<d.quests.length;++h){if(d.quests[h].daily){f=false;break}}if(f)continue}else if(a&&d.id!=0){n=c([d.id,0],true);r=n[0];o=n[1];var p=WH.dO(d);p.coord=d.coords[0];i[r][o].push(p);l++;continue}if(d.point=="start"||d.point=="end"){n=c(d.coord);r=n[0];o=n[1];if(i[r][o].length>3){var m=i[r][o];i[r][o]=[];for(var H=0;H<m.length;++H){s=c(m[H].coord,true);i[s[0]][s[1]].push(m[H])}}i[r][o].push(d);l++}else{for(var g=0;g<d.coords.length;++g){n=c(d.coords[g]);r=n[0];o=n[1];var p=WH.dO(d);p.coord=d.coords[g];if(i[r][o].length>3){var m=i[r][o];i[r][o]=[];for(var H=0;H<m.length;++H){s=c(m[H].coord,true);i[s[0]][s[1]].push(m[H])}}i[r][o].push(p);l++}}}var W=[];for(r in i)for(o in i[r])W.push({coord:[i[r][o][0].coord[0],i[r][o][0].coord[1]],level:i[r][o][0].level,list:i[r][o]});return[W,l]};ShowOnMap.buildTooltip=function(e,t){var a="";var i="";var n=[];var s=-1;var r={};var o=0;var l={};var c=1;let u=undefined;for(var d=0;d<e.length;++d){var f=e[d];i=WH.Types.getDetailPageName(f.type)&&f.id?WH.Entity.getUrl(f.type,f.id):"";var h=i+f.item;var p=i+f.point;if(!r[h]){r[h]={url:i,obj:f,coords:[f.coord],all:[f]};if(f.tooltipCoord){r[h].tooltipCoord=f.tooltipCoord}else if(f.noTooltipCoord){r[h].noTooltipCoord=f.noTooltipCoord}o++}else{if(!l[p])r[h].all.push(f);r[h].coords.push(f.coord)}l[p]=1}var d=0;for(var h in r){var i=r[h].url;var m=r[h].all;var f=r[h].obj;var H=r[h].coords;if(d>0)a+="<br />";n.push([d++,f.name,i]);c=f.type;if(!f.point){if(f.reacthorde==1&&f.reactalliance<1||f.side==2){if(s==2||s==-1)s=2;else s=0}else if(f.reactalliance==1&&f.reacthorde<1||f.side==1){if(s==3||s==-1)s=3;else s=0}else s=0}a+='<b class="q'+(s==2?" icon-horde":"")+(s==3?" icon-alliance":"")+'">'+f.name+"</b>";if(!r[h].noTooltipCoord&&H.length>0){let e=r[h].tooltipCoord??H[0];a+=" ("+e[0]+", "+e[1]+")<br />"}if(f.quests){if(f.quests.length>1)a+=WH.TERMS.starsthefollowingquests_colon;else a+=WH.TERMS.startsthefollowingquest_colon;a+='<div class="indent">';for(var g=0;g<f.quests.length;++g){var W=f.quests[g];if(t&&!W.daily)continue;a+='<span class="q0">['+W.level+"]</span> "+W.name+(W.series&&!W.first?'<sup style="font-size: 8px">(*)</sup>':"")+(W.category<0&&WH.Wow.Quest.getCategoryName(W.category)?' <i class="q0">'+WH.Wow.Quest.getCategoryName(W.category)+"</i>":"")+"<br />"}a+="</div>"}else if(f.description)a+=f.description+"<br />";else if(f.point){for(var d=0;d<m.length;++d){var E=m[d];switch(E.point){case"start":a+=WH.TERMS.startsthequest_stc+"<br />";if(s=="end")s="startend";else if(s!="startend")s="start";break;case"end":a+=WH.TERMS.endsthequest_stc+"<br />";if(s=="start")s="startend";else if(s!="startend")s="end";break;case"sourcestart":a+=WH.TERMS.sourceofqueststart_colon+"<br />";a+='<div class="indent">'+E.item+"</div>";if(s=="end")s="startend";else if(s!="startend")s="start";break;case"sourceend":a+=WH.TERMS.sourceofquestend_colon+"<br />";a+='<div class="indent">'+E.item+"</div>";if(s=="start")s="startend";else if(s!="startend")s="end";break;case"requirement":a+=WH.TERMS.objectiveofthequest_stc+"<br />";if(s==-1)s=E.objective;break;case"sourcerequirement":a+=WH.TERMS.sourceofaquestobjective_colon+"<br />";a+='<div class="indent">'+E.item+"</div>";if(s==-1)s=E.objective;break}if(E.iconType){u=E.iconType}}}}a+='<div class="q2">';if(e.length==1)a+=e[0].type==1&&e[0].id!=0?WH.TERMS.clicktoviewthisnpc_stc:e[0].type==2&&e[0].id!=0?WH.TERMS.clicktoviewthisobject_stc:"";else if(o==1)a+=c==1&&f.id!=0?WH.TERMS.clicktoviewthisnpc_stc:c==2&&f.id!=0?WH.TERMS.clicktoviewthisobject_stc:"";else a+="<br />"+WH.TERMS.clicktoview_ellipsis;a+="</div>";var _=[];_.push(a);if(u&&(s==="start"||s==="end"||s==="startend")){s=WH.Wow.Quest.getQuestClass(s,u)}_.push(s);if(e.length==1||o==1){_.push(i);_.push(null)}else{_.push("javascript:");_.push(n)}return _};ShowOnMap.getPinTypeName=function(e){let t=ShowOnMap.getPinTypeName;return(t.nameMap=t.nameMap||WH.getPageData("maps.showOnMap.typeNames")||{})[e]||e};WH.SiteAchievement=new function(){const e=1;const t=2;const a=3;const i={};i[e]=WH.TERMS.copper;i[t]=WH.TERMS.silver;i[a]=WH.TERMS.gold;this.getQualityName=function(e){return i[e]}};(function(e){var t=3;var a=new Array;var i=2650;var n=e("<audio />").get(0),s=WH.staticUrl+"/sfx/wsa.wav",r=1,o=0,l=3,c;function u(t,a){if(a<=0){if(t==true||t=="true"){e("#wsa-overflow").fadeOut(1e3,(function(){e("#wsa-overflow").remove();r=1}))}else{e("#wsa-overflow").remove();r=1}clearInterval(c)}return a-1}function d(e,t,a){var i=new Date;i.setDate(i.getDate()+a);var n=escape(t)+(a==null?"":"; expires="+i.toUTCString());document.cookie=e+"="+n}function f(e){var t,a,i,n=document.cookie.split(";");for(t=0;t<n.length;t++){a=n[t].substr(0,n[t].indexOf("="));i=n[t].substr(n[t].indexOf("=")+1);a=a.replace(/^\s+|\s+$/g,"");if(a==e)return unescape(i)}}function h(){for(key in a)clearTimeout(a[key])}e((function(){e("body").delegate(".wsa-vol","click",(function(){e(this).toggleClass("alt");if(e(this).hasClass("alt")==true){e.post("/account/set-sound",{_csrf:WH.User.getSessionKey(),muted:1})}else{e.post("/account/set-sound",{_csrf:WH.User.getSessionKey(),muted:0})}})).delegate(".wsa-notification","mouseover mouseout",(function(t){if(t.type=="mouseover"){h();e(".wsa-notification").stop();e(this).css("z-index",15e5);if(e(this).attr("data-animated")=="true"){e(".wsa-notification").fadeTo(100,1)}}else{e(this).css("z-index",999999);if(e(this).attr("data-persistent")!="true"){e(".wsa-notification").each((function(t,i){var n=e(this).attr("id");if(e(this).attr("data-animated")=="true"){a[n]=setTimeout("$('#"+n+"').fadeOut(3000,function(){ $('#"+n+"').remove(); })",1e3)}else{a[n]=setTimeout("$('#"+n+"').remove()",3e3)}}))}}})).delegate(".wsa-notification","click",(function(t){if(!(e(t.target).is("a")||e(t.target).hasClass("wsa-vol"))){e(this).remove()}}))}));e.fn.wsaNotification=function(d){var f={caption:"??? No name",rank:1,href:WH.Url.generatePath("/user#achievements"),animate:true,playsfx:true,desc:"",persist:false};var d=e.extend(f,d);var h=e("body").children("#wsa-overflow").length;var p=e("body").children(".wsa-notification").length;if(p<t&&h==0){var m=new Date,m="wsan"+m.getTime();if(p!=o%t)o=0;var H=!d.playsfx;var g=d.rank==0?WH.TERMS.newprivilege:WH.sprintf(WH.TERMS.achievementunlocked_format,WH.SiteAchievement.getQualityName(d.rank));var W='<div class="wsa-notification" data-animated="'+d.animate+'" data-persistent="'+d.persist+'" style="bottom: '+(o%t*125+15).toString()+'px" id="'+m+'"><em></em><ins></ins><span class="wsar'+d.rank+'"></span><div><var><i>'+g+'</i><a title="'+d.desc+'" href="'+d.href+'">'+WH.TERMS.viewdetails+" &rarr;</a></var>"+WH.getImitationHeading(d.caption,2).outerHTML+"</div>"+'<div class="wsa-vol'+(H?" alt":"")+'"></div>'+"</div>";e("body").prepend(W);if(d.playsfx==true||d.playsfx=="true"){if(!e(n).attr("src"))e(n).attr("src",s);if(n.play){n.play()}else{e(".wsa-sound").remove();e("body").append('<embed class="wsa-sound" src="'+s+'" autostart="true" hidden="true" loop="false" />')}}if(d.animate==true||d.animate=="true"){e("#"+m+" em").css("filter","");e("#"+m+" em").fadeOut(750,(function(){e("#"+m+" em").remove()}));e("#"+m+" ins").delay(250).animate({marginLeft:"355px",opacity:0},750,(function(){e(this).remove();if(!d.persist)a[m]=setTimeout("$('#"+m+"').fadeOut(3000,function(){ $('#"+m+"').remove(); })",i)}))}else{e("#"+m+" em").remove();e("#"+m+" ins").remove();if(!d.persist)a[m]=setTimeout("$('#"+m+"').remove()",i+1e3)}o++}else{var W='<div class="wsa-overflow" id="wsa-overflow" style="bottom: 0px"><a href="'+WH.Strings.escapeHtml(WH.Url.generatePath("/user"))+'">'+WH.sprintf(WH.TERMS.wsamore_format,1)+"</a></div>";if(h==0){e("body").prepend(W);l=3;if(d.animate==true||d.animate=="true")e("#wsa-overflow").slideDown();else e("#wsa-overflow").show();c=setInterval((function(){l=u(d.animate,l)}),1e3)}else{l=3;r++;e("#wsa-overflow b").text(r)}}}})(jQuery);function AchievementCheck(){$.ajax({cache:false,url:WH.Url.generatePath("/ajax-achievement-check"),type:"POST",success:function(e){if(e&&e.length){for(var t=0;t<e.length;t++){$().wsaNotification(e[t])}}}})}var Slider=new function(){const e=this;var t;var a;var i;function n(e){a=this;t=WH.getCursorPos(e);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);return false}function s(e){if(!t||!a){return}var i=WH.getCursorPos(e);var n=i.x-t.x;var s=u(a,a._pos+n);var r=f(a);if(r&&a.elements.input){a.elements.input.value=r.value}if(!s){t=i}if(a.onMove){a.onMove(e,a,r)}}function r(e){if(a.onMove){a.onMove(e,a,f(a))}a=null;t=null;WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);return false}function o(e,i){a=e;t=WH.getCursorPos(i);var n=WH.ac(a.parentNode);var o=Math.floor(p(a)/2);u(a,t.x-n.x-o);var l=f(a);if(l&&a.elements.input){a.elements.input.value=l.value}if(a.onMove){a.onMove(i,a,l)}WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);return false}function l(e,t){if(i){clearTimeout(i)}if(t.type==="change"||t.type==="keypress"&&t.which===13){c(e,t)}else{i=setTimeout(c.bind(0,e,t),1e3)}}function c(e,t){let a=e.elements.input.value;let i=f(e);if(isNaN(a)){a=i.value}if(a>e._max){a=e._max}if(a<e._min){a=e._min}Slider.setValue(e,a);if(e.onMove){e.onMove(t,e,f(e))}}function u(e,t,a){let i=false;let n=d(e);if(t<0){t=0;i=true}else if(t>n){t=n;i=true}let s=p(e);if(!s&&typeof a==="number"){a=Math.min(Math.max(a,0),100)}else{a=parseFloat(t)/n;a-=s/h(e)*a;a*=100}e.elements.trackBarProgress.style.width=a+"%";e.style.left=a+"%";e._pos=t;return i}function d(e){return h(e)-p(e)}function f(e){var t=e._pos/d(e);var a=Math.round(t*(e._max-e._min)+e._min);var i=[t,a];i.percent=t;i.value=a;return i}function h(e){if(e._tsz>0){return e._tsz}return e.elements.track.offsetWidth}function p(e){return typeof e._hsz==="number"?e._hsz:e.offsetWidth}this.getInput=function(e){return e.elements.input};this.getPercent=function(e){return f(e).percent};this.getValue=function(e){return f(e).value};this.setMax=function(e,t){e._max=t;if(e.elements.maxLabel){WH.st(e.elements.maxLabel,t)}Slider.setValue(e,f(e).value)};this.setValue=function(e,t,a){if(t<e._min){t=e._min}else if(t>e._max&&a!==true){t=e._max}if(t>e._max){e.elements.container.classList.add("exceeded-max")}else{e.elements.container.classList.remove("exceeded-max")}if(e.elements.input){e.elements.input.value=t}let i=(t-e._min)/(e._max-e._min);u(e,d(e)*i,100*i)};this.setValueDisplay=function(e,t,a){if(!e.elements.values){WH.error("Can't set the slider value display, this slider doesn't support labels.",t,e);return}if(a){e.elements.values.dataset.completion=`${a}`}else{delete e.elements.values.dataset.completion}WH.ee(e.elements.values);WH.st(e.elements.values,t)};this.setSize=function(e,t){let a=f(e);let i=d(e);e.elements.container.style.width=t+"px";if(i!==d(e)){this.setValue(e,a.value)}};this.setTitle=function(e,t){if(!e.elements.labels){WH.error("Can't set the slider title, this slider doesn't support labels.",t,e);return}if(!e.elements.title){e.elements.title=WH.ce("span",{className:"slider-labels-title"});WH.aef(e.elements.labels,e.elements.title)}WH.ee(e.elements.title);WH.st(e.elements.title,t)};this.init=function(t,a){t.classList.add("slider");t.dataset.track=a.remaining?"remaining":"progress";let i=WH.ce("div",{className:"slider-track-handle",onmousedown:n});let s=WH.ce("div",{className:"slider-track",onmousedown:o.bind(0,i)});let r=WH.ce("div",{className:"slider-track-bar"});let c=WH.ce("div",{className:"slider-track-bar-progress"});WH.ae(t,s);WH.ae(s,i);WH.ae(s,r);WH.ae(r,c);i.elements={container:t,input:undefined,labels:undefined,maxLabel:undefined,title:undefined,track:s,trackBarProgress:c,values:undefined};i._min=1;i._max=100;i._pos=0;i._tsz=0;i._hsz=null;if(a!=null){if(a.minValue||a.minValue===0){i._min=a.minValue}if(a.maxValue){i._max=a.maxValue}if(a.onMove){i.onMove=a.onMove}if(a.trackSize){i._tsz=a.trackSize}if(typeof a.handleSize==="number"){i._hsz=a.handleSize}if(a.editable===false){t.classList.add("not-editable");i._hsz=0}if(a.hasOwnProperty("value")){e.setValue(i,a.value,true)}if(a.showLabels!==false){t.classList.add("has-labels");i.elements.labels=WH.ce("div",{className:"slider-labels"});WH.ae(t,i.elements.labels);i.elements.values=WH.ce("span",{className:"slider-labels-values"});WH.ae(i.elements.labels,i.elements.values);let n;if(a.valueDisplay!==undefined){e.setValueDisplay(i,a.valueDisplay);n=function(){}}else{let e=WH.ce("span",{className:"slider-labels-values-sizer"});WH.ae(i.elements.values,e);if(i._min!==1){let e=WH.ce("span",{className:"slider-labels-values-min"},WH.ct(WH.TERMS.minimum_abbrev+WH.TERMS.colon_punct+i._min));WH.ae(i.elements.values,e)}i.elements.input=WH.ce("input",{className:"slider-labels-values-input",value:a.hasOwnProperty("value")?a.value:i._max,type:"text"});if(a.editable===false){i.elements.input.disabled=true}WH.ae(i.elements.values,i.elements.input);i.elements.maxLabel=WH.ce("span",{className:"slider-labels-values-max"},WH.ct(i._max));WH.ae(i.elements.values,i.elements.maxLabel);n=function(){WH.st(e,i.elements.input.value);window.requestAnimationFrame((function(){i.elements.input.style.width=(e.offsetWidth||20)+"px"}))}}if(typeof a.title==="string"){e.setTitle(i,a.title)}n();$(i.elements.input).bind("focus",(function(){this.parentNode.classList.add("input-focused")})).bind("blur",(function(){this.parentNode.classList.remove("input-focused")})).bind("change",n).bind("click",(function(){this.select()})).bind("keypress",(function(e){let t=[];let a=e.which;for(let e=48;e<58;e++){t.push(e)}if(!(WH.inArray(t,a)>=0)&&a!==13){e.preventDefault()}n()})).bind("keyup keydown change",(function(e){l(i,e);if(e.which===13||e.which===27){this.blur()}n()}))}}return i}};WH.StatusWidget=function(e,t){const a=this;const i=["remaining","title","value","valueDisplay"];const n={elements:{container:undefined,info:undefined},slider:undefined,updateFunction:undefined};this.getElement=function(e){if(!n.elements.hasOwnProperty(e)){WH.error("Status widget element not found.",e)}return n.elements[e]};this.update=function(){if(n.updateFunction){n.updateFunction(n.slider,this)}};function s(e,t){n.elements.container=e;n.updateFunction=t.updateFunction;n.elements.container.classList.add("status-widget");let s={editable:false,maxValue:t.hasOwnProperty("maxValue")?t.maxValue:100,minValue:t.hasOwnProperty("minValue")?t.minValue:1};for(let e=0,a;a=i[e];e++){if(t.hasOwnProperty(a)){s[a]=t[a]}}let r=WH.ce("div",{className:"status-widget-slider"});WH.ae(n.elements.container,r);n.slider=Slider.init(r,s);n.elements.info=WH.ce("div",{className:"status-widget-info"});WH.ae(n.elements.container,n.elements.info);if(typeof t.updateFunction==="function"){if(typeof t.updateInterval==="number"){setInterval(a.update,t.updateInterval)}requestAnimationFrame(a.update)}}s.apply(this,arguments)};WH.Strings=new function(){const e=this;this.laquo="«";this.lsaquo="‹";this.nbsp=" ";this.ndash="–";this.raquo="»";this.rsaquo="›";this.shy="­";this.zwnj="‌";const t=80;const a={guidIndex:0,guidPrefix:undefined};this.camelKebab=function(e){return/(?=[A-Z])/[Symbol.split](e).map((function(e){return e.toLowerCase()})).join("-")};this.escapeHtml=function(e){return WH.ce("div",{},WH.ct(e)).innerHTML};this.escapeRegExp=function(e){return e.replace(/[\s\S]/g,(function(e){let t=e.charCodeAt(0).toString(16);let a=t.length>2;return"\\"+(a?"u":"x")+("0000"+t).slice(a?-4:-2)}))};this.formatNumber=function(e,t,a,i){a=a||0;i=i||a;var n=WH.Strings.formatNumber.supportsOptions;if(n===undefined){n=WH.Strings.formatNumber.supportsOptions=!!(typeof Intl=="object"&&Intl&&typeof Intl.NumberFormat=="function")}var s=e;if(!e instanceof Number){e=new Number(e)}if(isNaN(e)){WH.error("Tried to convert an invalid number",s);e=0}let r=function(e){return e.replace("-",/[1-9]/.test(e)?"-":"")};if(!n){if(t){e*=100}return r(e.toFixed(i)+(t?"%":""))}return r(e.toLocaleString(undefined,{style:t?"percent":"decimal",useGrouping:true,minimumFractionDigits:a,maximumFractionDigits:i}))};this.guid=function(){if(!a.guidPrefix){a.guidPrefix=["wowhead-guid",Date.now(),WH.getServerTime().valueOf(),e.hashCode(location.href),""].join("-")}return a.guidPrefix+a.guidIndex++};this.hashCode=function(e){let t=0;for(let a=0;a<e.length;a++){t=(t<<5)-t+e.charCodeAt(a);t|=0}return t};this.hasReplacementValues=function(e){return!!e.match(/(%[sd]|%\d+\$s|\$\d)/)};this.renderBlizzardUiEscapedString=function(e,t={}){let a=document.createDocumentFragment();e=e.replace(/\|{2,}/g,"|");let i=-1;while(e.length){if(e.length===i){WH.error("Could not process Blizzard UI text: "+e);break}i=e.length;let n=e.indexOf("|");if(n<0){WH.ae(a,WH.ct(e));e="";continue}let s="";if(n>0){WH.ae(a,WH.ct(s=e.substr(0,n)));e=e.substr(n)}let r=false;e=r?e:e.replace(/^\|n/,(()=>{r=true;WH.ae(a,WH.ce("br"));return""}));e=r?e:e.replace(/^\|\|/,(()=>{r=true;WH.ae(a,WH.ct("|"));return""}));e=r?e:e.replace(/\|cn([^:]+):([\w\W]*?)\|r/,((e,i,n)=>{r=true;let s=t[i];if(s){WH.ae(a,WH.ce("span",{style:{color:"#"+s}},WH.ct(n)))}else{WH.ae(a,WH.ct(n))}return""}));e=r?e:e.replace(/\|c[0-9A-Fa-f]{2}([0-9A-Fa-f]{6})([\w\W]*?)\|r/,((e,t,i)=>{r=true;WH.ae(a,WH.ce("span",{style:{color:"#"+t}},WH.ct(i)));return""}));e=r?e:e.replace(/^\|T[\w\W]+?\|t/,(()=>{r=true;return""}));e=r?e:e.replace(/^\|A:([^:]+):([\d.]+):([\d.]+)(?::([\d.]+):([\d.]+)(?::(\d+):(\d+):(\d+))?)?\|a/,((e,t,i,n,s,o,l,c,u)=>{r=true;let d=WH.ce("img",{alt:t,src:WH.Wow.getTextureAtlasMemberUrl(t),style:{verticalAlign:"bottom"}});if(l!=null){d.style.filter=WH.DOM.getColorFilter(parseInt(l)/255,parseInt(c)/255,parseInt(u)/255)}i=parseFloat(i);n=parseFloat(n);let f=2;if(i===0){if(n===0){d.style.width=f+"ex";d.style.height=f+"ex"}else{d.style.width=f*n+"ex";d.style.height=f+"ex"}}else{if(n===0){d.style.width=f+"ex";d.style.height=i+"px"}else{d.style.width=n+"px";d.style.height=i+"px"}}WH.ae(a,d);return""}));e=r?e:e.replace(/^\|1([^;]*);([^;]*);/,((e,t,i)=>{r=true;WH.ae(a,WH.ct(/[01]\s*$/.test(s)?t:i));return""}));e=r?e:e.replace(/^\|4([^:;]*):([^:;]*)(?::([^:;]*))?;/,((e,t,i,n)=>{r=true;let o=parseInt((s.match(/(\d+)\s*$/)||["0","0"])[1]);WH.ae(a,WH.ct(o===1?t:i));return""}));e=r?e:e.replace(/^\|2\s*(.)/,((e,t)=>{r=true;if(["a","e","i","o","u"].includes(t.toLowerCase())){WH.ae(a,WH.ct("d'"))}else{WH.ae(a,WH.ct("de "))}return t}));if(!r){WH.ae(a,WH.ct("|"));e=e.substr(1)}}return a};this.slug=function(a,i,n){if(typeof a!=="string"){WH.error("Tried to convert a variable of type "+typeof a+" to kebab case.",a);return""}var s=WH.ce("textarea");s.innerHTML=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");a=s.value;a=a.replace(new RegExp(e.shy,"g"),"");if(Locale.exists(n)||Locale.isLocaleName(n)){if(n===LOCALE_ENUS||n===Locale.getName(LOCALE_ENUS)){a=a.replace(" & "," and ")}else{a=a.replace(WH.TERMS.wordspace_punct+WH.TERMS.ampersand_punct+WH.TERMS.wordspace_punct,WH.TERMS.wordspace_punct+WH.TERMS.and_lc+WH.TERMS.wordspace_punct)}}a=a.replace(/%\w|['#]|^\s*|\s*$/g,"");if(i){a=a.replace(/ \/ |_|[^\u00C0-\u1FFF\u2C00-\uD7FF\w]+/g,"-")}else{a=WH.removeAccents(a).replace(/ \/ |_|[^a-z0-9]/gi,"-")}a=a.toLocaleLowerCase();a=a.replace(/-{2,}/g,"-");a=a.replace(/^-+|-+$/g,"");if(a.length>t){let e=a.substr(t,1)==="-";a=a.substr(0,t);let i;if(!e&&(i=a.lastIndexOf("-"))!==-1){a=a.substr(0,i)}}return a};this.splitCsv=e=>e.split(",").map((e=>e.trim()));this.sprintf=function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(e){return a(n(e),arguments)}function a(a,i){var n=1,s=a.length,r,o="",l,c,u,d,f,h,p,m;for(l=0;l<s;l++){if(typeof a[l]==="string"){o+=a[l]}else if(typeof a[l]==="object"){u=a[l];if(u.keys){r=i[n];for(c=0;c<u.keys.length;c++){if(r==undefined){throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',u.keys[c],u.keys[c-1]))}r=r[u.keys[c]]}}else if(u.param_no){r=i[u.param_no]}else{r=i[n++]}if(e.not_type.test(u.type)&&e.not_primitive.test(u.type)&&r instanceof Function){r=r()}if(e.numeric_arg.test(u.type)&&(typeof r!=="number"&&isNaN(r))){throw new TypeError(t("[sprintf] expecting number but found %T",r))}if(e.number.test(u.type)){p=r>=0}switch(u.type){case"b":r=parseInt(r,10).toString(2);break;case"c":r=String.fromCharCode(parseInt(r,10));break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,u.width?parseInt(u.width):0);break;case"e":r=u.precision?parseFloat(r).toExponential(u.precision):parseFloat(r).toExponential();break;case"f":r=u.precision?parseFloat(r).toFixed(u.precision):parseFloat(r);break;case"g":r=u.precision?String(Number(r.toPrecision(u.precision))):parseFloat(r);break;case"o":r=(parseInt(r,10)>>>0).toString(8);break;case"s":r=String(r);r=u.precision?r.substring(0,u.precision):r;break;case"t":r=String(!!r);r=u.precision?r.substring(0,u.precision):r;break;case"T":r=Object.prototype.toString.call(r).slice(8,-1).toLowerCase();r=u.precision?r.substring(0,u.precision):r;break;case"u":r=parseInt(r,10)>>>0;break;case"v":r=r.valueOf();r=u.precision?r.substring(0,u.precision):r;break;case"x":r=(parseInt(r,10)>>>0).toString(16);break;case"X":r=(parseInt(r,10)>>>0).toString(16).toUpperCase();break}if(e.json.test(u.type)){o+=r}else{if(e.number.test(u.type)&&(!p||u.sign)){m=p?"+":"-";r=r.toString().replace(e.sign,"")}else{m=""}f=u.pad_char?u.pad_char==="0"?"0":u.pad_char.charAt(1):" ";h=u.width-(m+r).length;d=u.width?h>0?f.repeat(h):"":"";o+=u.align?m+r+d:f==="0"?m+d+r:d+m+r}}}return o}var i=Object.create(null);function n(t){if(i[t]){return i[t]}var a=t,n,s=[],r=0;while(a){if((n=e.text.exec(a))!==null){s.push(n[0])}else if((n=e.modulo.exec(a))!==null){s.push("%")}else if((n=e.placeholder.exec(a))!==null){if(n[2]){r|=1;var o=[],l=n[2],c=[];if((c=e.key.exec(l))!==null){o.push(c[1]);while((l=l.substring(c[0].length))!==""){if((c=e.key_access.exec(l))!==null){o.push(c[1])}else if((c=e.index_access.exec(l))!==null){o.push(c[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=o}else{r|=2}if(r===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}s.push({placeholder:n[0],param_no:n[1],keys:n[2],sign:n[3],pad_char:n[4],align:n[5],width:n[6],precision:n[7],type:n[8]})}else{throw new SyntaxError("[sprintf] unexpected placeholder")}a=a.substring(n[0].length)}return i[t]=s}return t}();this.toFixedTrimmed=function(e,t){return e.toFixed(t).replace(/\D?0*$/,"")};this.unescapeHtml=function(e){let t={"&gt;":">","&lt;":"<","&amp;":"&","&apos;":"'","&quot;":'"'};let a;return e.replace(/&(?:(?:#\d+)|(?:#x[0-9a-f]+)|[a-z]+);/gi,(function(e){if(t.hasOwnProperty(e)){return t[e]}a=a||new DOMParser;return t[e]=a.parseFromString(e,"text/html").documentElement.textContent}))};this.vsprintf=function(e,t){return this.sprintf.apply(null,[e].concat(t||[]))}};window.g_listviews={};function Listview(e){const t=this;const a=WH.User;if(!this.initialSetupComplete){WH.cO(this,e);if(typeof this.tabs==="string"){this.tabs=window[this.tabs]}if(this.id){let e=(this.tabs?"tab-":"lv-")+this.id;if(this.parent){this.container=WH.ce("div",{id:e});WH.ae(WH.ge(this.parent),this.container)}else{this.container=WH.ge(e)}if(this.tabs){this.container.style.display="none"}}else{return}g_listviews[this.id]=this;if(this.tabs){this.tabIndex=this.tabs.add(this.getTabName(),$.extend({id:this.id,onLoad:this.initialize.bind(this),onShow:function(){this.updateTileSizes();this.writeHash()}.bind(this)},this.tabOpts));this.tabClick=Tabs.trackClick.bind(this.tabs,this.tabs.tabs[this.tabIndex])}this.initialSetupComplete=true}if(!this.template){WH.error("Every listview requires a template");return}if(typeof this.template==="string"){this.container.dataset.template=this.template;this.loadingTemplate=true;Listview.loadTemplate(this.template,function(){this.template=Listview.templates[this.template];delete this.loadingTemplate;Listview.call(this,e)}.bind(this));return}if(this.template.templateName){this.container.dataset.template=this.template.templateName}if(a.getDebug()){this.debug=true}if(this.data==null){this.data=[]}if(!this.hasOwnProperty("hash")){if(this.template.hasOwnProperty("hash")){this.hash=this.template.hash}else{this.hash=Listview.HASH_FULL}}this.lockHash=true;if(this.searchable==null){if(this.template.searchable!=null){this.searchable=this.template.searchable}else{this.searchable=false}}if(this.filtrable==null){if(this.template.filtrable!=null){this.filtrable=this.template.filtrable}else{this.filtrable=false}}if(this.sortable==null){if(this.template.sortable!=null){this.sortable=this.template.sortable}else{this.sortable=true}}this.specialHashes={};if(this.data.length===1){this.filtrable=false;this.searchable=false;this.sortable=false}if(this.searchable&&this.searchDelay==null){if(this.template.searchDelay!=null){this.searchDelay=this.template.searchDelay}else{this.searchDelay=333}}if(this.clickable==null){if(this.template.clickable!=null){this.clickable=this.template.clickable}else{this.clickable=true}}if(this.hideBands==null)this.hideBands=this.template.hideBands;if(this.hideNav==null)this.hideNav=this.template.hideNav;if(this.hideHeader==null)this.hideHeader=this.template.hideHeader;if(this.hideCount==null)this.hideCount=this.template.hideCount;if(!this.hiddenControls){this.hiddenControls=this.template.hiddenControls||[]}if(typeof this.createHeaderRow!=="boolean"&&typeof this.template.createHeaderRow==="boolean"){this.createHeaderRow=this.template.createHeaderRow}if(this.computeDataFunc==null&&this.template.computeDataFunc!=null){this.computeDataFunc=this.template.computeDataFunc}if(this.createCbControls==null&&this.template.createCbControls!=null){this.createCbControls=this.template.createCbControls}if(this.createTooltipToggle==null&&this.template.createTooltipToggle!=null){this.createTooltipToggle=this.template.createTooltipToggle}if(this.template.onBeforeCreate!=null){if(this.onBeforeCreate==null){this.onBeforeCreate=this.template.onBeforeCreate}else{this.onBeforeCreate=[this.template.onBeforeCreate,this.onBeforeCreate]}}if(this.onAfterCreate==null&&this.template.onAfterCreate!=null){this.onAfterCreate=this.template.onAfterCreate}if(this.onDataUpdate==null&&this.template.onDataUpdate!=null){this.onDataUpdate=this.template.onDataUpdate}if(this.onNoData==null&&this.template.onNoData!=null){this.onNoData=this.template.onNoData}if(this.createNote==null&&this.template.createNote!=null){this.createNote=this.template.createNote}if(this.template.sortOptions){this.sortOptions=[];WH.cOr(this.sortOptions,this.template.sortOptions)}if(this.customFilter==null&&this.template.customFilter!=null){this.customFilter=this.template.customFilter}if(this.onSearchSubmit==null&&this.template.onSearchSubmit!=null){this.onSearchSubmit=this.template.onSearchSubmit}if(this.getItemLink==null&&this.template.getItemLink!=null){this.getItemLink=this.template.getItemLink}if(this.noRowClick==null&&this.template.noRowClick!=null){this.noRowClick=this.template.noRowClick}if(this.forceBandTop==null&&this.template.forceBandTop!=null){this.forceBandTop=this.template.forceBandTop}if(this.completionText==null&&this.template.completionText!=null){this.completionText=this.template.completionText}if(this.completionText==null){this.completionText=Listview.getCompletionText()}if(this.clip==null&&this.template.clip!=null){this.clip=this.template.clip}if(this.clip||this.template.compute||this.id==="topics"||this.id==="recipes"||this.template.noDebug){this.debug=false}if(this.mode==null){this.mode=this.template.mode}if(this.alternateVersions==null){this.alternateVersions=this.template.alternateVersions}if(this.template.noStyle!=null){this.noStyle=this.template.noStyle}if(this.nItemsPerPage==null){if(this.template.nItemsPerPage!=null){this.nItemsPerPage=this.template.nItemsPerPage}else{this.nItemsPerPage=50}}this.nItemsPerPage|=0;if(this.nItemsPerPage<=0){this.nItemsPerPage=0}if(this.validateHashPagination==null){this.validateHashPagination=true}this.resetRowVisibility();if(this.mode===Listview.MODE_CALENDAR){this.dates=[];this.nItemsPerPage=1;this.nDaysPerMonth=[];if(this.template.startOnMonth!=null){this.startOnMonth=this.template.startOnMonth}else{this.startOnMonth=new Date}this.startOnMonth.setDate(1);this.startOnMonth.setHours(0,0,0,0);if(this.nMonthsToDisplay==null){if(this.template.nMonthsToDisplay!=null){this.nMonthsToDisplay=this.template.nMonthsToDisplay}else{this.nMonthsToDisplay=1}}let e=this.startOnMonth.getFullYear();let t=this.startOnMonth.getMonth();for(let a=0;a<this.nMonthsToDisplay;++a){let i=new Date(e,t+a,32);this.nDaysPerMonth[a]=32-i.getDate();for(let i=1;i<=this.nDaysPerMonth[a];++i){this.dates.push({date:new Date(e,t+a,i)})}}if(this.template.rowOffset!=null){this.rowOffset=this.template.rowOffset}}this.columns=[];for(let e=0,t=this.template.columns.length;e<t;++e){let t={};WH.cO(t,this.template.columns[e]);this.columns.push(t)}if(this.extraCols!=null){for(let e=0,t=this.extraCols.length;e<t;++e){let t=null;let a=this.extraCols[e];if(typeof a==="string"){if(!Listview.extraCols.hasOwnProperty(a)){WH.error("Unknown extraCol ["+a+"].");continue}a=Listview.extraCols[a]}if(!a){WH.error("Could not find the requested listview column:",this.extraCols[e]);continue}if(a.after||a.before){let e=WH.inArray(this.columns,a.after?a.after:a.before,(function(e){return e.id}));if(e!==-1){t=a.after?e+1:e}}if(t==null){t=this.columns.length}if(a.id===Listview.COLUMN_ID_DEBUG_ID){this.columns.splice(0,0,WH.cO({},a))}else{this.columns.splice(t,0,WH.cO({},a))}if(!this.sortOptions){continue}t=null;if(a.hasOwnProperty("sortOptionsPosition")){switch(a.sortOptionsPosition){case Listview.SORT_OPTIONS_FIRST:t=0;break}}else if(a.after||a.before){let e=WH.inArray(this.sortOptions,a.after?a.after:a.before,(function(e){return e.id}));if(e!==-1){t=a.after?e+1:e}}if(t==null){t=this.sortOptions.length}if(a.id===Listview.COLUMN_ID_DEBUG_ID){this.sortOptions.splice(0,0,a)}else{this.sortOptions.splice(t,0,a)}}}this.visibility=[];let i=[];let n=[];if(this.columnList){(this.sortOptions||this.columns).forEach((e=>{if(this.columnList.includes(e.id)){i[e.id]=true}else{n[e.id]=true}}))}else{if(this.template.visibleColsTrees){this.visibleCols??=[];let e=WH.getDataTree();Object.entries(this.template.visibleColsTrees).forEach((([a,i])=>{if(i.includes(e)){t.visibleCols.push(a)}}))}if(this.visibleCols){this.visibleCols.forEach((e=>i[e]=true))}if(this.hiddenCols){this.hiddenCols.forEach((e=>n[e]=true))}}(this.sortOptions||this.columns).forEach(((e,t)=>{e.__index=t;if(i[e.id]||!e.hidden&&!n[e.id]){this.visibility.push(t)}}));if(this.sort==null&&this.template.sort){this.sort=this.template.sort.slice(0)}if(this.sort!=null){let e=this.sort;this.sort=[];for(let t=0,a=e.length;t<a;++t){let a=parseInt(e[t]);if(isNaN(a)){let a=0;if(e[t].charAt(0)==="-"){a=1;e[t]=e[t].substring(1)}let i=WH.inArray(this.columns,e[t],(function(e){return e.id}));if(i!==-1){if(a){this.sort.push(-(i+1))}else{this.sort.push(i+1)}}}else{this.sort.push(a)}}}else{this.sort=[]}if(this.debug){this.columns.splice(0,0,{id:Listview.COLUMN_ID_DEBUG_ID,name:WH.TERMS.id,width:"5%",compute:function(e,t){if(e.id){let a=WH.ce("pre",{style:{display:"inline",margin:"0"}},WH.ct(e.id));WH.clickToCopy(a);WH.ae(t,a)}},getVisibleText:function(e){return e.id||""},getValue:function(e){return e.id||0},sortFunc:function(e,t){if(e.id==null){return-1}else if(t.id==null){return 1}return WH.stringCompare(e.id,t.id)}});for(let e=0,t;t=this.columns[e];e++){t.__index=e}this.visibility.splice(0,0,-1);for(let e=0,t=this.visibility.length;e<t;++e){this.visibility[e]=this.visibility[e]+1}for(let e=0,t=this.sort.length;e<t;++e){if(this.sort[e]<0){this.sort[e]=this.sort[e]-1}else{this.sort[e]=this.sort[e]+1}}}this.originalSort=JSON.parse(JSON.stringify(this.sort));for(let e=0,t;t=this.columns[e];++e){t.actions=t.actions||[]}this.Filters=new Listview.Filters(this);if(!this.tabs||this.tabsCalledInitialize){this.initialize()}}Listview.COLUMN_ID_COMPLETION="completed";Listview.COLUMN_ID_DEBUG_ID="debug-id";Listview.COLUMN_ID_POPULARITY="popularity";Listview.COLUMN_TYPE_NUMBER="number";Listview.COLUMN_TYPE_RANGE="range";Listview.COLUMN_TYPE_TEXT="text";Listview.COMPLETION_TYPE_NONE=0;Listview.COMPLETION_TYPE_BATTLE_PET=1;Listview.COMPLETION_TYPE_COLLECTION=2;Listview.HASH_DISABLED=0;Listview.HASH_FULL=1;Listview.HASH_SIMPLE=2;Listview.HASH_DELIMITER=";";Listview.SORT_OPTIONS_FIRST=0;Listview.MODE_DEFAULT=0;Listview.MODE_CHECKBOX=1;Listview.MODE_DIV=2;Listview.MODE_TILED=3;Listview.MODE_CALENDAR=4;Listview.prototype={addOptions:function(e,t){t=t||{};t.className="listview-note-options";let a=WH.ce("div",t);WH.ae(this.getNoteTopDiv(),a);for(let t=0,i;i=e[t];t++){let e=WH.ce("div",{className:"listview-note-options-option"});let t=WH.ce("label",undefined,WH.ct(i.label));if(i.option.nodeType===Node.ELEMENT_NODE&&/^(input|select|textarea|button|object)$/.test(i.option.tagName.toLowerCase())){if(!i.option.id){i.option.id="listview-option-"+WH.Strings.guid()}t.htmlFor=i.option.id}else{t.style.cursor="default"}WH.ae(e,t);WH.ae(e,WH.ce("div",undefined,i.option));WH.ae(a,e)}},initialize:function(){const e=this;if(this.loadingTemplate){this.tabsCalledInitialize=true;return}delete this.tabsCalledInitialize;if(this.data.length){if(this.computeDataFunc!=null){for(let e=0,t=this.data.length;e<t;++e){this.computeDataFunc(this.data[e])}}}let t;if(this.onBeforeCreate!=null){if(typeof this.onBeforeCreate=="function"){t=this.onBeforeCreate()}else{for(let e=0;e<this.onBeforeCreate.length;++e){this.onBeforeCreate[e].bind(this)()}}}this.noData=WH.ce("div");this.noData.className="listview-nodata text";this.createMainContainer();this.createBands();if(this.customFilter!=null){this.Filters.applyDataOnly()}if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateNav();this.refreshRows(true);if(this.onDataUpdate){this.onDataUpdate.call(this)}this.updateBrowseSession();if(!e.clip&&e.scrollerVertical&&e.bandTop&&e.bandBot){e.updateScrollEnhancements();WH.aE(window,"resize",e.updateScrollEnhancements.bind(e));WH.aE(window,"scroll",e.updateScrollEnhancements.bind(e))}if(this.onAfterCreate){this.onAfterCreate(t)}this.lockHash=false},createHeader:function(){let e=WH.ce("tr");if(this.mode===Listview.MODE_CHECKBOX){let t=WH.ce("th",{style:{width:"33px"}});WH.ae(e,t);let a=WH.ce("div");WH.ae(t,a);let i=WH.ce("a",{className:"listview-cb"},WH.ct(WH.Strings.nbsp));WH.ae(a,i)}let t=WH.Device.isTouch();for(let a=0,i=this.visibility.length;a<i;++a){let i=this.visibility[a];let n=this.sortOptions?this.sortOptions[i]:this.columns[i];let s=WH.ce("th");let r=WH.ce("span");let o=WH.ce("span");let l=WH.ce("div");let c=WH.ce("a");n.__th=s;if(n.actions&&n.actions.length){c.href="javascript:";c.onclick=c.oncontextmenu=Listview.onColumnHeaderClick.bind(this,n,i)}else if(this.sortable&&(n.sortable==null||n.sortable)){c.href="javascript:";c.onclick=this.sortBy.bind(this,i+1,false)}if(c.onclick){if(!t){c.onmouseover=Listview.onColumnHeaderHover.bind(this,c,n);c.onmouseout=WH.Tooltips.hide}}else{c.className="static"}if(n.width!=null)s.style.width=n.width;if(n.align!=null)s.style.textAlign=n.align;if(n.span!=null)s.colSpan=n.span;let u=n.headerClasses||[];if(u.length){c.classList.add(...u)}WH.ae(o,WH.ct(n.name?n.name:WH.Strings.nbsp));WH.ae(r,o);WH.ae(c,r);WH.ae(l,c);WH.ae(s,l);WH.ae(e,s)}if(this.hideHeader){this.thead.style.display="none"}WH.ae(this.thead,e)},createSortOptions:function(e){if(!Array.isArray(this.sortOptions)){return}let t=null;if(Array.isArray(this.sort)){t=this.sort[0]}let a=[];for(let e=0;e<this.sortOptions.length;e++){if(this.sortOptions[e].hidden){continue}let i=WH.ce("a",{href:"javascript:"});i.innerHTML=this.sortOptions[e].name;i.onclick=this.sortGallery.bind(this,i,e+1);if(t===e+1){i.className="active"}a.push(i)}let i=WH.ce("span",{className:"listview-sort-options-choices"});for(let e=0;e<a.length;e++){WH.ae(i,a[e])}let n=WH.ce("div",{className:"listview-sort-options"},WH.ct(WH.TERMS.sortby_colon));WH.ae(n,i);WH.aef(e,n)},getSpecialHash:function(e){let t=e+":";let a=location.hash.slice(1).split(Listview.HASH_DELIMITER);for(let e=0,i=a.length;e<i;e++){if(a[e].indexOf(t)===0){return a[e].substr(t.length)}}return undefined},getSpecialHashesString:function(){let e=[];for(let t in this.specialHashes){if(this.specialHashes.hasOwnProperty(t)){e.push(t+":"+this.specialHashes[t])}}return e.join(Listview.HASH_DELIMITER)},isColumnVisible:function(e){return this.visibility.indexOf(e.__index)!==-1},removeSpecialHash:function(e){delete this.specialHashes[e];let t=e+":";let a=location.hash.slice(1).split(Listview.HASH_DELIMITER).filter((function(e){return e.slice(0,t.length)!==t}));location.hash=a.join(Listview.HASH_DELIMITER)},setSpecialHash:function(e,t){this.specialHashes[e]=t},sortGallery:function(e,t){let a=$(e);a.siblings("a").removeClass("active");a.addClass("active");this.sortBy(t)},copyValues:function(e,t,a,i){WH.copyToClipboard(this.data.map((t=>{if(t.__hidden){return null}let a=e(t);if(typeof a==="string"){a=a.trim();if(a.includes(",")){a=JSON.stringify(a)}}return a==null||a===""?"-":a})).filter((e=>e!=null)).join(a),i);t.updateIcon({faIcon:{prefix:"fas",name:"check"}});setTimeout((()=>{t.updateIcon({faIcon:{prefix:"fas",name:"paste"}})}),1.5*WH.Time.MS_SEC)},createBands:function(){const e=WH.LocalStorage;let t=WH.ce("div");let a=WH.ce("div");let i=WH.ce("div");let n=WH.ce("div");this.bandTop=t;this.bandBot=a;this.noteTop=i;this.noteBot=n;t.className="listview-band-top";a.className="listview-band-bottom";this.navTop=this.createNav(true);this.navBot=this.createNav(false);i.className=n.className="listview-note";if(this.note){i.innerHTML=this.note}else if(this.createNote){this.createNote(i,n)}this.createSortOptions(i);if(this._errors){let e=WH.ce("b",{className:"q10 fa fa-exclamation-triangle fa-size-s"},WH.ct(" "+WH.TERMS.error));let t=WH.ce("span",{className:"tip"},e);WH.Tooltips.attach(t,WH.TERMS.invalidfilters_tip,"q",{maxWidth:200});if(i.innerHTML){t.style.marginLeft="10px"}WH.ae(i,t)}if(!i.firstChild&&!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(i,WH.ct(WH.Strings.nbsp))}if(!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(n,WH.ct(WH.Strings.nbsp))}WH.ae(t,this.navTop);if(this.createHeaderRow){this.header=WH.ce("section",{className:"listview-header"});WH.ae(t,this.header)}const s=this.header||t;const r=WH.ae(s,WH.ce("div",{className:"listview-controls wh-button-group"}));if(!this.hiddenControls.includes("copyButton")){let e=this.getCopyButton();if(e){WH.ae(r,e)}}if(!this.hiddenControls.includes("hideFilter")){let e=this.Filters.getOptionsToggle();if(e){WH.ae(r,e)}}WH.ae(t,i);if(this.showLootSpecs){this.classSelectorDiv=WH.ce("div");this.classSelectorDiv.id="class-selector";this.classSelectorDiv.style.paddingLeft="3px";let a="";a+='<div id="class-selector-c0" class="iconmedium active">'+'<ins><span style="text-align: center; line-height: 30px; height: 30px; width: 30px;">'+WH.TERMS.all+"</span></ins>"+"<del></del>"+'<a href="javascript:" data-classid="0"></a></div>';WH.Wow.PlayerClass.getAll().forEach((e=>{a+='<div id="class-selector-c'+e+'" class="iconmedium">'+'<ins><img src="'+WH.staticUrl+"/images/wow/icons/medium/"+WH.Wow.PlayerClass.getIconName(e)+'.jpg" /></ins>'+"<del></del>"+'<a href="javascript:" data-classid="'+e+'"></a></div>'}));this.classSelectorDiv.innerHTML=a;$("div.iconmedium a",this.classSelectorDiv).bind("mouseover",(function(e){let t=parseInt($(e.target).attr("data-classid"));if(t){let a=WH.Wow.PlayerClass.getName(t);WH.Tooltips.showAtCursor(e,a,"q")}}));$("div.iconmedium",this.classSelectorDiv).bind("mouseout",(function(e){WH.Tooltips.hide()}));let i=this;$("div.iconmedium a",this.classSelectorDiv).bind("contextmenu",(function(e){return false}));let n=function(t){if(t){e.set(e.KEY_WOW_DATABASE_CLASS_FILTER,t);this.classFilter=function(e){for(let a in e.specs){if(WH.inArray(g_chr_specs_by_class[t],e.specs[a])!==-1){return true}}return false};if(!WH.isSet("g_filterByClassAchievement")){if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:WH.Url.generatePath("/website-achievement-explored"),data:{trigger:"bosslootfilter"},success:function(){AchievementCheck()},type:"POST"});window.g_filterByClassAchievement=true}}else{e.remove(e.KEY_WOW_DATABASE_CLASS_FILTER);this.classFilter=null;this.deleteRowCaches()}this.Filters.apply();this.applySort();this.refreshRows(true)};$("div.iconmedium a",this.classSelectorDiv).bind("mousedown",(function(e){let t=parseInt($(e.target).attr("data-classid"));const a="iconmedium-gold-selected";switch(e.which){case 3:if(t&&$(e.target).parent().hasClass(a)){$(e.target).parent().removeClass(a);n.call(i,null);$("#class-selector-c0").addClass(a)}break;default:$(".iconmedium",i.classSelectorDiv).removeClass(a);$(e.target).parent().addClass(a);n.call(i,t);break}}));$(t).append(this.classSelectorDiv);$(t).append('<div class="pad" style="clear: left;"></div>');let s=e.get(e.KEY_WOW_DATABASE_CLASS_FILTER);if(s){$("#class-selector-c"+s+" a",this.classSelectorDiv).trigger("mousedown")}}WH.ae(a,this.navBot);WH.ae(a,n);if(this.createCbControls||this.mode===Listview.MODE_CHECKBOX){this.cbBarTop=this.createCbBar(true);this.cbBarBot=this.createCbBar(false);WH.ae(t,this.cbBarTop);WH.ae(a,this.cbBarBot);if(!this.noteTop.firstChild&&!this.cbBarTop.firstChild){this.noteTop.innerHTML="&nbsp;"}if(!this.noteBot.firstChild&&!this.cbBarBot.firstChild){this.noteBot.innerHTML="&nbsp;"}}if(this.hideBands&1){t.style.display="none"}if(this.hideBands&2){a.style.display="none"}WH.ae(this.container,this.bandTop);this.scrollerHorizontal=WH.ce("div");this.scrollerHorizontal.className="listview-scroller-horizontal";WH.ae(this.container,this.scrollerHorizontal);this.scrollerVertical=WH.ce("div");this.scrollerVertical.className="listview-scroller-vertical";if(this.clip){this.scrollerVertical.style.width=this.clip.w+"px";this.scrollerVertical.style.height=this.clip.h+"px"}if(this.containVerticalScrolling){WH.aE(this.scrollerVertical,"wheel",WH.pickerWheel)}WH.ae(this.scrollerVertical,this.mainContainer);WH.ae(this.scrollerVertical,this.noData);WH.ae(this.scrollerHorizontal,this.scrollerVertical);WH.ae(this.container,this.bandBot)},createMainContainer:function(){let e=this.mainContainer;if(this.mode===Listview.MODE_DIV){this.mainContainer=this.mainDiv=WH.ce("div");if(!this.noStyle){this.mainContainer.className="listview-mode-div"}}else if(this.mode===Listview.MODE_TILED){this.mainContainer=this.mainDiv=WH.ce("div",{className:"listview-mode-tiled"});if(this.clickable){this.mainContainer.className+=" clickable"}if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}WH.aE(window,"resize",this.updateTileSizes.bind(this))}else{this.mainContainer=this.table=WH.ce("table");this.thead=WH.ce("thead");this.tbody=WH.ce("tbody");if(this.clickable){this.tbody.className="clickable"}if(this.mode===Listview.MODE_CALENDAR){this.table.className="listview-mode-calendar";let e=100/WH.Time.DAYS_PER_WEEK+"%";let t=WH.ce("colgroup");for(let a=0;a<WH.Time.DAYS_PER_WEEK;++a){let a=WH.ce("col");a.style.width=e;WH.ae(t,a)}WH.ae(this.mainContainer,t);if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}}else{this.table.className="listview-mode-default";this.createHeader();this.updateSortArrow()}WH.ae(this.table,this.thead);WH.ae(this.table,this.tbody)}if(e){e.after(this.mainContainer);WH.de(e);this.deleteRowCaches()}},createNav:function(e){let t=WH.ce("div");t.firstLink=WH.ce("a",{className:"listview-nav-link"});t.previousLink=WH.ce("a",{className:"listview-nav-link"});t.nextLink=WH.ce("a",{className:"listview-nav-link"});t.lastLink=WH.ce("a",{className:"listview-nav-link"});t.statusText=WH.ce("span");t.firstIndex=WH.ce("b");t.lastIndex=WH.ce("b");t.totalCount=WH.ce("b");t.className="listview-nav";t.firstLink.href=t.previousLink.href=t.nextLink.href=t.lastLink.href="javascript:";WH.ae(t.firstLink,WH.ct(WH.Strings.laquo+" "+WH.TERMS.first));WH.ae(t.previousLink,WH.ct(WH.Strings.lsaquo+" "+WH.TERMS.previous));WH.ae(t.nextLink,WH.ct(WH.TERMS.next+" "+WH.Strings.rsaquo));WH.ae(t.lastLink,WH.ct(WH.TERMS.last+" "+WH.Strings.raquo));t.firstLink.onclick=this.firstPage.bind(this);t.previousLink.onclick=this.previousPage.bind(this);t.nextLink.onclick=this.nextPage.bind(this);t.lastLink.onclick=this.lastPage.bind(this);if(this.mode===Listview.MODE_CALENDAR){WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.statusText,t.firstIndex)}else{WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.lastIndex,WH.ct("a"));WH.ae(t.totalCount,WH.ct("a"));WH.ae(t.statusText,t.firstIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.hyphen_punct));WH.ae(t.statusText,t.lastIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.of_lc));WH.ae(t.statusText,t.totalCount)}WH.ae(t,t.firstLink);WH.ae(t,t.previousLink);WH.ae(t,t.statusText);WH.ae(t,t.nextLink);WH.ae(t,t.lastLink);if(e){if(this.hideNav&1){t.style.display="none"}}else{if(this.hideNav&2){t.style.display="none"}}if(this.tabClick){$("a",t).click(this.tabClick)}if(e){this.resetSortLink=WH.ce("a",{className:"listview-reset-sort fa fa-times-circle",href:"javascript:",style:{display:"none"}},WH.ct(WH.TERMS.resetSort));WH.aE(this.resetSortLink,"click",this.resetSort.bind(null,this));WH.aef(t,this.resetSortLink)}return t},createCbBar:function(e){let t=WH.ce("div");if(this.createCbControls){this.createCbControls(t,e)}if(this.createTooltipToggle){this.createTooltipToggle(t,e)}if(t.firstChild){t.className="listview-withselected"+(e?"":"2");WH.ae(t,this.createToggleAll())}return t},createToggleAll:function(){let e=WH.ce("a");e.className="listview-toggleall";let t=function(e){let t=$("td:first-child input:checkbox:not(:checked)",$(this).parents(".listview")).length?WH.TERMS.selectall_stc:WH.TERMS.deselectall_stc;WH.Tooltips.showAtCursor(e,t,"q")};e.onclick=function(e,t,a){let i=$("td:first-child",$(this).parents(".listview"));if($("input:checkbox:not(:checked)",i).length){Listview.cbSelect.call(e,true)}else{Listview.cbSelect.call(e,false)}t.call(this,a)}.bind(e,this,t);e.onmousedown=WH.rf;e.onmouseover=t;e.onmousemove=WH.Tooltips.cursorUpdate;e.onmouseout=WH.Tooltips.hide;return e},deleteRowCaches:function(){for(let e in this.data){this.data[e].__tr=null}},getCopyButton:function(){const e=this;if(!this.template.columns||this.template.copyableColumns===false){return null}const t=new WH.Button({"aria-label":WH.TERMS.copy_clipboard+WH.TERMS.ellipsis_punct,"data-variation":WH.getDataTreeKey(),iconConfig:{faIcon:{prefix:"fas",name:"paste"}},style:"secondary",size:"small"});let a=[];let i=false;this.visibility.forEach((n=>{let s=e.columns[n];if(!s||s.copyable===false||!s.name||s.id===Listview.COLUMN_ID_COMPLETION){return}let r=(s.getPlainText?e=>s.getPlainText(e):null)||(s.getVisibleText&&!(s.id==="name"&&s.value)?e=>s.getVisibleText(e):null)||(s.getValue?e=>s.getValue(e):null)||(s.value?e=>e[s.value]:null);if(!r){return}a.push(Menu.createItem({label:s.name,url:e.copyValues.bind(e,r,t,WH.TERMS.comma_punct)}));i=i||["id",Listview.COLUMN_ID_DEBUG_ID].includes(s.id)}));if(!i){for(let n=0;n<10;n++){if(this.data[n]&&this.data[n].id!=null){i=true;a.unshift(Menu.createItem({label:WH.TERMS.id,url:e.copyValues.bind(e,(e=>e.id),t,WH.TERMS.comma_punct)}));break}}}if(i&&this.template.entityType){let i=WH.markup.Tags.getByEntityType(this.template.entityType);if(i){a.push(Menu.createItem({label:WH.TERMS.wowheadMarkupTag,url:e.copyValues.bind(e,(e=>WH.markup.Tags.getWhml(i,e.id)),t.getElement(),"\n")}))}}if(!a.length){return null}let n;if(a.length===1){n=WH.term("copyEach_format",Menu.getLabel(a[0]));WH.aE(t.getElement(),"click",Menu.getItemUrl(a[0]))}else{n=WH.TERMS.copy_clipboard+WH.TERMS.ellipsis_punct;a.unshift(Menu.createHeading({label:WH.TERMS.copyAll}));Menu.add(t.getElement(),a,{showAtElement:true})}WH.Tooltips.attach(t.getElement(),n,"q2");return t.getElement()},refreshRows:function(e){let t;switch(this.mode){case Listview.MODE_DIV:t=this.mainContainer;break;case Listview.MODE_TILED:t=this.mainDiv;break;default:t=this.tbody}if(!t){return}WH.ee(t);if(this.nRowsVisible===0){if(!this.filtered&&!this.forceBandTop){this.bandTop.style.display=this.bandBot.style.display="none";this.mainContainer.style.display="none"}this.noData.style.display="";this.showNoData();return}let a;let i;if(!(this.hideBands&1)){this.bandTop.style.display=""}if(!(this.hideBands&2)){this.bandBot.style.display=""}if(this.nDaysPerMonth&&this.nDaysPerMonth.length){a=0;for(let e=0;e<this.rowOffset;++e){a+=this.nDaysPerMonth[e]}i=a+this.nDaysPerMonth[this.rowOffset]}else if(this.nItemsPerPage>0){a=this.rowOffset;i=Math.min(a+this.nRowsVisible,a+this.nItemsPerPage);if(this.filtered&&this.rowOffset>0){for(let e=0,t=0;e<this.data.length&&t<this.rowOffset;++e){let i=this.data[e];if(i.__hidden||i.__deleted){a++}else{t++}}i+=a-this.rowOffset}}else{a=0;i=this.nRowsVisible}let n=i-a;if(this.mode===Listview.MODE_DIV){for(let e=0;e<n;++e){let t=a+e;let i=this.data[t];if(!i){break}if(i.__hidden||i.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}}else if(this.mode===Listview.MODE_TILED){for(let e=0;e<n;++e){let t=a+e;let i=this.data[t];if(!i){break}if(i.__hidden||i.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}this.updateTileSizes();let e=WH.qsa("img",this.mainDiv);for(let t=0,a;a=e[t];t++){WH.aE(a,"load",this.updateTileSizesAfterDelay.bind(this))}}else if(this.mode===Listview.MODE_CALENDAR){let e=WH.ce("tr");for(let t=0;t<7;++t){WH.ae(e,WH.ce("th",undefined,WH.ct(WH.Time.getWeekdayName(t))))}WH.ae(this.tbody,e);e=WH.ce("tr");let t=this.dates[a].date.getDay();for(let a=0;a<t;a++){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}let n=t;for(let t=a;t<i;++t){WH.ae(e,this.getEvent(t));if(++n===7){WH.ae(this.tbody,e);e=WH.ce("tr");n=0}}if(n!==0){for(;n<7;++n){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}WH.ae(this.tbody,e)}}else{for(let t=0;t<n;++t){let i=a+t;let s=this.data[i];if(!s){break}if(s.__hidden||s.__deleted){++n;continue}WH.ae(this.tbody,this.getRow(i,e))}}this.mainContainer.style.display="";this.noData.style.display="none";WH.Tooltips.attachTouchTooltips(t)},showNoData:function(){let e=this.noData;WH.ee(e);let t=-1;if(this.onNoData){t=this.onNoData.bind(this,e)()}if(t===-1){if(this.noDataElement){WH.ae(this.noData,this.noDataElement)}else if(this.noDataText){WH.ae(this.noData,WH.ct(this.noDataText))}else{WH.ae(this.noData,WH.ct(this.filtered?WH.TERMS.nomatches_tip:WH.TERMS.nodata_tip))}}},getColumn:function(e){for(let t=0,a;a=this.columns[t];t++){if(a.id===e){return a}}return undefined},getDiv:function(e){let t=this.data[e];if(t.__div==null||this.minPatchVersion!=t.__minPatch){this.createDiv(t,e)}return t.__div},createDiv:function(e,t){let a=WH.ce("div");e.__div=a;if(this.minPatchVersion){e.__minPatch=this.minPatchVersion}if(this.onItemClick){WH.aE(a,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink&&this.clickable){WH.aE(a,"click",this.onStandardClickableRowClick.bind(this,e))}this.template.compute.bind(this,e,a,t)()},getCell:function(e,t){let a=this.data[e];if(t||a.__td==null){this.createCell(a,e)}return a.__td},createCell:function(e,t){let a=WH.ce("td");e.__td=a;this.template.compute.bind(this,e,a,t)()},getEvent:function(e){let t=this.dates[e];if(t.__td==null){this.createEvent(t,e)}return t.__td},createEvent:function(e,t){e.events=WH.arrayFilter(this.data,(function(t){if(t.__hidden||t.__deleted||t.name.match(/^\[#/)){return false}if(!WH.Wow.Event){return false}let a=WH.Wow.Event.getNextEvent(t.occurrences,e.date);if(a){let t=new Date(a.start);let i=new Date(a.end);t.setHours(0,0,0,0);i.setHours(0,0,0,0);return t<=e.date&&i>e.date}return false}));let a=WH.ce("td");e.__td=a;if(e.date.getFullYear()===WH.getServerTime().getFullYear()&&e.date.getMonth()===WH.getServerTime().getMonth()&&e.date.getDate()===WH.getServerTime().getDate()){a.className="calendar-today"}let i=WH.ce("div",{className:"calendar-date"});WH.st(i,e.date.getDate());WH.ae(a,i);i=WH.ce("div");i.className="calendar-event";WH.ae(a,i);this.template.compute.bind(this,e,i,t)();if(this.onItemClick){WH.aE(a,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(a,"click",this.onStandardClickableRowClick.bind(this,e))}},getRow:function(e,t){let a=this.data[e];if(t||a.__tr==null){this.createRow(a)}return a.__tr},setRow:function(e){if(this.data[e.pos]){this.data[e.pos]=e;this.data[e.pos].__tr=e.__tr;this.createRow(this.data[e.pos]);this.refreshRows()}},createRow:function(e){let t=WH.ce("tr",{className:"listview-row"});e.__tr=t;if(this.mode===Listview.MODE_CHECKBOX){let a=WH.ce("td");if(!e.__nochk){a.className="listview-cb";a.onclick=Listview.cbCellClick;let t=WH.ce("input",{type:"checkbox"});t.onclick=Listview.cbClick;if(e.__chk){t.checked=true}e.__cb=t;WH.ae(a,t)}WH.ae(t,a)}for(let a=0,i=this.visibility.length;a<i;++a){let i=this.visibility[a];let n=this.sortOptions?this.sortOptions[i]:this.columns[i];let s=WH.ce("td");let r;if(n.align!=null){s.style.textAlign=n.align}if(n.compute){r=n.compute.bind(this,e,s,t,i)()}else if(n.getValue){r=n.getValue(e)}else if(e[n.value]!=null){r=e[n.value]}if(r!=null){s.insertBefore(WH.ct(r),s.firstChild)}WH.ae(t,s)}if(this.mode===Listview.MODE_CHECKBOX&&e.__chk){t.className="checked"}if(e.frommerge){t.className+=" mergerow"}if(this.onItemClick){WH.aE(t,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(t,"click",this.onStandardClickableRowClick.bind(this,e))}if(this.mode===Listview.MODE_CHECKBOX){let e=WH.qs(".listview-cleartext",t);let a=WH.qs("input",t);a.ariaLabel=WH.term("select_format",e.textContent)}},onStandardClickableRowClick:function(e,t){if(this.noRowClick){return}if(t.target&&WH.closest(t.target,"a")){return}location.href=this.getItemLink(e)},submitSearch:function(e){if(!this.onSearchSubmit||e.keyCode!==13){return}for(let e=0,t=this.data.length;e<t;++e){if(this.data[e].__hidden){continue}this.onSearchSubmit.bind(this,this.data[e])()}},validatePage:function(e){if(e===true&&!this.validateHashPagination){return}if(this.rowOffset<0){this.rowOffset=0}else if(this.mode===Listview.MODE_CALENDAR){this.rowOffset=Math.min(this.rowOffset,this.nDaysPerMonth.length-1)}else{this.rowOffset=this.getRowOffset(this.rowOffset+this.nItemsPerPage>this.nRowsVisible?this.nRowsVisible-1:this.rowOffset)}},getRowOffset:function(e){return this.nItemsPerPage>0&&e>0?Math.floor(e/this.nItemsPerPage)*this.nItemsPerPage:0},resetRowVisibility:function(e){for(let e=0,t=this.data.length;e<t;++e){this.data[e].__hidden=false}this.filtered=false;if(e!==true){this.rowOffset=0}this.nRowsVisible=this.data.length},changePage:function(){this.refreshRows();this.updateNav();this.writeHash();this.updateBrowseSession();WH.scrollTo(this.container,{allowScrollingDown:false,asNeeded:true})},firstPage:function(){if(this.rowOffset>0){this.rowOffset=0;this.changePage()}return false},previousPage:function(){if(this.rowOffset>0){this.rowOffset-=this.nItemsPerPage;this.validatePage();this.changePage()}return false},nextPage:function(){let e=this.rowOffset;this.rowOffset+=this.nItemsPerPage;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},lastPage:function(){let e=this.rowOffset;this.rowOffset=99999999;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},addSort:function(e,t){let a=WH.inArray(e,Math.abs(t),(function(e){return Math.abs(e)}));if(a!==-1){t=e[a];e.splice(a,1)}e.splice(0,0,t)},sortBy:function(e,t){let a=this.sortOptions||this.columns;if(e<=0||e>a.length){return}this.searchSort=false;if(Math.abs(this.sort[0])==e&&!t){this.sort[0]=-this.sort[0]}else{let t=-1;if(a[e-1].type===Listview.COLUMN_TYPE_TEXT){t=1}this.addSort(this.sort,t*e)}if(this.data[0]&&!this.data[0].__originalIndex){for(let e in this.data){if(this.data.hasOwnProperty(e)&&this.data[e]){this.data[e].__originalIndex=e}}}if(this.resetSortLink){this.resetSortLink.style.display=""}this.applySort();this.refreshRows();this.updateSortArrow();this.writeHash()},applySort:function(){if(!this.sort.length){return}Listview.sort=this.sort;Listview.columns=this.columns;Listview.sortOptions=this.sortOptions;if(this.template.beforeSort){this.template.beforeSort.call(this)}if(this.indexCreated){this.data.sort(Listview.sortIndexedRows.bind(this))}else{this.data.sort(Listview.sortRows.bind(this))}this.updateSortIndex();this.updateBrowseSession()},resetSort:function(e){if(e.originalSort&&e.data[0]&&e.data[0].hasOwnProperty("__originalIndex")){e.sort=JSON.parse(JSON.stringify(e.originalSort));e.data.sort((function(e,t){return(e.__originalIndex||0)-(t.__originalIndex||0)}));e.indexCreated=false;e.applySort();e.refreshRows();e.removeSortArrow();e.writeHash(true)}else{WH.error("Could not revert to default sort.",e.id,!e.originalSort?"No original sort":!e.data[0]?"No first row":"No original indexes")}if(e.resetSortLink){e.resetSortLink.style.display="none"}},setSort:function(e,t,a){this.searchSort=false;if(this.sort.toString()!==e.toString()){this.sort=e;this.applySort();if(t){this.refreshRows()}if(a){this.writeHash()}}},readHash:function(){if(!this.hash||!location.hash.length){return}let e=location.hash.substr(1);let t=this.rowOffset;let a=false;this.Filters.reset();const i=this;e.split(/[;:]/).forEach((function(e){if(/^\d+([+-]\d+)*$/.test(e)){let t=parseInt(e);if(isNaN(t)){return}i.rowOffset=t;a=true;i.validatePage(true);if(i.hash!==Listview.HASH_SIMPLE){let t=[];let a=e.match(/([+-])[0-9]+/g);if(a){let e=(i.sortOptions||i.columns).length;for(let n=a.length-1;n>=0;n--){let s=parseInt(a[n])||0;let r=Math.abs(s);if(r<=0||r>e){break}i.addSort(t,s)}i.setSort(t,false,false)}}if(i.tabs){i.tabs.setTabPound(i.tabIndex,i.buildHash())}}else{i.Filters.readHashPart(e)}}));if(!a){this.rowOffset=t}i.Filters.apply();i.updateSortArrow()},setHashMode:function(e){this.hash=e},updateBrowseSession:function(){const e=WH.SessionStorage;if(!window.JSON||!e.isSupported()){return}if(typeof Filter=="undefined"&&location.pathname!=="/search"){return}if(this.data.length<3){return}if(typeof this.getItemLink!="function"){return}const t=5;let a=location.pathname+location.search;let i=new Date(WH.getServerTime().getTime()-3*WH.Time.MS_DAY).getTime();let n=e.get(e.KEY_LISTVIEW_BROWSE);if(n){for(let e=0;e<n.length;e++){if(n[e].path===a||n[e].when<i){n.splice(e--,1)}}if(n.length>=t){n.splice(t-1,n.length-t-1)}}else{n=[]}let s=[];let r;let o=/^(.*\bwowhead\.com)?(\/[a-z-]+(=|\/([\w-]*-)?)\d+[^?&#]*)/i;for(let e=0;e<this.data.length;e++){if(r=o.exec(this.getItemLink(this.data[e]))){s.push(r[2])}}if(s.length<3){return}n.unshift({hash:location.hash,path:a,urls:s,when:WH.getServerTime().getTime()});e.set(e.KEY_LISTVIEW_BROWSE,n)},updateScrollEnhancements:function(){if(!this.bandTop.offsetParent){return}const e=200;let t=window.innerHeight-this.scrollerVertical.getBoundingClientRect().top-this.bandBot.offsetHeight;t=Math.max(t,e);if(t<this.scrollerVertical.scrollHeight){if(!this.container.dataset.fixedBottom){this.container.dataset.fixedBottom="true"}this.bandBot.style.width=this.bandBot.parentNode.offsetWidth+"px";this.container.style.paddingBottom=this.bandBot.offsetHeight+"px";if(this.scrollerVertical.scrollWidth>this.scrollerVertical.clientWidth){this.scrollerHorizontal.style.minHeight=this.scrollerVertical.scrollHeight+"px";this.scrollerVertical.style.maxHeight=t+"px"}else if(this.scrollerHorizontal.style.minHeight){this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}if(t===e){let e=this.bandTop.offsetParent;let a=t+this.scrollerVertical.getBoundingClientRect().top-e.getBoundingClientRect().top-parseInt(getComputedStyle(e).getPropertyValue("border-top-width"));this.bandBot.dataset.atTop="true";this.bandBot.style.top=a+"px"}else{if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}}}else{if(this.container.dataset.fixedBottom){delete this.container.dataset.fixedBottom;this.bandBot.style.width="";this.container.style.paddingBottom="";if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}}},removeSortArrow:function(){if(this.lsa){this.lsa.classList.remove("listview-sort-desc","listview-sort-asc");this.lsa.classList.remove("active")}},updateSortArrow:function(){if(!this.sort.length||!this.thead||this.mode===Listview.MODE_CALENDAR||this.searchSort){return}let e=WH.inArray(this.visibility,Math.abs(this.sort[0])-1);if(e===-1){return}if(this.mode===Listview.MODE_TILED){if(!this.sortOptions){return}let t=$(".listview-sort-options a",this.noteTop).get(e);if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"active listview-sort-desc":"active listview-sort-asc";this.lsa=t;return}if(this.mode===Listview.MODE_CHECKBOX&&e<this.thead.firstChild.childNodes.length-1){e+=1}let t=this.thead.firstChild.childNodes[e].firstChild.firstChild.firstChild;if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"listview-sort-desc":"listview-sort-asc";this.lsa=t},updateSortIndex:function(){let e=this.data;for(let t=0,a=e.length;t<a;++t){e[t].__si=t}this.indexCreated=true},updateTabName:function(){if(this.tabs&&this.tabIndex!=null){this.tabs.setTabName(this.tabIndex,this.getTabName())}},updateTileSizes:function(){if(this.mode!==Listview.MODE_TILED||!this.mainDiv||!this.mainDiv.offsetParent){return}this.mainDiv.dataset.widthTesting="true";let e=0;for(let t=0,a;a=this.mainDiv.childNodes[t];t++){e=Math.max(e,a.offsetWidth)}if(e>30){this.mainDiv.style.gridTemplateColumns=`repeat(auto-fit, minmax(${e}px, 1fr))`}delete this.mainDiv.dataset.widthTesting;clearTimeout(this.updateTileSizesDelay)},updateTileSizesAfterDelay:function(){if(!this.updateTileSizesDelay){this.updateTileSizesDelay=setTimeout(this.updateTileSizes.bind(this),100)}},writeHash:function(e){if(!this.hash||this.lockHash||!this.Filters){return}function t(e){let t=[];e=Listview.HASH_DELIMITER+e;let a=location.hash.slice(1).split(Listview.HASH_DELIMITER);for(let i=0,n=a.length;i<n;i++){let n=a[i].match(/^[a-zA-Z0-9_]+:/);if(n&&!e.includes(Listview.HASH_DELIMITER+n[0])){t.push(a[i])}}return t}let a=e===true?"":this.buildHash();if(this.tabs){this.tabs.setTabPound(this.tabIndex,a)}let i=this.getSpecialHashesString();let n=[];let s=t(i);if(this.tabs){if(s.length&&s[0].indexOf(this.id+":")===0){n.push(s.shift())}else{n.push(this.id)}}n.push(i);n=n.concat(s);n.push(a);let r=n.filter(Boolean).join(Listview.HASH_DELIMITER);if(this.tabs&&r===this.id&&this.tabs.selectedTab===-1&&!location.hash){r=""}if(r){location.replace("#"+r)}else{WH.clearHash()}},updateNav:function(){let e=[this.navTop,this.navBot];let t=false;let a=false;let i=new Date;if(this.nRowsVisible>0){if(!(this.hideNav&1)){e[0].style.display=""}if(!(this.hideNav&2)){e[1].style.display=""}}else{e[0].style.display=e[1].style.display="none"}if(this.mode===Listview.MODE_CALENDAR){for(let e=0;e<this.nDaysPerMonth.length;++e){if(e===this.rowOffset){if(e>0){t=true}if(e<this.nDaysPerMonth.length-1){a=true}}}i.setTime(this.startOnMonth.valueOf());i.setMonth(i.getMonth()+this.rowOffset)}else{if(this.nItemsPerPage){if(this.rowOffset>0){t=true}if(this.rowOffset+this.nItemsPerPage<this.nRowsVisible){a=true}}}for(let n=0;n<2;++n){let s=e[n];s.firstLink.style.display=t?"inline-block":"none";s.previousLink.style.display=t?"inline-block":"none";s.nextLink.style.display=a?"inline-block":"none";s.lastLink.style.display=a?"inline-block":"none";s.firstLink.dataset.visible=t;s.previousLink.dataset.visible=t;s.nextLink.dataset.visible=a;s.lastLink.dataset.visible=a;if(this.mode===Listview.MODE_CALENDAR){s.firstIndex.firstChild.nodeValue=WH.Time.getMonthName(i.getMonth())+" "+i.getFullYear()}else{s.firstIndex.firstChild.nodeValue=this.rowOffset+1;s.lastIndex.firstChild.nodeValue=this.nItemsPerPage?Math.min(this.rowOffset+this.nItemsPerPage,this.nRowsVisible):this.nRowsVisible;s.totalCount.firstChild.nodeValue=this.nRowsVisible}}if(!t&&!a){$(e[0]).addClass("listview-nav-nocontrols");$(e[1]).addClass("listview-nav-nocontrols")}else{$(e[0]).removeClass("listview-nav-nocontrols");$(e[1]).removeClass("listview-nav-nocontrols")}},getTabName:function(){let e=this.name;let t=this.data.length;for(let e=0,a=this.data.length;e<a;++e){if(this.data[e].__hidden||this.data[e].__deleted){--t}}if(typeof this.forceQuantity=="number"||typeof this.forceQuantity=="string"){t=this.forceQuantity}if((t>0||typeof this.forceQuantity=="string")&&!this.hideCount){e+=WH.sprintf(WH.TERMS._paren,t)}return e},buildHash:function(){let e=[];let t="";t+=this.rowOffset;if(this.hash===Listview.HASH_FULL&&this.sort.length&&JSON.stringify(this.originalSort)!==JSON.stringify(this.sort)){t+=("+"+this.sort.join("+")).replace(/\+-/g,"-")}if(t!=="0"){e.push(t)}e=e.concat(this.Filters.getHashParts());return e.join(Listview.HASH_DELIMITER)},getCheckedRows:function(){let e=[];for(let t=0,a=this.data.length;t<a;++t){let a=this.data[t];if(a.__cb&&a.__cb.checked||!a.__cb&&a.__chk){e.push(a)}}return e},resetCheckedRows:function(){for(let e=0,t=this.data.length;e<t;++e){let t=this.data[e];if(t.__cb){t.__cb.checked=false}else if(t.__chk){t.__chk=null}if(t.__tr){t.__tr.className=t.__tr.className.replace("checked","")}}},deleteRows:function(e){if(!e||!e.length){return}for(let t=0,a=e.length;t<a;++t){let a=e[t];if(!a.__hidden&&!a.__hidden){this.nRowsVisible-=1}a.__deleted=true}this.updateTabName();if(this.rowOffset>=this.nRowsVisible){this.previousPage()}else{this.refreshRows();this.updateNav();this.updateBrowseSession()}},setData:function(e){this.data=e;this.indexCreated=false;this.resetCheckedRows();this.resetRowVisibility();if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateSortArrow();if(this.customFilter!=null||this.classFilter!=null){this.Filters.applyDataOnly()}this.updateNav();this.refreshRows();if(this.onDataUpdate){this.onDataUpdate.call(this)}this.updateBrowseSession()},getNoteTopDiv:function(){return this.noteTop},getNoDataDiv:function(){return this.noData},createIndicator:function(e,t,a,i){if(!this.noteIndicators){this.noteIndicators=WH.ce("div");this.noteIndicators.className="listview-indicators";$(this.noteIndicators).insertBefore($(this.noteTop))}let n=$('<span class="indicator"></span>').html(e).append(!t?"":$('<a class="indicator-x">[x]</a>').attr("href",t).click((function(){if(this.tabClick){this.tabClick()}}))).css("cursor",typeof a=="function"?"pointer":null).click((function(){if(this.tabClick){this.tabClick()}if(typeof a==="function"){a()}}));if(i){WH.Tooltips.attach(n.get(0),i,"q")}$(this.noteIndicators).append(n);if(!this.showLootSpecs){this.noteTop.dataset.span="full"}return n[0]},removeIndicators:function(){if(this.noteIndicators){$(this.noteIndicators).remove();this.noteIndicators=null}$(this.noteTop).css("padding-top","")},createProgressBar:function(e,t,a,i,n,s){if(!this.noteProgressBars){this.noteProgressBars=WH.ce("table");this.noteProgressBars.className="listview-progressbars";$(this.noteProgressBars).insertBefore($(this.noteTop))}let r=4;if(isNaN(n)||n<1){n=1}if(n>r){n=r}let o=this.noteProgressBars.lastChild;let l=n;if(o&&o.childNodes){for(let e=0;e<o.childNodes.length;++e){l+=o.childNodes[e].colSpan||1}}if(!o||l>r){o=WH.ce("tr");WH.ae(this.noteProgressBars,o)}let c=WH.ce("td");if(n>1){c.colSpan=n}if(a){c.className="clickable";c.onclick=function(){a.apply(this,i)}}if(e){WH.ae(c,WH.ce("div",{className:"heading"},WH.ct(e)))}let u=WH.ce("div",{className:"bar-wrap"});let d=WH.ce("div",{className:"bar-bg"});WH.ae(u,d);if(t[2]){let e=WH.ce("div",{className:"bar yellow"});e.style.width=Math.round((t[1]+t[2]+t[5])/t[0]*1e3)/10+"%";WH.ae(u,e)}let f=WH.ce("div",{className:"bar"});f.style.width=Math.round((t[1]+t[5])/t[0]*1e3)/10+"%";if(s){f.className+=" "+s}WH.ae(u,f);if(t[5]){let e=WH.ce("div",{className:"bar gray"});e.style.width=Math.round(t[5]/t[0]*1e3)/10+"%";WH.ae(u,e)}else{t[5]=0}let h=WH.ce("span");WH.st(h,t[1]+t[5]+(t[2]||t[3]?" ("+(t[3]||t[2])+")":"")+" / "+t[0]);WH.ae(u,h);WH.ae(c,u);WH.ae(o,c);$(this.noteTop).css("padding-top","")},removeProgressBars:function(){if(this.noteProgressBars){$(this.noteProgressBars).remove();this.noteProgressBars=null}$(this.noteTop).css("padding-top","")},addTooltipToggle:function(e,t){if(!WH.User.isPremium()){return}let a=false;for(let e=0;e<this.data.length;e++){if(t[this.data[e].id]&&t[this.data[e].id].hasOwnProperty("screenshot")){a=true;break}}if(!a){return}WH.Tooltips.setScreenshotsEnabled(WH.User.hasSetting(WH.User.SETTING_PREMIUM_TOOLTIP_SCREENSHOTS));const i=WH.ce("label");const n=WH.ce("input",{checked:WH.Tooltips.getScreenshotsEnabled(),className:"tooltipToggle",type:"checkbox"});WH.aE(n,"click",(e=>{const t=e.target.checked;WH.Tooltips.setScreenshotsEnabled(t);WH.fetch(WH.Url.generate("/account/update-tooltip-screenshots"),{method:"POST",json:{_csrf:WH.User.getSessionKey(),newState:t}});WH.qsa('input[type="checkbox"].tooltipToggle').forEach((e=>{e.checked=t}))}));WH.ae(i,n);WH.ae(i,WH.ct(WH.TERMS.wordspace_punct));WH.ae(i,WH.ct(WH.TERMS.screenshotsontooltips_stc));WH.ae(e,i)},noteTopFormIsEmpty:function(){let e=true;$("input, select",this.noteTop).each((function(){switch(this.tagName){case"INPUT":if(this.value){e=false;return false}break;case"SELECT":if($(this).val()){e=false;return false}break}}));return e}};Listview.sortRows=function(e,t){let a=Listview.sort;let i=Listview.sortOptions||Listview.columns;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let n=0,s=a.length;n<s;++n){let s;let r=i[Math.abs(a[n])-1];if(!r){r=this.template}if(r.sortFunc){s=r.sortFunc.call(this,e,t,a[n])}else if(r.getValue){s=WH.stringCompare(r.getValue(e),r.getValue(t))}else{s=WH.stringCompare(e[r.value],t[r.value])}if(s){return s*a[n]}}return 0};Listview.sortIndexedRows=function(e,t){let a=Listview.sort;let i=Listview.sortOptions||Listview.columns;let n;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let s in a){let r=i[Math.abs(a[s])-1];if(!r){r=this.template}if(r.sortFunc){n=r.sortFunc.call(this,e,t,a[0])}else if(r.getValue){n=WH.stringCompare(r.getValue(e),r.getValue(t))}else{let a=r.stat||r.value;n=WH.stringCompare(e[a],t[a])}if(n){return n*a[s]}}return e.__si-t.__si};Listview.cbSelect=function(e){for(let t=0,a=this.data.length;t<a;++t){let a=this.data[t];let i=e;if(a.__hidden){continue}if(!a.__nochk&&a.__cb){let e=a.__cb,t=e.parentNode.parentNode;if(i==null){i=!e.checked}if(e.checked!==i){e.checked=i;t.className=e.checked?t.className+" checked":t.className.replace("checked","")}}else if(i==null){i=true}a.__chk=i}};Listview.cbClick=function(e){setTimeout(Listview.cbUpdate.bind(0,0,this,this.parentNode.parentNode),1);WH.sp(e)};Listview.cbCellClick=function(e){setTimeout(Listview.cbUpdate.bind(0,1,this.firstChild,this.parentNode),1);WH.sp(e)};Listview.cbUpdate=function(e,t,a){if(e){t.checked=!t.checked}a.className=t.checked?a.className+" checked":a.className.replace("checked","")};Listview.getCompletionText=function(e){return WH.cO({all:WH.TERMS.all,identical:WH.TERMS.complete,similar:WH.TERMS.inprogress,extra:WH.TERMS.excluded,duplicate:WH.TERMS.duplicate,missing:WH.TERMS.incomplete,this:WH.TERMS.current,other:WH.TERMS.other},{[Listview.COMPLETION_TYPE_BATTLE_PET]:{identical:WH.TERMS.maxlevel,similar:WH.TERMS.lowlevel,missing:WH.TERMS.missing},[Listview.COMPLETION_TYPE_COLLECTION]:{identical:WH.TERMS.collected,missing:WH.TERMS.missing}}[e]||{})};Listview.onColumnHeaderClick=function(e,t,a){const i=this;if(this.tabClick){this.tabClick()}if(a.button===2||a.shiftKey||a.ctrlKey){WH.Tooltips.hide();requestAnimationFrame((function(){if(e.actions.length===1||a.ctrlKey){let n=e.actions[0];if(n.menu){Menu.show(n.menu,WH.closest(a.target,"th"))}else{n.action.apply(i,e,t,a)}}else{let n=[];for(let a=0,s;s=e.actions[a];a++){if(s.heading){n.push(Menu.createHeading({label:s.name}))}else{n.push(Menu.createItem({label:s.name,submenu:s.menu,url:s.menu?undefined:s.action.bind(i,e,t)}))}}Menu.show(n,WH.closest(a.target,"th"))}}))}else{this.sortBy(t+1)}return false};Listview.onColumnHeaderHover=function(e,t){if(!(this.sortable&&(t.sortable==null||t.sortable)||t.actions.length)){return}let a=WH.ce("div");if(t.tooltipElement){WH.ae(a,t.tooltipElement)}else{WH.ae(a,WH.ce("b",{className:"q1"},WH.ct(t.tooltip||t.name)))}let i=this.Filters.getColumnTooltipAdditions(t);if(i){WH.ae(a,i)}WH.ae(a,WH.ce("div",{className:"q2 no-wrap"},WH.ct(WH.TERMS.clicktosort_stc)));if(t.actions.length){let e=t.actions.length>1?WH.TERMS.rightClickForMoreActions_stc:t.actions[0].tooltipText||WH.TERMS.rightClickTo_format.replace("%s",t.actions[0].name);WH.ae(a,WH.ce("div",{className:"q2 no-wrap"},WH.ct(e)))}WH.Tooltips.show(e,a.innerHTML,"q")};(function(){let e={};Listview.loadTemplate=function(t,a){let i=()=>{if(typeof Listview.templates[t]==="function"){Listview.templates[t]=Listview.templates[t]()}};if(Listview.templates.hasOwnProperty(t)){i();if(a){a()}return}let n=t;if(n.indexOf(".")>0){n=n.substr(0,n.indexOf("."))}let s=e.hasOwnProperty(n);if(!s){e[n]=[i]}if(a){e[n].push(a)}if(!s){let a=WH.ce("script");let i=WH.staticUrl+"/js/WH/Listview/Templates/"+n+".js";if(WH.PageMeta.scriptVersionQueryString){i+="?"+WH.PageMeta.scriptVersionQueryString}a.src=i;WH.aE(a,"load",(function(){if(!Listview.templates.hasOwnProperty(t)){WH.error('Loaded listview template file "'+n+'", but template "'+t+'" still not defined!')}else{while(e[n].length){e[n].shift()()}}}));WH.aE(a,"error",(function(){WH.error('Could not load listview template "'+t+'" from file "'+n+'"!')}));WH.ae(WH.qs("head"),a)}}})();Listview.extraCols={id:{id:"id",name:"ID",width:"5%",compute:function(e,t){if(e.id){WH.ae(t,WH.ct(e.id))}},sortFunc:function(e,t){let a=parseInt(e.id||0);let i=parseInt(t.id||0);if(a===i){return 0}return a<i?-1:1}},patch:{id:"obj-patch",name:WH.TERMS.patch,compute:function(e,t){if(typeof e.patch!="undefined"){let a=parseInt(e.patch);if(a===0||a===-1){WH.ae(t,WH.ct("???"))}else{let e=Math.floor(a/1e4);let i=Math.floor(a/100)%100;let n=a%100;let s=WH.sprintf("$1.$2.$3",e,i,n);WH.ae(t,WH.ct(s))}}},sortFunc:function(e,t){if(e.patch===t.patch){return 0}else if(e.patch<t.patch){return-1}else{return 1}}},date:{id:"obj-date",name:WH.TERMS.added,compute:function(e,t){if(e.date){if(e.date<=86400){WH.ae(t,WH.ct("???"))}else{let a=new Date(e.date*1e3);let i=(WH.getServerTime()-a)/1e3;return WH.formatDate(t,i,a,null,true)}}},sortFunc:function(e,t){if(e.date===t.date){return 0}else if(e.date<t.date){return-1}else{return 1}}},cost:{id:"cost",name:WH.TERMS.cost,getValue:function(e){if(e.cost){let t=e.cost[0];return(t[2]&&t[2][0]?t[2][0][1]:0)||(t[1]&&t[1][0]?t[1][0][1]:0)||t[0]}},compute:function(e,t){if(e.cost){let a=0;e.cost.forEach((e=>{if(a++>0){WH.ae(t,WH.ct(WH.TERMS.slashSeparator_punct))}WH.ae(t,WH.Wow.buildMoney({copper:e[0],currencies:e[1],items:e[2]}))}))}},sortFunc:function(e,t){if(e.cost==null){return-1}else if(t.cost==null){return 1}let a=0,i=0,n=0,s=0;let r=0,o=0;e.cost.forEach((e=>{if(e[2]!=null)WH.arrayWalk(e[2],(function(e,t,i,n){a+=Math.pow(10,n)+e[1]}));if(e[1]!=null)WH.arrayWalk(e[1],(function(e,t,a,i){n+=Math.pow(10,i)+e[1]}));r+=e[0]}));t.cost.forEach((e=>{if(e[2]!=null)WH.arrayWalk(e[2],(function(e,t,a,n){i+=Math.pow(10,n)+e[1]}));if(e[1]!=null)WH.arrayWalk(e[1],(function(e,t,a,i){s+=Math.pow(10,i)+e[1]}));o+=e[0]}));return WH.stringCompare(a,i)||WH.stringCompare(n,s)||WH.stringCompare(r,o)}},count:{id:"count",name:WH.TERMS.count,value:"count",compute:function(e,t){let a=WH.ct(e.count>0?WH.Strings.formatNumber(e.count):"??");if(WH.PageMeta.page==="item"&&e.hasOwnProperty("name")){a=WH.ce("span",{className:"tip",dataset:{simpleTooltip:WH.term("lootedNumerator_tip",e.name)}},a)}else if(WH.PageMeta.page==="npc"){a=WH.ce("span",{className:"tip",dataset:{simpleTooltip:WH.term("lootedNumerator_tip",g_pageInfo.name)}},a)}WH.ae(t,a);if(e.outof){let a=WH.ct(WH.Strings.sprintf(WH.TERMS.outOf_format,WH.Strings.formatNumber(e.outof)));if(WH.PageMeta.page==="item"&&e.hasOwnProperty("name")){let t=WH.ce("span",{className:"tip",dataset:{simpleTooltip:WH.term("lootedDenominator_tip",e.name)}},WH.ct(WH.Strings.formatNumber(e.outof)));a=WH.ce("span",{},WH.ct(WH.TERMS.outOf_format));a.innerHTML=WH.Strings.sprintf(a.innerHTML,t.outerHTML)}WH.ae(t,WH.ce("div",{className:"small q0"},a))}},getVisibleText:function(e){let t=e.count;if(e.outof){t+=" "+e.outof}return t},sortFunc:function(e,t){if(e.count==null){return-1}else if(t.count==null){return 1}return WH.stringCompare(e.count,t.count)}},percent:{id:"percent",name:"%",value:"percent",compute:function(row,td){const Npc=WH.Wow.Npc;let personalLootDifficulty=!WH.isMistsTree()&&this.selectedDifficulty==WH.Wow.Difficulty.ID_LEGACY_RAID_FINDER;if(row.modes&&personalLootDifficulty||g_pageInfo&&(g_pageInfo.type===WH.Types.NPC&&Npc.usesPersonalLootOutdoors(g_pageInfo.typeId)||g_pageInfo.type===WH.Types.ITEM&&(Npc.usesPersonalLootOutdoors(row.id)||row.personal_loot))){$(td).addClass("tip").mouseover((function(e){WH.Tooltips.showAtCursor(e,WH.TERMS.personal_loot_tip,"q")})).mousemove((function(e){WH.Tooltips.cursorUpdate(e)})).mouseout((function(){WH.Tooltips.hide()}));return WH.TERMS.personal_loot_abbrev}if(row.hasOwnProperty("percentOverride")){let e=row.percentOverride;return parseFloat(e.toFixed(e>=1.95?0:e>=.195?1:2))}if(row.count<=0||!this._totalCount&&!row.outof){return"??"}if(row.pctstack){let text="";let data=eval("("+row.pctstack+")");for(let e in data){let t=data[e]*row.percent/100;if(t>=1.95){t=parseFloat(t.toFixed(0))}else if(t>=.195){t=parseFloat(t.toFixed(1))}else{t=parseFloat(t.toFixed(2))}text+=WH.sprintf(WH.TERMS.stackof_format,e,t)+"<br />"}$(td).addClass("tip").mouseover((function(e){WH.Tooltips.showAtCursor(e,text,"q")})).mousemove((function(e){WH.Tooltips.cursorUpdate(e)})).mouseout((function(){WH.Tooltips.hide()}))}let value=parseFloat(row.percent.toFixed(row.percent>=1.95?0:row.percent>=.195?1:2));if(row.pctstack){$(td).append($("<span>").addClass("tip").text(value))}else{return value}},getVisibleText:function(e){let t=e.percent;if(e.hasOwnProperty("percentOverride")){t=e.percentOverride}else if(e.count<=0){return"??"}if(t>=1.95){return t.toFixed(0)}else if(t>=.195){return parseFloat(t.toFixed(1))}else{return parseFloat(t.toFixed(2))}},sortFunc:function(e,t){let a=e.percent;let i=t.percent;if(e.count==null){a=0}if(t.count==null){i=0}if(e.hasOwnProperty("percentOverride")){a=e.percentOverride}if(t.hasOwnProperty("percentOverride")){i=t.percentOverride}let n;if(a>=1.95){n=a.toFixed(0)}else if(a>=.195){n=parseFloat(a.toFixed(1))}else{n=parseFloat(a.toFixed(2))}let s;if(i>=1.95){s=i.toFixed(0)}else if(i>=.195){s=parseFloat(i.toFixed(1))}else{s=parseFloat(i.toFixed(2))}return WH.stringCompare(n,s)}},stock:{id:"stock",name:WH.TERMS.stock,width:"10%",value:"stock",compute:function(e,t){if(e.stock>0){return e.stock}else{return String.fromCharCode(8734)}},getVisibleText:function(e){if(e.stock>0){return e.stock}else{return String.fromCharCode(8734)+" infinity"}}},currency:{id:"currency",name:WH.TERMS.currency,getValue:function(e){if(e.currency){return e.currency[0]?e.currency[0][1]:0}},compute:function(e,t){if(e.currency){WH.ae(t,WH.Wow.buildMoney({currencies:e.currency}))}},sortFunc:function(e,t){if(e.currency==null){return-1}else if(t.currency==null){return 1}let a=0,i=0;WH.arrayWalk(e.currency,(function(e,t,i,n){a+=Math.pow(10,n)+e[1]}));WH.arrayWalk(t.currency,(function(e,t,a,n){i+=Math.pow(10,n)+e[1]}));return WH.stringCompare(a,i)}},mode:{id:"mode",name:"Mode",after:"name",type:"text",compute:function(e,t){if(e.modes&&e.modes.mode){if(this.validateBonuses){for(let t in this.validateBonuses){if(WH.inArray(e.bonustrees,this.validateBonuses[t])!==-1){if(this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}else{break}}}}if(e.bonustrees&&this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}let t=WH.Wow.Difficulty;let a=function(a){for(let i=0;i<t.GROUPS[a].length;i++){if(e.modes.mode.indexOf(t.GROUPS[a][i])<0){return false}}return true};let i=false;i=i||a(t.GROUP_RAID);i=i||a(t.GROUP_LEGACY_RAID);i=i||e.modes.mode.indexOf(t.ID_DUNGEON_NORMAL)>=0&&e.modes.mode.indexOf(t.ID_DUNGEON_HEROIC)>=0;return i?WH.TERMS.all:Listview.extraCols.mode.getVisibleText(e)}},getVisibleText:function(e){let t=WH.Wow.Difficulty;let a=e.modes.mode.includes.bind(e.modes.mode);let i=(a(t.ID_SEASON_OF_MASTERY_DUNGEON)||a(t.ID_SEASON_OF_MASTERY_20_PLAYER))&&!(a(t.ID_DUNGEON_NORMAL)||a(t.ID_RAID_40_PLAYER)||a(t.ID_CLASSIC_RAID_20_PLAYER)||a(t.ID_RAID_NORMAL));if(i){return WH.TERMS.seasonOfMastery_abbrev}if(a(t.ID_RAID_NORMAL)){return WH.TERMS.normal}if(a(t.ID_RAID_HEROIC)){return WH.TERMS.heroic}if(a(t.ID_RAID_MYTHIC)){return WH.TERMS.mythic}if(a(t.ID_RAID_FINDER)){return WH.TERMS.raidfinder}if(a(t.ID_MISTS_CELESTIAL)){return WH.TERMS.celestial}let n=a(t.ID_DUNGEON_NORMAL)||a(t.ID_TBC_DUNGEON_NORMAL)||a(t.ID_LEGACY_10_PLAYER)||a(t.ID_LEGACY_25_PLAYER);let s=a(t.ID_DUNGEON_HEROIC)||a(t.ID_TBC_DUNGEON_HEROIC)||a(t.ID_LEGACY_10_PLAYER_HEROIC)||a(t.ID_LEGACY_25_PLAYER_HEROIC)||a(t.ID_WOTLK_10_PLAYER_HEROIC)||a(t.ID_WOTLK_25_PLAYER_HEROIC);let r=a(t.ID_DUNGEON_MYTHIC);let o=a(t.ID_DUNGEON_TIMEWALKING);let l=a(t.ID_LEGACY_10_PLAYER)||a(t.ID_LEGACY_10_PLAYER_HEROIC)||a(t.ID_TBC_10_PLAYER)||a(t.ID_WOTLK_10_PLAYER_HEROIC);let c=a(t.ID_LEGACY_25_PLAYER)||a(t.ID_LEGACY_25_PLAYER_HEROIC)||a(t.ID_TBC_25_PLAYER)||a(t.ID_WOTLK_25_PLAYER_HEROIC);let u=a(t.ID_LEGACY_RAID_FINDER);let d=u;t.GROUPS[t.GROUP_DUNGEON].concat(t.GROUPS[t.GROUP_LEGACY_RAID]).forEach((function(e){d=d&&!a(e)}));let f=a(t.ID_RAID_NORMAL);let h=f;t.GROUPS[t.GROUP_DUNGEON].concat(t.GROUPS[t.GROUP_LEGACY_RAID]).forEach((function(e){h=h&&!a(e)}));let p;if(l&&!c){p=10}else if(c&&!l){p=25}let m;if(n&&!s&&!r&&!o){m="normal"}else if(s&&!n&&!r&&!o){m="heroic"}else if(r&&!n&&!s&&!o){m="mythic"}if(m&&!u&&!f){if(p&&!r){return WH.sprintf(WH.TERMS[m+"_format"],p)}else{return WH.TERMS[m]}}if(p&&!u&&!f){return WH.sprintf(WH.TERMS.dungeonplayer_format,p)}if(d){return WH.TERMS.raidfinder}if(h){return WH.TERMS.flexible}return WH.TERMS.all},sortFunc:function(e,t){return-WH.stringCompare(Listview.extraCols.mode.compute.call(this,e),Listview.extraCols.mode.compute.call(this,t))}},requires:{id:"requires",name:WH.TERMS.requires,type:"text",compute:function(e,t){let a=e.achievement?WH.Gatherer.get(WH.Types.ACHIEVEMENT,e.achievement):null;if(a){WH.noWrap(t);t.className="small";t.style.lineHeight="18px";let i=WH.ce("a",{className:"icontiny tinyspecial",href:WH.Entity.getUrl(WH.Types.ACHIEVEMENT,e.achievement),style:{backgroundImage:"url("+WH.Icon.getIconUrl(a.icon,WH.Icon.TINY)+")",whiteSpace:"nowrap"}},WH.ct(a["name_"+Locale.getName()]));WH.ae(t,i)}},getVisibleText:function(e){return WH.Gatherer.getName(WH.Types.ACHIEVEMENT,e.achievement)},sortFunc:function(e,t){let a=this.getColumn("requires");return WH.stringCompare(a.getVisibleText(e),a.getVisibleText(t))}},reqskill:{id:"reqskill",name:WH.TERMS.skill,width:"10%",value:"reqskill",before:"yield"},yield:{id:"yield",name:WH.TERMS.yields,type:"text",align:"left",span:2,value:"name",compute:function(e,t,a){if(e["yield"]&&g_items[e["yield"]]){let i=WH.ce("td");i.style.width="1px";i.style.paddingRight="0";i.style.borderRight="none";WH.ae(i,g_items.createIcon(e["yield"],1));WH.ae(a,i);t.style.borderLeft="none";let n=WH.ce("div");let s=WH.ce("a",{className:"q"+g_items[e["yield"]].quality,href:WH.Entity.getUrl(WH.Types.ITEM,e["yield"])});WH.ae(s,WH.ct(g_items[e["yield"]]["name_"+Locale.getName()]));WH.ae(n,s);WH.ae(t,n)}},getVisibleText:function(e){if(e["yield"]&&g_items[e["yield"]]){return g_items[e["yield"]]["name_"+Locale.getName()]}},sortFunc:function(e,t){if(!e["yield"]||!g_items[e["yield"]]||!t["yield"]||!g_items[t["yield"]]){return e["yield"]&&g_items[e["yield"]]?1:t["yield"]&&g_items[t["yield"]]?-1:0}return-WH.stringCompare(g_items[e["yield"]].quality,g_items[t["yield"]].quality)||WH.stringCompare(g_items[e["yield"]]["name_"+Locale.getName()],g_items[t["yield"]]["name_"+Locale.getName()])}},compare:{id:"compare",name:WH.TERMS.completion,getValue:function(e){return Math.floor(e.compare.progress*100)},compute:function(e,t,a){let i=WH.ce("span",{className:"compare-text"});if(!this.completionMode){i.style.display="block";i.style.margin="0 auto";i.style.textAlign="left";i.style.width="53px"}if(!this.completionText){this.completionText=Listview.getCompletionText()}let n=e.compare.hasOwnProperty("progressAmount")?e.compare.progressAmount:e.compare.progress;if(n<0){n=0}let s=WH.ce("span",{className:"progress-icon progress-"+(n===1?"8":Math.min(Math.round(n*8),7))});let r=WH.ce("span");if(this.completionMode){if(e.compare.progress===1){WH.st(r,this.completionText["identical"])}else if(e.compare.progress===-1){WH.st(r,this.completionText["duplicate"])}else if(!e.compare.progress&&e.compare.primary==this.dataSource){WH.st(r,this.completionText["extra"])}else if(!e.compare.progress){WH.st(r,this.completionText["missing"])}else{WH.ae(r,WH.ct(this.completionText["similar"]+" ("));WH.ae(r,WH.ce("span",{className:"tip"},WH.ct(Math.floor(e.compare.progress*100)+"%")));WH.ae(r,WH.ct(")"))}}else{WH.st(r,Math.floor(e.compare.progress*100)+"%")}let o=true;for(let t in e.compare.tooltip){o=o&&e.compare.tooltip[t].length!==e.compare.data.length}if(e.compare.tooltip.length&&o){i.onmouseover=function(e,t,a,i,n){let s='<table class="compare"><tr>';let r;s+="<tr>";for(let t=0;t<e.data.length;++t){r=e.data[t].status==a?"this":"other";s+="<td><b>"+i[r]+"</b></td>"}s+="</tr>";for(let t=0;t<e.tooltip.length;++t){let a=1;if(e.progress<1){a=e.tooltip[t][e.data[0].status]?1:0;for(let i=1;a&&i<e.data.length;++i){let n=e.tooltip[t];let s=n[e.data[i].status];if(s==="&lt;"+WH.TERMS.any+"&gt;"){continue}if(!s||s!==n[e.data[0].status]){a=0}}}s+="<tr>";for(let i=0;i<e.data.length;++i){s+='<td class="q'+a+'">'+e.tooltip[t][e.data[i].status]+"</td>"}s+="</tr>"}s+="</table>";WH.Tooltips.showAtCursor(n,s,"q")}.bind(i,e.compare,this.completionMode,this.dataSource,this.completionText);i.onmousemove=WH.Tooltips.cursorUpdate;i.onmouseout=WH.Tooltips.hide;if(!this.completionMode){r.className="tip"}}r.insertBefore(WH.ct(" "),r.firstChild);r.insertBefore(s,r.firstChild);r.style.whiteSpace="nowrap";WH.ae(i,r);WH.ae(t,i)},sortFunc:function(e,t){return e.compare.progress-t.compare.progress}},modify:{id:"modify",sortable:0,filtrable:0,compute:function(e,t,a){if(this.createModifyButton){t.style.cursor="default";$(t).click((function(e){e.stopPropagation()}));let a=WH.ce("a",{className:"icon-edit",href:"javascript:"},WH.ct(WH.TERMS.modify));WH.ae(t,this.createModifyButton(e,a))}}},bpetquality:{id:"quality",name:WH.TERMS.quality,compute:function(e,t,a){let i=e.compare.data[0].bpet&&e.compare.data[0].bpet.id?WH.Wow.Item.getQualityName(e.compare.data[0].bpet.quality):"";WH.ae(t,WH.ct(i))},sortFunc:function(e,t){let a=e.compare.data[0].bpet&&e.compare.data[0].bpet.id?e.compare.data[0].bpet.quality:-1;let i=t.compare.data[0].bpet&&t.compare.data[0].bpet.id?t.compare.data[0].bpet.quality:-1;return a-i}},popularity:{id:Listview.COLUMN_ID_POPULARITY,copyable:false,name:WH.TERMS.popularity_abbrev,sortOptionsPosition:Listview.SORT_OPTIONS_FIRST,tooltip:WH.TERMS.popularity,max:null,value:"popularity",compute:function(e,t,a,i){let n=this.columns[i];if(n.max===null){n.initMax.call(this,n)}let s=e.hasOwnProperty("popularity")?e.popularity:0;let r=n.max===0?0:s/n.max;r=Math.round(r*8);WH.ae(t,WH.ce("span",{className:"popularity-icon popularity-"+r}))},initMax:function(e){e.max=0;for(let t=0;t<this.data.length;t++){if(this.data[t].hasOwnProperty("popularity")){e.max=Math.max(e.max,this.data[t].popularity||0)}}},sortFunc:function(e,t){let a=e.hasOwnProperty("popularity")?e.popularity:0;let i=t.hasOwnProperty("popularity")?t.popularity:0;return i-a}},contentPhase:{id:"contentPhase",name:WH.isClassicTree()?WH.term("seasonPhase_format",WH.TERMS.seasonOfDiscovery_abbrev):WH.TERMS.phase,tooltip:WH.isClassicTree()?WH.term("seasonContentPhase_format",WH.TERMS.seasonOfDiscovery):WH.TERMS.contentPhase,value:"contentPhase",width:"5%",getVisibleText:function(e){if(typeof e.contentPhase==="number"){return e.contentPhase.toFixed(2).replace(/\D?0*$/,"")}return e.contentPhase||""}}};Listview.templates={};Listview.funcBox={getCurrentItemBonuses:function(e){var t=[];var a=e.bonuses?e.bonuses:this.itemBonusesFromDD?this.itemBonusesFromDD:null;var i=!e.bonuses&&this.itemBonusesFromDD;var n=i?this.validateBonuses:[];if((!a||!a.length)&&e.context){var s=Listview.funcBox.getBonusDataForContext.call(this,e.context);if(s.length==2){a=s[0];n=s[1];i=true}}if(a){for(var r in a){var o=a[r];if(WH.inArray(t,o)==-1&&(!i||WH.inArray(e.bonustrees,n[r])!=-1)){t.push(o)}}}return t},getItemLevelWithBonuses:function(e){const t=WH.Wow.Item.Bonuses;var a=e.level;var i=false;var n=false;var s=Listview.funcBox.getCurrentItemBonuses.call(this,e);if(s.length>0&&WH.isSet("g_itembonuses")){for(var r in s){var o=s[r];if(g_itembonuses[o]){WH.arrayWalk(g_itembonuses[o],(function(e){switch(e[0]){case t.EFFECT_TYPE_ADJUST_ITEM_LEVEL:a+=e[1];break;case t.EFFECT_TYPE_SCALE_HEIRLOOM:case t.EFFECT_TYPE_SCALE_DYNAMIC_REWARD:i=e[1];break;case t.EFFECT_TYPE_PREVIEW_LEVEL:n=e[1];break;case t.EFFECT_TYPE_SET_ITEM_LEVEL:case t.EFFECT_TYPE_SET_PVP_ITEM_LEVEL:a=e[0];break}}))}}}if(i){let e=WH.getScalingDistributionCurve(i);if(e&&e.maxLevel){let t=e.maxLevel;let a=Math.min(WH.Wow.getMaxPlayerLevel(),t);let i=Math.round(WH.getCurveValue(e.curve,a));if(i){return i}}}if(n&&a==e.level&&n<600){return n}return a},createSimpleCol:function(e,t,a,i){return{id:e,name:WH.TERMS[t]||t,width:a,value:i}},initLootTable:function(e){var t;if(this._totalCount!=null)t=this._totalCount;else t=e.outof;if(t==0){if(e.count!=-1)e.percent=e.count;else e.percent=0}else{e.percent=e.count/t*100}Listview.funcBox.initModeFilter.bind(this,e)()},initModeFilter:function(e){if(this._lootModes==null){this._lootModes={}}if(this._distinctModes==null){this._distinctModes={}}if(e.modes){let t=WH.Wow.Difficulty.getIds();for(let a=0;a<t.length;a++){let i=t[a];if(this._lootModes[i]==null){this._lootModes[i]=0}if(e.modes.mode.indexOf(i)>=0){this._lootModes[i]++}}let a=e.modes.mode.join(",");if(this._distinctModes[a]==null){this._distinctModes[a]=0}this._distinctModes[a]++}},addModeIndicator:function(){const e=this;const t=WH.Wow.Difficulty;if(!this._distinctModes){WH.error("Cannot add difficulty mode indicator, difficulty modes were not initialized.","Cause: "+(!this.data.length?"No listview data.":"Unknown."));return}let a=0;for(let e in this._distinctModes){if(this._distinctModes.hasOwnProperty(e)&&this._distinctModes[e]){a++}}if(this._distinctModes[t.GROUPS[t.GROUP_NONE].join(",")]&&a<2){return}let i=[t.ID_NONE,t.ID_DUNGEON_NORMAL,t.ID_DUNGEON_HEROIC,t.ID_DUNGEON_MYTHIC,t.ID_DUNGEON_TIMEWALKING,t.ID_TBC_DUNGEON_NORMAL,t.ID_TBC_DUNGEON_HEROIC,t.ID_SEASON_OF_MASTERY_DUNGEON,t.ID_SEASON_OF_DISCOVERY_5_PLAYER,t.ID_SEASON_OF_DISCOVERY_1_PLAYER,t.ID_LEGACY_RAID_FINDER,t.ID_LEGACY_10_PLAYER,t.ID_LEGACY_10_PLAYER_HEROIC,t.ID_LEGACY_25_PLAYER,t.ID_LEGACY_25_PLAYER_HEROIC,t.ID_CLASSIC_RAID_20_PLAYER,t.ID_SEASON_OF_MASTERY_20_PLAYER,t.ID_SEASON_OF_DISCOVERY_10_PLAYER,t.ID_SEASON_OF_DISCOVERY_20_PLAYER,t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG,t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1,t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2,t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3,t.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL,t.ID_RAID_40_PLAYER,t.ID_SEASONAL_40_PLAYER,t.ID_TBC_10_PLAYER,t.ID_TBC_25_PLAYER,t.ID_WOTLK_10_PLAYER_HEROIC,t.ID_WOTLK_25_PLAYER_HEROIC,t.ID_MISTS_CELESTIAL,t.ID_RAID_FINDER,t.ID_RAID_NORMAL,t.ID_RAID_HEROIC,t.ID_RAID_MYTHIC];let n={};n[t.ID_DUNGEON_HEROIC]=WH.TERMS.heroic;n[t.ID_DUNGEON_NORMAL]=WH.TERMS.normal;n[t.ID_TBC_DUNGEON_NORMAL]=WH.TERMS.normal;n[t.ID_TBC_DUNGEON_HEROIC]=WH.TERMS.heroic;n[t.ID_NONE]=WH.TERMS.normal;n[t.ID_LEGACY_10_PLAYER]=WH.sprintf(WH.TERMS.normal_format,10);n[t.ID_LEGACY_25_PLAYER]=WH.sprintf(WH.TERMS.normal_format,25);n[t.ID_LEGACY_10_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,10);n[t.ID_LEGACY_25_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,25);n[t.ID_LEGACY_RAID_FINDER]=WH.TERMS.raidfinder;n[t.ID_RAID_40_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;n[t.ID_RAID_NORMAL]=WH.TERMS.normal;n[t.ID_RAID_HEROIC]=WH.TERMS.heroic;n[t.ID_RAID_MYTHIC]=WH.TERMS.mythic;n[t.ID_RAID_FINDER]=WH.TERMS.raidfinder;n[t.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic;n[t.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking;n[t.ID_CLASSIC_RAID_20_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;n[t.ID_TBC_10_PLAYER]=t.getName(t.ID_TBC_10_PLAYER);n[t.ID_TBC_25_PLAYER]=t.getName(t.ID_TBC_25_PLAYER);n[t.ID_WOTLK_10_PLAYER_HEROIC]=t.getName(t.ID_WOTLK_10_PLAYER_HEROIC);n[t.ID_WOTLK_25_PLAYER_HEROIC]=t.getName(t.ID_WOTLK_25_PLAYER_HEROIC);n[t.ID_SEASON_OF_MASTERY_DUNGEON]=t.getName(t.ID_SEASON_OF_MASTERY_DUNGEON);n[t.ID_SEASON_OF_MASTERY_20_PLAYER]=t.getName(t.ID_SEASON_OF_MASTERY_20_PLAYER);n[t.ID_SEASONAL_40_PLAYER]=t.getName(t.ID_SEASONAL_40_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_10_PLAYER]=t.getName(t.ID_SEASON_OF_DISCOVERY_10_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER]=t.getName(t.ID_SEASON_OF_DISCOVERY_20_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG]=t.getName(t.ID_SEASON_OF_DISCOVERY_20_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1]=t.getName(t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2]=t.getName(t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3]=t.getName(t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3);n[t.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL]=t.getName(t.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL);n[t.ID_SEASON_OF_DISCOVERY_5_PLAYER]=t.getName(t.ID_SEASON_OF_DISCOVERY_5_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_1_PLAYER]=t.getName(t.ID_SEASON_OF_DISCOVERY_1_PLAYER);n[t.ID_MISTS_CELESTIAL]=t.getName(t.ID_MISTS_CELESTIAL);let s={};this.diffLangref={};$.extend(this.diffLangref,n);if(WH.WAS.showAds()){s[t.ID_LEGACY_10_PLAYER]=n[t.ID_LEGACY_10_PLAYER];s[t.ID_LEGACY_25_PLAYER]=n[t.ID_LEGACY_25_PLAYER];s[t.ID_LEGACY_10_PLAYER_HEROIC]=n[t.ID_LEGACY_10_PLAYER_HEROIC];s[t.ID_LEGACY_25_PLAYER_HEROIC]=n[t.ID_LEGACY_25_PLAYER_HEROIC];s[t.ID_LEGACY_RAID_FINDER]=n[t.ID_LEGACY_RAID_FINDER];n[t.ID_LEGACY_10_PLAYER]=WH.TERMS.normal_abbrev+10;n[t.ID_LEGACY_25_PLAYER]=WH.TERMS.normal_abbrev+25;n[t.ID_LEGACY_10_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+10;n[t.ID_LEGACY_25_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+25;n[t.ID_LEGACY_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;n[t.ID_RAID_NORMAL]=WH.TERMS.normal_abbrev;n[t.ID_RAID_HEROIC]=WH.TERMS.horde_abbrev;n[t.ID_RAID_MYTHIC]=WH.TERMS.mythic_abbrev;n[t.ID_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;n[t.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic_abbrev;n[t.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking_abbrev;n[t.ID_SEASON_OF_MASTERY_DUNGEON]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_DUNGEON);n[t.ID_SEASON_OF_MASTERY_20_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_20_PLAYER);n[t.ID_SEASONAL_40_PLAYER]=t.getNameShorthand(t.ID_SEASONAL_40_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_10_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_10_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_20_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_20_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2);n[t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3);n[t.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL);n[t.ID_SEASON_OF_DISCOVERY_5_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_5_PLAYER);n[t.ID_SEASON_OF_DISCOVERY_1_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_DISCOVERY_1_PLAYER);n[t.ID_MISTS_CELESTIAL]=t.getNameShorthand(t.ID_MISTS_CELESTIAL)}let r=[];let o=function(t){WH.setSelectedLink(this.closest&&this.closest(".indicator")||this,"lootmode-"+e.tabIndex);e.selectedDifficulty=t;let a=Listview.funcBox.getItemBonusesForDifficulty.call(e,t);e.itemBonusesFromDD=a[0];e.validateBonuses=a[1];if(t!=null){e.setSpecialHash("mode",WH.Strings.slug(n[t].replace(" ","")))}else{e.removeSpecialHash("mode")}e.customFilter=function(a){if(e.hasMultipleSeasonsPhases){return Listview.funcBox.filterSeasonPhaseMode.call(e,a,e._totalCount,t)}else{return Listview.funcBox.filterMode(a,e._totalCount,t)}};e.Filters.apply();e.applySort();e.refreshRows(true)};let l;let c=e.getSpecialHash("mode");for(let e=0;e<i.length;e++){let a=i[e];if(!this._lootModes[a]){continue}let u=WH.ce("a");WH.ae(u,WH.ce("span",{},WH.ct(n[a])));WH.ae(u,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",this._lootModes[a])));u._clickAction=o.bind(u,a);WH.aE(u,"click",u._clickAction);let d=t.getIconClass(a);if(d){u.classList.add(d)}r.push({indicator:$('<span class="indicator-mode"></span>').append(u).append($("<b"+(d?' class="'+d+'"':"")+">"+n[a]+" ("+this._lootModes[a]+")</b>")),tooltip:s[a]});if(r.length===1){l=o.bind(u[0],a)}if(c===WH.Strings.slug(n[a].replace(" ",""))){u._clickAction()}}if(l&&(!WH.setSelectedLink.groups||!WH.setSelectedLink.groups["lootmode-"+e.tabIndex])){l()}let u=false;for(let e=0;e<r.length;++e){let t=$("a",r[e].indicator);if(!$("span",t).html()&&r.length==3){u=true}else{this.createIndicator(r[e].indicator,null,t[0]._clickAction,r[e].tooltip)}}if(u){l()}if(this.showLootSpecs){this.classSelectorDiv.style.marginTop="0px"}},addModesAndSeasonsPhases:function(){const e=this;const t=WH.Wow.Season;let a=t.getPreferredSeason();let i=this.seasonPhaseData?.[a];if(a===t.SEASON_ALL||i){this._selectedSeasonId=a}else{this._selectedSeasonId=t.SEASON_ALL}this._selectedPhaseId=typeof i==="object"?Object.entries(i).map((e=>+e[0])).reduce(((e,t)=>Math.max(e,t)),t.PHASE_ALL):t.PHASE_ALL;Listview.funcBox.addModeIndicator.call(this);if(this.hasMultipleSeasonsPhases&&this.seasonPhaseData!=undefined){let a=function(a,i,n,s,r,o,l){e._selectedSeasonId=a;e._selectedPhaseId=i;WH.st(s,Menu.getLabel(o));r.forEach((e=>{if(e==o){e.checked=true}else{e.checked=false}}));n.Filters.apply();n.applySort();n.refreshRows(true);if(l){t.setPreferredSeason(a)}const c=WH.qs(".listview-note .tag");if(c){const e=n.data.filter((e=>e.__hidden)).length;WH.st(WH.qs(".tag-label",c),WH.term("itemsFilteredOut_format",e));c.dataset.hidden=`${!e}`}};let i=[];let n=WH.DOM.createImitationSelect({menu:i});let s=[t.NO_SEASON,t.SEASON_CLASSIC_20TH_ANNIVERSARY];let r=Object.keys(this.seasonPhaseData).sort(((e,t)=>{e=parseInt(e);t=parseInt(t);let a=s.indexOf(e);let i=s.indexOf(t);if(a!==-1&&i!==-1){return a-i}if(a!==-1){return-1}if(i!==-1){return 1}return e-t}));r.forEach((e=>{let s=Object.keys(this.seasonPhaseData[e]);for(let o in this.seasonPhaseData[e]){e=parseInt(e);o=parseInt(o);let l=t.getSeasonName(e)??(e===0?"":WH.term("season_format",e));let c=WH.isRetailTree()&&(e==t.NO_SEASON||e==t.SEASON_RETAIL_LEGION_REMIX);let u=l;let d=o===0?c?"":WH.term("allPhases"):WH.term("phase_format",o);if(u!==""&&d!==""){u+=WH.TERMS.hyphen_punct}u+=d;if(r.length===1&&s.length===1){this._selectedSeasonId=e;this._selectedPhaseId=o}let f=Menu.createItem({label:u});let h=t=>a(e,o,this,n,i,f,t);Menu.setItemUrl(f,(()=>h(true)));i.push(f);if(e==this._selectedSeasonId&&o==this._selectedPhaseId){f.checked=true;WH.st(n,u);h(false)}}}));if(i.length>1){let e=Menu.createItem({label:WH.term("allSeasonsAndPhases")});let s=s=>a(t.SEASON_ALL,t.PHASE_ALL,this,n,i,e,s);Menu.setItemUrl(e,(()=>s(true)));i.unshift(e);if(this._selectedSeasonId===t.SEASON_ALL&&this._selectedPhaseId===t.PHASE_ALL){s(false)}WH.React.loadComponentCss("universal/Tag",(()=>{WH.React.initComponent(this.noteTop,"modules/universal/Tag",{buttonProps:{"data-simple-tooltip":WH.TERMS.resetFilter,onClick:()=>s(true)},"data-hidden":!this.data.filter((e=>e.__hidden===true)).length,label:WH.term("itemsFilteredOut_format",this.data.filter((e=>e.__hidden===true)).length)})}))}WH.aef(this.noteTop,n);if(Object.keys(this._distinctModes).length<=1){this.customFilter=function(t){return Listview.funcBox.filterSeasonPhaseMode.call(e,t,this._totalCount,this.selectedDifficulty??WH.Wow.Difficulty.ID_NONE)};this.Filters.apply();this.applySort();this.refreshRows(true)}}},filterMode:function(e,t,a){if(t!=null&&e.count!=null){if(e._count==null)e._count=e.count;var i=e._count;if(a!=null&&e.modes[a]){i=e.modes[a].count;t=e.modes[a].outof;if(e.modes[a].percentOverride){e.percentOverride=e.modes[a].percentOverride}}e.__tr=null;e.count=i;e.outof=t;if(t)e.percent=i/t*100;else e.percent=i}if(a==null){return true}return e.modes&&e.modes.mode&&e.modes.mode.indexOf(a)>=0},filterSeasonPhaseMode:function(e,t,a){let i=this._selectedSeasonId??WH.Wow.Season.SEASON_ALL;let n=this._selectedPhaseId??WH.Wow.Season.PHASE_ALL;if(!e.itemSeasonPhaseData){e.percent=e.count/e.outof*100;let t=e.seasonId??WH.Wow.Season.NO_SEASON;let a=e.phaseId??WH.Wow.Season.NO_PHASE;return i===WH.Wow.Season.SEASON_ALL&&n===WH.Wow.Season.PHASE_ALL||t==i&&a==n}a=a||WH.Wow.Difficulty.ID_NONE;let s=0;if(e.itemSeasonPhaseData){if(i===WH.Wow.Season.SEASON_ALL&&n===WH.Wow.Season.PHASE_ALL){t=0;Object.keys(e.itemSeasonPhaseData).forEach((i=>{Object.keys(e.itemSeasonPhaseData[i]).forEach((n=>{let r=e.itemSeasonPhaseData[i][n][a];if(r){if(r.count>0&&r.outof>0){s+=r.count;t+=r.outof}if(r.percentOverride){e.percentOverride=r.percentOverride}}}))}))}else{let r=((e.itemSeasonPhaseData[i]||{})[n]||{})[a];if(!r){return false}s=r.count;t=r.outof;if(r.percentOverride){e.percentOverride=r.percentOverride}}}if(e._count==null){e._count=e.count}e.__tr=null;e.count=s;e.outof=t;if(t){e.percent=s/t*100}else{e.percent=s}return true},getItemBonusesForDifficulty:function(e){var t=[];if(e&&WH.isSet("g_pageInfo")){var a=e<0?-e:e;var i=0;var n=g_pageInfo.typeId;switch(g_pageInfo.type){case 1:i=g_npcs[n]&&g_npcs[n].hasOwnProperty("location")?g_npcs[n].location[0]:0;break;case 7:i=n;break;default:break}var s=0;if(WH.isSet("g_mapdifficulties")&&g_mapdifficulties[i]&&g_mapdifficulties[i][a]){s=g_mapdifficulties[i][a]}else if(WH.isSet("g_difficulties")&&g_difficulties[a]){s=g_difficulties[a].context||0}t=Listview.funcBox.getBonusDataForContext.call(this,s)}return t},getItemUrl:function(e,t){var a;if(e.baseName){a=e.baseName}else if(typeof e.name==="string"&&e.name!==""){a=e.name}var i={};var n=Listview.funcBox.getCurrentItemBonuses.call(this,e);if(n.length>0){i.bonus=n.join(":")}if(this.ilvlOverride){i[this.ilvlOverride.name]=""}else if(this.addIlvlToLinks){i.ilvl=Listview.funcBox.getItemLevelWithBonuses(e)}return WH.Entity.getUrl(WH.Types.ITEM,e.id,a,i,t)},getBonusDataForContext:function(e){var t=[];if(e&&WH.isSet("g_item_bonuscontexts")&&g_item_bonuscontexts[e]){var a=[];var i=[];for(var n in g_item_bonuscontexts[e]){var s=g_item_bonuscontexts[e][n];a.push(s[1]);i.push(s[0])}t=[a,i]}return t},initSeasonPhaseData:function(){this.seasonPhaseData={};for(let e=0;e<this.data.length;e++){if(this.data[e].hasOwnProperty("itemSeasonPhaseData")){Object.keys(this.data[e].itemSeasonPhaseData).forEach((t=>{this.seasonPhaseData[t]??={};Object.keys(this.data[e].itemSeasonPhaseData[t]).forEach((e=>{this.seasonPhaseData[t][e]=true}))}))}else if(this.data[e].hasOwnProperty("seasonId")){this.seasonPhaseData[this.data[e].seasonId]??={};if(this.data[e].hasOwnProperty("phaseId")){this.seasonPhaseData[this.data[e].seasonId][this.data[e].phaseId]=true}else{this.seasonPhaseData[this.data[e].seasonId][WH.Wow.Season.NO_PHASE]=true}}else{this.seasonPhaseData[WH.Wow.Season.NO_SEASON]??={};this.seasonPhaseData[WH.Wow.Season.NO_SEASON][WH.Wow.Season.NO_PHASE]=true}}this._distinctModes??={};this._lootModes??={};let e=Object.keys(this.seasonPhaseData);if(e.length>1||e.length===1&&(parseInt(e[0])!==WH.Wow.Season.NO_SEASON||Object.keys(this.seasonPhaseData[e[0]]).length>1)){this.hasMultipleSeasonsPhases=true;Listview.funcBox.addModesAndSeasonsPhases.call(this)}else{this.hasMultipleSeasonsPhases=false;this.seasonPhaseData=undefined;Listview.funcBox.addModeIndicator.call(this)}},assocArrCmp:function(e,t,a){if(e==null)return-1;else if(t==null)return 1;var i=Math.max(e.length,t.length);for(var n=0;n<i;++n){if(e[n]==null)return-1;else if(t[n]==null)return 1;var s=WH.stringCompare(a[e[n]],a[t[n]]);if(s!=0)return s}return 0},location:function(e,t,a){if(e.location==null){return}var i=a?a:3;var n=e.location.slice(0,i);if(n.length<e.location.length){n.push(-1)}for(var s=0,r=n.length;s<r;++s){if(s>0)WH.ae(t,WH.ct(WH.TERMS.comma_punct));var o=n[s];if(o==-1)WH.ae(t,WH.ct(WH.TERMS.ellipsis_punct));else{var l=WH.ce("a");l.className="q1";l.href=WH.Entity.getUrl(WH.Types.ZONE,o,WH.Wow.Area.getName(o));WH.ae(l,WH.ct(WH.Wow.Area.getName(o)||WH.Gatherer.getName(WH.Types.ZONE,o)));WH.ae(t,l)}}},arrayText:function(e,t){if(e==null){return}else if(!Array.isArray(e)){return t[e]}var a="";for(var i=0,n=e.length;i<n;++i){if(i>0)a+=" ";if(!t[e[i]])continue;a+=t[e[i]]}return a},createCenteredIcons:function(e,t,a,i,n,s,r){if(e!=null){var o=0;const _=WH.ce("div");const T=WH.ce("div");WH.ae(document.body,_);if(a&&(e.length!=1||!r)){var l=WH.ce("div");l.style.position="relative";l.style.width="1px";var c=WH.ce("div");c.className="q0";c.style.position="absolute";c.style.right="2px";c.style.lineHeight="26px";c.style.fontSize="11px";c.style.whiteSpace="nowrap";WH.ae(c,WH.ct(a));WH.ae(l,c);WH.ae(_,l);_.style.paddingLeft=$(c).width()+"px"}var u=g_items;if(i==WH.Types.SPELL){u=g_spells}else if(i==WH.Types.BATTLE_PET_ABILITY){u=g_petabilities}for(var d=0,f=e.length;d<f;++d){if(s&&o%s==0){WH.ae(_,WH.ce("div",{className:"clear-left"}))}o++;var h;if(e[d]==null){h=WH.ce("div");h.style.width=h.style.height="26px"}else{var p=undefined;var m=undefined;var H=undefined;if(typeof e[d]=="object"){p=e[d][0];m=e[d][1];H=e[d][2]}else{p=e[d]}if(typeof p=="string"){h=Icon.create(p,0,null,H)}else if(p){h=u.createIcon(p,0,m)}else{h=Icon.create("inventoryslot_empty",0,null,"javascript:")}if(n){h.children[2].rel=n[d]}}if(e.length==1&&r){if(p&&g_items[p]){WH.ee(_);var g=g_items[p],W=WH.ce("a"),E=WH.ce("span");E.style.paddingTop="4px";W.href=WH.Entity.getUrl(WH.Types.ITEM,p);W.className="q"+g.quality+" icontiny tinyspecial";W.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+g.icon.toLowerCase()+".gif)";W.style.whiteSpace="nowrap";WH.st(W,WH.Gatherer.getName(WH.Types.ITEM,p));WH.ae(E,W);if(m>1)WH.ae(E,WH.ct(" ("+m+")"));if(a){var l=WH.ce("span");l.className="q0";l.style.fontSize="11px";l.style.whiteSpace="nowrap";WH.ae(l,WH.ct(a));WH.ae(_,l);if($(c).length>0)E.style.paddingLeft=$(c).width()+"px"}WH.ae(_,E)}}else{_.dataset.contentLayout="centered-icons";WH.ae(_,h)}}T.className="clear";WH.ae(t,_);WH.ae(t,T);return true}},createSocketedIcons:function(e,t,a,i,n){var s=0,r=WH.ce("div"),o=WH.ce("div");for(var l=0,c=e.length;l<c;++l){var u,d=a[l];if(g_items&&g_items[d])u=g_items.createIcon(d,0);else if(WH.isSet("g_gems")&&g_gems&&g_gems[d])u=Icon.create(g_gems[d].icon,0,null,WH.Entity.getUrl(WH.Types.ITEM,d));else u=Icon.create(null,0,null,"javascript:");u.className+=" iconsmall-socket-"+g_file_gems[e[l]]+(!a||!d?"-empty":"");u.style.cssFloat=u.style.styleFloat="left";if(i&&i[l]){u.insertBefore(WH.ce("var"),u.childNodes[1]);++s}WH.ae(r,u)}r.style.margin="0 auto";r.style.textAlign="left";r.style.width=26*e.length+"px";o.className="clear";WH.ae(t,r);WH.ae(t,o);if(n&&s==e.length){r=WH.ce("div");r.style.paddingTop="4px";WH.ae(r,WH.ct(n));WH.ae(t,r)}}};WH.Switcher=function(e,t,a){const i="true";const n="false";const s={elements:{container:undefined},toggleable:false};this.activateChoice=function(e){let t=WH.qs('.wh-button[data-switcher-id="'+e+'"]',s.elements.container);if(t){t.click()}else{WH.error("Could not find switcher choice with ID "+e)}};this.setChoice=e=>{let t=WH.qs('.wh-button[data-switcher-id="'+e+'"]',s.elements.container);if(t){r(t)}else{let e=WH.qs('.wh-button[data-active="true"]',s.elements.container);if(e){e.dataset.active=n}}};this.setChoiceLabel=function(e,t){let a=WH.qs('.wh-button[data-switcher-id="'+e+'"]',s.elements.container);if(a){WH.ee(a);if(t){WH.ae(a,t)}}else{WH.error("Could not find switcher choice with ID "+e)}};function r(e){let t=s.toggleable&&e.dataset.active===i?n:i;WH.setData('.wh-button[data-active="true"]',"active",n,e.parentElement);e.dataset.active=t}function o(e){let t=new WH.Button({"aria-label":e.name,"data-active":e.active?i:n,label:e.name,type:"toggle",style:"secondary"}).getElement();WH.ae(s.elements.container,t);if(e.id){t.dataset.switcherId=e.id}WH.aE(t,"click",c.bind(t,e));WH.preventSelectStart(t);if(e.nonTouchTooltip){WH.Tooltips.attachNonTouch(t,e.nonTouchTooltip)}else if(e.tooltip){WH.Tooltips.attach(t,e.tooltip)}}function l(e,t,a){a=a||{};if(a.toggleable){s.toggleable=true}s.elements.container=e;s.elements.container.classList.add("wh-button-group");s.elements.container.dataset.groupType="toggle";for(let e=0,a;a=t[e];e++){o(a)}}function c(e,t){r(this);if(e.onChange){e.onChange.apply(this,arguments)}}l.apply(this,arguments)};function Tabs(e){WH.cO(this,e);if(this.parent){this.parent=WH.ge(this.parent)}if(!this.parent){WH.error("Tabs cannot be created without a parent.");return}WH.DOM.setData(this.parent,"tabs",this);this.selectedTab=-1;this.tabList=null;this.tabs=[];this.nShows=0;if(this.maxRows==null&&window.innerWidth<768){this.maxRows=4}if(this.poundable==null)this.poundable=1;this.poundedTab=null;if(this.onLoad==null)this.onLoad=Tabs.onLoad.bind(this);if(this.onShow==null)this.onShow=Tabs.onShow.bind(this);if(this.onHide)this.onHide=this.onHide.bind(this);this.trackClick=Tabs.trackClick.bind(this);if(e.tabs instanceof Array){for(var t=0,a=e.tabs.length;t<a;t++){this.add(e.tabs[t].name,e.tabs[t].options)}this.flush()}}Tabs.prototype={add:function(e,t){let a;let i=this.tabs.length;a={caption:e,index:i,owner:this};WH.cO(a,t);this.tabs.push(a);if(this.tabList){let e=this.createTab(a);WH.ae(this.tabList,e)}WH.onLoad((()=>{const e=WH.ge(`tab-${a.id}`);e.role="tabpanel";e.tabIndex="0"}));return i},hide:function(e,t){if(this.tabs[e]){var a=this.selectedTab;if(e==0&&a==-1)this.poundedTab=this.selectedTab=a=0;if(e!=this.poundedTab)this.selectedTab=-1;this.tabs[e].hidden=!t;this.flush();if(!t&&e==a){this.selectedTab=a;for(var i=0,n=this.tabs.length;i<n;++i){if(i!=e&&!this.tabs[i].hidden)return this.show(i,1)}}}},markFirstTabInRow:function(){let e=null;if(this.tabs){this.tabs.some((t=>{if(!t.element){return true}if(e===null){e=t.element.getBoundingClientRect().left}t.element.dataset.firstInRow=JSON.stringify(t.element.getBoundingClientRect().left===e)}))}},unlock:function(e,t){if(this.tabs[e]){this.tabs[e].locked=t;let a=WH.gE(this.tabList,"button");$(".fa-lock",a[e]).remove();if(t){$("div, b",a[e]).prepend('<span class="fa fa-lock" />')}let i=location.hash.substr(1).split(";")[0];if(this.tabs[e].id==i){this.show(e,1)}}},focus:function(e){if(e<0)e=this.tabs.length+e;this.forceScroll=1;WH.gE(this.tabList,"button")[e].onclick({},true);this.forceScroll=null},show:function(e,t,a){const i=WH.DOM;var n;if(isNaN(e)||e<0)e=0;else if(e>=this.tabs.length)e=this.tabs.length-1;if(t==null&&e==this.selectedTab||this.tabs[e].hidden)return;if(this.tabs[e].locked)return this.onShow(this.tabs[e],this.tabs[this.selectedTab]);if(this.selectedTab!=-1){n=this.tabs[this.selectedTab];if(this.onHide&&!this.onHide(n))return;if(n.onHide&&!n.onHide())return}++this.nShows;let s=WH.gE(this.tabList,"button");if(this.selectedTab!==-1){delete s[this.selectedTab].dataset.selected;s[this.selectedTab].ariaSelected="false"}s[e].dataset.selected="true";s[e].ariaSelected="true";let r=i.getData(s[e],"tabSettings");if(this.maxRows||r.collapsed){const t=function(e){const t=WH.qs(".tab-responsive-list",e.parentNode);if(t){const a=WH.qs("div",t);if(e.dataset.responsiveHidden==="true"){t.dataset.selected="true";a.innerHTML=this.getMoreTabName(true,WH.qs("div",e).innerHTML)}else{delete t.dataset.selected;a.innerHTML=this.getMoreTabName(true)}}};if(a){setTimeout(t.bind(this,s[e]),250)}else{t.call(this,s[e])}}n=this.tabs[e];if(n.onLoad){n.onLoad();n.onLoad=null}this.onShow(this.tabs[e],this.tabs[this.selectedTab]);if(n.onShow)n.onShow(this.tabs[this.selectedTab]);const o=s[e].closest("div");const l=s[e].getBoundingClientRect();const c=o.getBoundingClientRect();const u=l.left-c.left;const d=c.width/2;const f=l.width/2;const h=o.scrollLeft+u-d+f;o.scrollTo({left:h,behavior:"smooth"});this.selectedTab=e;window.dispatchEvent(new CustomEvent("scroll"))},flush:function(e){var t;var a=WH.ce("div");a.className="tabs-container";var i="div";this.tabList=WH.ce(i);this.tabList.className="tabs";this.tabList.role="tablist";WH.ae(a,this.tabList);for(var n=0;n<this.tabs.length;++n){var s=this.tabs[n];s.element=this.createTab(s);WH.ae(this.tabList,s.element)}let r=WH.qsa("button",this.tabList);let o=0;r.forEach(((e,t)=>{e.tabIndex=t===0?0:-1}));const l=e=>{if(e.key==="ArrowRight"||e.key==="ArrowLeft"){r[o].tabIndex=-1;do{if(e.key==="ArrowRight"){o=(o+1)%r.length}else{o=(o-1+r.length)%r.length}}while(r[o].parentElement.dataset.selected==="true");r[o].tabIndex=0;r[o].focus();r[o].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"});e.preventDefault()}};WH.aE(this.tabList,"keydown",l);WH.ee(this.parent);WH.ae(this.parent,a);if(isNaN(e)){let t=false;let a;this.tabs.some((e=>{if(e.collapsed){t=true}else if(isNaN(a)){a=e.index}return t&&!isNaN(a)}));if(t){e=a}}if(this.onLoad){let t=this.onLoad();if(t!=null){this.poundedTab=e=t}}new WH.ScrollFade(this.tabList);this.show(e,null,true);this.collapseExtraTabs();WH.aE(window,"resize",this.markFirstTabInRow.bind(this));this.markFirstTabInRow();setTimeout(this.markFirstTabInRow.bind(this),.5*WH.Time.MS_SEC)},createTab:function(e){const t=WH.DOM;var a,i;a=WH.ce("button");a.role="tab";t.setData(a,"tabSettings",e);if(e.className){a.className=e.className}if(e.hidden){a.style.display="none"}if(this.poundable&&!e.noPound){a.dataset.href="#"+e.id}else{a.dataset.href=null}if(e.menu){Menu.add(a,e.menu,{showAtElement:true,onShow:e.onShowMenu,onHide:e.onHideMenu})}else{a.onclick=Tabs.onClick.bind(e,a)}if(e.tooltip){WH.Tooltips.attach(a,e.tooltip,"q")}var n=WH.ce("div");if(e.locked){i=WH.ce("span",{className:"fa fa-lock"});WH.ae(n,i)}else if(e.icon&&e.textless){let t=WH.ce("img",{ariaLabel:e.caption,className:"textless-icon",src:WH.Icon.getIconUrl(e.icon.toLowerCase(),WH.Icon.MEDIUM)});WH.Tooltips.attach(t,e.caption);WH.ae(n,t);if(e.iconBorder){n.classList.add("bordered-icon")}}else if(e.icon&&!e.textless){i=WH.ce("span",{className:"icontiny"});i.style.backgroundImage=`url(${WH.Icon.getIconUrl(e.icon.toLowerCase(),WH.Icon.SMALL)})`;WH.ae(n,i);if(e.iconBorder){i.classList.add("bordered-icon")}}else if(e.image){i=WH.ce("img");$.extend(i,e.image);WH.ae(n,i)}else if(e.fontIcon){i=WH.ce("i",{className:"fa fa-"+e.fontIcon});WH.ae(n,i)}if(e["class"]){n.className=e["class"]}if(!e.textless){WH.ae(n,WH.ct(e.caption))}WH.ae(a,n);a.tabSettings=e;e.tab=a;return a},collapseExtraTabs:function(){const e=this;const t=WH.DOM;let a=e.tabs.some((e=>e.collapsed));if(!e.maxRows&&!a){return}const i=1;let n=e.maxRows||Number.MAX_SAFE_INTEGER;let s=WH.qs(":scope > button",e.tabList);let r=getComputedStyle(s);let o=s.getBoundingClientRect().height+parseFloat(r.marginTop)+parseFloat(r.marginBottom);if(!(a||e.tabList.getBoundingClientRect().height-i>o*n)){return}let l=WH.qsa("button",e.tabList);let c=[];let u=[];if(a){l.forEach((e=>{if(t.getData(e,"tabSettings").collapsed){u.push(e)}}))}else{l.forEach((e=>{if(e.offsetTop-i>o*n-o){u.push(e)}else{c.push(e);while(c.length>2){c.shift()}}}))}while(u.length>0&&c.length>0){u.unshift(c.pop())}let d=[];u.forEach((a=>{a.dataset.responsiveHidden="true";let i=t.getData(a,"tabSettings");d.push(Menu.createItem({label:i.caption,url:()=>{a.click();if(window.innerWidth<768){WH.scrollTo(e.tabList,{animated:true,asNeeded:true})}},options:{checkedFunc:()=>e.selectedTab===i.index}}))}));e.add(e.getMoreTabName(false),{className:"tab-responsive-list",fontIcon:"bars",menu:d,onShowMenu:()=>e.currentTabContents.classList.add("tab-fade"),onHideMenu:()=>e.currentTabContents.classList.remove("tab-fade"),noPound:false})},getMoreTabName:function(e,t){var a=e?'<i class="fa fa-bars"></i>':"";if(t){a+=" &ndash; "+t}return a},setTabIcon:function(e,t){let a=WH.gE(this.tabList,"button")[e];a.tabSettings.icon=t;WH.qs("span.icontiny",a).style.backgroundImage='url("'+WH.Icon.getIconUrl(t,WH.Icon.TINY)+'")'},setTabName:function(e,t){this.tabs[e].caption=t;var a=WH.gE(this.tabList,"button");WH.setTextNodes(a[e],t)},setTabPound:function(e,t){if(!this.poundable){return}let a=WH.gE(this.tabList,"button");a[e].setAttribute("data-href","#"+this.tabs[e].id+(t?";"+t:""))},setTabTooltip:function(e,t){this.tabs[e].tooltip=t;var a=WH.gE(this.tabList,"button");if(t==null)a[e].onmouseover=a[e].onmousemove=a[e].onmouseout=null;else{a[e].onmouseover=function(e){WH.Tooltips.showAtCursor(e,t,"q2")};a[e].onmousemove=WH.Tooltips.cursorUpdate;a[e].onmouseout=WH.Tooltips.hide}},getSelectedTab:function(){return this.selectedTab},getTabById:function(e){for(var t=0,a=this.tabs.length;t<a;++t){if(this.tabs[t].id==e)return t}}};Tabs.onClick=function(e,t,a){var i=WH.rfWithoutControlKey(t);if(i==null)return;Menu.hide();if(a!=null||this.index!==this.owner.selectedTab){this.owner.show(this.index,a)}if(this.owner.poundable&&!this.locked){let t=e.getAttribute("data-href");if(t&&t.startsWith("#")){if(location.hash.indexOf(t)!==0){location.replace(t)}}}return i};Tabs.onLoad=function(){if(!this.poundable||!location.hash.length){return}let e=location.hash.substr(1).split(/[;:]/)[0];if(e){for(let t=0,a;a=this.tabs[t];t++){if(a.id===e&&!a.locked){return t}}}};Tabs.onShow=function(e,t){if(e.hidden||e.locked)return;if(t)WH.ge("tab-"+t.id).style.display="none";if(this.poundedTab!=null||t)this.trackClick(e);var a=WH.ge("tab-"+e.id);if(!a){throw new Error(`Tab not found. Expected ID "${"tab-"+e.id}".`)}a.style.display="";this.currentTabContents=a;WH.Tools.Bloodmallet.updateChartsSizes(a);if((this.nShows===1&&typeof this.poundedTab==="number"&&this.poundedTab>=0||this.forceScroll)&&!this.noScroll){setTimeout((()=>{let e=(location.hash.split(Listview.HASH_DELIMITER)[0]||"").slice(1);let t=e&&WH.ge(e);if(!t){t=this.parent}else if(!a.contains(t)){WH.error("Hash-specified element conflicts with tab contents.");t=this.parent}WH.scrollTo(t,{animated:!WH.pageWasReloaded()})}),100)}};Tabs.trackClick=function(e){if(!this.trackable||e.tracked){return}WH.Track.interactiveEvent({category:"Tab Click",action:"Page: "+this.trackable,label:"Tab: "+e.id});e.tracked=1};WH.Theme=new function(){const e=this;const t=WH.Layout;this.THEME_IMMORTAL="immortal";this.THEME_STANDARD="standard";const a=[];const i={[WH.dataTree.RETAIL]:[this.THEME_STANDARD],[WH.dataTree.CLASSIC]:[this.THEME_STANDARD],[WH.dataTree.TBC]:[this.THEME_STANDARD],[WH.dataTree.WRATH]:[this.THEME_STANDARD],[WH.dataTree.CATA]:[this.THEME_STANDARD],[WH.dataTree.MISTS]:[this.THEME_STANDARD],[WH.dataTree.D2]:[this.THEME_STANDARD],[WH.dataTree.DI]:[this.THEME_IMMORTAL],[WH.dataTree.D4]:[this.THEME_IMMORTAL]};this.getFaviconUrl=()=>{let e=WH.getDataTreeKey();return t.getFaviconUrl(e,16)};this.getTheme=function(){return WH.PageMeta.theme||e.THEME_STANDARD};this.getThemePath=function(){return e.getTheme()+"/"};this.getThemes=function(){return i[WH.getDataTree()]||[]};this.isDark=function(){return!a.includes(e.getTheme())};this.isStandard=function(){return e.getTheme()===e.THEME_STANDARD};this.set=function(t){if(e.getThemes().indexOf(t)<0){alert(WH.TERMS.invalidOption);WH.error("Tried to set an invalid theme:",t);return}WH.User.saveOption("theme",t,(function(){window.location=window.location.href}))}};WH.Tools=new function(){const e={cta:{},includedCss:[]};this.createMountCollectionTrackerCta=function(){return e.cta.mountTracker=e.cta.mountTracker||t("mount",WH.TERMS.mountCollectionTracker,"/mount-collection-tracker")};this.createBattlePetCollectionTrackerCta=function(){return e.cta.battlePetTracker=e.cta.battlePetTracker||t("pet",WH.TERMS.battlePetCollectionTracker,"/battle-pet-collection-tracker")};this.createToyCollectionTrackerCta=function(){return e.cta.toyTracker=e.cta.toyTracker||t("toy",WH.TERMS.toyCollectionTracker,"/toy-collection-tracker")};this.createWowheadClientCta=function(){return e.cta.wowheadClient=e.cta.wowheadClient||t("client",WH.TERMS.wowheadClientGather_tip,"/client")};function t(e,t,i){if(e==="client"&&WH.User.isClientCtaSuppressed()){return null}a("collection-tracker-cta");var n=WH.ce("div",{className:"collection-tracker-cta"});n.setAttribute("data-type",e);var s=WH.ce("div",{className:"collection-tracker-cta-name"});WH.st(s,t);WH.ae(n,s);if(e==="new"){var r=WH.ce("div",{className:"collection-tracker-cta-name-all-new"});WH.st(r,WH.TERMS.allNew_tip);WH.aef(s,r)}if(e!=="client"){var o=WH.createButton(WH.TERMS.collectionCta_button)}else{var o=WH.createButton(WH.TERMS.downloadNow)}WH.ae(n,o);WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-primary"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-left"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-center"}));if(e==="client"){WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-right"},WH.ct(WH.TERMS.helpUpdateDatabase_tip)))}else{WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-right"}))}WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-gradient"}));WH.ae(n,WH.ce("a",{ariaLabel:WH.TERMS.mountCollectionTracker,className:"collection-tracker-cta-cover",href:i}));return n}function a(t){if(e.includedCss.includes(t)){return}let a=WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"tools/partials/"+t+".css";if(WH.PageMeta.scriptVersionQueryString){a+="?"+WH.PageMeta.scriptVersionQueryString}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:a}))}};WH.Track=new function(){const e="Click";const t={adsBlocked:3,adsUnblocked:4,loggedInUserIsPremium:2,userIsLoggedIn:1,userShouldSeeAds:5};const a=1e4;const i=10;const n=[25,50,75,90,100];const s={gaReady:false,scriptAdded:undefined};this.gaInit=function(e){if(!s.scriptAdded){(function(e,t,a,i,n,s,r){e["GoogleAnalyticsObject"]=n;e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date;s=t.createElement(a),r=t.getElementsByTagName(a)[0];s.async=1;s.src=i;r.parentNode.insertBefore(s,r)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");let e=()=>{let e=document.createElement("script");e.async=true;e.src="https://www.googletagmanager.com/gtag/js?id=G-1G60NXCNZF";document.body.appendChild(e)};if(document.body){e()}else{WH.aE(document,"bodyAvailable",e)}window.dataLayer=window.dataLayer||[];window.gtag=function(){dataLayer.push(arguments)};gtag("js",new Date);gtag("config","G-1G60NXCNZF");s.scriptAdded=true}if(!window.ga||!ga.create){if(!e){e=1}if(e>100){return}setTimeout(WH.Track.gaInit.bind(WH.Track,e+1),e*9);return}ga("create","UA-574613-1","wowhead.com");r(t.userShouldSeeAds,WH.WAS.showAds());r(t.userIsLoggedIn,WH.User.isLoggedIn());if(WH.User.isLoggedIn()){r(t.loggedInUserIsPremium,WH.User.isPremium())}if(WH.WAS.showAds()){var a=WH.ce("ins",{className:"AdSense",style:{display:"block",height:"1px",position:"absolute",top:"-1px"}});document.body.appendChild(a);r(t.adsBlocked,!a.clientHeight);document.body.removeChild(a)}ga("set","anonymizeIp",true);ga("send","pageview");s.gaReady=true;n.forEach(o)};this.interactiveEvent=e=>l(e);this.interactiveEventOutgoing=e=>l(e,{isOutgoing:true});this.linkClick=(t,a)=>l({...a,action:e,value:t.href},{isOutgoing:true});this.nonInteractiveEvent=e=>l(e,{nonInteraction:true});function r(e,t){ga("set","dimension"+e,t)}function o(e){let t=false;const a=()=>{if(t){return}t=true;requestAnimationFrame((()=>{const i=window.scrollY;const n=document.documentElement.scrollHeight-document.documentElement.clientHeight;if(i/n*100>=e){l({action:"scroll_event",event_category:"Scroll Depth",event_label:`${e}%`,scroll_depth:e});window.removeEventListener("scroll",a,{passive:true})}t=false}))};window.addEventListener("scroll",a,{passive:true})}function l(t,n){const{action:r,...o}=t;const{category:c,label:u,value:d}=o;const{nonInteraction:f,isOutgoing:h}=n||{};let{retryCount:p}=n||{};let m=()=>WH.debug("Track Event:",t,n);if(!p){m()}if(!s.gaReady){if(WH.isDev()){return}if(!p){p=0}p++;if(p*i>a){return}setTimeout(l.bind(null,t,{nonInteraction:f,isOutgoing:h,retryCount:p}),i);return}if(p){m()}let H;if(typeof f==="boolean"){H??={};H.nonInteraction=f?1:0}if(h){H??={};H.transport="beacon"}if(c){ga("send","event",c,r,u,d,H)}gtag("event",r,o);if(window.PARSELY){if(window.PARSELY?.beacon?.trackPageView){window.PARSELY?.beacon.trackPageView({url:r===e&&d.startsWith("http")?d:undefined,urlref:location.href,action:`_${r}`,data:(()=>{let e={};Object.entries(t).forEach((([t,a])=>e[`_${t}`]=a));return e})()})}else{WH.debug("Parsely tracking is failing.",t)}}}};WH.Twitter=new function(){const e=WH.DOM;const t=Object.seal({loadedScript:false,loadingQueue:[]});this.renderTweet=function(t,a){i((()=>e.onBodyAdd(a,(()=>{a.dataset.loading="true";let e=WH.ce("span",{className:"twitter-tweet-loading fa fa-circle-o-notch fa-spin fa-fw q0"});WH.aef(a,e);let i={};if(WH.Theme.isDark()){i.theme="dark"}twttr.widgets.createTweet(t,a,i).then((t=>{e.parentNode.removeChild(e);if(t){a.dataset.loading="false"}else{delete a.dataset.loading}})).catch((()=>{delete a.dataset.loading;e.parentNode.removeChild(e)}))}))))};function a(){let a=e.addScriptOnce("https://platform.twitter.com/widgets.js",{type:"text/javascript"});if(a){WH.aE(a,"load",(function(){t.loadedScript=true;while(t.loadingQueue.length){t.loadingQueue.shift()()}}))}}function i(e){if(t.loadedScript){window.requestAnimationFrame(e)}else{t.loadingQueue.push(e);a()}}};WH.Url=new function(){const e=this;const t=WH.Game;const a=WH.Types;const i=WH.getPageData("url.alternatePathCommands")||{};const n="wowhead.com";const s="nether";const r="skyhold";const o=WH.getPageData("url.rootEnvPathCommands")||[];this.addGet=function(e,t,a){if(e instanceof Location){e=""+e}if(typeof e!=="string"){WH.error("Tried to add a get arg to a non-string!",e,t,a);return e}if(e.substr(-12)==="wowhead.com/"){e+="home"}var i=t+"\\b(=*[^&]+)?";if(e.indexOf("?"+t)>-1){e=e.replace(new RegExp("\\?"+i),"")}if(e.indexOf("&"+t)>-1){e=e.replace(new RegExp("&"+i),"")}return e+(e.indexOf("?")===-1&&e.indexOf("&")===-1?"?":"&")+t+(a?"="+a:"")};this.addMaxSizeParams=function(t,a){let i=/^https?:\/\/wow\.zamimg\.com/.test(t);i|=t.substr(0,WH.staticUrl.length)===WH.staticUrl;if(!i){return t}if(/^https?:\/\/[^\/]+\/modelviewer\//.test(t)){return t}let n=WH.PageMeta.staticResizing||{limit:600,throttle:{start:600,percent:0}};let s=l(t);let r=e.parseQueryString(t);let o=function(e){e=e.toLowerCase();for(let t in r){if(!r.hasOwnProperty(t)){continue}if(t.toLowerCase()===e){return t}}};let c=Math.max(1,Math.ceil((window.devicePixelRatio||1)*2)/2);let u=false;let d=false;["width","height"].forEach((function(e){if(!a[e]){return}let t=/^(\d+)(?:px)?$/.exec(a[e]);if(t===null){return}let i=Math.ceil(parseInt(t[1])*c);if(i>n.limit){return}if(s[e]&&i>=s[e]){return}d=d||i>n.throttle.start;let l="max"+e.substr(0,1).toUpperCase()+e.substr(1);l=o(l)||l;let f=r[l];if(f){if(/\D/.test(f)){return}f=parseInt(f)}if(f>i){return}u=true;r[l]=i}));if(!u){return t}if(d){if(parseInt(WH.MD5.hash(t).substr(-2),16)/255>n.throttle.percent/100){return t}}let f="";{let e=t.indexOf("#");if(e>=0){f=t.substr(e);t=t.substr(0,e)}}{let e=t.indexOf("?");if(e>=0){t=t.substr(0,e)}}let h=e.buildQuery(r);return t+"?"+h+f};this.atRootHome=()=>WH.Url.removePathPrefixes(location.pathname,true)==="/"||e.atNewRootHome();this.atNewRootHome=()=>e.getPathCommand()==="/new-home";this.buildQuery=function(e){let t=[];let a=Object.keys(e);a.sort((function(e,t){return e.localeCompare(t)}));for(let i,n=0;i=a[n];n++){if(!e.hasOwnProperty(i)){continue}if(e[i]===""){t.push(i)}else{t.push(i+"="+encodeURIComponent(e[i]).replace(/%3a/gi,":"))}}return t.join("&")};this.ensurePathSlash=function(e){if(e.substr(0,1)!=="/"){e="/"+e}return e};this.generate=function(t,a){a=a||{};let i,s;if(a.production){i=`www.${n}`;s="https:"}else{i=location.hostname;s=location.protocol}return s+"//"+i+e.generatePath(t,a.dataEnv,a.locale)};this.generateAnonymous=function(t,a){t=e.ensurePathSlash(t);let i=a?"?"+e.buildQuery(a):"";return`${location.protocol}//${s}.${WH.PageMeta.envDomain}${t}${i}`};this.generatePath=function(t,a,i){a=a||WH.getDataEnv();if(t!==""){t=e.removePathPrefixes(t)}if(o.includes(t.replace(/\?[\w\W]*/,""))){a=Object.values(WH.dataEnv).find((e=>WH.Game.getSelectorByDataEnv(e)==null))??a}let n=[];let s=WH.Game.getSelectorByDataEnv(a);if(s){n.push(s)}i=typeof i==="number"?i:Locale.getId();i=Locale.getDataEnvForcedLocale(a)??i;let r=Locale.getSelector(i);if(r){n.push(r)}t=t.replace(/^\/+|\/+$/,"");if(t){n.push(t)}return"/"+n.join("/")};this.generatePrivate=t=>{t=e.ensurePathSlash(t);return`${location.protocol}//${r}.${WH.PageMeta.envDomain}${t}`};this.generateStatic=e=>`${WH.STATIC_URL}${e}`;this.getAlternatePathCommand=(e,t)=>i[e]?.[t];this.getCanonical=function(){var e=WH.qs('link[rel="canonical"]');if(!e){return location.protocol+"//"+location.host+location.pathname+(location.search||"")}return e.href};this.getCanonicalPath=function(){var t=WH.qs('link[rel="canonical"]');if(!t){return location.pathname+(location.search||"")}return e.getPathFromUrl(t.href,true)};this.getDataPageUrl=function(t,a){let i=WH.getPageData("url.dataPageVersions")||{};let n=Locale.getId();a=a||WH.getDataEnv();let r=["dv="+i[t]||0,"db="+encodeURIComponent(WH.getDataCacheVersion(a)).replace(/%3a/gi,":")].join("&");let o=WH.isDataEnvRestricted(a)?location.hostname:`${s}.${WH.PageMeta.envDomain}`;let l=e.generatePath(`/data/${t}`,a,n);return`${location.protocol}//${o}${l}?${r}`};this.getLoginPath=function(t){let a="/account=signin";t=(t??location.pathname+location.search).replace(/^\//,"");if(t&&t.startsWith("account=signin")){t=WH.getGets().next||""}if(t){a+="?next="+encodeURIComponent(t)}return e.generatePath(a)};this.getModifiedPageQuery=function(e){let t=location.pathname;let a=location.search;let i=location.hash;if(!a){if(t.indexOf("&")>=0){a="?"+t.substr(t.indexOf("&")+1);t=t.substr(0,t.indexOf("&"))}}let n=WH.parseQueryString(a);e(n);let s=t;if(Object.keys(n).length){s+="?"+WH.Url.buildQuery(n)}s+=i;return s};this.getPathCommand=()=>e.removePathPrefixes(window.location.pathname);this.getPathFromUrl=function(e,t){if(t===true){return e.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^#]+).*$/,"/$1")}return e.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^?&#]+).*$/,"/$1")};this.getRegistrationPath=function(){return e.generatePath("/account=signup")};this.getUrlByReference=e=>{let t=e.split("=");if(t.length!==2){return null}let i=a.getIdByString(t[0]);if(!i||!/^\d+$/.test(t[1])){return null}return WH.Entity.getUrl(i,t[1])};this.hasPathPrefixes=function(e){if(e.startsWith("/")){e=e.substr(1)}let t=e.replace(/^([^/?&]*)?([/?&].*)?$/,"$1");return WH.Game.getAllSelectors().includes(t)||Locale.getPathSelectors().includes(t)};this.parsePathPrefixes=function(e){let a={};let i=e.replace(/[?&#].*/,"").replace(/^\//,"").split("/");let n=t.getDataEnvBySelector(i[0]);if(n){a.dataEnv=n;i.shift()}let s=Locale.getBySelector(i[0]);if(s){a.locale=s}return a};this.isRelative=function(e){return!e.startsWith("mailto:")&&!/^(https?:)?\/\//.test(e)};this.parseQueryString=function(e){let t;if((t=e.indexOf("#"))>=0){e=e.substr(0,t)}t=e.indexOf("?");if(t<0){return{}}return WH.parseQueryString(e.substr(t+1))};this.pushHistory=function(t){if(!/^https?:/.test(t)){t=e.generatePath(t)}history.pushState({},"",t)};this.removePathPrefixes=(a,i)=>{let n=a.match(/^([^?&]*)?([?&].*)?$/);if(!n){WH.error("Could not parse path when attempting to remove path prefixes.",a);return e.ensurePathSlash(a)}if(n[1].startsWith("/")){n[1]=n[1].substr(1)}let s=n[1].split(/[/?&]/);let r;if(t.getAllSelectors().includes(s[0])){r=s.shift()}if(Locale.getPathSelectors().includes(s[0])){s.shift()}if(i&&r){s.unshift(r)}return"/"+s.join("/")+(n[2]||"")};this.replaceHistory=function(t){if(!/^https?:/.test(t)){t=e.generatePath(t)}history.replaceState({},"",t)};this.replacePageQuery=function(t){let a=e.getModifiedPageQuery(t);if(a){history.replaceState({},"",a)}};function l(e){let t;if(t=e.match(/\/uploads\/blog\/(images|thumbs)\/(\d+)/)){let e=g_blogimages[t[2]];switch(t[1]){case"thumbs":return e?{width:e.thumbwidth,height:e.thumbheight}:{width:200,height:200};case"images":return e?{width:e.width,height:e.height}:{}}return{}}if(t=e.match(/\/uploads\/screenshots\/(normal|resized|small|thumb)\/(\d+)/)){let e=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,t[2]);let a;let i;switch(t[1]){case"normal":return e?{width:e.width,height:e.height}:{};case"resized":a=772;i=618;break;case"small":a=300;i=300;break;case"thumb":a=150;i=150;break}if(!a||!i){return{}}if(!e){return{width:a,height:i}}let n=e.width/e.height;let s=Math.min(a,e.width);let r=Math.round(s/n);if(r>i){r=i;s=Math.round(r*n)}return{width:s,height:r}}if(t=e.match(/\/uploads\/guide\/images\/(\d+)/)){let e=WH.Gatherer.get(WH.Types.GATHERER_GUIDE_IMAGE,t[1]);return e?{width:e.width,height:e.height}:{}}return{}}};WH.UserAgent=new function(){var e=["ahrefsbot","baiduspider","bingbot","bitdiscovery","blexbot","comscore.com/web-crawler","dotbot","duckduckbot","exabot","garlikcrawler","getintent","googlebot","ia_archiver","mail.ru_bot","mauibot","mediapartners-google","megaindex.com/crawler","mj12bot","naver.me/spd","petalbot","piplbot","protopage","rogerbot","semrushbot","sogou.com/docs/","viglink","weborama","yahoo! slurp","yandexbot","yandexmobilebot"];this.isWebCrawler=function(){var t=navigator.userAgent;if(!t){return false}t=t.toLowerCase();for(var a=0,i=e.length;a<i;a++){if(t.indexOf(e[a])!==-1){return true}}return false}};var vi_thumbnails={1:"//i3.ytimg.com/vi/$1/default.jpg"};var vi_siteurls={1:"https://www.youtube.com/watch?v=$1",2:"https://nether.wowhead.com/video-stream/$1"};var vi_sitevalidation=[/https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([^& ]{11})/i,/https?:\/\/(?:www\.)?youtu\.be\/([^& ]{11})/i];function vi_submitAVideo(){tabsContribute.focus(2)}function vi_validateForm(e){if(!e.elements["videourl"].value.length){alert(WH.TERMS.errorvideo_tip);return false}var t=false;for(var a in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(a)){continue}if(e.elements["videourl"].value.match(vi_sitevalidation[a])){t=true;break}}if(!t){alert(WH.TERMS.errorvideo_tip);return false}return true}function vi_appendSticky(){var e=WH.ge("infobox-sticky-vi");if(!e)return;var t=g_pageInfo.type;var a=g_pageInfo.typeId;var i=WH.inArray(lv_videos,1,(function(e){return e.sticky}));if(i!=-1){e.className="has-thumb";var n=lv_videos[i];var s=WH.ce("a");s.href="#videos:id="+n.id;s.onclick=function(e){VideoViewer.show({videos:lv_videos,pos:i});return WH.rfWithoutControlKey(e)};var r=WH.ce("img");r.src=WH.sprintf(vi_thumbnails[n.videoType].replace(/\/default\.jpg/,"/mqdefault.jpg"),n.videoId);r.className="border";WH.ae(s,r);WH.ae(e,s);var o=$("#infobox-videos");if(!o)o=$("th",$(e).parents().prev("tr"));o.append(" ("+lv_videos.length+")").wrapInner($('<a href="#videos"></a>').click((function(){tabsRelated.focus(tabsRelated.getTabById("videos"));return false})))}else if(g_user){var s;if(g_user.id>0)s='<a href="javascript:" onclick="vi_submitAVideo(); return false">';else s='<a href="'+WH.Strings.escapeHtml(WH.Url.generatePath(WH.Url.getLoginPath()))+'">';e.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,s+WH.TERMS.suggestone_stc+"</a>")}else{$("#infobox-videos,#infobox-sticky-vi").closest("td, th").css("display","none")}vi_appendSticky=function(){}}var g_videos={};window.VideoViewer=new function(){const e=170-Lightbox.BLEED_SIZE;const t=20;const a=50;var i,n,s,r,o,l,c=0,u,d,f,h,p,m,H,g,W,E;function _(e){var t=i[e],a="#videos:";if(c==0)a+="id="+t.id;else a+=u+":"+(e+1);return a}function T(e){N();if(e&&o==1&&WH.getWindowSize().h>d.offsetHeight)return;d.style.visibility="hidden";var t=i[n];if(!e){var a=t.caption!=null&&t.caption.length;WH.Track.interactiveEvent({category:"Videos",action:"Show",label:t.id+(a?` (${t.caption})`:"")});g.href=WH.sprintf(vi_siteurls[t.videoType],t.videoId);switch(t.videoType){case 1:$(h).empty().append(WH.markup.getDomFragment("[youtube="+t.videoId+" width="+s+" height="+r+"]"));break;case 2:WH.ee(h);WH.ae(h,WH.ce("video",{controls:true,width:s,height:r},WH.ce("source",{src:WH.Url.generateAnonymous("/video-stream/"+t.id+"-"+t.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})})));g.href=WH.sprintf(vi_siteurls[t.videoType],t.id+"-"+t.videoId);break}if(!t.user&&typeof g_pageInfo=="object")t.user=g_pageInfo.username;var l=t.date&&t.user,c=i.length>1;if(l){var u=new Date(t.date),f=(WH.getServerTime()-u)/1e3;var T=W.firstChild.childNodes[1];T.href=WH.Url.generatePath("/user="+t.user);T.innerHTML=t.user;var S=W.firstChild.childNodes[3];WH.ee(S);WH.formatDate(S,f,u);W.firstChild.style.display=""}else W.firstChild.style.display="none";var S=W.childNodes[1];WH.ee(S);S=W.childNodes[2];if(c){var b="";if(t.user)b=WH.TERMS.dash_punct;b+=n+1+WH.TERMS.of_lc+i.length;S.innerHTML=b;S.style.display=""}else S.style.display="none";W.style.display=l||c?"":"none";var y=t.subject!=null&&t.subject.length&&t.type&&t.typeId;if(a||y){var I="";if(y){var A=WH.ce("div");WH.ae(A,WH.ct(WH.Types.getUpperSingular(t.type)+WH.TERMS.colon_punct));WH.ae(A,WH.ce("a",{href:WH.Entity.getUrl(t.type,t.typeId)},WH.ct(t.subject)));I+=A.innerHTML}var R=document.createDocumentFragment();if(a){if(y){I+=WH.TERMS.dash_punct}R=t.noMarkup?document.createTextNode(t.caption):WH.markup.getDomFragment(t.caption,{mode:WH.markup.MODE.SIGNATURE})}$(E).html(I).append(R);E.style.display=""}else E.style.display="none";if(i.length>1){p.href=_(v(-1));m.href=_(v(1));p.style.display=m.style.display="";H.style.display="none"}else{p.style.display=m.style.display="none";H.style.display=""}location.replace(_(n))}else $("object, embed",h).each((function(){this.width=s;this.height=r}));Lightbox.reveal();d.style.visibility="visible"}function v(e){var t=n;t+=e;if(t<0)t=i.length-1;else if(t>=i.length)t=0;return t}function S(){n=v(-1);T();return false}function b(){n=v(1);T();return false}function y(e){switch(e.keyCode){case 37:S();break;case 39:b();break}}function I(){T(1)}function A(){WH.ee(h);if(i.length>1)WH.dE(document,"keyup",y);if(l&&c==0){if(l.indexOf(":id=")!=-1)l="#videos";WH.setHash(l)}else WH.clearHash()}function R(e,t,a){if(typeof a.videos=="string"){i=g_videos[a.videos];c=1;u=a.videos}else{i=a.videos;c=0;u=null}d=e;n=0;if(a.pos&&a.pos>=0&&a.pos<i.length)n=a.pos;if(t){e.className+=" has-lightbox-caption screenshotviewer";f=WH.ce("div");f.className="lightbox-content screenshotviewer-screen";var s=WH.ce("div");var r=WH.ce("div");s.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";r.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";p=WH.ce("a");m=WH.ce("a");p.className="screenshotviewer-prev";m.className="screenshotviewer-next";p.href="javascript:";m.href="javascript:";var o=WH.ce("span");o.className="fa fa-chevron-left";WH.ae(p,o);o=WH.ce("span");o.className="fa fa-chevron-right";WH.ae(m,o);p.onclick=S;m.onclick=b;H=WH.ce("a");H.className="screenshotviewer-cover";H.href="javascript:";H.onclick=Lightbox.hide;var _=WH.ce("span");var v=WH.ce("b");WH.ae(v,WH.ct(WH.TERMS.close));WH.ae(_,v);WH.ae(H,_);WH.ae(s,p);WH.ae(r,m);WH.ae(f,s);WH.ae(f,r);WH.ae(f,H);h=WH.ce("div",{className:"screenshotviewer-image"});WH.ae(f,h);WH.ae(e,f);var I=WH.ce("a");I.className="dialog-option fa fa-times";I.href="javascript:";I.onclick=Lightbox.hide;WH.ae(I,WH.ct(WH.TERMS.close));WH.ae(e,I);g=WH.ce("a");g.className="dialog-option fa fa-external-link";g.href="javascript:";g.target="_blank";WH.ae(g,WH.ct(WH.TERMS.original));WH.ae(e,g);var A=WH.ce("div",{className:"lightbox-caption"});W=WH.ce("div");W.className="screenshotviewer-from";var R=WH.ce("span");WH.ae(R,WH.ct(WH.TERMS.from));WH.ae(R,WH.ce("a"));WH.ae(R,WH.ct(" "));WH.ae(R,WH.ce("span"));WH.ae(W,R);WH.ae(W,WH.ce("span"));WH.ae(W,WH.ce("span"));WH.ae(A,W);E=WH.ce("div");E.className="screenshotviewer-caption";WH.ae(A,E);WH.ae(e,A)}l=location.hash;if(i.length>1)WH.aE(document,"keyup",y);T()}function N(){s=Math.floor(window.innerWidth-Lightbox.BLEED_SIZE-e-t);r=Math.floor(s*(9/16));let i=r+Lightbox.BLEED_SIZE+a;if(i>window.innerHeight){r=Math.floor(window.innerHeight-Lightbox.BLEED_SIZE-a);s=Math.floor(r*(16/9))}Lightbox.setSize(s+t)}this.checkPound=function(){if(location.hash&&location.hash.indexOf("#videos")==0){if(!g_listviews["videos"]){var e=location.hash.split(":");if(e.length==3){var t=g_videos[e[1]],a=parseInt(e[2]);if(t&&a>=1&&a<=t.length){VideoViewer.show({videos:e[1],pos:a-1})}}}}};this.show=function(e){Lightbox.show("videoviewer",{onShow:R,onHide:A,onResize:I},e);return false};$(document).ready(this.checkPound)};WH.WarcraftLogs=new function(){const e=WH.Gatherer;const t=WH.Types;this.displayTopSpells=function(e,t,a,i,n){var s=WH.ce("div",{className:a});WH.ae(s,WH.getImitationHeading(t,6));var r=WH.ce("table");var o=WH.ce("tr",{className:a+"-popularity"});var l=WH.ce("tr",{className:a+"-icon"});WH.ae(r,o);WH.ae(r,l);var c=0;if(i){for(var u=0,d;d=i[u];u++){var f=WH.Gatherer.get(WH.Types.SPELL,d.id);if(!f){continue}var h=WH.Entity.getUrl(WH.Types.SPELL,d.id,f.name);var p=WH.Icon.create(f.icon,WH.Icon.SMALL,h,{span:true});var m=Icon.getLink(p);m.setAttribute("data-whattach","true");if(n){m.target="_blank"}var H=WH.ce("td");WH.ae(H,p);WH.ae(o,WH.ce("td",{innerHTML:Math.round(d.pop)+"%"}));WH.ae(l,H);c++}}var g=0;if(!c){WH.de(l);var W=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});WH.ae(o,W);g++}WH.ae(s,r);if(e instanceof jQuery){e.append(s)}else{WH.ae(e,s)}return g};this.getCovenantTooltip=function(a){let i=WH.ce("div");WH.ae(i,WH.ce("b",{className:"q1"},WH.ct(e.getName(t.COVENANT,a.id))));let n=WH.ce("table",{style:{marginTop:"10px"}});WH.ae(i,n);a.soulbinds.forEach((function(a){let i=WH.ce("td",{className:"q",style:{paddingRight:"3px",textAlign:"right"}},WH.ct(WH.Strings.formatNumber(a.pop/100,true,0,1)));let s=a.id?e.getName(t.SOULBIND,a.id):null;if(!s){if(a.pop<.5){return}s=WH.TERMS.unknown+" / "+WH.TERMS.none}let r=WH.ce("td",{className:"q",style:{whiteSpace:"nowrap"}},WH.ct(s));let o=WH.ce("tr");WH.ae(o,i);WH.ae(o,r);WH.ae(n,o)}));return i.innerHTML}};WH.WAS=new function(){const e=this;const t=WH.DOM;const a=WH.DynamicFixedElement;const i=WH.Layout;const n=WH.LocalStorage;const s=WH.Responsive;const r=WH.Time;this.ANIMATION_DURATION_MS=333;this.EVENT_MOBILE_FOOTER_REMOVED="wh-mobile-footer-ad-removed";this.EVENT_MOBILE_FOOTER_CREATED="wh-mobile-footer-ad-created";const o=3;const l=2;var c=1e3*60*10;const u=1360;var d="Other";var f="Other";const h=150;const p=20;const m=["https://securepubads.g.doubleclick.net/tag/js/gpt.js","https://cdn.dotaoutpost.com/stable/js/wowhead.js?type=ab"+(()=>{let e=WH.parseQueryString(WH.getQueryString());return e.zafAbId?`&id=${e.zafAbId}`:""})(),"https://www.googletagmanager.com/gtm.js?id=GTM-KN7HXDF","https://zaf.api.fanbyte.com/stable/js/wowhead.js"+(()=>{let e=WH.parseQueryString(WH.getQueryString());return e.zafId?`?id=${e.zafId}`:""})()];const H="skinned";const g=[H,"skinned-3rd-party"];const W=["flex-leaderboard-active","flex-leaderboard-docked","flex-skin-active","flex-skin-docked"];const E="takeover-active";const _=Math.floor(Date.now()/1e3)%10===0;const T="zaf-anchor";const v="zaf-billboard";const S="zaf-inline-leaderboard";const b="zaf-inline-mobile-unit-1";const y="zaf-left-rail-1";const I="zaf-left-rail-2";const A="zaf-right-rail-1";const R="zaf-right-rail-2";const N="skin";const w="zaf-video-top";const C={TYPE_ANCHOR:T,TYPE_BILLBOARD:v,TYPE_INLINE_LEADERBOARD:S,TYPE_INLINE_MOBILE_1:b,TYPE_LEFT_RAIL_1:y,TYPE_LEFT_RAIL_2:I,TYPE_RIGHT_RAIL_1:A,TYPE_RIGHT_RAIL_2:R,TYPE_SKIN:N,TYPE_VIDEO_TOP:w};const M={elements:{skinLeft:undefined,skinRight:undefined,skinWrapper:undefined},hasVideo:false,isFlexSkinned:false,isSkinned:false,maxLayoutWidth:undefined,mobileFooterAdExists:false,postSkinSetupCallbacks:[],rejected:{},removeVideoCallbackRegistered:false,removed:false,skin:null,skinOffsetUpdateTimer:undefined,targetData:{}};this.init=function(){if(!e.showAds()){return}const t=WH.getPageData("WAS.init");const{targetData:a,ads:i,email:n}=t;z();M.targetData=a;if(i instanceof Array){B()}n&&ee(n);WH.onLoad((()=>{Y();let e=false;WH.aE(window,"resize",(()=>{if(!e){e=true;requestAnimationFrame((()=>{Y();e=false}))}}))}))};this.addPostSkinSetupCallback=function(e){if(typeof e=="function"){M.postSkinSetupCallbacks.push(e)}};this.displaySkin=function(t){let a=window.innerWidth<u;let i=ie();let n=!t.creatives||!t.creatives.left||!t.creatives.right;if(a||i||n){ne("Skin rejected by Wowhead",a?"Not enough space":i?"Suppressing ads for Blizzard":n?"Not a sides-only skin":"");e.removeSkin();return false}if(M.skin!==null){e.removeSkin(true)}M.skin=t;document.body.classList.add(H);re();let s=t.clickMacro?`${t.clickMacro}${t.link}`:t.link;M.elements.skinWrapper=WH.ce("div",{className:"skin-wrapper"});M.elements.skinLeft=WH.ce("a",{className:"skin-left",href:s,style:"background: url("+t.creatives.left+")",target:"_blank"});M.elements.skinRight=WH.ce("a",{className:"skin-right",href:s,style:"background: url("+t.creatives.right+")",target:"_blank"});WH.ae(M.elements.skinWrapper,M.elements.skinLeft);WH.ae(M.elements.skinWrapper,M.elements.skinRight);WH.aef(document.body,M.elements.skinWrapper);e.updateSkinMode();e.updateSkinPosition();WH.aE(window,"scroll",(function(){e.updateSkinPosition(true)}));Z(t);WH.Track.nonInteractiveEvent({category:"Skin",action:"Skin Displayed",label:t.creative,value:t.lineItem});return true};this.fillDynamicUnits=function(){if(!e.showAds()){return}zamaf.cmd.push((function(){zamaf.displayAllDynamic()}))};this.getChannelGroup=function(){return M.targetData.channelGroup||d};this.getChannelName=function(){return M.targetData.channelName||f};this.getDfpLog=function(){let e=n.get(n.KEY_WAS_DFP_LOG);return Array.isArray(e)?e:[]};this.hasVideo=function(){return M.hasVideo};this.hideAll=function(){F().forEach((e=>e.dataset.hiddenByWas=true))};this.isFlexSkinned=()=>M.isFlexSkinned;this.isSkinned=function(){return M.skin!==null||document.body.classList.contains("skinned")};this.onMobileFooterCreated=t=>{WH.aE(document.body,e.EVENT_MOBILE_FOOTER_CREATED,t);M.mobileFooterAdExists&&requestAnimationFrame(t)};this.remove=function(e){J(e)};this.removeAll=function(t){M.removed=true;t=t!==false;Object.values(C).forEach((e=>J(e)));let a=WH.qsa(".dynamic-ad");if(a.length){if(t){$(a).slideUp({complete:function(){a.forEach(WH.de)},duration:e.ANIMATION_DURATION_MS})}else{a.forEach(WH.de)}}setTimeout((function(){WH.qsa("[data-contains-block]").forEach((function(e){delete e.dataset.containsBlock}));WH.qsa("[data-left-contains-block]").forEach((function(e){delete e.dataset.leftContainsBlock}))}),t?e.ANIMATION_DURATION_MS+1:1);e.removeSkin()};this.removeSkin=function(e){if(M.elements.skinWrapper){WH.de(M.elements.skinWrapper)}if(e!==true){$("#ad-skin, .skin--link").remove();document.body.classList.remove("body--skin","body--prelude");WH.de("div#pw-oop-flex_leaderboard_container");WH.de("div#bgdiv");document.body.style.background=""}document.documentElement.classList.remove(E);g.concat(W).forEach((e=>document.body.classList.remove(e)));re();M.skin=null;WH.Layout.Responsive.updateHeaderOffset();K()};function O(e,t){if(e&&typeof e.elementId==="string"){ne("Unit rejected by ZAF",e.elementId);WH.debug(e.elementId+" unit rejected by ZAF.",e);J(e.elementId)}else{WH.debug("Unknown unit rejected by ZAF.",e)}}this.removeVideo=function(a){if(document.readyState==="loading"&&!M.removeVideoCallbackRegistered){M.removeVideoCallbackRegistered=true;WH.onLoad(e.removeVideo.bind(this,a))}M.hasVideo=false;const i=WH.qs(".blocks-video");WH.de(i);const n=WH.qs("#main > .blocks");if(n&&t.isEmpty(n)){Q(v,n,a!==false)}};this.restoreHidden=function(){$('[data-hidden-by-was="true"]').attr("data-hidden-by-was","false")};this.showAds=function(){return g_user.ads&&!M.removed};this.updateSkinMode=function(){if(!e.isSkinned()){return}if(i.getFullscreenMode()){document.body.dataset.skinMode="standard";return}let t=i.getElement("layout");if(!M.maxLayoutWidth){M.maxLayoutWidth=t&&parseInt(getComputedStyle(t).getPropertyValue("max-width"))||undefined;if(M.maxLayoutWidth){M.maxLayoutWidth--}}document.body.dataset.skinMode=M.maxLayoutWidth&&t&&t.offsetWidth>=M.maxLayoutWidth?"large-screen":"standard"};this.updateSkinPosition=function(t){if(t){clearTimeout(M.skinOffsetUpdateTimer);M.skinOffsetUpdateTimer=setTimeout((()=>M.skinOffsetUpdateTimer=undefined),h+1)}if(M.skinOffsetUpdateTimer){requestAnimationFrame((()=>e.updateSkinPosition()))}if(!e.isSkinned()){return}let a=i.getHeaderBottom();if(!a||!M.elements.skinLeft||!M.elements.skinRight){return}M.elements.skinLeft.style.top=a+"px";M.elements.skinRight.style.top=a+"px"};this.validateUnit=function(t){if(!e.showAds()||M.rejected[t]){delete M.rejected[t];J(t)}};function L(e,t){var a="block-remove";if([N].indexOf(e)>-1||$("."+a,t).length){return}var i=WH.ce("a",{href:WH.Url.generatePath("/premium"),className:a},WH.ct(WH.TERMS.removeallads));WH.ae(t,i)}function D(t,a,i){var n=e.getChannelName().match(/\bTest\b/)||WH.isDev()||WH.User.hasRole(U_GROUP_ADMIN);var s=[0,0];var r=WH.ge(a);if(r.dataset.unitWidth&&r.dataset.unitHeight){s=[parseInt(r.dataset.unitWidth),parseInt(r.dataset.unitHeight)]}if(!V(s,i)){var o=WH.qs("iframe",a);if(o){s=[parseInt(o.getAttribute("width")),parseInt(o.getAttribute("height"))];if(n){WH.warn("IFRAME UNIT SIZES:",s[0],s[1],"FROM THIS IFRAME:",o)}}}return s}function k(e){if(e.id&&e.id.indexOf("skin")!==-1){return e}if(e.getAttribute("data-was-unit")==="true"){return e.parentNode}if(e.getAttribute("data-was-parent")==="true"){return e}if(e.parentNode.getAttribute("data-was-unit")==="true"){return e.parentNode.parentNode}if(e.parentNode.getAttribute("data-was-parent")==="true"){return e.parentNode}if(e.id){var t=P();if(t.indexOf(e.id)>-1){return e}}return e.parentNode}function P(){var e=[];for(var t in C){if(e.indexOf(C[t])===-1){e.push(C[t])}}P=function(e){return e}.bind(null,e);return e}const x=(e,t)=>({canFitTwo:e>=o*t,viewportHeight:t,contentHeight:e});const U=({canFitTwo:e,viewportHeight:t})=>({"--rail-track-1-height":e?`${l*t}px`:"100%","--rail-track-2-display":e?"block":""});function F(){return WH.qsa(Object.values(C).map((e=>`[id="${e}"]`)))}function q(){let a=WH.isBlizzardReferral();if(a==="brl"){let e=(""+location.href).replace(/[?&]brl=[^?&#]*/,"").replace(/[?&]brl\b/,"").replace(/^(https?:\/\/[^\/]+\/)home$/,"$1");window.history.replaceState({},"",e)}if(!e.showAds()){return}t.onBodyAvailable((()=>{let e=new MutationObserver(re);e.observe(document.documentElement,{attributes:true,attributeFilter:["class"]});e.observe(document.body,{attributes:true,attributeFilter:["class"]});re()}));window.zamaf=window.zamaf||{};zamaf.cmd=zamaf.cmd||[];if(a){n.set(n.KEY_WAS_BLIZZARD_REFERRAL_TIME,Date.now()+c)}}const Y=()=>{const e=WH.ge("main");if(!e){return}const t=x(e.offsetHeight,window.innerHeight);const a=U(t);se(a)};function B(){zamaf.setTargeting=function(){googletag.pubads().setTargeting("Channel",M.targetData.channelName);googletag.pubads().setTargeting("ChannelGroup",M.targetData.channelGroup);googletag.pubads().setTargeting("DataEnvironment",M.targetData.dataEnv);googletag.pubads().setTargeting("DataTree",M.targetData.dataTree);if(M.targetData.entityType){googletag.pubads().setTargeting("EntityType",M.targetData.entityType)}googletag.pubads().setTargeting("Game",M.targetData.game);googletag.pubads().setTargeting("Universe",M.targetData.universe)};zamaf.slotRenderCallback=ae.bind(e);zamaf.skinRenderCallback=e.displaySkin.bind(e);zamaf.cmd.push({event:"zaf:slot:rejected",handler:O});if(zamaf&&zamaf.initialize){zamaf.initialize()}}function G(e,t){if(t){return e.style.visibility==="hidden"}else{return e.getAttribute("data-hidden-by-was")==="true"}}function V(e,t){if([N].indexOf(t)>=0){return true}return e&&e[0]&&e[1]&&e[0]!==1&&e[1]!==1}function z(){window.googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"gtm.js","gtm.start":(new Date).getTime()});for(let e=0,t;t=m[e];e++){WH.ae(document.head,WH.ce("script",{async:true,src:t}))}}function K(){WH.qsa(".element-highlight:not(#highlight-highlight-classic)").forEach((e=>WH.de(e)));s.test();a.checkAll()}function j(t,a,i){var s={_time:(new Date).toUTCString(),_slot:a,_channelName:e.getChannelName(),_channelGroup:e.getChannelGroup()};if(i){s._error=i}for(var r in t){if(t.hasOwnProperty(r)&&(typeof t[r]!=="object"||!t[r]||r==="size")){s[r]=t[r]}}var o=e.getDfpLog().slice(0,p-1);o.unshift(s);n.set(n.KEY_WAS_DFP_LOG,o)}function Z(e){M.postSkinSetupCallbacks.forEach((t=>t(e)));K()}function X(t,a){if(!t){return}let i=t.parentNode;if(!i){return}WH.de(t);if(a===v){e.removeVideo()}if(zamaf._getGlobals){let e=zamaf._getGlobals().globalSlots["ad-"+a];if(e){zamaf.destroySlot(e.elementId,e.slot)}}}function Q(a,i,n){if(i){let a=function(){if(t.isEmpty(i)){WH.de(i)}};if(n){i.style.height="250px";i.style.minHeight="0";$(i).slideUp({complete:a,duration:e.ANIMATION_DURATION_MS})}else{a()}}}function J(e){WH.debug("Removing "+e+" unit.");if(typeof e!=="string"){return}const t=WH.qsa(`[id*='${e}']`);if(t.length===0){M.rejected[e]=true;return}t.forEach((t=>X(t,e)))}const ee=async e=>{try{const t=await new Promise((e=>{window.reviq=window.reviq||[];window.reviq.push((t=>e(t)))}));t.setUid({e:e})}catch(e){WH.error(`Failed to set RevIq UID: ${e}`)}};function te(e,t,a,i){var n=k(t);if(!n){ne("Impression shown but slot callback failed",e);return}a=parseInt(a);i=parseInt(i);n.className=n.className.replace(/ *\bis-[0-9]+x[0-9]+\b/g,"");n.className+=" is-"+a+"x"+i;L(e,n);var s=a+"x"+i;if(a===728||a===970){var r=n.parentNode.parentNode;r.setAttribute("data-contains-block",s);if(r.parentNode&&r.parentNode.parentNode&&r.parentNode.parentNode.parentNode&&r.parentNode.parentNode.parentNode.setAttribute){r.parentNode.parentNode.parentNode.setAttribute("data-contains-block",s)}}else if(typeof e==="string"&&e.match(/^vertical/)){let e=WH.closest(t,".sidebar");if(e){e.dataset.containsSidebarBlock=s}let a=WH.qs(".layout-wrapper");if(a){a.dataset.containsSidebarBlock=s}}}function ae(e){var t=e.slot.getSlotElementId();if(t===N){let e=WH.ge("ad-skin");if(e){WH.onMutate(e,WH.Layout.Responsive.check.bind(null,true),{attributes:true})}WH.Layout.Responsive.check(true);return}var a=WH.ge(t);if(a&&a.className.indexOf("zamaf-au")>-1){return}if(!a){var i='Div for DFP unit "'+t+'" not found!';WH.debug(i);j(e,t,i);return}if(e.isEmpty){WH.info("No slot rendered in DFP event!",e);j(e,null,"No slot rendered in DFP event.");return}j(e,t);var n=D(e,a,t);te(t,a,n[0],n[1]);if(WH.qs(".block-report",a)){return}var s=WH.ce("a",{text:WH.TERMS.reportad,className:"block-report",onclick:function(e,t){WH.Layout.expandSite();ContactTool.show();$('select[name="reason"]').val(9);setTimeout((function(){$('input[name="email"]').focus()}),1)}.bind(null,a,t)});WH.ae(a,s)}function ie(){var e=WH.isBlizzardReferral();let t=n.get(n.KEY_WAS_BLIZZARD_REFERRAL_TIME);if(t){let a=Date.now();if(!isNaN(t)&&t>a&&t<a+c+20*r.MS_SEC){e=true}else{n.remove(n.KEY_WAS_BLIZZARD_REFERRAL_TIME)}}ie=function(e){return e}.bind(null,e);return e}function ne(e,t,a){if(_){WH.Track.nonInteractiveEvent({category:"Ads",action:e,label:t,value:a})}}const se=e=>{const t=document.documentElement.style;Object.entries(e).forEach((([e,a])=>{if(a===""){t.removeProperty(e)}else{t.setProperty(e,a)}}))};function re(){let e=M.isSkinned;M.isFlexSkinned=document.documentElement.classList.contains(E)||W.some((e=>document.body.classList.contains(e)));M.isSkinned=M.isFlexSkinned||g.some((e=>document.body.classList.contains(e)));document.body.dataset.bgActive=`${M.isSkinned}`;if(M.isSkinned!==e){window.dispatchEvent(new Event("resize"))}WH.WAS.updateSkinPosition()}q()};var WAS={displaySkin:WH.WAS.displaySkin};WH.Weights=new function(){this.allowWeights=function(){return!WH.isRetailTree()};this.getCategoryNames=function(){return WH.getPageData("items.weightPresets.categoryNames")||{}};this.getPresets=function(){return WH.getPageData("items.weightPresets")||{}}};function wt_getScaleFacetOptions(e,t){var a=[];if(e){if(e.weights){for(var i in e.weights){if(e.weights.hasOwnProperty(i)){a.push([i,e.weights[i]])}}}else{for(var i=0,n;n=items_filterConfig.filters[i];i++){if(n.stat&&WH.Wow.Item.Stat.jsonToName(n.stat)&&e[n.stat]){a.push([n.id,e[n.stat]])}}}}a.sort((function(e,t){return-WH.stringCompare(e[1],t[1])}));var s=[],r=[];for(var o=0,l;l=a[o];o++){s.push(l[0]);r.push(l[1])}if(s.length&&r.length){var c={weights:s.join(":"),"weight-values":r.join(":")};if(t){c["gem-quality"]=3}return c}return{}}function wt_getScaleFilter(e,t){if(!WH.Weights.allowWeights()){return""}var a=wt_getScaleFacetOptions(e,t);if(a.weights&&a["weight-values"]){var i=";";if(t){i="&"}else if(typeof a["gem-quality"]!="undefined"){i+="gm="+a["gem-quality"]+";"}i+="weights="+a.weights+(t?"&":";")+"weight-values="+a["weight-values"];return i}return""}function wt_getScaleUrlSegment(e,t){var a=wt_getScaleFacetOptions(e,t);if(a.weights&&a["weight-values"]){var i="";if(!t&&typeof a["gem-quality"]!="undefined"){i+="/gem-quality:"+a["gem-quality"]}i+="/weights:"+a.weights+"/weight-values:"+a["weight-values"];return i}return""}function wt_showClassPresetMenu(e,t,a,i,n,s){const r=WH.Url;if(!(t&&i&&n)){return}var o=[[,WH.TERMS.chooseclassspec]];let l=r.generatePath("/items");for(var c=0,u;u=items_filterConfig.categories[c];c++){if(u.id==i){l+="/"+u.url;break}}if(i==4&&n){l+="/slot:"+n}var d="";var f="/live-only:on/group-by:"+(i==2?"slot":"source")+"?filter=161;1;0";if(i==2){if(Locale.getName()=="enus"){let e=WH.Wow.Item.getInvTypeName(n);if(e){f+="#"+WH.Strings.slug(e)}}else{f+="#slot-"+n}}if(g_user.weightscales&&g_user.weightscales.length){var h=[0,WH.TERMS.custom,undefined,[]];o.push(h);for(var p=0,m;m=g_user.weightscales[p];p++){d=wt_getScaleUrlSegment(m)+"/upgrade-for:"+t;if(a&&a.length){d+="/upgrade-bonuses:"+a.join(":")}h[3].push([m.id,m.name,l+d+f])}}var H=WH.isSet("g_items")&&g_items[t]?g_items[t].specs:null;let g=WH.Weights.getPresets();let W=WH.Weights.getCategoryNames();for(var E in g){if(!g.hasOwnProperty(E)){continue}var _=[E,WH.Wow.PlayerClass.getName(E),undefined,[],{className:"c"+E,tinyIcon:WH.Wow.PlayerClass.getIconName(E)}];if(H!=null&&H.length>0&&g_chr_specs_by_class[E]){var T=g_chr_specs_by_class[E];var v=false;for(var S in T){if(T.hasOwnProperty(S)&&WH.inArray(H,T[S])!=-1){v=true;break}}if(!v){continue}}o.push(_);var b=0;var y=0;for(let e in g[E]){if(!g[E].hasOwnProperty(e)){continue}_[Menu.ITEM_SUBMENU].push([undefined,W[e]||WH.term("itemlevel_format",e)]);y++;for(let i in g[E][e]){if(!g[E][e].hasOwnProperty(i)){continue}v=H==null||H.length==0;if(!v){for(let e in H){if(H.hasOwnProperty(e)&&i===H[e]){v=true;break}}}if(v){d="/class:"+E+wt_getScaleUrlSegment(g[E][e][i])+"/upgrade-for:"+t;if(a&&a.length){d+="/upgrade-bonuses:"+a.join(":")}_[Menu.ITEM_SUBMENU].push([b,g[E][e][i].meta.label,l+d+f,,{tinyIcon:g[E][e][i].meta.__icon}]);b++}}}if(y===1){_[Menu.ITEM_SUBMENU].shift()}}Menu.sort(o);Menu.show(o,e)}WH.Wow=new function(){const e=this;this.INVENTORY_SLOT_AMMO=0;this.INVENTORY_SLOT_HEAD=1;this.INVENTORY_SLOT_NECK=2;this.INVENTORY_SLOT_SHOULDERS=3;this.INVENTORY_SLOT_SHIRT=4;this.INVENTORY_SLOT_CHEST=5;this.INVENTORY_SLOT_WAIST=6;this.INVENTORY_SLOT_LEGS=7;this.INVENTORY_SLOT_FEET=8;this.INVENTORY_SLOT_WRISTS=9;this.INVENTORY_SLOT_HANDS=10;this.INVENTORY_SLOT_FINGER_1=11;this.INVENTORY_SLOT_FINGER_2=12;this.INVENTORY_SLOT_TRINKET_1=13;this.INVENTORY_SLOT_TRINKET_2=14;this.INVENTORY_SLOT_BACK=15;this.INVENTORY_SLOT_MAIN_HAND=16;this.INVENTORY_SLOT_OFF_HAND=17;this.INVENTORY_SLOT_RANGED=18;this.INVENTORY_SLOT_TABARD=19;this.INVENTORY_SLOTS_WITH_MODELS=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_TABARD];if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()||WH.isCataTree()){this.INVENTORY_SLOTS_WITH_MODELS.push(this.INVENTORY_SLOT_RANGED)}this.PAPERDOLL_SLOT_ORDER=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_NECK,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_TABARD,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_FINGER_1,this.INVENTORY_SLOT_FINGER_2,this.INVENTORY_SLOT_TRINKET_1,this.INVENTORY_SLOT_TRINKET_2,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_RANGED,this.INVENTORY_SLOT_AMMO];this.SIDE_ANY=0;this.SIDE_ALLIANCE=1;this.SIDE_HORDE=2;this.SIDE_BOTH=3;const t=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS];const a={[e.SIDE_ALLIANCE]:"alliance",[e.SIDE_HORDE]:"horde"};const i={};i[e.SIDE_ANY]="any";i[e.SIDE_ALLIANCE]="alliance";i[e.SIDE_HORDE]="horde";i[e.SIDE_BOTH]="both";const n=1e4;const s=100;const r=1;const o=WH.deepFreeze(WH.getPageData("wow.versions")||[]);const l={invSlotNames:undefined};this.buildMoney=function(e){var t={};if(e.copper){t.unnamed=e.copper.toString()}if(e.items&&e.items.length){t.items="";for(var a,i=0;a=e.items[i];i++){t.items+=(t.items?",":"")+a[0]+","+a[1]}}if(e.currencies&&e.currencies.length){t.currency="";for(var n,i=0;n=e.currencies[i];i++){t.currency+=(t.currency?",":"")+n[0]+","+n[1]}}if(e.achievementPoints){t.achievement=e.achievementPoints.toString()}return WH.markup.tags.money.toNode(t)};this.getApiSlot=t=>e[`INVENTORY_SLOT_${t}`]??e[`INVENTORY_SLOT_${t}S`];this.getEnvForProduct=e=>{switch(e){case"wowt":return WH.dataEnv.PTR;case"wowxptr":return WH.dataEnv.PTR2;case"wow_beta":return WH.dataEnv.BETA;case"wow_classic_era":case"wow_classic_era_ptr":case"wow_classic_era_beta":return WH.dataEnv.CLASSIC;case"wow_classic":case"wow_classic_ptr":case"wow_classic_beta":return WH.dataEnv.MISTS}return WH.dataEnv.MAIN};this.getInventorySlotName=function(e){l.invSlotNames=l.invSlotNames||WH.getPageData("wow.invSlotNames")||{};return l.invSlotNames[e]};this.getMaxPlayerLevel=e=>WH.getPageData("wow.maxLevels")[e??WH.getDataEnv()];this.getPatchVersionObject=function(e,t){var a=t||WH.Wow.getVersionList();var i=false;if(!e){e=Date.now();i=true}var n="?????";var s={build:999999,timestamp:9999999999999,version:n,versionNum:999999};for(var r=0,o;o=a[r];r++){if(o.timestamp<=e&&(s.version=="?????"||s.build<o.build)){s=o}}if(WH.isDev()&&s.version===n){if(i){WH.error("Could not find a build for the current time!",e,"Versions:",a)}else{WH.error("Could not find a build for timestamp "+e+"!","Versions:",a)}}return s};this.getSideIcon=function(e){return a[e]};this.getSideName=e=>WH.TERMS[i[e]];this.getSideTerm=function(e){return i[e]};this.getSourceName=e=>WH.getPageData("wow.sources")[e];this.getSources=()=>({...WH.getPageData("wow.sources")});this.getTextureAtlasMemberUrl=function(e,t){return WH.Strings.sprintf("%s/images/wow/TextureAtlas/%s/%s%s",WH.STATIC_URL,WH.getDataEnvKey(t),e.replace(/\//g,"").toLowerCase(),WH.WebP.getImageExtension())};this.getVersionList=function(){return o};this.getVersionNumFromStr=function(e){let t=e.split(".");while(t.length<3){t.push(0)}let a=parseInt(t[0])*n||0;if(t[1]){a+=parseInt(t[1])*s||0}if(t[2]){a+=parseInt(t[2])*r||0}return a};this.getVersionStrFromNum=function(e){e=parseInt(e);if(isNaN(e)){return""}return Math.floor(e/1e4)+"."+Math.floor(e%1e4/100)+"."+e%100};this.getVersionString=function(e){return WH.PageMeta.dataEnv.versions[e||WH.getDataEnv()]};this.getVersionStringFromTimestamp=function(e,t){return WH.Wow.getPatchVersionObject(e,t).version};this.hasVersion=function(t,a){return e.getVersionNumFromStr(e.getVersionString(a))>=t};this.isBodyArmorSlot=function(e){return t.includes(e)};this.showContentPhasePrompt=function(e,t,a,i){if((g_user.roles&U_GROUP_STAFF)==0&&!WH.User.hasCapability(WH.User.CAP_CONTENT_PHASE_EDIT)||WH.isRetailTree()){WH.error("Asked to show content phase prompt when we are not allowed.");return}if(!t.length){WH.error("Should call the content phase prompt with at least one type ID");return}if(isNaN(a)){a=""}var n=t.length===1?"this entity":"these "+t.length+" entities";var s=prompt("What should the content phase be for "+n+"?",a);if(s===null){return}var r=undefined;if(s===""){r=0}else{r=parseFloat(s);if(isNaN(r)||r<0){alert("Invalid response ("+s+"): must be a positive number");return}}$.ajax({url:WH.Url.generatePath("/admin/content-phase/set"),data:{type:e,typeIdCsv:t.join(","),phase:r.toFixed(2)},method:"POST",error:function(e,t,a){alert("Could not update content phase: "+t+"\n"+a)},success:function(e){if(i){i(e.phase)}else{alert("Updated "+e.typeIds.length+" "+(e.typeIds.length==1?"entity":"entities")+" to content phase "+(e.phase||"(None)")+".")}}})}};window.ZUL=new function(){const e=WH.Tooltips;this.HEIGHT=40;var t=false;var a={};var i={bodyAvailableListenerAttached:false,enabled:false,mainMenuRendered:false,mobileScrollSetUp:false,mouseOver:false,iScroll:null,submenuCount:0,submenuTier:0,submenuTiers:[],timers:{menuExpand:null,menuExpandComplete:null,menuOut:null,menuOutPost:null,menuOverPost:null,mobileMenuToggle:null}};this.setOptions=function(e){if(typeof e!="object"){return}if(typeof t!="object"){t={}}for(var a in e){if(!e.hasOwnProperty(a))continue;t[a]=e[a]}};this.closeMobileMenu=function(){M()};this.addToMenu=function(e){if(!t.states){t.states={}}if(!t.states.universal){t.states.universal={}}if(!t.states.universal.content){t.states.universal.content=[]}if(e instanceof Array){t.states.universal.content=t.states.universal.content.concat(e)}else if(typeof e=="object"){t.states.universal.content.push(e)}ZUL.regenerateMenu()};this.getEnabled=()=>i.enabled;this.regenerateMenu=function(){M();if(a.mobileMenu){u(a.barMobile)}};this.setEnabled=e=>{if(i.enabled!==Boolean(e)){T(e);return true}return false};this.init=function(e){ZUL.setOptions(e?{state:"loggedIn",user:e}:{state:"loggedOut"});n()};function n(){if(!document.body){if(!i.bodyAvailableListenerAttached){i.bodyAvailableListenerAttached=true;WH.aE(document,"bodyAvailable",n)}return}if(a.bar){a.barMobile=null;a.bar.parentElement.removeChild(a.bar)}a.bar=document.createElement("div");a.bar.id=a.bar.className="zul-bar";var e=false;if(typeof t.mobileLoadCheck=="function"){if(t.mobileLoadCheck()){e=true}}else if(t.mobileLoadCheck){e=true}T(e);document.body.insertBefore(a.bar,document.body.firstChild);s();I();if(typeof t.onCreateBar=="function"){t.onCreateBar()}}function s(){if(typeof t.mobileWidthCheck==="function"){T(t.mobileWidthCheck())}else if(typeof t.mobileWidthCheck==="number"){T(document.documentElement.offsetWidth<t.mobileWidthCheck)}}function r(){if(a.barMobile||!a.bar){return}a.barMobile=document.createElement("div");a.barMobile.id=a.barMobile.className="zul-bar-mobile";a.barMobile.className+=" zul-bar-mobile-top-menu";a.barMobile.setAttribute("data-tier","0");c(a.barMobile);o(a.barMobile);u(a.barMobile);a.bar.appendChild(a.barMobile);if(typeof t.onCreateMobileBar=="function"){t.onCreateMobileBar()}}function o(e){if(a.mobileBarContent){a.mobileBarContent.parentNode.removeChild(a.mobileBarContent);a.mobileBarContent=null}var t=function(){if(a.mobileBarContent){return}a.mobileBarContent=document.createElement("div");a.mobileBarContent.id=a.mobileBarContent.className="zul-bar-mobile-content"};var i=k();var n=P();if(n.mobileBarPre){t();W(a.mobileBarContent,n.mobileBarPre,false)}if(i.mobileBarPre){t();W(a.mobileBarContent,i.mobileBarPre,false)}if(n.mobileBarContent){t();W(a.mobileBarContent,n.mobileBarContent,false)}if(i.mobileBarPost){t();W(a.mobileBarContent,i.mobileBarPost,false)}if(n.mobileBarPost){t();W(a.mobileBarContent,n.mobileBarPost,false)}if(a.mobileBarContent){e.appendChild(a.mobileBarContent)}}const l=(e,t)=>{const a=WH.ce("button",{ariaLabel:t.ariaLabel,className:`zul-bar-mobile-item-${t.name}`});WH.ae(e,a);WH.Tooltips.attachNonTouch(a,t.ariaLabel);WH.aE(a,"click",t.onClick)};function c(t){const i="zul-bar-mobile";if(a.mobileMenuButton){a.mobileMenuButton.parentNode.removeChild(a.mobileMenuButton)}a.mobileMenuButton=WH.ce("button",{ariaLabel:WH.TERMS.menu,className:`${i}-menu-button`,id:`${i}-menu-button`});e.attachNonTouch(a.mobileMenuButton,WH.TERMS.menu);Y(a.mobileMenuButton,"click",w);WH.ae(t,a.mobileMenuButton)}function u(e){if(a.mobileMenu){a.mobileMenu.parentNode.removeChild(a.mobileMenu)}a.mobileMenu=document.createElement("div");a.mobileMenu.id=a.mobileMenu.className="zul-bar-mobile-menu";a.mobileMenuList=d();a.mobileMenu.appendChild(a.mobileMenuList);e.appendChild(a.mobileMenu);_()}function d(e,t){var a=document.createElement("div");a.className="zul-bar-mobile-menu-list-wrapper";a.id=a.className+(e?"-"+e:"");a.setAttribute("data-tier",t||0);a.style.left=U(t?1:0);var i=document.createElement("ul");i.className="zul-bar-mobile-menu-list";i.id=i.className+(e?"-"+e:"");a.appendChild(i);return a}function f(){var e=document.createElement("li");e.className="zul-bar-mobile-row";return e}function h(e){i.submenuCount++;var t=d(i.submenuCount,1);W(t.firstChild,e,true);a.mobileMenu.appendChild(t);S(true)}function p(e){var t=k();var a=P();W(e,a.pre,true);W(e,t.pre,true);W(e,a.content,true);W(e,t.post,true);W(e,a.post,true)}function m(e,a){var i=document.createElement("form");i.id="zul-bar-form-"+a.name;i.className="zul-bar-form "+i.className;if(typeof a.action=="function"){i.action=a.action(e,t,a)}else{i.action=a.action||"/"}if(typeof i.method=="function"){i.method=a.method(e,t,a)}else{i.method=a.method||"post"}for(var n=0,s;s=a.fields[n];n++){H(i,s,a)}e.appendChild(i)}function H(e,a,i){var n=false;var s=false;var r="input";var o={};switch(a.type){case"text":o.type="text";if(typeof a.label=="function"){o.placeholder=a.label(e,t,a)}else if(a.label){o.placeholder=a.label}else if(typeof a.placeholder=="function"){o.placeholder=a.placeholder(e,t,a)}else if(a.placeholder){o.placeholder=a.placeholder}if(typeof a.value=="function"){o.value=a.value(e,t,a)}else if(a.value){o.value=a.value}break;case"password":o.type="password";if(typeof a.label=="function"){o.placeholder=a.label(e,t,a)}else if(a.label){o.placeholder=a.label}else if(typeof a.placeholder=="function"){o.placeholder=a.placeholder(e,t,a)}else if(a.placeholder){o.placeholder=a.placeholder}if(typeof a.value=="function"){o.value=a.value(e,t,a)}else if(a.value){o.value=a.value}break;case"checkbox":o.type="checkbox";if(typeof a.label=="function"){s=a.label(e,t,a)}else{s=a.label}if(typeof a.checked=="function"){o.checked=a.value(e,t,a)}else if(a.checked){o.checked="checked"}break;case"hidden":r="hidden";if(typeof a.value=="function"){o.value=a.value(e,t,a)}else{o.value=a.value}break;case"button":r="button";if(typeof a.typeHTML=="function"){o.type=a.typeHTML(e,t,a)}else if(a.typeHTML){o.type=a.typeHTML}else{o.type="button"}if(typeof a.label=="function"){o.innerHTML=a.label(e,t,a)}else{o.innerHTML=a.label}break;case"link":return E(e,a,true,false);break;default:alert("Invalid element type passed to ZUL bar: "+a.type);return false}var l=["click","mouseover","mouseout","change","keyup","keydown","focus","blur"];var c=["name","innerHTML"].concat(l);for(var u=0,d;d=c[u];u++){if(a.hasOwnProperty(d)){if(["name","innerHTML"].indexOf(d)>-1&&typeof a[d]=="function"){o[d]=a[d](e,t,a)}else{o[d]=a[d]}}}o.id="zul-bar-form-"+i.name+"-"+a.name;o.className="zul-bar-form-"+a.type;if(typeof a.className=="function"){o.className+=" "+a.className(e,t,a)}else if(a.className){o.className+=" "+a.className}var f=document.createElement(r);for(var h in o){if(!o.hasOwnProperty(h)){continue}if(l.indexOf(h)>-1&&typeof o[h]=="function"){Y(f,h,o[h])}else{f[h]=o[h]}}if(n){var p=document.createElement("label");p.id=p.className=o.id+"-prelabel";p.className="zul-bar-form-prelabel zul-bar-form-"+a.type+"-prelabel "+p.className;p.htmlFor=f.id;p.innerHTML=n;Y(p,"mousedown",(function(){return false}));e.appendChild(p)}e.appendChild(f);if(s){var m=document.createElement("label");m.id=m.className=o.id+"-postlabel";m.className="zul-bar-form-postlabel zul-bar-form-"+a.type+"-postlabel "+m.className;m.htmlFor=f.id;m.innerHTML=s;Y(m,"mousedown",(function(){return false}));e.appendChild(m)}return true}function g(e,a){var i=[];for(var n=0,s;s=a[n];n++){if(s.type=="concatenation"){var r=s.content(e,t);if(r){i=i.concat(r)}}else{i.push(s)}}return i}function W(e,a,i){if(!(a instanceof Array)||!a.length){return}a=g(e,a);for(var n=0,s;s=a[n];n++){if(typeof s.condition=="function"){if(!s.condition(e,t)){continue}}var r=e;if(i){var o=f();e.appendChild(o);r=o}switch(s.type){case"button":l(r,s);break;case"link":E(r,s,false,i);break;case"form":m(r,s);break;case"custom":if(typeof s.custom=="function"){s.custom(r,t)}break;default:}}}function E(e,i,n,s){let r=WH.ce("a",{className:"zul-bar-mobile-item-"+(n?"form-":"")+i.name,dataset:{disableWowheadTooltip:"true"}});if(i.ariaLabel){r.ariaLabel=i.ariaLabel}if(typeof i.id=="function"){var o=i.id(e,t,i);if(o){r.id=o}}else if(i.id){r.id=F(i.id)}if(typeof i.innerHTML=="function"){r.innerHTML=i.innerHTML(e,t,i)}else if(i.innerHTML){r.innerHTML=F(i.innerHTML)}else if(typeof i.text=="function"){r.appendChild(document.createTextNode(i.text(e,t,i)))}else if(i.text){r.appendChild(document.createTextNode(F(i.text)))}if(typeof i.href=="function"){var l=i.href(e,t,i);if(l){r.href=l}}else if(i.href){r.href=F(i.href)}if(typeof i.heading=="function"){if(i.heading(e,t,i)){r.className+=" zul-bar-mobile-heading"}}else if(i.heading){r.className+=" zul-bar-mobile-heading"}if(typeof t.mobileIconSpacing=="function"){if(t.mobileIconSpacing(e,t,i)){r.className+=" zul-bar-icon-spacing"}}else if(t.mobileIconSpacing){r.className+=" zul-bar-icon-spacing"}var c=false;if(i.checked){switch(typeof i.checked){case"function":if(i.checked(e,t,i)){r.className+=" zul-bar-checked";c=true}break;case"string":if(location.href.match(i.checked)){r.className+=" zul-bar-checked";c=true}break;default:r.className+=" zul-bar-checked";c=true}}if(!c){if(i.imageIcon){if(typeof i.imageIcon=="function"){i.imageIcon=i.imageIcon(e,t,i)}var u;if(typeof i.imageIcon!="object"){u=i.imageIcon}else if(i.imageIcon.url){u=i.imageIcon.url}if(u){r.style.backgroundImage="url("+u+")";r.className+=" zul-bar-has-image-icon"}if(i.imageIcon.enlargeIcon){r.className+=" zul-bar-enlarge-image-icon"}}var d=false;if(typeof i.fontIcon=="function"){var f=i.fontIcon(e,t,i);if(f){d=f}}else if(i.fontIcon){d=i.fontIcon}if(d){r.className+=" zul-bar-has-fa";var h=document.createElement("i");h.className="fa fa-fw fa-"+d;r.insertBefore(h,r.firstChild)}}if(typeof i.className=="function"){var p=i.className(e,t,i);if(p){r.className+=" "+p}}else if(i.className){r.className+=" "+i.className}var m=false;var H=!i.hasOwnProperty("tap")||typeof i.tap==="boolean"&&i.tap;for(var g=0,W;W=["click","mouseover","mouseout"][g];g++){if(i[W]){if(W==="tap"||s&&W==="click"&&H){Y(r,"tap",function(e,t){O(this);setTimeout((function(){e.call(this,t)}),1)}.bind(r,i[W]));m=true}else if(s&&W==="click"){Y(r,W,function(e,t){O(this);setTimeout((function(){e.call(this,t)}),1)}.bind(r,i[W]))}else{Y(r,W,i[W])}}}if(s&&!m&&H){if(typeof r.href=="string"&&r.href&&r.href.charAt(0)!=="#"&&r.href.substring(0,11)!=="javascript:"){Y(r,"tap",(function(e){var t=e.target;O(t);setTimeout((function(){window.location=t.href}),1)}));m=true}}if(m){r.className+=" has-tap-event"}e.appendChild(r);if(i.menu&&i.menu.mobile){if(typeof i.menu.mobile=="function"){i.menu.mobile=i.menu.mobile()}var E;if(typeof i.mobileMenuText=="function"){E=i.mobileMenuText(a.mobileMenuBackTitleText,t,i)}else if(i.mobileMenuText){E=F(i.mobileMenuText)}else if(typeof i.innerHTML=="function"){E=i.innerHTML(a.mobileMenuBackTitleText,t,i)}else if(i.innerHTML){E=i.innerHTML}else if(typeof i.text=="function"){E=$(i.text(a.mobileMenuBackTitleText,t,i))}else if(i.text){E=$(i.text)}if(m){e.className+=" zul-mobile-menu-action-with-submenu";var _=document.createElement("a");_.className="zul-mobile-menu-submenu-arrow has-tap-event";Y(_,"tap",L.bind(_,E,i.menu.mobile));e.appendChild(_)}else{e.className+=" zul-mobile-menu-has-submenu";r.className+=" has-tap-event";Y(r,"tap",L.bind(r,E,i.menu.mobile))}}}function _(){if(a.mobileMenuBackRow){a.mobileMenuBackRow.parentNode.removeChild(a.mobileMenuBackRow)}a.mobileMenuBackRow=document.createElement("div");a.mobileMenuBackRow.id=a.mobileMenuBackRow.className="zul-bar-mobile-menu-back-row";a.mobileMenuBackButton=document.createElement("a");a.mobileMenuBackButton.innerHTML=t.mobileBackText||"Back";a.mobileMenuBackButton.id=a.mobileMenuBackButton.className="zul-bar-mobile-menu-back-button";a.mobileMenuBackButton.onclick=D;a.mobileMenuBackRow.appendChild(a.mobileMenuBackButton);a.mobileMenuBackTitle=document.createElement("div");a.mobileMenuBackTitle.id=a.mobileMenuBackTitle.className="zul-bar-mobile-menu-back-title";a.mobileMenuBackTitleText=document.createElement("span");a.mobileMenuBackTitleText.id=a.mobileMenuBackTitleText.className="zul-bar-mobile-menu-back-title-text";a.mobileMenuBackTitle.appendChild(a.mobileMenuBackTitleText);a.mobileMenuBackRow.appendChild(a.mobileMenuBackTitle);if(t.mobileHeader){a.mobileMenuBackHeader=document.createElement("ul");a.mobileMenuBackHeader.id="zul-bar-mobile-menu-back-header";a.mobileMenuBackHeader.className=a.mobileMenuBackHeader.id+" zul-bar-mobile-menu-list";W(a.mobileMenuBackHeader,t.mobileHeader,true);a.mobileMenuBackRow.appendChild(a.mobileMenuBackHeader);a.barMobile.className+=" zul-bar-mobile-menu-has-mobile-header"}a.barMobile.appendChild(a.mobileMenuBackRow)}function T(e){if(e){r();i.enabled=true;document.documentElement.dataset.header="mobile";document.body.dataset.zulBar="true"}else{i.enabled=false;document.documentElement.dataset.header="standard";document.body.dataset.zulBar="false"}}function v(e){WH.qsa(".zul-bar-mobile-menu-active",e??WH.ge("zul-bar-mobile-menu-list")).forEach((e=>e.classList.remove("zul-bar-mobile-menu-active")))}function S(e){var t=e?-1:1;if(i.submenuTier+t>0){return false}R();i.submenuTier=i.submenuTier+t;if(!e){i.submenuTiers.pop()}y();a.barMobile.setAttribute("data-tier",i.submenuTier);if(i.submenuTier==0){a.barMobile.className+=" zul-bar-mobile-top-menu"}else{a.barMobile.className=a.barMobile.className.replace(/ *zul-bar-mobile-top-menu\b/g,"")}var n=a.mobileMenu.childNodes;var s=[];for(var r=0,o;o=n[r];r++){var l=parseInt(o.getAttribute("data-tier"))+t;if(l>0){o.setAttribute("data-tier","1");o.style.left=U(i.submenuTier);setTimeout(function(e){e.parentNode.removeChild(e)}.bind(null,o),251)}else{if(l==0){o.style.height="100%"}s.push(o);setTimeout(function(e,t){e.setAttribute("data-tier",t);e.style.left=U(i.submenuTier)}.bind(null,o,l),51)}}if(!e){v(n[n.length-2])}B(a.mobileMenu,250);setTimeout(function(e){for(var t=0,a;a=e[t];t++){if(t!=e.length-1){a.style.height="10px"}}N(e[e.length-1])}.bind(null,s),251);return true}function b(){if(!a.mobileMenu){return}var e=a.mobileMenu.childNodes;for(var t=0,n;n=e[t];t++){if(t>0){n.parentNode.removeChild(n)}else{n.setAttribute("data-tier","0");n.style.left=U(0)}}i.submenuTiers=[];i.submenuTier=0;a.barMobile.setAttribute("data-tier","0");a.barMobile.className+=" zul-bar-mobile-top-menu"}function y(){var e=i.submenuTiers[i.submenuTier*-1-1];if(e){a.mobileMenuBackTitleText.innerHTML=e}}function I(){Y(window,"resize",s);I=function(){}}function A(){if(!i.mobileScrollSetUp){var e=function(e){if(i.mobileMenuShown){if(!document.getElementById("zul-bar-mobile").contains(e.target)){e.preventDefault()}}};Y(document.body,"touchmove",e);Y(document.body,"mousewheel",e);i.mobileScrollSetUp=true}}function R(){if(i.iScroll){i.iScroll.destroy();i.iScroll=null}}function N(e){R();i.iScroll=new IScroll(e,{mouseWheel:true,tap:true})}function w(){Menu.hide(true);WH.Tooltips.hide();if(i.mobileMenuShown){M()}else{C()}}function C(){V("mobileMenuToggle");V("mobileMenuToggleCallback");if(!i.mainMenuRendered){p(a.mobileMenuList.firstChild);i.mainMenuRendered=true}var e=document.getElementById("zul-bar-mobile-menu-list-wrapper");e.style.height="100%";if(!a.fade){a.fade=document.createElement("div");a.fade.id=a.fade.className="zul-bar-fade";Y(a.fade,"click",w);a.bar.appendChild(a.fade)}document.body.className+=" zul-mobile-show-menu";i.timers.mobileMenuToggle=setTimeout((function(){document.body.className+=" zul-mobile-animate-menu"}),1);if(typeof t.onShowMobileBarEnd=="function"){i.timers.mobileMenuToggleCallback=setTimeout((function(){t.onShowMobileBarEnd()}),152)}A();N(e);i.mobileMenuShown=true}function M(){V("mobileMenuToggle");V("mobileMenuToggleCallback");if(typeof t.onHideMobileBarStart=="function"){t.onHideMobileBarStart()}R();if(a.fade){a.fade.parentNode.removeChild(a.fade);a.fade=null}var e=document.body;e.className=e.className.replace(/ *zul-mobile-animate-menu\b/g,"");i.timers.mobileMenuToggle=setTimeout((function(){e.className=e.className.replace(/ *zul-mobile-animate-menu\b/g,"").replace(/ *zul-mobile-show-menu\b/g,"");v();b();if(typeof t.onHideMobileBarEnd=="function"){t.onHideMobileBarEnd()}}),251);i.mobileMenuShown=false;b()}function O(e){var t=G(e,"ul");v(t);e.className+=" zul-bar-mobile-menu-active"}function L(e,t){if(this.classList.contains("zul-bar-mobile-menu-active")){WH.debug("Skipping a duplicate tap of a ZUL bar menu item.");return}i.submenuTiers.push(e);O(this);setTimeout((function(){h(t)}),1)}function D(){S(false)}function k(){if(!t.state){return{}}var e={name:t.state};return x(t.states,e)}function P(){if(t.states&&t.states&&t.states.universal){return t.states.universal}return{}}function x(e,t){if(e&&typeof e[t.name]=="object"){for(var a in e[t.name]){if(e[t.name].hasOwnProperty(a)){t[a]=e[t.name][a]}}}return t}function U(e){return parseInt(e)*100+"%"}function F(e){return e.indexOf("%")>-1?q(e,t.user):e}function q(e,t){if(!t){return e}for(var a in t){if(!t.hasOwnProperty(a))continue;e=e.replace("%"+a.toUpperCase()+"%",t[a])}return e}function Y(e,t,a,i){if(e.addEventListener){e.addEventListener(t,a,i)}else if(e.attachEvent){e.attachEvent("on"+t,a)}}function B(e,t){var a=e.scrollTop/(t/15);var i=e.scrollLeft/(t/15);var n=setInterval((function(){if(e.scrollTop!=0||e.scrollLeft!=0){e.scrollTop=Math.max(0,e.scrollTop-a);e.scrollLeft=Math.max(0,e.scrollLeft-i)}else clearInterval(n)}),15)}function G(e,t){while(e.parentNode){if(e.parentNode.tagName==t.toUpperCase()){return e.parentNode}e=e.parentNode}return null}function $(e){if(!a.htmlEscaper){a.htmlEscaper=document.createElement("div")}a.htmlEscaper.innerHTML="";a.htmlEscaper.appendChild(document.createTextNode(e));return a.htmlEscaper.innerHTML}function V(e){clearTimeout(i.timers[e]);i.timers[e]=null}};ZUL.setOptions({site:"wowhead",mobileLoadCheck:function(){return WH.Layout.Responsive.check()},mobileWidthCheck:function(){return WH.Layout.Responsive.check()},mobileBackText:WH.TERMS.back_verb,mobileIconSpacing:true,states:{loggedOut:{pre:[{type:"custom",custom:function(e,t){e.style.paddingLeft="32px";var a=WH.ce("span");a.id=a.className="zul-bar-mobile-loginwithcolon";a.innerHTML=WH.TERMS.loginwith_colon;WH.ae(e,a);a=WH.ce("span");a.id=a.className="zul-bar-mobile-logincolon";a.innerHTML=WH.TERMS.login+WH.TERMS.colon_punct;WH.ae(e,a);var i=WH.ce("a",{id:"zul-bar-mobile-battlenet",className:"zul-bar-mobile-item-battlenet btn btn-blizzard",innerHTML:"Battle.net",href:WH.getRelativeHostPrefix()+WH.Url.generatePath("/battle-net/start")});WH.aE(i,"tap",(function(){WH.visitUrlWithPostData(WH.getRelativeHostPrefix()+WH.Url.generatePath("/battle-net/start"),{r:1});return false}));WH.ae(e,i);let n=WH.ce("a",{id:"zul-bar-mobile-email",className:"zul-bar-mobile-item-email btn btn-site",innerHTML:"<span>"+WH.TERMS.email+"</span>",href:WH.Url.getLoginPath()});WH.aE(n,"tap",(function(){WH.goToLoginPage();return false}));WH.ae(e,n)}},{type:"link",name:"register",innerHTML:WH.TERMS.register,href:WH.Url.getRegistrationPath()},{type:"link",name:"get-premium",innerHTML:WH.TERMS.getpremium,href:WH.Url.generatePath("/premium"),fontIcon:"star"}]},loggedIn:{pre:[{type:"link",name:"staff",innerHTML:WH.TERMS.staffemployees,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(Menu.getMenu("staff"))}},condition:function(e,t){return Menu.getMenu("staff")}},{type:"link",name:"favorites",innerHTML:WH.TERMS.favorites,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(WH.Favorites.getMenu())}},condition:WH.Favorites.hasFavorites},{type:"link",name:"user",innerHTML:function(e,t){return t.user.name+" <small>("+WH.numberFormat(t.user.reputation)+" "+WH.TERMS.reputation+")</small>"},mobileMenuText:"%NAME%",menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getUserMenu())}}},{type:"link",name:"characters",innerHTML:WH.TERMS.myprofiles,menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getProfilerMenu())}}},{type:"link",name:"upgrade",innerHTML:WH.TERMS.upgradeavailable,href:WH.Url.generatePath("/premium"),fontIcon:"arrow-up",condition:function(e,t){return!t.user.premium}}]},universal:{pre:[{type:"link",name:"mobileheader",href:WH.Url.generatePath("/"),heading:true},{name:"data-env-switcher-header",type:"link",text:WH.TERMS.selectGame,heading:true},{type:"concatenation",content:function(e,t){const a=WH.Game;const i=WH.Layout;const n=WH.WebP;let s=WH.getDataEnv();let r=a.get();let o=e=>WH.STATIC_URL+"/images/header/data-tree-switcher/"+a.getKey(e)+"-icon-2x"+n.getImageExtension();let l={};Object.entries(WH.dataEnvToTree).forEach((([e,t])=>{l[t]??=[];l[t].push(parseInt(e))}));let c=e=>{let t=a.getDataTrees(e);if(t.length===1&&l[t[0]].length===1){let n=l[t[0]][0];return{name:"data-env-switcher-game",type:"link",text:a.getName(e),href:i.getEnvSwitcherUrl.bind(i,n),imageIcon:{url:o(e)},checked:s===n}}return{name:"data-env-switcher-game",type:"link",text:a.getName(e),imageIcon:{url:o(e)},checked:r===e,menu:{mobile:()=>{let e=[];t.forEach((t=>{l[t].forEach((a=>{if(!WH.isDataEnvActive(a)){return}e.push({name:"data-env-switcher-game",type:"link",text:WH.term(WH.getDataEnvTerm(a)),href:i.getEnvSwitcherUrl.bind(i,a),imageIcon:{url:i.getFaviconUrl(WH.getDataTreeKey(t))},checked:s===a})}))}));return e}}}};let u=[];let d=[];a.getAllSorted().forEach((e=>{if(a.hasAccess(e)){if(a.isUnderstated(e)){d.push(e)}else{u.push(c(e))}}}));u.push({name:"more-envs",type:"link",text:WH.TERMS.more+WH.TERMS.ellipsis_punct,checked:d.includes(r),menu:{mobile:()=>d.map((e=>c(e)))}});return u}},{type:"link",text:WH.TERMS.featuredGuides,heading:true},{type:"concatenation",content:function(e,t){return Menu.prepareForZul(Menu.getFeaturedNavigationMenu())}},{type:"link",text:WH.TERMS.navigation,heading:true},{type:"concatenation",content:function(e,t){return Menu.prepareForZul(Menu.getMenu())}},{type:"link",text:"",heading:true}],content:(()=>{const e=WH.Layout;return[{type:"link",name:"feedback",innerHTML:WH.TERMS.feedback,href:"javascript:",fontIcon:"envelope",click:function(){ZUL.closeMobileMenu();ContactTool.show()}},{type:"link",name:"locale",innerHTML:function(e,t){return Locale.getDescription()||WH.TERMS.language},href:"javascript:",mobileMenuText:WH.TERMS.language,menu:{mobile:function(){return Menu.prepareForZul(e.User.getLocaleMenu())}}},{type:"link",name:"theme",innerHTML:function(e,t){let a=WH.TERMS.unknown;switch(WH.Theme.getTheme()){case"standard":a=WH.TERMS.standard;break;default:WH.error("Unknown theme in ZUL configuration!",WH.Theme.getTheme())}return WH.TERMS.theme_format.replace("%s","<b>"+a+"</b>")},condition:function(e,t){return WH.Theme.getThemes().length>1},mobileMenuText:WH.TERMS.changeTheme,menu:{mobile:function(){let e=WH.Theme.getThemes();let t=[];for(let a=0,i=e.length;a<i;a++){let i=e[a];(function(e){t.push({name:"theme-"+e,type:"link",innerHTML:WH.TERMS.theme_format.replace("%s",WH.TERMS[e]),href:"javascript:",click:function(){let t=WH.qs(".zul-bar-mobile-item-theme-"+e);if(t){if(t.classList.contains("zul-bar-checked")){ZUL.closeMobileMenu();return}t.classList.add("zul-bar-has-fa");WH.aef(t,WH.ce("i",{className:"fa fa-refresh fa-spin"}))}if(!WH.User.isLoggedIn()){window.location=WH.Url.generatePath(WH.Url.getLoginPath(WH.Url.getPathCommand()));return}WH.Theme.set(e)},checked:function(t,a){return WH.Theme.getTheme()===e}})})(i)}return t}()}}]})(),mobileBarContent:[{type:"form",name:"search",action:WH.Url.generatePath("/search"),method:"get",fields:[{type:"text",name:"q",label:WH.TERMS.searchGuidesNewsDatabase_stc_ellipsis,value:function(){var e=function(){var t=$(".header-search form input");if(!t.length){setTimeout(e,5);return}$("#zul-bar-form-q").val(t.val()||"")};e();setTimeout((function(){WH.Search.Live.attach(WH.ge("zul-bar-form-search-q"))}),0);return""},focus:function(){document.body.scrollTop=0;document.body.scrollLeft=0;setTimeout((function(){document.body.scrollTop=0;document.body.scrollLeft=0;let e=WH.ce("div",{className:"zul-bar-fade zul-bar-fade-body-only"});WH.aE(e,"click",(()=>WH.de(e)));WH.ae(document.body,e)}),5)},blur:function(){WH.de(".zul-bar-fade.zul-bar-fade-body-only")}}]},{ariaLabel:WH.TERMS.share,name:"share",onClick:e=>{const t=WH.ShareServices.getSubredditByGame(WH.Game.get());const a=location.href;const i=[[,WH.TERMS.shareon_colon],[1,WH.TERMS.bluesky,WH.ShareServices.getShareUrl("bluesky",a),undefined,{fontIcon:"bluesky",newWindow:true}],[2,WH.TERMS.facebook,WH.ShareServices.getShareUrl("facebook",a),undefined,{fontIcon:"facebook",newWindow:true}],[3,WH.TERMS.reddit,WH.ShareServices.getShareUrl("reddit",a,t),undefined,{fontIcon:"reddit-alien",newWindow:true}]];Menu.show(i,e.target)},type:"button"}]}}});WH.Admin.Debug=new function(){const e=this;this.TYPE_CODE="code";this.TYPE_MESSAGE="message";this.TYPE_QUERY="query";this.TYPE_SEO="seo";const t=0;const a=1;const i=2;const n="log";const s="warn";const r="error";const o="critical";const l={announcementId:1e5,footerInitialized:false,queue:[],debugQueueButton:undefined};this.critical=function(e,t,a){d({level:o,markup:a||false,message:t,type:e})};this.error=function(e,t,a){d({level:r,markup:a||false,message:t,type:e})};this.initFooter=function(){let e=WH.qs(".footer-utility-site-links");if(!e){return}let t=WH.ce("a",{className:"debug-footer-toggle fa"});WH.preventSelectStart(t);let a=WH.ce("li",{className:"footer-list-item-debug"});WH.ae(e,a);WH.ae(a,t);WH.aE(t,"click",(function(){let e=WH.qs(".debug-footer");if(e.dataset.state==="hidden"){WH.st(this,"Hide debug");this.classList.add("fa-minus-circle");this.classList.remove("fa-plus-circle");e.dataset.state="visible";if(l.footerInitialized){WH.scrollTo(t)}}else{WH.st(this,"Show debug");this.classList.add("fa-plus-circle");this.classList.remove("fa-minus-circle");e.dataset.state="hidden"}}));if(WH.User.hasRole(U_GROUP_DEV)){WH.qs(".debug-footer").dataset.state="hidden"}WH.DOM.dispatchEvent(t,"click");l.footerInitialized=true};this.initFooterTabs=function(){let e=WH.qs(".debug-footer-inner");if(!e){return}WH.qsa(".debug-footer .tabs a").forEach((function(t){WH.aE(t,"click",(function(){let t;if(!this.tabSettings||!(t=WH.ge("tab-"+this.tabSettings.id))){return}let a=t.offsetHeight-2;if(e.style.minHeight){if(parseInt(e.style.minHeight)>=a){return}}else{let e;if(this.tabSettings.id!=="info"&&(e=WH.ge("tab-info"))){e.style.display="";let t=e.offsetHeight-2;e.style.display="none";if(t>a){a=t}}}a=Math.min(a,window.innerHeight);e.style.minHeight=a+"px"}))}))};this.log=function(e,t,a){d({level:n,markup:a||false,message:t,type:e})};this.warn=function(e,t,a){d({level:s,markup:a||false,message:t,type:e})};function c(){return WH.PageMeta.debug||false}function u(t){switch(t.type){case e.TYPE_CODE:case e.TYPE_QUERY:if(t.level!==r&&!WH.User.hasRole(U_GROUP_DEV)){return a}return i;case e.TYPE_SEO:if(t.level!==r&&!WH.User.hasRole(U_GROUP_BLOGGER|U_GROUP_EDITOR)){return a}return i;case e.TYPE_MESSAGE:return i;default:WH.error("Unknown debug message type.",t.type);return i}}function d(e){if(!c()){l.queue.push(e);return}switch(u(e)){case i:f(e);break;case t:break;case a:l.queue.push(e);g();break;default:WH.error("Debug message action could not be determined.",e.type,e);f(e)}}function f(e){if(!e.message){var t="Tried to display an empty debug message.";WH.error(t,e);alert(t);return}var a={allowMarkup:e.markup,class:"debug debug-type-"+(e.type||"unknown")+" debug-level-"+e.level,id:l.announcementId.toString(),nocookie:1,parent:"debug-message-wrapper-"+l.announcementId,text:e.message};var i=WH.ce("div",{id:a.parent});var n=WH.ge("announcement-0");if(n){n.parentNode.insertBefore(i,n)}else{if(document.readyState!=="complete"){WH.aE(document,"readystatechange",f.bind(this,e));return}else{var s=WH.qs(".main-contents");if(s){WH.aef(s,i)}else{WH.aef(document.body,i)}}}l.announcementId++;new WH.Announcement(a);$("#"+a.parent+"-markup .error-reveal-button").click((function(){$("#"+a.parent+"-markup > div").show();WH.de(this)}))}function h(){while(l.queue.length){f(l.queue.shift())}}function p(){var e={};for(var t=0,a=l.queue.length;t<a;t++){var i=l.queue[t];if(!e[i.level]){e[i.level]=0}e[i.level]++}return e}function m(){if(!l.debugQueueButton){l.debugQueueButton=WH.Layout.User.createDebugQueueElement();if(!l.debugQueueButton){return undefined}WH.aE(l.debugQueueButton.getElement(),"click",(function(){h();g()}));WH.Tooltips.attach(l.debugQueueButton.getElement(),H().html)}return l.debugQueueButton}function H(){var e=p();var t="debug";var a=l.queue.length!==1?"s":"";var i=[];for(var n in e){if(!e.hasOwnProperty(n)){continue}if(e[n]===l.queue.length){t=n}else{i.push(e[n]+" "+n+(e[n]!==1?"s":""))}}var s=l.queue.length+" "+t+" message"+a+" queued.";let r;if(i.length){r=s+"<br>Click to show "+Locale.formatList(i)+"."}else{r=s+"<br>Click to show."}return{html:'<div class="no-wrap q2">'+r+"</div>",text:s}}function g(){if(!c()){return}if(!l.queue.length&&!l.debugQueueButton){return}const e=m();if(!e){if(document.readyState!=="complete"){WH.aE(document,"readystatechange",g.bind(this))}else{h()}return}if(!l.queue.length){if(e.getElement().style.display!=="none"){e.getElement().style.display="none";WH.Layout.updateSearchWidth()}return}var t=p();if(t.hasOwnProperty(r)){e.getElement().dataset.level=r}else if(t.hasOwnProperty(o)){e.getElement().dataset.level=o}else if(t.hasOwnProperty(s)){e.getElement().dataset.level=s}else{e.getElement().dataset.level=n}e.updateText(e.getElement().dataset.level===n?"":l.queue.length);e.getElement().ariaLabel=H().text;if(e.getElement().style.display==="none"){delete e.getElement().style.display;WH.Layout.updateSearchWidth()}}};WH.Admin.Localization=new function(){var e=0;var t=1;var a={0:{class:"q10",name:"Error"},1:{class:"r1",name:"Warning"}};var i={default:":",[LOCALE_FRFR]:" :",[LOCALE_ZHCN]:"：",[LOCALE_ZHTW]:"："};var n={default:": ",[LOCALE_FRFR]:" : ",[LOCALE_ZHCN]:"：",[LOCALE_ZHTW]:"："};var s={default:"…"};var r={default:"!",[LOCALE_ZHCN]:"！",[LOCALE_ZHTW]:"！"};var o={default:".",[LOCALE_ZHCN]:"。",[LOCALE_ZHTW]:"。"};var l={default:"?",[LOCALE_ZHCN]:"？",[LOCALE_ZHTW]:"？"};this.initValidation=function(e,t,a,i,n){let s;let r=$(t);if(e===LOCALE_ENUS){r.bind("keydown keyup change",function(e,t){clearTimeout(s);s=setTimeout(h.bind(null,e,t),300)}.bind(null,r,i))}else{r.bind("keydown keyup change",function(e,t,a,i,n){clearTimeout(s);s=setTimeout(g.bind(null,e,t,a,i,n),300)}.bind(null,e,r,$(a),i,n))}if(g_user.roles&U_GROUP_DEV){r.change()}};function c(e){var t=e.match(/%(?:\d+\$)?[sd]/g);return t?t.length:0}function u(e,t){var i=e.siblings(".localization-message");if(!i.length){i=$("<div/>",{class:"localization-message"}).appendTo(e.parent())}i.empty();if(t.length){for(var n=0,s=t.length;n<s;n++){var r=t[n];var o="localization-message-"+a[r.type].name.toLowerCase();$("<div/>",{class:o+" "+a[r.type]["class"],text:a[r.type].name+": "+r.message}).appendTo(i)}}}function d(t,a){var i=[];if(!a.match(/[<>]/)&&t.match(/[<>]/)){i.push({type:e,message:"This translation appears to have HTML in it, but the original does not."})}return i}function f(e,a){var i=[];var n=a.match(/\n/g);var s=e.match(/\n/g);n=n?n.length:0;s=s?s.length:0;if(n>=3){return i}if(s>0&&n===0){i.push({type:t,message:"This translation has line breaks, but the original does not."})}else if(n!==s){i.push({type:t,message:"The number of line breaks in this translation ("+s+") does not "+"match the original ("+n+")."})}return i}function h(e,a){let c=a||(e.is("input, textarea")?e.val():e.text());var d=[];if(c!==""){if(c.match(/[<>]/)){d.push({type:t,message:"Avoid using HTML in term text."})}if(c.indexOf("\t")>-1){d.push({type:t,message:"Avoid tabs in term text."})}if(c.indexOf(" ")===0){d.push({type:t,message:"Avoid starting with a space in term text."})}var f=false;var h=[o,r,l,s,n,i];for(var p=0,m=h.length;p<m;p++){var H=h[p]["default"];if(c.substr(-1*H.length)===H){f=true;break}}if(!f&&c.substr(-1)===" "){d.push({type:t,message:"Avoid ending with a space in term text, if it's not related to punctuation (such as "+"after a colon)."})}if(c.indexOf("  ")>-1){d.push({type:t,message:"Avoid using multiple sequential spaces in term text."})}if(c.match(/(\r\n|\r|\n)/)){d.push({type:t,message:"Avoid using line breaks in term text, if possible."})}}u(e,d)}function p(e,a,c){var u=[];var d=false;var f=function(i,n){var s=i["default"];var r=i[c]||s;if(a.substr(-1*s.length)===s){d=true;if(e.substr(-1*r.length)!==r){return[{type:t,message:"This translation doesn't end in matching "+n+" punctuation for this locale ("+r+")."}]}}else{if(e.substr(-1*r.length)===r||e.substr(-1*s.length)===s){if(r==="："&&s===":"&&a.substr(-2)===": "||r==="："&&s===": "&&a.substr(-1)===":"){return[]}return[{type:t,message:"This translation ends in "+n+" punctuation, but the original "+"does not."}]}}return[]};u=u.concat(f(o,"full stop"));u=u.concat(f(r,"exclamation"));u=u.concat(f(l,"question mark"));u=u.concat(f(s,"ellipsis"));u=u.concat(f(n,"colon"+(Locale.hasWordSpaces(c)?" (with a space)":"")));u=u.concat(f(i,"colon"+(Locale.hasWordSpaces(c)?" (without a space)":"")));if(!d){if(a.substr(-1)===" "){if(Locale.hasWordSpaces(c)||Locale.hasSentenceSpaces(c)){if(e.substr(-1)!==" "){u.push({type:t,message:"This translation doesn't end in a space, but the original does."})}}}else{if(e.substr(-1)===" "){u.push({type:t,message:"This translation ends in a space, but the original does not."})}}}return u}function m(e,a,i){var n=[];if(Locale.hasWordSpaces(i)||Locale.hasSentenceSpaces(i)){var s=e.substr(0,1);var r=a.substr(0,1);if(s===" "&&r!==" "){n.push({type:t,message:"This translation starts with a space, but the original does not."})}else if(s!==" "&&r===" "){n.push({type:t,message:"This translation does not start with a space, but the original does."})}}if(e.indexOf("\t")>-1&&a.indexOf("\t")){n.push({type:t,message:"This translation has a tab character, but the original does not."})}if(e.indexOf("  ")>-1&&a.indexOf("  ")===-1){n.push({type:t,message:"This translation has multiple spaces, but the original does not."})}return n}function H(e,a){var i=[];var n=c(e);var s=c(a);if(n!==s){i.push({type:t,message:"This translation has "+n+" string replacement placeholders, "+"but the original has "+s+"."})}return i}function g(e,t,a,i,n){i=i||(t.is("input, textarea")?t.val():t.text());n=n||(a.is("input, textarea")?a.val():a.text());let s=[];if(i!==""){s=s.concat(d(i,n));s=s.concat(H(i,n));s=s.concat(p(i,n,e));s=s.concat(m(i,n,e));s=s.concat(f(i,n))}u(t,s)}};WH.D4.Affix=new function(){this.MAGIC_TYPE_NONE=0;this.MAGIC_TYPE_LEGENDARY=1;this.MAGIC_TYPE_UNIQUE=2;this.MAGIC_TYPE_SET=3;this.MAGIC_TYPE_MYTHIC_UNIQUE=4};WH.D4.Affix.Category=WH.defineEnum({Offensive:0,Defensive:1,Utility:2,Resource:3,Mobility:4},(function(e){"use strict";const t=this;this.getIdString=()=>t.name.toLowerCase()}));WH.D4.Gender=new function(){const e=this;this.FEMALE=1;this.MALE=0;const t=[e.FEMALE,e.MALE];const a={[this.FEMALE]:WH.TERMS.female,[this.MALE]:WH.TERMS.male};const i={[this.FEMALE]:"female",[this.MALE]:"male"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getBySlug=function(e){for(let t in i){if(i[t]===e){return t}}return null};this.getName=function(e){return a[e]||null};this.getSlug=function(e){return i[e]||null}};WH.D4.Item=new function(){const e=WH.D4.Affix;this.getModifiedName=(t,a)=>{const i=WH.D4.Item.Quality;switch(t.quality){case i.COMMON:case i.MAGIC:case i.MAGIC2:case i.LEGENDARY:let n;a.forEach((a=>{if(t.quality===i.LEGENDARY&&a.magicType!==e.MAGIC_TYPE_LEGENDARY){return}if(a.modifier){n=WH.Strings.sprintf(WH.Strings.escapeHtml(a.modifier),n||t["nameHtml_"+Locale.getName()]||WH.Strings.escapeHtml(t["name_"+Locale.getName()]||t.name))}}));if(n!==undefined){return n}break}}};WH.D4.ItemType=new function(){const e=this;const t=WH.getPageData("d4.itemType")||{};this.getAll=()=>Object.keys(t).map((e=>parseInt(e))).sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))));this.getClassMask=e=>t[e]?.classMask;this.getSlots=e=>t[e]?.slots||[];this.getName=e=>t[e]?.name;this.getIdString=e=>t[e]?.idString;this.getSocketTarget=e=>t[e]?.socketTarget;this.isTwoHand=e=>t[e]?.isTwoHand||false;this.isWeapon=e=>t[e]?.isWeapon||false};WH.D4.PlayerClass=function(e){"use strict";const t=this;const a=WH.Game;const i=WH.D4.PlayerClass.Index;const n=Object.seal({dataEnv:undefined,index:{},names:{}});const s=WH.getPageData("d4.playerClass.index");const r=WH.getPageData("d4.playerClass.names");this.fromIdString=e=>t.fromIndex(i.cases().find((t=>t.getIdString()===e)));this.fromIndex=e=>n.index[e.value];this.getIdString=e=>t.getIndex(e).getIdString();this.getIndex=e=>i.tryFrom(WH.findKey(n.index,e,true));this.getName=e=>n.names[e];const o=e=>{e??=WH.getDataEnv();if(a.getByEnv(e)!==a.D4){e=a.getEnv(a.D4)}if(!s[e]){e=WH.getRootEnv(e)}n.dataEnv=e;n.index=s[e]??{};n.names=r[e]??{}};o.apply(this,arguments)};WH.stub("D4");WH.D4.ModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.DOM;const a=WH.Game;const i=WH.D4.PlayerClass;const n=WH.Types;const s=WH.Url;const r=20;const o=76;const l={elements:{animationSelect:undefined,classSelect:undefined,lightboxContent:undefined,screen:undefined},playerGender:undefined,playerClass:undefined,dataEnv:undefined,entityType:undefined,entityId:undefined,extendedHash:false,fromMarkup:false,ignoreHash:false,library:{},libraryLoadedCallbacks:{},message:undefined,oldHash:"",onHide:undefined,ratio:16/9,resizeEventBound:false,shown:false,variant:0,viewer:undefined};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return l.library[e]};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}let i=!!l.libraryLoadedCallbacks[a];if(!i){l.libraryLoadedCallbacks[a]=[]}if(t){if(l.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{l.libraryLoadedCallbacks[a].push(t)}}if(i){return}let n=WH.ce("script");n.src=d(a)+"/modelviewer/viewer.js";WH.aE(n,"load",(function(){if(window.Viewer&&window.Viewer.default){l.library[a]=window.Viewer.default;delete window.Viewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but Viewer is still undefined!");return}while(l.libraryLoadedCallbacks[a].length){l.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load Viewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){e=e||{};l.dataEnv=e.dataEnv||WH.getDataEnv();l.entityId=e.typeId;l.entityType=e.type;l.extendedHash=!!e.extendedHash;l.fromMarkup=!!e.fromTag;l.ignoreHash=!!e.noPound;l.message=e.message;l.onHide=e.onHide;Lightbox.show("modelviewer",{onShow:E,onHide:W})};function c(){if(l.entityType===n.D4_ITEM){if(l.elements.classSelect){return}let e=WH.getPageData("modelData");if(!e||e.length===0){return}l.elements.classSelect=t.createImitationSelect({native:true});let a=l.elements.classSelect;a.classList.add("d4-model-select");WH.ae(WH.qs(".modelviewer-model"),a);const n=new i(l.dataEnv);e.forEach((e=>{WH.D4.Gender.getAll().forEach((t=>{let i=n.getName(e)+WH.TERMS.comma_punct+WH.D4.Gender.getName(t);WH.ae(a,WH.ce("option",{dataset:{classId:e,genderId:t},label:i}))}))}));WH.aE(a,"change",(()=>{switch(l.entityType){case WH.Types.D4_ITEM:p();break}}));a.selectedIndex=0}}const u=e=>{if(WH.isDataEnvRestricted(e)){return s.generatePrivate("").replace(/\/+$/,"")}return WH.isDev()?"https://static-staging.wowhead.com":WH.STATIC_URL};const d=e=>{let t=e??WH.getDataEnv();if(a.getByEnv(t)!==a.D4){t=a.getEnv(a.D4)}return u(e)+`/d4/mv-cors/${WH.getDataEnvKey(t)}`};function f(){let e=l.elements.classSelect;let t=e.options[e.selectedIndex];return{playerClass:e?t.dataset.classId:169776,playerGender:t.dataset.genderId}}function h(){WH.onLoad(m)}function p(){g();const e=new i(l.dataEnv);let t=e.getIndex(parseInt(l.playerClass));l.viewer.loadItem(l.entityId,t.value,l.playerGender,null)}function m(){if(!location.hash||location.hash.indexOf("#modelviewer")!==0){return}let t=location.hash.split(":");if(t.length<3){let e=WH.ge("wh-mv-view-in-3d-button");if(e){e.click()}return}t.shift();let a=parseInt(t.shift());let i={type:a,extendedHash:true};switch(a){case WH.Types.D4_ITEM:i.typeId=parseInt(t.shift());break}if(i.typeId){e.showLightbox(i)}}function H(){let t=l.dataEnv;if(!e.isLibraryLoaded(t)){e.loadLibrary(H.bind(this),t);return}if(!l.viewer){WH.ee(l.elements.screen);let a=WH.ce("canvas",{id:WH.Strings.guid(),style:{width:"100%",height:"100%"}});WH.ae(l.elements.screen,a);l.viewer=new(e.getLibrary(t))({rootGameDataPath:d(t),basePath:d(t)+"/modelviewer",canvasQuerySelector:"#"+a.id})}switch(l.entityType){case WH.Types.D4_ITEM:c();p();break;default:WH.error("Unsupported entity type",l.entityType)}if(!l.resizeEventBound){WH.aE(window,"resize",_);l.resizeEventBound=true}_();if(!l.ignoreHash){let e="#modelviewer";if(l.extendedHash){switch(l.entityType){case n.D4_ITEM:e+=":"+l.entityType+":"+l.entityId;break}}location.replace(WH.rtrim(e,":"))}}function g(){let e=f();l.playerClass=e.playerClass;l.playerGender=e.playerGender}function W(){l.shown=false;if(!l.ignoreHash){if(!l.fromMarkup&&l.oldHash&&l.oldHash.indexOf("modelviewer")===-1){WH.setHash(l.oldHash)}else{WH.clearHash()}}WH.ee(l.elements.screen);if(l.viewer){l.viewer=undefined}if(l.onHide){l.onHide()}}function E(e,t){l.shown=true;if(t){e.classList.add("has-lightbox-caption","modelviewer");l.elements.screen=WH.ce("div",{className:"modelviewer-screen"});l.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(l.elements.lightboxContent,l.elements.screen);e.append(l.elements.lightboxContent);_();let t=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(t,"click",Lightbox.hide);WH.ae(e,t);WH.ae(e,WH.ce("a",{className:"dialog-option fa fa-question",href:s.generatePath("/help=modelviewer"),target:"_blank"},WH.ct(WH.TERMS.help)));WH.ae(e,WH.ce("div",{className:"modelviewer-model"}));WH.ae(e,WH.ce("div",{className:"modelviewer-instructions"},WH.ct(WH.TERMS.modelviewercontrols_tip)));WH.ae(e,WH.ce("div",{id:"modelviewer-msg",className:"sub",style:{marginTop:"-6px",color:"#ccc",fontSize:"13px"}}));if(WH.User.isLoggedIn()){WH.fetch(s.generatePath("/website-achievement-explored"),{form:{trigger:"modelviewer"},success:AchievementCheck})}}requestAnimationFrame(H);let a=WH.qs("#modelviewer-msg",e);if(l.message){a.innerHTML=l.message;WH.displayDefault(a)}else{WH.displayNone(a)}let i="";switch(l.entityType){case n.D4_ITEM:i+="D4 Item "+l.entityId;break}WH.Track.interactiveEvent({category:"Model Viewer",action:"Show",label:WH.Strings.slug(i)});l.oldHash=location.hash}function _(){if(!l.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=l.elements.lightboxContent.offsetWidth;t=l.elements.lightboxContent.offsetHeight;l.elements.screen.style.width="100%";l.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-r;t=window.innerHeight-Lightbox.BLEED_SIZE-o;let a=Math.round(t*(16/9));let i=Math.round(e*(9/16));if(e>a){e=a}else if(t>i){t=i}l.elements.screen.style.width=e+"px";l.elements.screen.style.height=t+"px"}}h()}));WH.D4.Slot=new function(){const e=this;this.BACKPACK=0;this.HEAD=4;this.TORSO=5;this.OFF_HAND=6;this.MAIN_HAND=7;this.TWO_HAND_BLUNT=8;this.TWO_HAND_SLASH=9;this.TWO_HAND_RANGED=10;this.ONE_HAND_MAIN=11;this.ONE_HAND_OFF=12;this.HANDS=13;this.LEGS=14;this.FEET=15;this.RIGHT_FINGER=16;this.LEFT_FINGER=17;this.NECK=18;this.COSMETIC_BACK=19;this.BODY=20;this.TROPHY=21;const t=WH.getPageData("d4.slot.names")||{};const a={[this.BACKPACK]:"backpack",[this.HEAD]:"head",[this.TORSO]:"torso",[this.OFF_HAND]:"off-hand",[this.MAIN_HAND]:"main-hand",[this.TWO_HAND_BLUNT]:"two-hand-blunt",[this.TWO_HAND_SLASH]:"two-hand-slash",[this.TWO_HAND_RANGED]:"two-hand-ranged",[this.ONE_HAND_MAIN]:"one-hand-main",[this.ONE_HAND_OFF]:"one-hand-off",[this.HANDS]:"hands",[this.LEGS]:"legs",[this.FEET]:"feet",[this.RIGHT_FINGER]:"right-finger",[this.LEFT_FINGER]:"left-finger",[this.NECK]:"neck",[this.COSMETIC_BACK]:"cosmetic-back",[this.BODY]:"body",[this.TROPHY]:"trophy"};const i={[this.HEAD]:2838315796,[this.TORSO]:3464278949,[this.OFF_HAND]:4152556196,[this.MAIN_HAND]:2552014734,[this.TWO_HAND_BLUNT]:2179417043,[this.TWO_HAND_SLASH]:1860774254,[this.TWO_HAND_RANGED]:72124820,[this.ONE_HAND_MAIN]:2552014734,[this.ONE_HAND_OFF]:2552014734,[this.HANDS]:2813703134,[this.LEGS]:3479454196,[this.FEET]:3463355509,[this.RIGHT_FINGER]:2838679582,[this.LEFT_FINGER]:2838679582,[this.NECK]:2580281430};this.getAll=()=>Object.keys(a).map((e=>parseInt(e))).sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))));this.getDisplaySort=()=>[this.HEAD,this.TORSO,this.HANDS,this.LEGS,this.FEET,this.NECK,this.RIGHT_FINGER,this.LEFT_FINGER,this.TWO_HAND_RANGED,this.TWO_HAND_BLUNT,this.TWO_HAND_SLASH,this.MAIN_HAND,this.ONE_HAND_MAIN,this.OFF_HAND,this.ONE_HAND_OFF,this.COSMETIC_BACK,this.BACKPACK,this.BODY,this.TROPHY];this.getName=e=>t[e];this.getIconHash=e=>i[e];this.getIdString=e=>a[e];this.isWeaponSlot=e=>[this.TWO_HAND_RANGED,this.TWO_HAND_BLUNT,this.TWO_HAND_SLASH,this.MAIN_HAND,this.ONE_HAND_MAIN,this.OFF_HAND,this.ONE_HAND_OFF].includes(e)};WH.D4.Item.Quality=new function(){const e=this;this.COMMON=0;this.MAGIC=1;this.MAGIC2=2;this.RARE=3;this.RARE2=4;this.LEGENDARY=5;this.UNIQUE=6;this.SET=7;this.MYTHIC_UNIQUE=8;const t={[this.COMMON]:"normal",[this.MAGIC]:"magic",[this.MAGIC2]:"magic",[this.RARE]:"rare",[this.RARE2]:"rare",[this.LEGENDARY]:"legendary",[this.UNIQUE]:"unique",[this.SET]:"set",[this.MYTHIC_UNIQUE]:"mythic-unique"};this.getQualityIds=()=>Object.keys(t).map((e=>parseInt(e)));this.getSlug=e=>t[e]};WH.D4.PlayerClass.Index=WH.defineEnum({Sorcerer:0,Druid:1,Barbarian:2,Rogue:3,Necromancer:4,Spiritborn:5},(function(e){"use strict";const t=this;const a={0:"sorcerer",1:"druid",2:"barbarian",3:"rogue",4:"necromancer",5:"spiritborn"};this.getIdString=()=>a[t.value];this.getFlag=()=>1<<t.value}));WH.DI.EquipItem=new function(){};WH.DI.Gender=new function(){const e=this;this.FEMALE="f";this.MALE="m";const t=[e.FEMALE,e.MALE];const a={[this.FEMALE]:WH.TERMS.female,[this.MALE]:WH.TERMS.male};const i={[this.FEMALE]:1,[this.MALE]:0};const n={[this.FEMALE]:"female",[this.MALE]:"male"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getBySlug=function(e){for(let t in n){if(n[t]===e){return t}}return null};this.getName=function(e){return a[e]||null};this.getNumericId=function(e){return i[e]};this.getSlug=function(e){return n[e]||null}};WH.DI.InventoryColor=new function(){this.GRAY=0;this.INFERIOR_BLUE=1;this.LIGHT_BLUE=2;this.WHITE=3;this.BLUE=4;this.GOLD=5;this.ORANGE=6;this.GREEN=7;this.DUBO=8;this.VIOLET=9};WH.stub("DI");WH.DI.ModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.DOM;const a=WH.Types;const i=WH.Url;const n=[-1,0,1,2];const s=20;const r=76;const o={elements:{animationSelect:undefined,classSelect:undefined,lightboxContent:undefined,resonanceSelect:undefined,screen:undefined},playerGender:undefined,playerClass:undefined,dataEnv:undefined,entityResonance:undefined,entityType:undefined,entityId:undefined,extendedHash:false,fromMarkup:false,ignoreHash:false,library:{},libraryLoadedCallbacks:{},message:undefined,oldHash:"",onHide:undefined,ratio:16/9,resizeEventBound:false,selectedResonance:n[0],shown:false,variant:0,viewer:undefined};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return o.library[e]};this.getStaticBase=function(e){return"/di/modelviewer"};this.getContentPath=t=>{let a=`${e.getStaticBase(t)}/`;if(WH.isDataEnvRestricted(t)){return i.generatePrivate(a)}return(WH.isDev()?"https://static-staging.wowhead.com":WH.STATIC_URL)+a};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}let i=!!o.libraryLoadedCallbacks[a];if(!i){o.libraryLoadedCallbacks[a]=[]}if(t){if(o.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{o.libraryLoadedCallbacks[a].push(t)}}if(i){return}let n=WH.ce("script");n.src=e.getContentPath(a)+"viewer.js";WH.aE(n,"load",(function(){if(window.Viewer&&window.Viewer.default){o.library[a]=window.Viewer.default;delete window.Viewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but Viewer is still undefined!");return}while(o.libraryLoadedCallbacks[a].length){o.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load Viewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){e=e||{};o.dataEnv=e.dataEnv||WH.getDataEnv();o.entityId=e.typeId;o.entityResonance=e.hasResonance;o.entityType=e.type;o.extendedHash=!!e.extendedHash;o.fromMarkup=!!e.fromTag;o.ignoreHash=!!e.noPound;o.message=e.message;o.onHide=e.onHide;Lightbox.show("modelviewer",{onShow:H,onHide:m})};function l(){if(!o.elements.animationSelect){o.elements.animationSelect=t.createImitationSelect({native:true});let e=o.elements.animationSelect;e.classList.add("di-animation-select");WH.ae(WH.qs(".modelviewer-model"),e)}let e=o.elements.animationSelect;if(e.dataset.modelId!==o.entityId.toString()){WH.ee(e);let t=o.viewer.npc.animator.animations;if(t.length===0){e.dataset.hidden=true;return}t.forEach((t=>{WH.ae(e,WH.ce("option",{label:t.name,value:t.name}))}));e.dataset.modelId=o.entityId;WH.aE(e,"change",(()=>{o.viewer.npc.animator.setAnimationByName(e.options[e.selectedIndex].value)}))}e.selectedIndex=0}function c(){if(o.entityType===a.DI_EQUIP_ITEM){if(o.elements.classSelect){return}let e=WH.getPageData("modelData");if(!e||e.length===0){return}o.elements.classSelect=t.createImitationSelect({native:true});let a=o.elements.classSelect;a.classList.add("di-model-select");WH.ae(WH.qs(".modelviewer-model"),a);e.forEach((e=>{let t=WH.DI.PlayerClass.getByIdString(e.classString);let i=e.required?"di-class-equip":"di-class-restricted";let n=WH.DI.PlayerClass.getName(t)+WH.TERMS.comma_punct+WH.DI.Gender.getName(e.gender);let s=`${t}-${WH.DI.Gender.getNumericId(e.gender)}`;WH.ae(a,WH.ce("option",{className:i,label:n,value:s}))}));WH.aE(a,"change",(()=>{p();o.viewer.loadItem(o.entityId,o.playerClass,o.playerGender,o.variant,o.selectedResonance)}));a.selectedIndex=0}}function u(){let e=o.elements.classSelect;let t=e?e.options[e.selectedIndex].value.split("-"):[WH.DI.PlayerClass.WIZARD,WH.DI.Gender.getNumericId(WH.DI.Gender.MALE)];return{playerClass:parseInt(t[0]),playerGender:parseInt(t[1])}}function d(){WH.onLoad(f)}function f(){if(!location.hash||location.hash.indexOf("#modelviewer")!==0){return}let t=location.hash.split(":");if(t.length<3){let e=WH.ge("wh-mv-view-in-3d-button");if(e){e.click()}return}t.shift();let a=parseInt(t.shift());let i={type:a,extendedHash:true};switch(a){case WH.Types.DI_EQUIP_ITEM:i.typeId=parseInt(t.shift());break}if(i.typeId){e.showLightbox(i)}}function h(){let t=o.dataEnv;if(!e.isLibraryLoaded(t)){e.loadLibrary(h.bind(this),t);return}if(!o.viewer){WH.ee(o.elements.screen);let a=WH.ce("canvas",{id:WH.Strings.guid(),style:{width:"100%",height:"100%"}});WH.ae(o.elements.screen,a);o.viewer=new(e.getLibrary(t))({basePath:e.getContentPath(t).replace(/\/$/,""),canvasQuerySelector:"#"+a.id,databasePath:i.generatePath("/data-modelviewer/"),rootGameDataPath:e.getContentPath(t)+"data/"})}switch(o.entityType){case WH.Types.DI_EQUIP_ITEM:c();p();W();o.viewer.loadItem(o.entityId,o.playerClass,o.playerGender,o.variant,o.selectedResonance);break;case WH.Types.DI_NPC:o.viewer.loadMonster(o.entityId,-1,(function(){o.viewer.npc=this;o.viewer.npc.animator.setAnimationByIndex(0);l()}));break;default:WH.error("Unsupported entity type",o.entityType)}if(!o.resizeEventBound){WH.aE(window,"resize",g);o.resizeEventBound=true}g();if(!o.ignoreHash){let e="#modelviewer";if(o.extendedHash){switch(o.entityType){case a.DI_EQUIP_ITEM:e+=":"+o.entityType+":"+o.entityId;break}}location.replace(WH.rtrim(e,":"))}}function p(){let e=u();o.playerClass=e.playerClass;o.playerGender=e.playerGender}function m(){o.shown=false;if(!o.ignoreHash){if(!o.fromMarkup&&o.oldHash&&o.oldHash.indexOf("modelviewer")===-1){WH.setHash(o.oldHash)}else{WH.clearHash()}}WH.ee(o.elements.screen);if(o.viewer){o.viewer=undefined}if(o.onHide){o.onHide()}}function H(e,t){o.shown=true;if(t){e.classList.add("has-lightbox-caption","modelviewer");o.elements.screen=WH.ce("div",{className:"modelviewer-screen"});o.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(o.elements.lightboxContent,o.elements.screen);e.append(o.elements.lightboxContent);g();let t=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(t,"click",Lightbox.hide);WH.ae(e,t);WH.ae(e,WH.ce("a",{className:"dialog-option fa fa-question",href:i.generatePath("/help=modelviewer"),target:"_blank"},WH.ct(WH.TERMS.help)));WH.ae(e,WH.ce("div",{className:"modelviewer-model"}));WH.ae(e,WH.ce("div",{className:"modelviewer-instructions"},WH.ct(WH.TERMS.modelviewercontrols_tip)));WH.ae(e,WH.ce("div",{id:"modelviewer-msg",className:"sub",style:{marginTop:"-6px",color:"#ccc",fontSize:"13px"}}));if(WH.User.isLoggedIn()){WH.fetch(i.generatePath("/website-achievement-explored"),{form:{trigger:"modelviewer"},success:AchievementCheck})}}requestAnimationFrame(h);let n=WH.qs("#modelviewer-msg",e);if(o.message){n.innerHTML=o.message;WH.displayDefault(n)}else{WH.displayNone(n)}let s="";switch(o.entityType){case a.DI_EQUIP_ITEM:s+="DI Item "+o.entityId;break}WH.Track.interactiveEvent({category:"Model Viewer",action:"Show",label:WH.Strings.slug(s)});o.oldHash=location.hash}function g(){if(!o.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=o.elements.lightboxContent.offsetWidth;t=o.elements.lightboxContent.offsetHeight;o.elements.screen.style.width="100%";o.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-s;t=window.innerHeight-Lightbox.BLEED_SIZE-r;let a=Math.round(t*(16/9));let i=Math.round(e*(9/16));if(e>a){e=a}else if(t>i){t=i}o.elements.screen.style.width=e+"px";o.elements.screen.style.height=t+"px"}}function W(){if(o.entityResonance){if(!o.elements.resonanceSelect){o.elements.resonanceSelect=t.createImitationSelect({native:true});let e=o.elements.resonanceSelect;e.classList.add("di-resonance-select");WH.ae(WH.qs(".modelviewer-model"),e)}let e=o.elements.resonanceSelect;if(e.dataset.modelId!==o.entityId.toString()){WH.ee(e);n.forEach(((t,a)=>{WH.ae(e,WH.ce("option",{label:WH.TERMS.gemResonance+WH.TERMS.colon_punct+a,value:t}))}));e.dataset.modelId=o.entityId;WH.aE(e,"change",(()=>{o.viewer.loadItem(o.entityId,o.playerClass,o.playerGender,o.variant,e.options[e.selectedIndex].value)}))}e.selectedIndex=0}}d()}));WH.DI.PlayerClass=new function(){const e=this;this.BARBARIAN=2;this.BLOOD_KNIGHT=7;this.CRUSADER=5;this.DEMON_HUNTER=4;this.MONK=3;this.NECROMANCER=6;this.TEMPEST=8;this.WIZARD=1;const t=[e.BARBARIAN,e.BLOOD_KNIGHT,e.CRUSADER,e.DEMON_HUNTER,e.MONK,e.NECROMANCER,e.TEMPEST,e.WIZARD];const a={[this.BARBARIAN]:"barbarian",[this.BLOOD_KNIGHT]:"bloodknight",[this.CRUSADER]:"crusader",[this.DEMON_HUNTER]:"demonhunter",[this.MONK]:"monk",[this.NECROMANCER]:"necromancer",[this.TEMPEST]:"tempest",[this.WIZARD]:"sorceress"};const i=WH.getPageData("di.playerClass.names")||{};const n={[this.BARBARIAN]:"barbarian",[this.BLOOD_KNIGHT]:"blood-knight",[this.CRUSADER]:"crusader",[this.DEMON_HUNTER]:"demon-hunter",[this.MONK]:"monk",[this.NECROMANCER]:"necromancer",[this.TEMPEST]:"tempest",[this.WIZARD]:"wizard"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getByIdString=function(e){for(let t in a){if(a[t]===e){return parseInt(t)}}return undefined};this.getBySlug=function(e){for(let t in n){if(n[t]===e){return parseInt(t)}}return undefined};this.getIdString=function(e){return a[e]};this.getName=function(e){return i[e]||null};this.getSlug=function(e){return n[e]}};WH.DI.EquipItem.DropRank=new function(){const e=this;this.NORMAL=1;this.MAGIC=2;this.RARE=3;this.LEGENDARY=4;this.SET=5;const t=[this.NORMAL,this.MAGIC,this.RARE,this.LEGENDARY,this.SET];const a=WH.getPageData("di.equipItem.dropRank.names")||{};const i={[this.NORMAL]:"normal",[this.MAGIC]:"magic",[this.RARE]:"rare",[this.LEGENDARY]:"legendary",[this.SET]:"set"};this.getAll=function(){return t.slice()};this.getName=function(e){return a[e]||null};this.getSlug=function(e){return i[e]}};WH.DI.EquipItem.Position=new function(){const e=this;this.AMULET=6;this.BRACELET=17;this.BRACELET2=18;this.CHEST=5;this.FEET=11;this.HANDS=4;this.HEAD=1;this.LEGS=13;this.MAIN_HAND=10;this.MAIN_HAND2=19;this.NECK=3;this.OFF_HAND=12;this.OFF_HAND2=20;this.RING=7;this.RING2=9;this.SHOULDER=2;this.TALISMAN=14;this.WAIST=8;const t=[this.AMULET,this.BRACELET,this.BRACELET2,this.CHEST,this.FEET,this.HANDS,this.HEAD,this.LEGS,this.MAIN_HAND,this.MAIN_HAND2,this.NECK,this.OFF_HAND,this.OFF_HAND2,this.RING,this.RING2,this.SHOULDER,this.TALISMAN,this.WAIST];const a=WH.getPageData("di.equipItem.position.names")||{};const i={[this.AMULET]:"amulet",[this.BRACELET]:"bracelet",[this.BRACELET2]:"bracelet2",[this.CHEST]:"chest",[this.FEET]:"feet",[this.HANDS]:"hands",[this.HEAD]:"head",[this.LEGS]:"legs",[this.MAIN_HAND]:"main-hand",[this.MAIN_HAND2]:"main-hand2",[this.NECK]:"neck",[this.OFF_HAND]:"off-hand",[this.OFF_HAND2]:"off-hand2",[this.RING]:"ring",[this.RING2]:"ring2",[this.SHOULDER]:"shoulder",[this.TALISMAN]:"talisman",[this.WAIST]:"waist"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getName=function(e){return a[e]};this.getSlug=function(e){return i[e]}};WH.stub("DI.Skill");WH.DI.Skill.Type=new function(){this.NORMAL=1;this.ACTIVE=2;this.POTION=3;this.TORCH=4;this.ON_BORN=5};WH.Layout.DataTreeSwitcher=new function(){const e=WH.Game;const t=WH.Layout;const a=WH.Responsive;const i=WH.Tooltips;const n=WH.Url;const s=[WH.dataTree.TBC,WH.dataTree.WRATH,WH.dataTree.CATA];const r={elements:{container:undefined}};this.checkEnvDimensions=()=>{WH.qsa(".data-env-links-group .data-env-link").forEach((e=>{let t=getComputedStyle(e);let a=parseFloat(t.height);let i=parseFloat(t.width);e.dataset.equalDimensions=JSON.stringify(i/a<1.06)}))};this.init=()=>{let t=e.get();r.elements.container=WH.ge("data-tree-switcher");let i=n.atRootHome();let s=WH.ce("a",{ariaLabel:WH.TERMS.allNews,className:"fa fa-home",dataset:{current:`${i}`,simpleTooltip:WH.ce("span",{className:i?"q":"q2"},WH.ct(WH.TERMS.allNews)).outerHTML,tooltipMode:"attach"}});if(!i){s.href="/"}WH.ae(r.elements.container,WH.ce("div",{dataset:{current:`${i}`,game:"wow"}},s));let o=[];e.getAll().forEach((a=>{if(e.isUnderstated(a)&&a!==t){e.getDataTrees(a).forEach((e=>o.push(e)))}else{c(a,i)}}));if(o.length){WH.ae(r.elements.container,WH.ce("div",{dataset:{game:"none"}},l(o,WH.TERMS.moreGames)))}a.adjustByScrollSize(r.elements.container,(()=>r.elements.container.dataset.text="short"),(()=>r.elements.container.dataset.text="long"))};function o(e,a){let i=!a&&e===WH.getDataTree()&&!t.useAlternateSwitcherPathCommand(WH.dataTreeToRoot[e],n.removePathPrefixes(location.pathname));let s=WH.ce("a",{dataset:{current:JSON.stringify(i),tree:WH.getDataTreeKey(e)}},[WH.ce("img",{alt:WH.TERMS[WH.getDataTreeTerm(e)]}),WH.ct(WH.TERMS[WH.getDataTreeShortTerm(e)])]);if(i){WH.preventSelectStart(s)}else{u(s,e)}return s}function l(e,a){let n=[Menu.createHeading({label:a})];e.forEach((e=>{n.push(Menu.createItem({label:WH.TERMS[WH.getDataTreeTerm(e)],options:{regenerateMenuItem:a=>{Menu.setItemUrl(a,t.getEnvSwitcherUrl(WH.dataTreeToRoot[e]));return a}}}))}));let s=WH.ce("a",{ariaLabel:a,className:"data-tree-switcher-ellipsis",href:"javascript:",innerHTML:"&middot;&middot;&middot;"});i.attach(s,a);Menu.add(s,n,{onShow:()=>i.hide(),showAtElement:true});return s}function c(t,a){if(!e.hasAccess(t)){return}let i=WH.getDataTree();let n=e.getDataTrees(t);let c=e.getAbbrev(t);let d=e.getName(t);let f={dataset:{text:"long"}};if(n.length>1){f.dataset.disabled="true"}let h=WH.ce("div",{dataset:{game:e.getKey(t)}});if(n.length===1&&e.get()===t){f.dataset.disabled="true";h.dataset.current="true"}let p=WH.ce("a",f,[WH.ce("img",{alt:d}),WH.ct(t===e.WOW?c:d)]);u(p,n[0]);WH.ae(h,p);f.dataset.text="short";let m=WH.ce("a",f,[WH.ce("img",{alt:d}),WH.ct(c)]);u(m,n[0]);WH.ae(h,m);if(n.length>1){let e=WH.ce("div",{className:"data-trees"});let t=[];n.forEach((n=>{if(s.includes(n)&&n!==i){t.push(n)}else{WH.ae(e,o(n,a))}}));if(t.length){let a=l(t,WH.TERMS.moreWowVersions);a.dataset.tree="none";WH.ae(e,a)}WH.ae(h,e)}WH.ae(r.elements.container,h)}function u(e,a){let i=WH.dataTreeToRoot[a];WH.aE(e,"click",t.updateDataEnvLink.bind(e,e,i));WH.aE(e,"mouseover",t.updateDataEnvLink.bind(e,e,i));t.updateDataEnvLink(e,i)}};WH.Layout.FilledPageMode=new function(){const e=WH.Layout;const t={enabled:false,headerBottomListenerAdded:false};this.disable=()=>{t.enabled=false;e.setForcedFullscreenMode(false);document.body.dataset.filledPageMode="false";WH.qs(".main-contents").style.top=null};this.enable=()=>{t.enabled=true;e.setForcedFullscreenMode(true);scrollTo(0,0);document.body.dataset.filledPageMode="true";if(!t.headerBottomListenerAdded){e.onHeaderBottomMove((e=>{if(t.enabled){WH.qs(".main-contents").style.top=`${e}px`}}));t.headerBottomListenerAdded=true}}};WH.Layout.Footer=new function(){const e=[{platformName:"discord",href:"https://discord.gg/wowhead"},{platformName:"bluesky",href:"https://bsky.app/profile/wowhead.com"},{platformName:"facebook",href:"https://www.facebook.com/Wowhead"},{platformName:"youtube",href:"https://www.youtube.com/user/Wowhead"},{platformName:"rss",href:"/news/rss/all"},{platformName:"vk",href:"https://vk.com/wowheadrussia"}];this.init=function(e){WH.Page.init();o();r();l();c();WH.setupFooterMenus();Menu.add(WH.qs(".footer-utility-social-links .fa-rss"),e)};function t(e,t){Menu.onLoad((()=>{if(Menu.hasSubmenuContent(e)){Menu.add(t,Menu.getSubmenu(e))}}))}function a(e,a){let i=WH.ce("li");let n=WH.ce("a",{href:Menu.getItemUrl(e)||"javascript:",dataset:{disableWowheadTooltip:"true"}},WH.ct(Menu.getLabel(e)));t(e,n);WH.ae(i,n);WH.ae(a,i)}function i(e){Menu.getMenu("footer").forEach((a=>{if((Menu.getItemUrl(a)||"").match(/\/random$/)&&!WH.Game.supportsRandomPages(WH.Game.get())){return}let i=WH.ce("a",{dataset:{disableWowheadTooltip:"true"}},WH.ct(Menu.getLabel(a)));let n=Menu.getItemOptions(a);if(n.className){i.className=n.className}if(Menu.getItemCrumb(a)==="advertise"){i.href="/advertising";WH.aE(i,"click",(()=>WH.Track.linkClick(i,{category:"Footer Links",label:"Advertise"})))}else{i.href=Menu.getItemUrl(a)||"javascript:"}t(a,i);let s=WH.ce("li",{className:"footer-list-item"});WH.ae(s,i);WH.ae(e,s)}))}function n(){const t=WH.ce("div",{className:"footer-utility-social-links"});const a=Locale.getId()!==LOCALE_RURU?e.filter((e=>e.platformName!=="vk")):e;WH.React.initComponent(t,"modules/universal/SocialMediaButton/SocialGroup",{socialButtons:a,size:"small"});return t}function s(){let e=WH.ce("img",{alt:"",src:`${WH.STATIC_URL}/images/logos/wh-logo-thumbnail.png`});let t=WH.ce("a",{ariaLabel:WH.TERMS.homepage_short,href:WH.Url.generatePath("/")},e);let a=WH.ce("li",{className:"footer-utility-logo"},t);let n=WH.ce("ul",{className:"footer-utility-site-links"},a);i(n);return n}function r(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-content-links"});let a=WH.ce("section",{className:"footer-content"});Menu.getMenu("footerLinks").forEach((e=>{let a=WH.ae(t,WH.ce("ul",{className:"footer-list"}));let i=WH.ce("li",{className:"footer-list-item-heading"});let n=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));n.dataset.disableWowheadTooltip="true";WH.ae(i,n);WH.ae(a,i);Menu.onLoad((()=>{if(!Menu.hasSubmenuContent(e)){return}Menu.getSubmenu(e).forEach((e=>{let t=WH.ce("li",{className:"footer-list-item"});let i=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));i.dataset.disableWowheadTooltip="true";WH.ae(t,i);WH.ae(a,t)}))}))}));WH.ae(a,t);WH.ae(e,a)}function o(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-navigation"});let i=WH.ce("section",{className:"footer-navigation-bar"});let n=WH.ce("ul",{className:"footer-navigation-bar-links"});let s=WH.ce("ul",{className:"footer-navigation-bar-links"});let r=Menu.getMenu().filter((e=>{let t=Menu.getItemOptions(e);return!t.breadcrumbOnly}));r.slice(0,r.length/2).forEach((e=>{a(e,n)}));r.slice(r.length/2,r.length).forEach((e=>{a(e,s)}));let o=WH.ce("section",{className:"footer-navigation-bar-logo"});let l=WH.ce("section",{className:"footer-navigation-bar-logo-link"});let c=WH.ce("a",{ariaLabel:WH.TERMS.homepage_short,href:WH.Url.generatePath("/")});WH.ae(c,l);WH.ae(o,c);WH.ae(i,n);WH.ae(i,o);WH.ae(i,s);WH.ae(t,i);WH.ae(e,t);let u=()=>{let e=[0,1,2,4];let t=window.innerWidth;let a=t>=1366?e[3]:t>=768?e[2]:e[0];i.dataset.columns=a.toString();let n=17;let s=WH.qs(".footer-navigation-bar-links li a");if(s){n=Math.ceil(parseFloat(getComputedStyle(s).lineHeight))}let r=a===4?"ul":"li";for(let t of WH.qsa(r,i)){if(t.clientHeight>n){i.dataset.columns=(e.indexOf(a)-1).toString();break}}};u();WH.aE(window,"resize",u)}function l(){const e=WH.qs(".footer-content");const t=WH.ce("div",{className:"footer-button-outer"});const a=new WH.Button({"aria-label":WH.TERMS.topOfPage_short,clickHandler:()=>scroll({top:0,behavior:"smooth"}),"data-variation":WH.getDataTreeKey(),iconConfig:{faIcon:{prefix:"fas",name:"angles-up"}},label:WH.TERMS.topOfPage_short,style:`hybrid`});WH.ae(t,a.getElement());WH.ae(e,t)}function c(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-utility-bar"});let a=WH.ce("section",{className:"footer-utility"});let i=s();let r=n();WH.ae(t,i);WH.ae(t,r);WH.ae(a,t);WH.ae(e,a)}};WH.Layout.Responsive=new function(){const e=this;const t=WH.DOM;const a=WH.DynamicFixedElement;const i=WH.Layout;const n=WH.Responsive;this.HEADER_RESIZE_MS=150;const s={"xl-desktop":n.BREAKPOINT_XL_DESKTOP,"lg-desktop":n.BREAKPOINT_LG_DESKTOP,"sm-desktop":n.BREAKPOINT_SM_DESKTOP,tablet:n.BREAKPOINT_TABLET};const r=247;const o=85;const l=r-o;const c="header-nav-collapsed";const u="compact";const d="standard";const f=2;const h=280;const p={"right-rail":n.BREAKPOINT_RIGHT_RAIL,"no-rails":n.BREAKPOINT_NO_RAILS,"no-billboard":n.BREAKPOINT_NO_BILLBOARD};const m=2;const H={elements:{collapsibleNavLinks:undefined,firstMenuItem:undefined,header:undefined,headerNav:undefined,headerNavEllipsis:undefined,headerNavFeatures:undefined,headerNavFeaturesEllipsis:undefined,headerNavFeaturesLinks:undefined,headerNavLinks:undefined,headerNavWrapper:undefined,headerUser:undefined,headerWrapper:undefined,layoutWrapper:undefined,logo:undefined,search:undefined,themeSwitcher:undefined,utilityButtons:undefined},featuredNavCompact:undefined,featuredNavCompactHiddenViewportWidths:[0,0],featuredNavOverflowMenu:[],hiddenHeader:undefined,initialized:false,logoShrinkViewportWidth:0,collapsibleNavLinkCount:undefined,maxMobileNavigationWidth:767,mobileMode:false,navOverflowLastNavState:undefined,navOverflowLastResponsiveStep:{compact:0,standard:0},navOverflowLastViewportWidth:{compact:0,standard:0},navOverflowMenu:[],resizeCallbacks:[],responsiveNavStep:{compact:0,standard:0},responsiveNavStepWidths:{compact:[0,0],standard:[0,0]},shrinkHeader:false,updateSearchWidth:false};this.check=function(e){if(!H.initialized){return H.mobileMode}let t=H.mobileMode;if(C()){i.disableLayoutAnimation();q(!H.mobileMode);ZUL.setEnabled(H.mobileMode);if(!H.mobileMode&&C()){q(!H.mobileMode);ZUL.setEnabled(H.mobileMode)}setTimeout((function(){requestAnimationFrame(i.enableLayoutAnimation)}),10)}if(!H.mobileMode){P()}if(e===true||e!==false&&t&&!H.mobileMode){H.updateSearchWidth=true;w();N()}if(H.updateSearchWidth){requestAnimationFrame(i.updateSearchWidth.bind(i,false));H.updateSearchWidth=false}return H.mobileMode};this.init=function(t){H.initialized=true;if(!t){return}H.elements.collapsibleNavLinks=t.collapsibleNavLinks;H.elements.header=t.header;H.elements.headerNav=t.nav;H.elements.headerNavEllipsis=t.navEllipsis;H.elements.headerNavFeatures=t.featuredNav;H.elements.headerNavFeaturesEllipsis=t.featuredEllipsis;H.elements.headerNavFeaturesLinks=t.featuredLinks;H.elements.headerNavLinks=t.navLinks;H.elements.headerNavWrapper=t.navWrapper;H.elements.headerUser=WH.qs(".header-user");H.elements.headerWrapper=t.headerWrapper;H.elements.layoutWrapper=WH.qs(".layout-wrapper");H.elements.search=WH.qs("form",i.getElement("header-search"));H.elements.utilityButtons=WH.ae(H.elements.headerNavWrapper,WH.Layout.User.getUtilityButtons());H.collapsibleNavLinkCount=H.elements.collapsibleNavLinks.length;WH.onMutate(document.body,w,{characterData:false,subtree:false});WH.onMutate(H.elements.headerUser,F.bind(e,true));WH.aE(window,"scroll",w);WH.aE(window,"resize",N);if(document.fonts){document.fonts.load("14px Open Sans").then(N)}WH.DOM.bindBreakpoints(document.body,s,true);WH.DOM.bindBreakpoints(document.body,p,false,"rails");e.check(true)};this.updateHeaderOffset=function(){let e;if(H.elements.header){if(!ZUL.getEnabled()){let e=10;if(!i.getFullscreenMode()){e+=H.elements.headerWrapper.getBoundingClientRect().height;if(t.isVisible(H.elements.headerNavFeatures)){e-=H.elements.headerNavFeatures.getBoundingClientRect().height}}document.documentElement.style.scrollPaddingTop=e+"px"}else{document.documentElement.style.scrollPaddingTop=null}}};function g(e,t,a,i){for(let n=e;n<H.collapsibleNavLinkCount;n++){let s=H.elements.collapsibleNavLinks[n];if(y(t,a,i)){s.classList.add(c);e++;H.navOverflowMenu.push(s.menuItem);if(a===s){break}}else{s.classList.remove(c)}}return e}function W(e){H.mobileMode=true;let t=e+m;if(t>H.maxMobileNavigationWidth){H.maxMobileNavigationWidth=t}}function E(){if(H.elements.headerNavEllipsis&&!H.elements.headerNavEllipsis.classList.contains(c)){return H.elements.headerNavEllipsis}let e=H.elements.headerNavLinks||WH.qsa(".header-nav a");for(let t=e.length-1;t>=0;t--){if(!e[t].classList.contains(c)){return e[t]}}return undefined}function _(e,t){let a=e.getBoundingClientRect();let i=getComputedStyle(e).getPropertyValue("padding-right");let n=a.right-parseInt(i||0)-2;let s=n-(t.originalWidth||56);return{rect:a,right:n,rightWithEllipsis:s}}function T(){return H.featuredNavCompact?u:d}function v(){b(H.elements.headerNavFeaturesLinks,H.elements.headerNavFeaturesEllipsis,H.featuredNavOverflowMenu);v=function(){}}function S(){b(H.elements.headerNavLinks,H.elements.headerNavEllipsis,H.navOverflowMenu);S=function(){}}function b(e,t,a){for(let t=0,a=e.length;t<a;t++){e[t].originalWidth=e[t].getBoundingClientRect().width}t.originalWidth=t.getBoundingClientRect().width;Menu.add(t,a)}function y(e,t,a){let i=t.getBoundingClientRect();if(i.top!==e.rect.top){return true}return i.left+t.originalWidth>(a?e.right:e.rightWithEllipsis)}function I(e){if(H.elements.headerNavFeaturesLinks&&!H.featuredNavCompact){let e=H.elements.headerNavFeaturesLinks[0];let t=H.elements.headerNavFeaturesLinks[H.elements.headerNavFeaturesLinks.length-1];if(e&&t&&e.getBoundingClientRect().top!==t.getBoundingClientRect().top){return true}}return false}function A(e){let t=T();F();let a=0;for(let i=1;i<=f;i++){if(e<=(H.responsiveNavStepWidths[t][i-1]||0)){a=i}}if(a!==H.responsiveNavStep[t]){M(t,a);H.updateSearchWidth=true}let i=E();if(i&&!(H.featuredNavCompact&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true")){let a=H.responsiveNavStep[t];let n=H.elements.headerNav.getBoundingClientRect().top;let s=L(t,n,i,a);if(typeof s==="number"){if(e>H.responsiveNavStepWidths[t][s-1]){H.responsiveNavStepWidths[t][s-1]=e}if(s!==a){H.updateSearchWidth=true}}else{return true}}return false}function R(e){if(!WH.qs("input",H.elements.search)){return false}let t=H.elements.search.offsetWidth;if(t+1>=e){i.updateSearchWidth(false);t=H.elements.search.offsetWidth}let a=H.elements.header.dataset.logo==="small"?t:t+l;return a<h}function N(){if(H.mobileMode){return}WH.WAS.updateSkinMode()}function w(){if(H.mobileMode){return}let e=H.elements.layoutWrapper?.offsetTop;let t=window.scrollY;if(WH.WAS&&WH.WAS.isFlexSkinned()){t+=100}x(t,e);Y(t,e)}function C(){let e=H.mobileMode;let t=window.innerWidth;H.mobileMode=t<=H.maxMobileNavigationWidth;if(!H.mobileMode){if(A(t)||H.elements.search&&R(t)||I(t)){W(t)}}U(t);return H.mobileMode!==e}function M(e,t){if(H.responsiveNavStep[e]===t){return}H.responsiveNavStep[e]=t;document.body.dataset.responsiveNavStep=""+t}function O(e,t,a){let i=e.getBoundingClientRect();if(t.left!==i.left||t.top!==i.top||a&&e.classList.contains(c)){Menu.hide(true)}}function L(e,t,a,i){if(a.getBoundingClientRect().top!==t){let n=i+1;if(n>f){return null}M(e,n);return L(e,t,a,n)}return i}function D(){if(H.navOverflowMenu.length===0){H.elements.headerNavEllipsis.classList.add(c)}else{H.elements.headerNavEllipsis.classList.remove(c);H.navOverflowMenu.reverse()}if(H.featuredNavOverflowMenu.length===0){H.elements.headerNavFeaturesEllipsis.classList.add(c)}else{H.elements.headerNavFeaturesEllipsis.classList.remove(c)}}function k(e,t){if(H.mobileMode||!H.featuredNavCompact||H.featuredNavOverflowMenu.length!==H.elements.headerNavFeaturesLinks.length&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true"){return}let a=H.responsiveNavStep[T()]-1;let i=e<=H.featuredNavCompactHiddenViewportWidths[a];if(!i){let t=H.elements.headerNavFeaturesEllipsis.getBoundingClientRect();let n=H.elements.headerNavFeatures.getBoundingClientRect();if(t.width>n.width||t.top!==n.top){H.featuredNavCompactHiddenViewportWidths[a]=e;i=true}}if(t!==true||t===true&&i){document.body.dataset.hideFeaturedNavWhileScrolling=JSON.stringify(i)}if(t!==true&&!i){k(e,true)}}function P(){if(H.mobileMode||!H.elements.headerNavFeaturesLinks||H.featuredNavCompact){return}H.elements.headerNavFeaturesLinks.forEach((e=>{if(!e.origTextWidth){let t=WH.qs("span",e);t.style.display="table-cell";e.origTextWidth=t.scrollWidth;t.style.display=null}e.dataset.restrictTextWidth=JSON.stringify(e.offsetWidth+10<e.origTextWidth)}))}function x(e,t){if(t!=null){document.body.dataset.fixedHeader=JSON.stringify(e>=t)}let a=i.getFullscreenMode()&&e>=(t||0)+70;if(H.hiddenHeader!==a){H.hiddenHeader=a;document.body.dataset.hideHeader=JSON.stringify(H.hiddenHeader);const e=WH.qs("input",H.elements.search);if(e){e.blur()}}}function U(e){if(H.mobileMode||!H.elements.header){return}let t=H.elements.header.dataset.logo==="small";let a=e<H.logoShrinkViewportWidth;if(!a){let e=t?H.elements.search.offsetWidth-l:H.elements.search.offsetWidth;a=e<h}if(a){if(!t){if(e>=H.logoShrinkViewportWidth){H.logoShrinkViewportWidth=e}H.elements.header.dataset.logo="small"}}else{if(t){delete H.elements.header.dataset.logo}}}function F(e){if(H.mobileMode||!H.elements.headerNav){return}let t=window.innerWidth;let a=T();if(H.navOverflowLastNavState===a&&H.navOverflowLastResponsiveStep[a]===H.responsiveNavStep[a]&&H.navOverflowLastViewportWidth[a]===t&&e!==true){return}H.navOverflowLastNavState=a;H.navOverflowLastResponsiveStep[a]=H.responsiveNavStep[a];H.navOverflowLastViewportWidth[a]=t;let i=0;if(H.featuredNavCompact){v();for(let e=0,t=H.elements.collapsibleNavLinks.length;e<t;e++){H.elements.collapsibleNavLinks[e].classList.remove(c)}H.navOverflowMenu.length=0;H.featuredNavOverflowMenu.length=0;let e=_(H.elements.headerNavFeatures,H.elements.headerNavFeaturesEllipsis);let a=false;for(let t=0,n=H.elements.headerNavFeaturesLinks.length;t<n;t++){let s=H.elements.headerNavFeaturesLinks[t];if(!a){let r=t===n-1;i=g(i,e,s,r);a=y(e,s,r)}if(a){s.classList.add(c);H.featuredNavOverflowMenu.push(s.menuItem)}else{s.classList.remove(c)}}D();k(t)}else{S();H.navOverflowMenu.length=0;let e=_(H.elements.headerNav,H.elements.headerNavEllipsis);for(let t=0,a=H.elements.headerNavLinks.length;t<a;t++){let n=H.elements.headerNavLinks[t];if(i<H.collapsibleNavLinkCount&&!n.classList.contains(c)){i=g(i,e,n,t===a-1)}}D()}}function q(e){if(!e){document.body.classList.add("no-header")}else{document.body.classList.remove("no-header")}}function Y(t,n){n=n||0;let s=i.getFullscreenMode();if(!s&&WH.WAS){s=WH.WAS.isFlexSkinned()}let r=s||t>=n+70;let o=H.shrinkHeader!==r;if(!o){return}let l=Menu.getOpener();let c;if(l&&WH.closest(l,".header-wrapper")){c=l.getBoundingClientRect()}H.shrinkHeader=r;H.featuredNavCompact=r;document.body.dataset.shrinkHeader=s?"default":r?"scrolling":"false";document.body.dataset.navLayout=T();!H.mobileMode&&B();F();if(H.featuredNavCompact){requestAnimationFrame(F.bind(e,true))}if(c){O(l,c,r)}a.checkAll();e.check();if(o&&H.resizeCallbacks.length){H.resizeCallbacks.forEach((e=>e()))}}function B(){const e=H.elements.utilityButtons;const t=H.elements.headerNavWrapper.getBoundingClientRect();if(H.featuredNavCompact){H.elements.headerNavWrapper.style.paddingRight="";H.elements.headerNav.style.paddingRight=""}else{H.elements.headerNav.style.paddingRight=t.right-e.getBoundingClientRect().left+10+"px";H.elements.headerNavWrapper.style.paddingRight=""}}};WH.Layout.User=new function(){const e=this;const t=WH.Layout;const a=WH.Url;const i={defaultButtonConfig:Object.seal({"data-variation":WH.getDataTreeKey(),size:"small",style:"transparent"}),elements:Object.seal({loggedInUserButtons:undefined,utilityButtons:undefined}),userMenu:undefined};this.createDebugQueueElement=function(){if(!i.elements.loggedInUserButtons){WH.error("Cannot create debug queue element, #user-logged-in-buttons not found.");return null}const e=new WH.Button({...i.defaultButtonConfig,iconConfig:{faIcon:{prefix:"fas",name:"triangle-exclamation"}},id:"header-favorites-button",label:""});WH.aef(i.elements.loggedInUserButtons,e.getElement());return e};this.getLocaleMenu=function(){let e=location.pathname+location.search+location.hash;e=WH.Url.removePathPrefixes(e);let t=Locale.getId();let a=[Menu.createHeading({label:WH.TERMS.language})];let i=WH.getPageData("layout.user.preferredLanguageTips")||{};let n=function(e,a,n){if(!i.hasOwnProperty(e)){return}let s=Locale.getName(a);let r="";if(n){r=WH.TERMS[WH.getDataEnvTerm()]}else{r=WH.GlobalStrings["LFG_LIST_LANGUAGE_"+s.toUpperCase()]||Locale.getDescription(a)}let o=[WH.Strings.sprintf(i[e][t],r)];if(a!==t){o.push(WH.Strings.sprintf(i[e][a],n?i[WH.getDataEnvTerm()][a]:Locale.getDescription(a)))}return o.map(WH.Strings.escapeHtml).join("<br>")};let s=function(e){let t=e[Menu.ITEM_CRUMB];if(Locale.getPreferred()===t){return n("preferredLanguageRemove_format",t,false)}if(e[Menu.ITEM_URL]){return n("preferredLanguageUse_format",t,false)}return n("preferredLanguageSet_format",t,false)};let r=function(e){let t=e[Menu.ITEM_CRUMB];let a=Menu.getItemOptions(e).extraActions[0];a.fontIcon=Locale.getPreferred()===t?"star":"star-o"};$.each(Locale.getAllByName(),(function(i,o){let l=WH.Url.generate(e,{locale:o.id});if(l===location.href){l=undefined}let c=Menu.createItem({crumb:o.id,label:o.description,url:l,options:{checkedFunc:function(){return o.id===t},extraActions:[{fontIcon:"star-o","data-preferred-locale":o.id,callback:function(e){if(Locale.getPreferred()===o.id){Locale.setPreferred(null)}else{Locale.setPreferred(o.id);if(l&&o.id!==t){location.href=l}}WH.qsa(".menu-item [data-preferred-locale]").forEach((function(e){let t=parseInt(e.dataset.preferredLocale);let i=Menu.findItem(a,[t]);r(i);let n=Menu.getItemOptions(i).extraActions[0];e.classList.remove("fa-star","fa-star-o");e.classList.add("fa-"+n.fontIcon)}));let i=Menu.findItem(a,[o.id]);let n=s(i);if(n){WH.Tooltips.show(e.target,n,"q2")}}}],onBeforeShow:r}});let u=Menu.getItemOptions(c);u.extraActions[0].tooltipText=s.bind(null,c);if(!l&&t!==o.id){u.className="q10";let e=n("languageNotAvailable_format",o.id,true);if(e){u.attributes={"data-simple-tooltip":WH.ce("span",{className:"q10",innerHTML:e}).outerHTML}}}a.push(c)}));return a};this.getProfilerMenu=function(){if(!g_user.lists){return null}var e=[];var t=[["refresh",WH.TERMS.refreshcharacterlist,"/battle-net/start",null,{icon:WH.staticUrl+"/images/icons/battlenet.png"}]];var a=[],i=[],n=[],s=[],r=[];g_user.lists.sort((function(e,t){return t.pinned-e.pinned||(WH.stringCompare(e.realm,t.realm)||WH.stringCompare(e.name,t.name))}));let o=null;const l=g_user.lists.slice();l.sort(((e,t)=>(e.region??"ZZ").localeCompare(t.region??"ZZ")||(e.realm??"ZZ").localeCompare(t.realm??"ZZ")||e.name.localeCompare(t.name)||e.id-t.id));const c=l.find((e=>e.region))?.region;const u=l.some((e=>e.region!==c));$.each(l,(function(e,t){if(t.mode==1){if(WH.Profiler.isMain(t.pinned)){a.push(WH.Profiler.getMenuItem(t,true))}if(WH.Profiler.isPinned(t.pinned)){i.push(WH.Profiler.getMenuItem(t,true))}if(o!==t.realmId){n.push([undefined,u?`${t.region} ${t.realm}`:t.realm])}o=t.realmId;n.push(WH.Profiler.getMenuItem(t))}else{r.push(WH.Profiler.getMenuItem(t))}}));var d=0,f,h,p;var m=function(e,t){var a=0+t;return function(t){if(t){return}for(var i=0;i<e.length;i++){if(e[i][0]==a){e.splice(i--,1)}}}};if(g_user.battlenetChars&&g_user.battlenetChars.length){g_user.battlenetChars.sort((function(e,t){return WH.stringCompare(e.region,t.region)||WH.stringCompare(e.realm,t.realm)||WH.stringCompare(e.name,t.name)}));o=false;for(var H=0;H<g_user.battlenetChars.length;H++){h=g_user.battlenetChars[H];if(h.level<10){continue}f=WH.Strings.slug(h.region+" "+h.realm+" "+h.name,true);p=false;for(var g=0;g<g_user.lists.length;g++){if(g_user.lists[g].url==f){p=true;break}}if(p){continue}if(o&&o!=h.realm){if(s.length){s.unshift([undefined,o])}s.push([undefined,h.realm])}o=h.realm;d--;s.push([d,h.name,"/list/"+f+"?private",null,{className:"listmanager-mode1"}]);WH.BlizzardApi.characterExists(h.region,h.realm,h.name,m(s,d))}}var W=0;if(n.length)W++;if(s.length)W++;if(r.length)W++;const E=Menu.createItem({crumb:0,label:WH.term("parens_format",WH.TERMS.updateAll_stc,n.filter((e=>e[0])).length),url:e=>{WH.Tooltips.showFadingTooltipAtCursor(WH.TERMS.queueingUpdates_tip,e);WH.Profiler.resyncAll((()=>{}))},options:{icon:WH.STATIC_URL+"/images/icons/battlenet.png"}});if(n.length+s.length+r.length<=12||W<=1){if(n.length){e.push([undefined,WH.TERMS.profiles]);e.push.apply(e,n);if(WH.User.isPremium()){e.push(E)}}if(s.length){e.push([undefined,WH.TERMS["import"]]);e.push.apply(e,t.concat(s))}if(r.length){e.push([undefined,WH.TERMS.customlists]);e.push.apply(e,r)}}else{if(a){e.push([undefined,WH.TERMS.mainCharacterLabel]);e.push.apply(e,a)}if(i.length){Menu.sort(i);e.push([undefined,WH.TERMS.pinnedprofiles]);e.push.apply(e,i);e.push([undefined,WH.TERMS.other])}if(n.length){if(WH.User.isPremium()){n.push(Menu.createSpacer());n.push(E)}e.push([1,WH.TERMS.profiles,null,n])}if(s.length){e.push([1,WH.TERMS["import"],null,t.concat(s)])}if(r.length){e.push([1,WH.TERMS.customlists,null,r])}}return e};this.getUserMenu=function(){if(i.userMenu){return i.userMenu}let e=[];let t=WH.Url.generatePath("/user="+g_user.name);let a=["user-page",WH.TERMS.userpage,t,null,{checkedUrl:new RegExp(WH.Strings.escapeRegExp(t)+"$","i"),fontIcon:"user"}];e.push(a);let n=WH.Url.generatePath("/account");let s=["settings",WH.TERMS.settings,n,null,{fontIcon:"cog",checkedUrl:new RegExp(WH.Strings.escapeRegExp(n)+"(?!=premium|/guides)")}];e.push(s);if(WH.Notifications.browserSupportsNotifications()){let t=WH.Url.generatePath("/notifications/settings");e.push(["notifications",WH.TERMS.notificationSettings,t,null,{fontIcon:"bell",checkedUrl:new RegExp(WH.Strings.escapeRegExp(t))}])}if(WH.User.isPremium()){let t=WH.Url.generatePath("/account/premium");e.push(["premium",WH.TERMS.premiumsettings,t,null,{checkedUrl:new RegExp(WH.Strings.escapeRegExp(t)),fontIcon:"star"}])}else{let t=WH.Url.generatePath("/premium");e.push(["premium-upgrade",WH.TERMS.premiumsettings,t,null,{className:"premium-upgrade",checkedFunc:()=>location.pathname===t,fontIcon:"star"}])}let c=WH.TERMS.reputation;if(g_user.reputation){c=WH.Strings.sprintf(WH.TERMS.parens_format,WH.TERMS.reputation,WH.Strings.formatNumber(g_user.reputation))}let u=["reputation",c,WH.Url.generatePath("/reputation"),null,{fontIcon:"trophy"}];e.push(u);let d=o();if(d){e.push(d)}let f=r();if(f){e.push(f)}let h=l();if(h){e.push(h)}e.push(["sign-out",WH.TERMS.signout,WH.Url.generatePath("/account/signout")]);e.push(["sign-out-global",WH.TERMS.logOutEverywhere,WH.Url.generatePath("/account/signout?global")]);i.userMenu=e;return e};this.getUtilityButtons=()=>i.elements.utilityButtons;this.init=function(){const a=WH.qs(".header");if(!a){return}const n=WH.ae(a,WH.ce("div",{className:"header-user"}));if(WH.User.isLoggedIn()){c(n)}else{u(n)}const r=e=>e.getDate()===1&&e.getMonth()===3;if(r(new Date)){let e;const t=new WH.Button({"data-variation":WH.getDataTreeKey(),clickHandler:()=>{if(!e){e=new WH.Confetti(a,t.getElement())}else{e.haveAParty()}},label:WH.TERMS.darkMode,size:"small",style:"primary"});WH.ae(n,t.getElement())}i.elements.utilityButtons=WH.ce("div",{className:"wh-button-group",id:"user-utility-buttons"});const o=new WH.Button({...i.defaultButtonConfig,"aria-label":s(),"data-simple-tooltip":WH.TERMS.fullscreen,"data-tooltip-mode":"attach",clickHandler:e=>{t.toggleFullscreenMode();e.target.ariaLabel=s()},iconConfig:{faIcon:{prefix:"fas",name:"expand"}}}).getElement();WH.ae(i.elements.utilityButtons,o);if(WH.Notifications.browserSupportsNotifications()){const e=new WH.Button({...i.defaultButtonConfig,"aria-label":WH.TERMS.notificationSettings,"data-simple-tooltip":WH.TERMS.notificationSettings,"data-tooltip-mode":"attach",href:WH.Url.generatePath("/notifications/settings"),iconConfig:{faIcon:{prefix:"fas",name:"bell"}}}).getElement();WH.ae(i.elements.utilityButtons,e)}const l=new WH.Button({...i.defaultButtonConfig,"aria-label":WH.TERMS.feedback,"data-simple-tooltip":WH.TERMS.feedback,"data-tooltip-mode":"attach",clickHandler:ContactTool.show.bind(ContactTool,undefined),iconConfig:{faIcon:{prefix:"fas",name:"envelope"}}}).getElement();WH.ae(i.elements.utilityButtons,l);const d=new WH.Button({...i.defaultButtonConfig,"aria-label":WH.TERMS.language,"data-simple-tooltip":WH.TERMS.language,"data-tooltip-mode":"attach",iconConfig:{faIcon:{prefix:"fas",name:"earth-americas"}}}).getElement();WH.ae(i.elements.utilityButtons,d);Menu.add(d,e.getLocaleMenu(),{padded:true})};function n(e,t,a,i,n){var s=WH.ce("a",{className:"header-user-"+t});if(a){WH.ae(s,WH.ce("span",undefined,WH.ct(a)));s.ariaLabel=n??a}else if(n){s.ariaLabel=n}s.href=i||"javascript:";WH.ae(e,s);return s}function s(){return t.getFullscreenMode()?WH.TERMS.exitFullscreenMode:WH.TERMS.enterFullscreenMode}function r(){let e=WH.getPageData("d4.build.myRecent");if(!e||!e.count){return}const t=WH.Game.getEnv(WH.Game.D4);let a=[];e.list.forEach((e=>{a.push(Menu.createItem({crumb:e.id,label:e.name,url:WH.Entity.getUrl(WH.Types.D4_BUILD,e.id,e.name,undefined,t)}))}));let i=WH.Url.generatePath("/account/builds",t);return Menu.createItem({crumb:"builds",label:WH.TERMS.myBuilds,url:i,submenu:a,options:{fontIcon:"book",checkedUrl:new RegExp(i)}})}function o(){let e=WH.getPageData("guide.myRecent");if(!e||!e.count){return}let t=[];e.list.forEach((function(e){let a={extraActions:[{fontIcon:"pencil",url:WH.Url.generate("guide/edit?id="+e.id,{dataEnv:e.dataEnv}),tooltipText:WH.TERMS.edit}]};if(!e["public"]){a.rel="np"}if(e.classId){a.className="c"+e.classId;if(e.specId){a.tinyIcon=WH.Wow.PlayerClass.Specialization.getIconName(e.specId)}else{a.tinyIcon=WH.Wow.PlayerClass.getIconName(e.classId)}}t.push(Menu.createItem({crumb:e.id,label:e.name,url:e.url,options:a}))}));let a=WH.Url.generatePath("/account/guides");return Menu.createItem({crumb:"guides",label:WH.TERMS.myguides,url:a,submenu:t,options:{fontIcon:"book",checkedUrl:new RegExp(a)}})}function l(){if(!g_user.lists||!g_user.lists.length){return null}var t={onBeforeShow:function(t){Menu.setSubmenu(t,e.getProfilerMenu())},zulGetMobileMenu:function(){return Menu.prepareForZul(e.getProfilerMenu())},zulHref:function(e,t,a,i){return a?false:"/user="+g_user.name},fontIcon:"users"};let a=WH.Profiler.getFavorite(false)??(g_user.lists||[]).reverse().find((e=>e.thumbnail));if(a){t.armory=WH.BlizzardApi.getCharacterThumbnailUrl(a.region,a.thumbnail)}return["lists",WH.TERMS.myprofiles,"/user="+g_user.name+"#lists",null,t]}function c(t){const a=i.elements.loggedInUserButtons=WH.ae(t,WH.ce("div",{className:"wh-button-group",id:"user-logged-in-buttons"}));const s=Menu.getMenu("staff");if(s){const e=new WH.Button({...i.defaultButtonConfig,"aria-label":WH.TERMS.staffemployees,"data-simple-tooltip":WH.TERMS.staffemployees,"data-tooltip-mode":"attach",iconConfig:{faIcon:{prefix:"fas",name:"gear"}}}).getElement();WH.ae(a,e);WH.FrequentPages.prependFrequentPages(s);Menu.add(e,s);Menu.getMenu().push([4,WH.TERMS.staffemployees,null,s,{breadcrumbOnly:true,onBreadcrumbDisplay:WH.FrequentPages.logBreadcrumb,zulHide:true}])}const r=new WH.Button({...i.defaultButtonConfig,"aria-label":WH.TERMS.favorites,"data-simple-tooltip":WH.TERMS.favorites,"data-tooltip-mode":"attach",iconConfig:{faIcon:{prefix:"fas",name:"star"}},id:"header-favorites-button"}).getElement();WH.ae(a,r);WH.Favorites.refreshMenu(r);var o=WH.Profiler.getFavorite(false);if(o){var l=WH.Profiler.getAvatarUrl(o);if(l){let a=n(t,"profile",undefined,WH.Profiler.getPath(o),WH.TERMS.characterprofiler+WH.TERMS.colon_punct+o.name);a.style.background=`url(${l})`;var c=e.getProfilerMenu();if(c&&c.length){Menu.add(a,c,{padded:true})}}}let u=WH.User.getUsername();let d=WH.User.getReputation();let f=n(t,"user",u,WH.User.getPath(),WH.sprintf(WH.TERMS.visitUserPage_format,u,WH.Strings.formatNumber(d)));if(d){WH.ae(f,WH.ce("span",{classList:"header-user-user-reputation"},WH.ct(WH.term("parens_format","",WH.Strings.formatNumber(d)))))}Menu.add(f,e.getUserMenu(),{padded:true})}function u(e){let t=WH.Url.getLoginPath();const i=WH.ae(e,WH.ce("div",{className:"wh-button-group"}));const n=WH.ae(e,WH.ce("div",{className:"wh-button-group",dataset:{position:"right"}}));const s=WH.ce("a",{className:"header-user-text",href:t},WH.ce("span",undefined,WH.ct(WH.TERMS.loginwith_colon)));WH.ae(i,s);let r=WH.Url.generatePath("/battle-net/start?r=1");const o=new WH.Button({ariaLabel:WH.TERMS.loginwith_colon+WH.TERMS.colon_punct+WH.TERMS.battlenet,clickHandler:()=>{WH.visitUrlWithPostData(WH.Url.generatePath("/battle-net/start"),{r:1});return false},href:r,iconConfig:{iconUrl:`${WH.STATIC_URL}/images/zul/icons/for-buttons/bnet-large.png`},label:WH.TERMS.battlenet,size:"small",style:"blizzard"});WH.ae(i,o.getElement());const l=new WH.Button({ariaLabel:WH.TERMS.loginwith_colon+WH.TERMS.email,"data-variation":WH.getDataTreeKey(),href:t,iconConfig:{faIcon:{prefix:"fas",name:"envelope"}},label:WH.TERMS.email,size:"small",style:"primary"});WH.ae(i,l.getElement());const c=new WH.Button({ariaLabel:WH.TERMS.register,"data-variation":WH.getDataTreeKey(),href:a.getRegistrationPath(),iconConfig:{faIcon:{prefix:"fas",name:"user-plus"}},label:WH.TERMS.register,size:"small",style:"primary"});WH.ae(n,c.getElement())}};Listview.Filters=function(e){const t=this;const a=WH.Device;const i=WH.DOM;const n="all";const s="any";const r=n;const o=[n,s];const l=1;const c=2;const u=3;const d=4;const f=5;const h=6;const p=7;const m={">":l,"=":c,"<":u,">=":d,"<=":f};const H={};H[l]=">";H[c]="=";H[u]="<";H[d]=">=";H[f]="<=";H[h]=WH.TERMS.min+"-"+WH.TERMS.max;H[p]=WH.TERMS.text;const g={};g["default"]=[{type:l,text:H[l]},{type:d,text:H[d]},{type:c,text:H[c]},{type:f,text:H[f]},{type:u,text:H[u]},{type:h,text:H[h]}];g[Listview.COLUMN_TYPE_TEXT]=[{type:p,text:H[p]},{type:l,text:H[l]},{type:d,text:H[d]},{type:c,text:H[c]},{type:f,text:H[f]},{type:u,text:H[u]},{type:h,text:H[h]}];const W={NUMBER:/(>|=|<|>=|<=)\s*(-?[0-9.]+)/,RANGE:/(-?[0-9.]+)\s*-\s*(-?[0-9.]+)/};const E=[Listview.COLUMN_ID_COMPLETION,Listview.COLUMN_ID_DEBUG_ID,Listview.COLUMN_ID_POPULARITY];const _={};_[l]=function(e,t){return t>e};_[c]=function(e,t){return t==e};_[u]=function(e,t){return t<e};_[d]=function(e,t){return t>=e};_[f]=function(e,t){return t<=e};_[h]=function(e,t){return e.min<=t&&t<=e.max};const T={};T[l]=function(e,t){return t.max>e};T[c]=function(e,t){return t.min<=e&&e<=t.max};T[u]=function(e,t){return t.min<e};T[d]=function(e,t){return t.max>=e};T[f]=function(e,t){return t.min<=e};T[h]=function(e,t){return e.min<=t.max&&t.min<=e.max};const v={elements:{columnFilters:undefined,container:undefined,match:{all:undefined,any:undefined,container:undefined},reset:undefined,tableFilter:undefined,tableFilterIcon:undefined,tableFilterClear:undefined},filters:[],hasFilterableColumns:false,listview:undefined,matchType:r};this.apply=function(){WH.Tooltips.hide();pe();t.applyDataOnly();he();v.listview.validatePage();v.listview.updateNav();v.listview.refreshRows();v.listview.updateBrowseSession();v.listview.writeHash()};this.focus=function(){re();if(v.listview.searchable&&v.elements.tableFilter){WH.safeFocus(v.elements.tableFilter)}};this.reset=function(){while(v.filters.length){let e=v.filters.pop();if(e.column){I(e.column)}}if(v.elements.columnFilters){WH.ee(v.elements.columnFilters)}if(v.elements.tableFilter){v.elements.tableFilter.value=""}v.matchType=r;if(v.elements.match[r]){v.elements.match[r].checked=true}v.listview.resetRowVisibility();t.apply()};this.resetAndFocus=function(){requestAnimationFrame(J)};this.applyDataOnly=function(){v.listview.resetRowVisibility(true);if(!v.filters.length&&!v.listview.customFilter&&!v.listview.classFilter){return}let e=[];let t=L();for(let a=0,i;i=t[v.listview.visibility[a]];a++){if(!E.includes(i.id)&&q(i)){e.push(i)}}let a=0;let i=v.matchType===s?ue:ce;for(let t=0,n=v.listview.data.length;t<n;t++){let n=v.listview.data[t];n.__hidden=true;if(v.listview.customFilter&&!v.listview.customFilter(n,t)){continue}if(v.listview.customFilter2&&!v.listview.customFilter2(n,t)){continue}if(v.listview.classFilter&&!v.listview.classFilter(n,t)){continue}if(n.__alwaysvisible||!v.filters.length||i(n,e)){n.__hidden=false;a++}}v.listview.filtered=a<v.listview.data.length;v.listview.nRowsVisible=a};this.getColumnTooltipAdditions=function(e){let t=v.filters.filter((function(t){return(t.column||{}).id===e.id}));if(!t.length){return null}t.sort((function(e,t){WH.stringCompare(e.invert,t.invert)}));let a=WH.ce("div","no-wrap");for(let e=0,i;i=t[e];e++){WH.ae(a,WH.ce("div",undefined,WH.ct((i.invert?WH.TERMS.invertedFilter_stc:WH.TERMS.filter)+WH.TERMS.colon_punct+U(i,true))))}return a};this.getHashParts=function(){let e=[];let t=[];let a=[];for(let e=0,i;i=v.filters[e];e++){if(!i.enabled){continue}let e=encodeURIComponent(U(i));if(i.column){a.push(i.column.id+"="+e)}else{t.push("q="+e)}}let i=t.length+a.length>1;if(t=t.join(Listview.HASH_DELIMITER)){e.push(t)}if(a=a.join(Listview.HASH_DELIMITER)){e.push(a)}if(i&&v.matchType!==r){e.push("match"+WH.ucfirst(v.matchType))}return e};this.getOptionsToggle=function(){if(v.listview.searchable||v.hasFilterableColumns){const e=new WH.Button({"aria-label":WH.TERMS.filterTheseResults_stc,"data-active":S(),"data-variation":WH.getDataTreeKey(),clickHandler:(e,t)=>{z(e);if(S()){t.dataset.active="true"}else{delete t.dataset.active}},iconConfig:{faIcon:{prefix:"fas",name:"filter"}},style:"secondary",size:"small"}).getElement();WH.Tooltips.attachNonTouch(e,x,"q2");return e}else{return null}};this.isColumnFiltered=function(e){for(let t=0,a;a=v.filters[t];t++){if(a.column.id===e.id&&a.enabled){return true}}return false};this.readHashPart=function(e){let t=e.match(/^q=(.*)$/);if(t){if(v.listview.searchable){ae(decodeURIComponent(t[1]),{skipApply:true})}return}e.split(",").forEach((function(e){let t=e.match(/^([A-Za-z0-9_]+)=(.+)$/);if(t){let e=decodeURIComponent(t[1]);let a=decodeURIComponent(t[2]);let i=L();for(let t=0,n;n=i[t];t++){if(n.id===e&&v.listview.isColumnVisible(n)&&q(n)){ae(a,{column:n,skipApply:true,allowDuplicateColumns:true});break}}return}let a=e.match(/^match([A-Za-z]+)$/);if(a){ne(a[1].toLowerCase(),true)}}))};function S(){return!!v.listview.container.dataset.filters}function b(){let e=WH.ce("div",{className:"listview-filters"});if(v.listview.searchable){let t=v.listview._truncated?WH.TERMS.searchwithindisplayedresults_ellipsis:WH.TERMS.searchAllColumns_ellipsis;let a=WH.ce("div",{className:"listview-filters-table"});if(v.listview.tabClick){WH.aE(a,"click",v.listview.tabClick)}v.elements.tableFilterIcon=WH.ce("span",{className:a.className+"-search-icon fa fa-search"});WH.ae(a,v.elements.tableFilterIcon);let i=WH.ce("input",{placeholder:t,style:{width:v.listview._truncated?"20em":"16em"},type:"text"});v.elements.tableFilter=i;for(let e=0,t;t=v.filters[e];e++){if(!t.column){i.value=t.invert+U(t);break}}WH.aE(i,"keyup",pe);WH.onAfterTyping(i,Z.bind(i),v.listview.searchDelay);WH.aE(i,"blur",(function(){if(this.value&&this.value.trim()===""){this.value=""}}));WH.aE(i,"keypress",v.listview.submitSearch.bind(this));WH.ae(a,i);v.elements.tableFilterClear=WH.ce("a",{className:a.className+"-clear fa fa-times-circle",href:"javascript:",style:{display:"none"}});WH.aE(v.elements.tableFilterClear,"click",(function(){i.value="";i.placeholder=t;Z.call(i)}));WH.ae(a,v.elements.tableFilterClear);WH.ae(e,a)}v.elements.columnFilters=WH.ce("div",{className:"listview-filters-columns"});WH.ae(e,v.elements.columnFilters);let t=WH.ce("div",{className:"listview-filters-actions"});WH.ae(e,t);let a=WH.ce("a",{className:"fa fa-plus",href:"javascript:"},WH.ct(WH.TERMS.addColumnFilter_ellipsis));Menu.add(a,w,{showAtElement:true});WH.ae(t,a);v.elements.match.container=WH.ce("div",undefined,WH.ct(WH.TERMS.match+WH.TERMS.colon_punct));WH.ae(t,v.elements.match.container);let i="listview-match-"+WH.Strings.guid();let r=WH.ce("label",undefined,WH.ct(WH.TERMS.all));v.elements.match.all=WH.ce("input",{name:i,type:"radio"});WH.aef(r,v.elements.match.all);WH.ae(v.elements.match.container,r);let o=WH.ce("label",undefined,WH.ct(WH.TERMS.any));v.elements.match.any=WH.ce("input",{name:i,type:"radio"});WH.aef(o,v.elements.match.any);WH.ae(v.elements.match.container,o);v.elements.match[v.matchType].checked=true;WH.aE(v.elements.match.all,"change",(function(){ne(n)}));WH.aE(v.elements.match.any,"change",(function(){ne(s)}));v.elements.reset=WH.ce("a",{className:"fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.reset));WH.aE(v.elements.reset,"click",J);WH.ae(t,v.elements.reset);return e}function y(e,a){e.enabled=false;if(!t.isColumnFiltered(e.column)){I(e.column)}if(a){e.elements.wrapper.dataset.showError="true";WH.st(e.elements.error,a)}else{delete e.elements.wrapper.dataset.showError}t.apply()}function I(e){if(e.__th){e.__th.firstChild.firstChild.classList.remove("q5")}}function A(e){if(e.__th){e.__th.firstChild.firstChild.classList.add("q5")}}function R(e){re();e.elements.text.focus()}function N(e,a){const n="listview-filters-columns-filter";let s=WH.ce("div",{className:n});let r=WH.ce("a",{className:n+"-remove",href:"javascript:"});WH.aE(r,"click",K.bind(r,s));WH.Tooltips.attachNonTouch(r,WH.TERMS.removefilter_stc,"q10");WH.ae(s,r);let o=i.createImitationSelect({text:C(e)});o.classList.add(n+"-name");Menu.add(o,w.bind(undefined,s,o),{showAtElement:true});WH.ae(s,o);let l=i.createImitationSelect({text:WH.TERMS.error});l.classList.add(n+"-operator");Menu.add(l,M.bind(undefined,s,l),{showAtElement:true});WH.ae(s,l);let c=WH.ce("div",{className:n+"-text-wrapper"});WH.ae(s,c);let u=WH.ce("input",{className:n+"-text",type:"text"});WH.onAfterTyping(u,B.bind(u,s,u),v.listview.searchDelay);WH.ae(c,u);let d=WH.ce("div",{className:n+"-range"},WH.ct("-"));WH.ae(c,d);let f=WH.ce("input",{className:n+"-text2",type:"text"});WH.onAfterTyping(f,B.bind(f,s,f),v.listview.searchDelay);WH.ae(c,f);let h=WH.ce("input",{className:n+"-invert",type:"checkbox"});let m=WH.ce("label",{className:n+"-invert-label",href:"javascript:"},h);WH.ae(m,WH.ct(WH.TERMS.invert));WH.aE(h,"change",Y.bind(h,s,h));WH.ae(s,m);let H=WH.ce("span",{className:n+"-error"});WH.ae(s,H);if(a){WH.st(o,C(a.column));se(l,s,a.operator);u.value=a.text;f.value=a.text2;h.checked=!!a.invert}else{if(e.type===Listview.COLUMN_TYPE_TEXT){a={column:e,elements:undefined,enabled:false,invert:"",operator:p,test:undefined,text:"",text2:""};se(l,s,a.operator);v.filters.push(a);he()}else{let i=false;try{a=P(">0",e)}catch(e){WH.error(e.message||e);i=true}if(!a||i){let t="Could not create empty numeric filter.";WH.error(t,e.id,e);alert(t);throw new Error(t)}v.filters.push(a);A(a.column);se(l,s,a.operator);u.value=a.text;f.value=a.text2;t.apply()}}s.__listviewFilter=a;a.elements={error:H,operator:l,text:u,text2:f,wrapper:s};return s}function w(e,t){let a=[];let i;let n;if(e){a.push(Menu.createHeading({label:WH.TERMS.changeColumn_ellipsis}));let s=O(e);i=G.bind(undefined,s,t);n=s.column.id}else{i=$.bind(undefined)}let s=L();for(let e=0,t;t=s[v.listview.visibility[e]];e++){if(!q(t)){continue}if(t.id===Listview.COLUMN_ID_DEBUG_ID){let e=Menu.createItem({label:WH.Strings.sprintf(WH.TERMS.parens_format,C(t),WH.TERMS.staffonly_stc),url:i.bind(undefined,t)});e.checked=t.id===n;a.push(e);continue}let e=Menu.createItem({label:C(t),url:i.bind(undefined,t)});e.checked=t.id===n;a.push(e)}return a}function C(e){return e.tooltip||e.name||e.id}function M(e,t){let a=[];let i=O(e);let n=g[i.column.type]||g["default"];for(let e=0,s;s=n[e];e++){let e=Menu.createItem({label:s.text,url:V.bind(undefined,i,t,s)});e.checked=s.type===i.operator;a.push(e)}return a}function O(e){return e.__listviewFilter}function L(){return v.listview.sortOptions||v.listview.columns||[]}function D(e,t){let a=v.listview.template.getVisibleText?(""+v.listview.template.getVisibleText(e)).trim():"";if(t.getVisibleText){return a+t.getVisibleText(e)}if(t.getValue){return a+t.getValue.call(v.listview,e)}if(t.value){return a+e[t.value]}if(t.compute){return a+t.compute.call(v.listview,e,WH.ce("td"),WH.ce("tr"),t.__index)}return""}function k(e){return e?e.type||Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT}function P(e,t){e=e.replace(/\s+/g," ").trim();let a={elements:undefined,enabled:true,invert:"",test:undefined,text:"",text2:""};if(t){a.column=t}let i=k(t);if(e){if(e.charAt(0)==="!"||i===Listview.COLUMN_TYPE_TEXT&&e.charAt(0)==="-"){a.invert="!";e=e.substr(1)}let t;if(e.match(W.NUMBER)){t=te(RegExp.$2);if(!ee(t)){a.operator=m[RegExp.$1];a.value=t;a.text=""+t}}else if(e.match(W.RANGE)){t={min:te(RegExp.$1),max:te(RegExp.$2)};if(!ee(t.min)&&!ee(t.max)){if(t.min===t.max){a.operator=c;a.value=t.min;a.text=""+t.min}else{if(t.min>t.max){let e=t.min;t.min=t.max;t.max=e}a.operator=h;a.value=t;a.text=""+t.min;a.text2=""+t.max}}}else{let n=e.toLowerCase().split(" ");if(i===Listview.COLUMN_TYPE_TEXT){a.operator=p;a.text=e;if(a.invert){a.regExp=WH.createOrRegex(e)}else{a.words=n}}else if(n.length===1&&!ee(t=te(n[0]))&&""+t===n[0]){a.operator=c;a.value=t;a.text=""+t}}}if(e&&!a.operator){throw new Error(WH.TERMS.invalidfilter_stc)}if(!a.text){return null}ie(a);return a}function x(){return WH.ce("div",{className:"no-wrap"},WH.ct(S()?WH.TERMS.hidefilteroptions_stc:WH.TERMS.filterTheseResults_stc)).outerHTML}function U(e,t){let a=t?"":e.invert;switch(e.operator){case h:return a+e.text+"-"+e.text2;case p:return a+e.text;default:if(!H[e.operator]){let t="Could not generate simple filter text for unsupported filter operator.";WH.error(t,e.operator);alert(t);throw new Error(t)}return a+H[e.operator]+e.text}}function F(e){v.listview=e;if(v.listview.filtrable){let e=L();for(let t=0,a;a=e[t];++t){if(!q(a)){continue}if(!v.hasFilterableColumns&&v.listview.isColumnVisible(a)){v.hasFilterableColumns=true}if(a.actions){a.actions.unshift({action:j.bind(undefined,a),name:WH.TERMS.filter,tooltipText:WH.TERMS.rightClickToFilter_stc})}}}}function q(e){return e.id&&(e.filtrable==null||e.filtrable)}function Y(e,t){let a=O(e);a.invert=this.checked?"!":"";let i=X(a);if(!i.success){y(a,i.error)}}function B(e,t){let a=O(e);let i=t.value.trim();let n=t.className.indexOf("text2")===-1?"text":"text2";if(a[n]===i){return}if(a.enabled){if(i){if(a[n]!==i){a[n]=i;let e=X(a);if(!e.success){y(a,e.error)}}}else{a[n]=i;y(a)}}else{if(i){a[n]=i;let e=X(a);if(!e.success){y(a,e.error)}}else{delete a.elements.wrapper.dataset.showError}}}function G(e,a,i){if(e.column.id===i.id){t.apply();return}let n=e.column;e.column=i;WH.st(a,C(i));let s=X(e);if(!s.success){y(e,s.error)}if(!t.isColumnFiltered(n)){I(n)}R(e)}function $(e){let t=N(e);WH.ae(v.elements.columnFilters,t);R(O(t))}function V(e,a,i){if(e.operator===i.type){t.apply();return}let n=e.operator;e.operator=i.type;se(a,e.elements.wrapper,e.operator);if(i.type===h){if(n===p){let t=te(e.text);if(!ee(t)){e.text=""+t;e.value=t;e.elements.text.value=e.text}else{e.text="0";e.value=0;e.elements.text.value=e.text}}if(!e.text2||e.text2===e.text){e.text2=(e.value||0)+1;e.elements.text2.value=e.text2}}let s=X(e);if(!s.success){y(e,s.error)}R(e)}function z(e){if(!v.listview.container.dataset.filters){re();if(v.listview.searchable&&v.elements.tableFilter){v.elements.tableFilter.focus()}}else{delete v.listview.container.dataset.filters}if(!a.isTouch()){WH.Tooltips.showAtCursor(e,x(),"q2")}}function K(e){let a=O(e);WH.de(e);let i=v.filters.indexOf(a);if(i!==-1){v.filters.splice(i,1);if(!t.isColumnFiltered(a.column)){I(a.column)}t.apply()}Menu.hide(true);WH.Tooltips.hide()}function j(e){for(let t=0,a;a=v.filters[t];t++){if(a.column&&a.column.id===e.id){R(a);return}}let t=e.type===Listview.COLUMN_TYPE_TEXT?WH.TERMS.examplefilter_tip:WH.TERMS.examplefilter2_tip;let a=prompt(WH.sprintf(WH.TERMS.columnfilter_format+"\n\n"+t,C(e)));if(a!==null){let t=ae(a,{column:e});if(t){R(t)}}}function Z(){ae(this.value)}function X(e){let t={success:false};try{let a=P(U(e),e.column);if(a){Q(e,a);se(a.elements.operator,a.elements.wrapper,a.operator);let i=a.elements.text;let n=a.elements.text2;if(a.operator===h){if(a.text===e.text2||a.text2===e.text){i.value=a.text;n.value=a.text2;if(document.activeElement===i){n.focus()}else if(document.activeElement===n){i.focus()}}if(document.activeElement!==i&&document.activeElement!==n){i.focus()}}else{i.focus()}delete a.elements.wrapper.dataset.showError;t.success=true}}catch(e){t.error=e.message||e}return t}function Q(e,a){let i=v.filters.indexOf(e);if(i!==-1){v.filters.splice(i,1,a)}else{v.filters.push(a)}a.elements=e.elements;a.elements.wrapper.__listviewFilter=a;A(a.column);t.apply()}function J(){t.reset();t.focus()}function ee(e){return typeof e==="number"&&isNaN(e)}function te(e){let t=parseFloat(e);if(Number.isInteger(t)&&!Number.isSafeInteger(t)){t=BigInt(e)}return t}function ae(e,a){a=a||{};let i;try{i=P(e,a.column)}catch(e){alert(e.message||e);return null}let n=false;let s=false;if(!a.allowDuplicateColumns){for(let e=v.filters.length-1;e>=0;e--){if(a.column&&v.filters[e].column&&v.filters[e].column.id===a.column.id||!a.column&&!v.filters[e].column){if(v.filters[e].elements){WH.de(v.filters[e].elements.wrapper)}if(i){v.filters.splice(e,1,i);n=true}else{v.filters.splice(e,1)}s=true}}}if(i){if(!n){v.filters.push(i);n=true}re();if(a.column){WH.ae(v.elements.columnFilters,N(a.column,i))}else if(v.listview.searchable&&v.elements.tableFilter){let e=U(i);if(e!==v.elements.tableFilter.value.trim()){v.elements.tableFilter.value=e}}}if(a.column){if(n&&!s){A(a.column)}else if(s&&!n&&!t.isColumnFiltered(a.column)){I(a.column)}}if((n||s)&&!a.skipApply){t.apply()}return i}function ie(e){if(!e.enabled){delete e.test;return}let t=k(e.column);if(t===Listview.COLUMN_TYPE_TEXT&&e.operator!==p){t=Listview.COLUMN_TYPE_NUMBER}switch(t){case Listview.COLUMN_TYPE_TEXT:e.test=e.invert?fe.bind(null,e):de.bind(null,e);break;case Listview.COLUMN_TYPE_RANGE:let a=T[e.operator].bind(null,e.value);e.test=le.bind(null,e,a);break;case Listview.COLUMN_TYPE_NUMBER:let i=_[e.operator].bind(null,e.value);e.test=oe.bind(null,e,i);break;default:let n="Unknown column type cannot be filtered.";WH.error(n,t,e.column.id);throw new Error(n)}}function ne(e,a){if(!o.includes(e)){return}v.matchType=e;re();v.elements.match[e].checked=true;if(!a){t.apply()}}function se(e,t,a){WH.st(e,H[a]);t.dataset.type=a===p?"string":"number";if(a===h){t.dataset.useRange="true"}else{delete t.dataset.useRange}}function re(){if(!v.listview.searchable&&!v.hasFilterableColumns){return}if(!v.elements.container){v.elements.container=b();let e=v.listview.noteTop||v.listview.noteIndicators||v.listview.navTop;v.listview.bandTop.insertBefore(v.elements.container,e.nextSibling)}v.listview.container.dataset.filters="visible"}function oe(e,t,a,i){let n=te(a.getValue?a.getValue(i):i[a.value]);if(ee(n)){return false}return e.invert?!t(n):t(n)}function le(e,t,a,i){return e.invert?!t({min:a.getMinValue(i),max:a.getMaxValue(i)},e.value):t({min:a.getMinValue(i),max:a.getMaxValue(i)},e.value)}function ce(e,t){let a=0;for(let i=0,n;n=v.filters[i];i++){if(!n.enabled){a++;continue}if(n.column){if(n.test(n.column,e)){a++}else{break}}else{let i=false;for(let a=0,s;s=t[a];a++){if(n.test(s,e)){i=true;break}}if(i){a++}else{break}}}return a===v.filters.length}function ue(e,t){for(let a=0,i;i=v.filters[a];a++){if(!i.enabled){continue}if(i.column){if(i.test(i.column,e)){return true}}else{for(let a=0,n;n=t[a];a++){if(i.test(n,e)){return true}}}}return false}function de(e,t,a,i){let n=false;let s=D(a,t);if(s){s=s.toString().toLowerCase();n=true;for(let t=0,a=e.words.length;t<a;t++){if(s.indexOf(e.words[t])===-1){n=false;break}}}return n}function fe(e,t,a,i){let n=false;let s=D(a,t);if(s){s=s.toString().toLowerCase();n=s.match(e.regExp)!=null}return!n}function he(){if(!v.elements.reset){return}let e=0;for(let t=0,a;a=v.filters[t];t++){if(a.enabled||a.column){e++}}switch(e){case 0:WH.displayNone(v.elements.match.container);WH.displayNone(v.elements.reset);break;case 1:WH.displayNone(v.elements.match.container);WH.displayBlock(v.elements.reset);break;default:WH.displayBlock(v.elements.match.container);WH.displayBlock(v.elements.reset)}}function pe(){if(v.listview.searchable&&v.elements.tableFilter){if(v.elements.tableFilter.value.trim()){v.elements.tableFilterIcon.style.display="none";v.elements.tableFilterClear.style.display=""}else{v.elements.tableFilterIcon.style.display="";v.elements.tableFilterClear.style.display="none"}}}F(e)};Listview.Filters.resetAndFocus=function(){this.Filters.resetAndFocus()};WH.markup.DisplayOptions=new function(){const e=this;const t=Object.seal({containers:{},options:{},groups:{}});this.registerContainer=e=>{const a=WH.Strings.guid();t.containers[a]={...e};n(t.containers[a],s())};this.registerGroup=e=>{const{element:a,name:i}=e;if(!t.groups[i]){t.groups[i]=[]}const n={active:false,...e};t.groups[i].push(n);WH.aE(a,"click",(()=>g(n)))};this.registerOption=e=>{const{element:a}=e;const i=WH.Strings.guid();t.options[i]={...e};if(e.active){o(t.options[i])}else{l(t.options[i])}WH.aE(a,"click",(()=>d(t.options[i])))};this.reset=()=>{t.containers={};t.options={};t.groups={}};const a=e=>{delete e.element.dataset.optionDimmed;e.element.dataset.optionActive=true;e.active=true};const i=e=>{delete e.element.dataset.optionActive;const[t,a]=e.dim?["optionDimmed",true]:["optionActive",false];e.element.dataset[t]=a;e.active=false};const n=(e,t)=>{const n=r(e);if(n(t)){a(e)}else{i(e)}};const s=()=>Object.values(t.options).reduce(((e,t)=>{if(t.active===true){e.push(t.containerName)}return e}),[]);const r=e=>{const{displayOptions:t}=e;const a=/[a-zA-Z0-9-]+/g;const i=(e,t)=>e.replace(a,(e=>t.includes(e)?"true":"false"));const n=e=>{try{return Function(`"use strict";return (${e});`)()}catch(t){throw new Error(`Invalid expression: ${e}`)}};return function(e){const a=i(t,e);return n(a)}};const o=e=>{e.active=true;WH.markup.tags["display-option"].enable(e.element);c(e).forEach((e=>l(e)));Object.values(t.containers).forEach((e=>{n(e,s())}))};const l=e=>{e.active=false;WH.markup.tags["display-option"].disable(e.element);u(e).forEach((e=>i(e)));Object.values(t.containers).forEach((e=>{n(e,s())}))};const c=e=>{let a=[];if(e.radioName){a=Object.values(t.options).filter((t=>t!==e&&t.radioName===e.radioName))}return a};const u=e=>t.containers[e.containerName]??[];const d=e=>{if(e.active){l(e)}else{o(e)}};const f=e=>{WH.markup.tags["display-group"].enable(e.element);e.active=true;const t=H(e);t.forEach((e=>l(e)));m(t,WH.Strings.splitCsv(e["enable-options"])).forEach((e=>o(e)))};const h=e=>WH.markup.tags["display-group"].disable(e.element);const p=e=>(t.groups[e]??[]).forEach((e=>h(e)));const m=(e,t)=>e.filter((e=>t.includes(e.containerName)))??[];const H=e=>Object.values(t.options).filter((({groupName:t})=>t===e.name))??[];const g=e=>{p(e.name);f(e)}};WH.markup.LinkValidation=new function(){const e="broken-link";const t=Object.seal({confirmedInvalid:new Set,confirmedValid:new Set});this.scan=e=>{const t=location.origin;const i=location.href.replace(/#[\w\W]*/,"");let n=`a[href^="${t}"]`;n+=":not([data-entity])";n+=':not([href*="[="])';n+=`:not([href^="${i}#"])`;const s=WH.qsa(n,e);const r={};Array.from(s).forEach((e=>{r[e.href]??=[];r[e.href].push(e)}));Object.values(r).forEach(a)};const a=a=>{const i=a[0].href;if(t.confirmedValid.has(i)){return}const n=()=>a.forEach((t=>{t.dataset.simpleTooltip=WH.ce("span",{className:"q10"},WH.ct(WH.term("invalidValue_format",WH.TERMS.link))).outerHTML;t.classList.add(e)}));if(t.confirmedInvalid.has(i)){n();return}WH.fetch(i,{cookies:false,errorExpected:true,method:"HEAD",success:()=>t.confirmedValid.add(i),error:()=>{WH.debug(`Link Validation failed for ${i}`);t.confirmedInvalid.add(i);n()}})}};WH.markup.Tags=new function(){this.getByEntityType=e=>{if(!e){return undefined}let t;Object.entries(WH.markup.tags).some((([a,i])=>{if(i.entityType===e){t=a;return true}}));return t};this.getWhml=(e,t,a={})=>`[${e}=${t}`+(a.bonuses&&a.bonuses.length?` bonus=${a.bonuses.join(":")}`:"")+(a.spec?` spec=${a.spec}`:"")+"]"};WH.markup.tags["--"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,trim:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false}},toNode:function(e){return null},toText:function(e){return""}};WH.markup.tags.achievement={entityType:WH.Types.ACHIEVEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ACHIEVEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ACHIEVEMENT)};WH.markup.tags.statistic={...WH.markup.tags.achievement};delete WH.markup.tags.statistic.entityType;WH.markup.tags.achievementpoints={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("span",{className:"moneyachievement tip"},WH.ct(WH.numberFormat(e.unnamed)));WH.markup.applyCommonAttributes(t,e);WH.Tooltips.attach(t,"<b>"+WH.TERMS.achievementpoints_stc+"</b>","q1",{byCursor:true});return t}};WH.markup.tags.acronym={empty:false,attr:{unnamed:{req:true}},toNode:function(e){var t=WH.ce("span");t.className="tip";WH.markup.applyCommonAttributes(t,e);WH.aE(t,"mouseover",(function(t){WH.Tooltips.showAtCursor(t,e.unnamed,"q1")}));WH.aE(t,"mousemove",WH.Tooltips.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltips.hide);return t}};WH.markup.tags["adventure-combatant-ability"]={entityType:WH.Types.ADVENTURE_COMBATANT_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:/^false$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY)};WH.markup.tags.affix={entityType:WH.Types.AFFIX,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AFFIX),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AFFIX)};WH.markup.tags.anchor={empty:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false,valid:/\S+/}},validate:function(e){if(!e.unnamed&&!e.id){return false}return true},toNode:function(e){if(!e.unnamed&&e.id){e.unnamed=e.id;e.id=null}var t=WH.ce("a",{id:e.unnamed});WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.artifactcalc={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(){return null}};WH.markup.tags["azerite-essence-power"]={entityType:WH.Types.AZERITE_ESSENCE_POWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},spec:{req:false,valid:/^[0-9]+$/},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER)};WH.markup.tags["azerite-essence"]={entityType:WH.Types.AZERITE_ESSENCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE)};WH.markup.tags["azerite-finder"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{class:{req:true,valid:/.+/},spec:{req:false,valid:/.+/},selectmultiple:{req:false,valid:/^true|false$/},showtiers:{req:false,valid:/^true|false$/},spells:{req:false,valid:/^\d+(,\d+){0,19}$/}},callbacks:[],toNode:function(e){let t=WH.ce("div",{className:"clear azerite-finder-markup-parent exclude-units",style:{display:"none"}});let a=function(){let a={embed:WH.Strings.guid(),class:e["class"]};if(e.spec){a.spec=e.spec}if(e.selectmultiple){a.multiselect=e.selectmultiple==="true"?1:0}if(e.showtiers){a.showtier=e.showtiers==="true"?1:0}if(e.spells){a.spellids=e.spells}$(t).load("/azerite-finder?"+WH.Url.buildQuery(a))};if(!WH.Wow.AzeriteFinder){this.callbacks.push(a);if(this.callbacks.length===1){WH.loadAssets("azerite-finder",(function(){let e;while(e=WH.markup.tags["azerite-finder"].callbacks.shift()){e()}}))}}else{a()}return t}};WH.markup.tags.b={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("b");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(b|big|strong)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[b]$2[/b]")}};WH.markup.tags["bfa-champion"]={entityType:WH.Types.BFA_CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.BFA_CHAMPION,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BFA_CHAMPION)};WH.markup.tags["blizzconline-giveaway"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(){let e=false;return function(){if(!e){$.getScript("https://widget.gleamjs.io/e.js");e=true}return WH.ce("a",{className:"e-widget no-button",href:"https://gleam.io/nsPDV/wowheads-blizzconline-giveaway",rel:"nofollow"},WH.ct("Wowhead's BlizzConline 2021 Giveaway"))}}()};WH.markup.tags["bloodmallet-chart"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{axiscolor:{req:false,valid:/.+/},azeritetier:{req:false,valid:/.+/},backgroundcolor:{req:false,valid:/.+/},class:{req:true,valid:/.+/},chartmode:{req:false,valid:/.+/},corruptionrepresentation:{req:false,valid:/.+/},covenant:{req:false,valid:/.+/},entries:{req:false,valid:/^\d+$/},fontcolor:{req:false,valid:/.+/},fightstyle:{req:false,valid:/.+/},renown:{req:false,valid:/^\d+$/},spec:{req:true,valid:/.+/},type:{req:false,valid:/.+/}},toNode:function(e){WH.Tools.Highcharts.loadScript((function(){clearTimeout(WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout);WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout=setTimeout(WH.Tools.Bloodmallet.loadCharts,0)}));var t=WH.ce("div",{className:"bloodmallet_chart exclude-units",textContent:WH.TERMS.loading_ellipsis,id:WH.Strings.guid()});t.setAttribute("data-wow-class",e["class"].replace("-","_"));t.setAttribute("data-wow-spec",e.spec.replace("-","_"));var a={azeritetier:"azerite-tier",chartmode:"chart-mode",corruptionrepresentation:"corruption-representation",covenant:"covenant",entries:"show-top",fightstyle:"fight-style",renown:"renown",type:"type"};for(var i in a){if(e[i]){t.setAttribute("data-"+a[i],e[i].replace("-","_"))}}return t}};WH.markup.tags["bluesky-post"]=(()=>{let e=false;const t=()=>{if(e){return}e=true;WH.aE(window,"message",(e=>{if(e.origin!=="https://embed.bsky.app"){return}const t=e.data.id;if(!t){return}const a=`bluesky-iframe-${t}`;const i=WH.ge(a);if(!i){return}if(e.data.height){i.style.height=`${e.data.height}px`}}))};return{empty:false,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){const a=e._contents.textContent;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}const i=a.match(/\bat:\/\/([^/]+)\/app\.bsky\.feed\.post\/([a-z0-9]+)/);if(!i){return WH.ce("span",{className:"error"},WH.ct("Invalid Bluesky embed code!"))}t();const n=WH.Strings.guid();return WH.ce("iframe",{id:`bluesky-iframe-${n}`,src:`https://embed.bsky.app/embed/${i[1]}/app.bsky.feed.post/${i[2]}?id=${n}`,frameBorder:"0",scrolling:"no",height:"300",width:"100%",style:{border:"none",maxWidth:"600px"}})}}})();WH.markup.tags.bluetweet={empty:true,ltrim:true,attr:{id:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"markup-bluetweet exclude-units"},WH.ce("a",{href:"https://twitter.com/wowheadtweets/status/"+e.id},WH.ct("Tweet #"+e.id)));WH.Twitter.renderTweet(e.id,t);return t}};WH.markup.tags.box={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{align:{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^true$/},clear:{req:false,valid:/^(left|right|both)$/i},display:{req:false,valid:/^block$/},float:{req:false,valid:/^(left|right|none)$/i},level:{req:false,valid:/^[1-6]$/i},margin:{req:false,valid:/^[0-5]|half$/i}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(e){return true},toNode:function(e){let t=WH.ce("div",{className:"box",dataset:{level:e.level||null}});WH.markup.applyCommonAttributes(t,e);if(e.display)t.style.display=e.display;if(e.align)t.style.textAlign=e.align;if(e.border)t.dataset.border="true";if(e.clear)t.style.clear=e.clear;if(e.first)t.classList.add("first");if(e.last)t.classList.add("last");if(e["float"])t.classList.add("markup-float-"+e["float"]);if(e.margin){t.dataset.margin=`${e.margin}`}return t}};WH.markup.tags.br={empty:true,toNode:function(e){return WH.ce("br")},fromHtml:function(e){return e.replace(/<br\b[\s\S]*?>/gi,"\n")}};WH.markup.tags["build-items"]={empty:false,allowedParents:{build:1},attr:{alt:{req:false,valid:WH.markup.regex.isEntityList},bis:{req:false,valid:WH.markup.regex.isEntityList},list:{req:false,valid:WH.markup.regex.isEntityList},icon:{req:false,valid:/\S+/}},toNode:function(e){const t=WH.ce("span",{dataset:{buildItemsTag:"true"}});t.whMarkupInfo={alternatives:e.alt,content:e.bis,icon:e.icon?.toLowerCase(),list:e.list};return t}};WH.markup.tags.build=function(){return{empty:false,allowedChildren:{url:1,"build-items":1},allowedParents:{builds:1},attr:{class:{req:false,valid:/^.+$/},consumables:{req:false,valid:WH.markup.regex.isEntityList},hero:{req:false,valid:/^.+$/},set:{req:false,valid:WH.markup.regex.intCsv},"set-items":{req:false,valid:WH.markup.regex.isEntityList},site:{req:false,valid:WH.markup.regex.domain},spec:{req:false,valid:/^.+$/},"stat-guide":{req:false,valid:/^[0-9]+$/},stats:{req:false,valid:/^((\d+%?)?[a-zA-Z]+(>+|=|>=)?)+$/},tab:{req:false,valid:/^.+$/},talents:{req:false,valid:/^[\/a-zA-Z0-9_-]+$/},title:{req:false,valid:/^.+$/},trinkets:{req:false,valid:WH.markup.regex.isEntityList},"trinkets-alt":{req:false,valid:WH.markup.regex.isEntityList},weapons:{req:false,valid:WH.markup.regex.isEntityList},"weapons-alt":{req:false,valid:WH.markup.regex.isEntityList}},toNode:function(e){let t="build-summary";let a=WH.ce("section",{className:t});a.whMarkupInfo={type:"wow-build"};e._contents.querySelectorAll("[data-build-items-tag]").forEach((e=>{e.parentNode.removeChild(e);a.whMarkupInfo.extraItems??=[];const t=document.createDocumentFragment();while(e.hasChildNodes()){WH.ae(t,e.firstChild)}a.whMarkupInfo.extraItems.push({...e.whMarkupInfo,header:t})}));Object.entries(e).forEach((([e,t])=>{if(t===""){return}let i=e==="set-items"?"tier":e.replace("-alt","").replace("-items","");if(!a.whMarkupInfo[i]){a.whMarkupInfo[i]={}}let n=a.whMarkupInfo[i];if(!e.includes("-alt")){n.content=t}else{n.alternatives=t}}));return a}}}();WH.markup.tags.building={entityType:WH.Types.BUILDING,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},nolvl:{req:false,valid:/^true$/},short:{req:false,valid:/^true$/},side:{req:false,valid:/^1|2$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.unnamed;var a=WH.markup.getDatabaseDomainInfo(e);let i=a.dataEnv;var n=a.nameKey;var s=WH.ce("a");var r=WH.Gatherer.get(WH.Types.BUILDING,t,a.dataEnv);if(r&&r[n]){if(r.hasOwnProperty("fromDataEnv")){i=r.fromDataEnv}var o=r[n];s.href=WH.Entity.getUrl(WH.Types.BUILDING,t,o,undefined,i,a.localeId);var l=e["short"]?WH.TERMS.level_abbrev:WH.TERMS.level;if(e.side){var c=new RegExp(e.side==1?" \\/ .+$":"[^\\/]+ \\/ ");o=o.replace(c,"")}else if(e["short"]){if(WH.Wow.Building.hasShortName(t)){o=WH.Wow.Building.getShortName(t)}}var u=!e.nolvl&&r.hasOwnProperty("level")?l+WH.TERMS.wordspace_punct+r.level+WH.TERMS.wordspace_punct:"";WH.st(s,u+o)}else{s.href=WH.Entity.getUrl(WH.Types.BUILDING,t,undefined,undefined,i,a.localeId);WH.st(s,WH.Entity.getPlaceholderName(WH.Types.BUILDING,t))}WH.markup.applyCommonAttributes(s,e);return s},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BUILDING)};WH.markup.tags.builds=function(){let e={};let t={};return{empty:false,allowedChildren:{build:1,"d4-build":1,"d4-paragon-calc":1,"d4-skill-tree":1},attr:{domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(a){let i=WH.markup.getDatabaseDomainInfo(a);let n=WH.ce("section",{className:"build-summary-container exclude-units"});let s=[];let r=[];let o=[];let l=[];let c;while(a._contents.hasChildNodes()){c=a._contents.removeChild(a._contents.firstChild);if(c.whMarkupInfo.type==="d4-skill-tree"){l.push(c.whMarkupInfo)}else if(c.whMarkupInfo.type==="d4-build"){r.push(c.whMarkupInfo)}else if(c.whMarkupInfo.type==="d4-paragon-calc"){o.push(c.whMarkupInfo)}else{s.push(c.whMarkupInfo)}}if(r.length>0){const a=()=>{WH.React.initComponent(n,"modules/d4/build-planner/Builds",{configs:r,dataEnv:i.dataEnv})};const s=`d4-build-${i.dataEnv}`;if(!t[s]){e[s]??=[];e[s].push(a);if(e[s].length===1){WH.loadAssets("d4-build",(()=>{t[s]=true;let a;while(a=e[s].shift()){a()}}),i.dataEnv)}}else{a()}}if(o.length>0){let t=()=>{try{WH.DOM.setData(n,"paragonCalc",new WH.D4.ParagonCalc(n,{dataEnv:i.dataEnv,editable:false,markup:true,calcs:o}))}catch(e){WH.error("Unable to create Paragon Calc",{calcs:o,error:e})}};if(!WH.D4.ParagonCalc?.isReady(i.dataEnv)){let a=`d4-paragon-calc-${i.dataEnv}`;e[a]??=[];e[a].push(t);if(e[a].length===1){WH.loadAssets("d4-paragon-calc",(()=>{let t;while(t=e[a].shift()){t()}}),i.dataEnv)}}else{t()}}if(l.length>0){let t=function(){try{WH.DOM.setData(n,"skillTree",new WH.D4.SkillPlanner(n,{dataEnv:i.dataEnv,editable:false,embedded:true,markup:true,trees:l}))}catch(e){WH.error("Unable to create skill tree",{trees:l,error:e})}};if(!WH.D4.SkillPlanner?.isReady(i.dataEnv)){let a=`d4-skill-tree-${i.dataEnv}`;e[a]??=[];e[a].push(t);if(e[a].length===1){WH.loadAssets("d4-skill-tree",(()=>{let t;while(t=e[a].shift()){t()}}),i.dataEnv)}}else{t()}}if(s.length>0){let t=function(){new WH.Wow.BuildSummary(n,s,i.dataEnv)};if(!WH.Wow.BuildSummary){let a=`wow-build-summary-${i.dataEnv}`;e[a]??=[];e[a].push(t);if(e[a].length===1){WH.loadAssets("build-summary",(()=>{let t;while(t=e[a].shift()){t()}}),i.dataEnv)}}else{t()}}return n}}}();WH.markup.tags.center={empty:false,allowInReplies:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.ce("div",{className:"wh-center"});t.style.textAlign="-moz-center";t.style.textAlign=t.style.textAlign||"-webkit-center";t.style.textAlign=t.style.textAlign||"center";return t},fromHtml:function(e){return e.replace(/<center>([\s\S]+?)<\/center>/gi,"[pad][div align=center]$1[/div][pad]")}};WH.markup.tags.champion={entityType:WH.Types.CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.CHAMPION,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CHAMPION)};WH.markup.tags.chart={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{id:{req:true,valid:/^[0-9a-zA-Z-]+$/},type:{req:true,valid:/^barpercent|pie|rank|rankpercent$/},width:{req:false,valid:/^\d+$/},height:{req:false,valid:/^\d+$/},credits:{req:false,valid:/^profiler|none$/},sort:{req:false,valid:/^asc|desc$/}},toNode:function(e){var t;if(!g_charts.hasOwnProperty(e.id)){t=WH.ce("div",{className:"highchart "+e.type+" exclude-units",style:{border:"1px solid #CCC"}},WH.ct("(Chart "+e.id+" not found)"));if(e.width){t.style.width=""+e.width+"px";t.style.maxWidth="100%"}if(e.height){t.style.height=""+e.height+"px"}return t}var a=WH.markup.getDatabaseDomainInfo(e);var i=a.nameKey;var n={};if(!e.credits||e.credits=="profiler"){n.href=WH.Url.generatePath("/list");n.text=WH.TERMS.poweredbyprofiler_tip}if(e.credits=="none"){n.enabled=false}switch(e.type){case"rank":case"rankpercent":var s=g_charts[e.id];var r=s[0].keyType;var o;var l;var c;var u;var d=[];for(var f in s[0].data){d.push(f)}d.sort((function(e,t){return WH.stringCompare(s[0].data[e],s[0].data[t])}));if(e.sort=="desc"){d.reverse()}else if(!e.sort){if(s[1].data){if(s[0].data[d[0]]/s[1].data>.5){d.reverse()}}}t=WH.ce("div",{className:"exclude-units",style:{display:"inline-block"}});if(e.width){t.style.width=""+e.width+"px";t.style.maxWidth="100%"}var h;var p;var m=WH.ce("ol");WH.ae(t,m);for(var H=0;H<d.length;H++){f=d[H];u=false;o=f;l="";c="";if(u=WH.Gatherer.get(s[0].keyType,parseInt(f,10),a.dataEnv)){o=u.hasOwnProperty(i)?u[i]:f;l=u.hasOwnProperty("quality")?u.quality:"";c=u.hasOwnProperty("icon")?u.icon:""}p=WH.ce("li");WH.ae(m,p);if(c){var g=document.createDocumentFragment();WH.ae(g,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+c+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(g,WH.ct(WH.Strings.nbsp))}if(r){h=WH.ce("a",{href:WH.Entity.getUrl(r,f),className:"q"+l+(c?" icontiny":"")})}else{h=WH.ce("span",{className:"q"+l})}WH.ae(p,h);if(c){WH.ae(h,g)}WH.ae(h,WH.ct(o));if(e.type=="rankpercent"&&s[1].data){WH.ae(p,WH.ct(" "));WH.ae(p,WH.ce("small",{className:"q0"},WH.ct(WH.sprintf(WH.TERMS._paren,(s[0].data[f]/s[1].data*100).toFixed(4)+"%"))))}}if(n.text){var W=WH.ce("div",{style:{position:"relative",top:"-12px",textAlign:"right",fontSize:"10px"}});WH.ae(t,W);if(n.href){h=WH.ce("a",{href:n.href,className:"q0"},WH.ct(n.text))}else{h=WH.ce("span",{className:"q0"},WH.ct(n.text))}WH.ae(W,h)}return t;break}if(!WH.isSet("g_highcharts")){WH.Tools.Highcharts.loadScript();g_highcharts={charts:[],divIndex:0,pending:undefined};g_highcharts.ShowCharts=function(e){if(e){g_highcharts.pending=undefined}else if(typeof g_highcharts.pending!="undefined"){return}var t=false;if(WH.isSet("Highcharts")){for(var a=0;a<g_highcharts.charts.length;a++){if(g_highcharts.charts[a].rendered){continue}if($(g_highcharts.charts[a].container).length==0){t=true;continue}$(g_highcharts.charts[a].container).highcharts(g_highcharts.charts[a].chart);g_highcharts.charts[a].rendered=true}}else{t=true}if(t){g_highcharts.pending=window.setTimeout(g_highcharts.ShowCharts,250,true);return}}}t=WH.ce("div",{className:"highcharts-wowhead-style highchart "+e.type+" exclude-units"});if(e.width){t.style.width=""+e.width+"px";t.style.maxWidth="100%"}if(e.height){t.style.height=""+e.height+"px"}switch(e.type){case"barpercent":var s=g_charts[e.id];var E={container:t,chart:{}};E.chart={credits:n,chart:{type:"bar",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,max:100,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var e=this.x+": "+this.y+"%";let t=WH.User.Completion.getByType(s[0].keyType);if(Object.keys(t).length){for(var a in g_user.lists){var i=g_user.lists[a];if(!(i.id in t)){continue}var n=WH.inArray(t[i.id],this.point.id)!=-1;e+='<br><span class="progress-icon '+(n?"progress-8":"progress-0")+'"></span> ';e+=i.character+" - "+i.realm+" "+i.region}}return e},useHTML:true},series:[{data:[],events:{click:function(t){if(g_charts[e.id][0].keyType){location.href=WH.Entity.getUrl(g_charts[e.id][0].keyType,t.point.series.data[t.point.x].id)}}}}]};var _;var T=[];let r=WH.User.Completion.getByType(s[0].keyType);if(Object.keys(r).length&&g_user.hasOwnProperty("lists")&&g_user.lists&&g_user.lists.length){for(var H=0;H<g_user.lists.length;H++){_=""+g_user.lists[H].id;if(g_user.lists[H].pinned>0&&r.hasOwnProperty(_)){T=r[_];if(g_user.lists[H].pinned>1){break}}}}var v=[];for(var f in s[0].data){if(!s[0].data.hasOwnProperty(f)){continue}v.push({k:f,v:s[0].data[f]})}v.sort((function(e,t){return WH.stringCompare(t.v,e.v)}));if(e.sort=="asc"){v.reverse()}for(var H=0;H<v.length;H++){var S=v[H];var u=WH.Gatherer.get(s[0].keyType,S.k,a.dataEnv);u=u?u[i]:S.k;var b={id:S.k,y:Math.round(S.v/s[1].data*100)};if(T.indexOf(parseInt(b.id,10))!=-1){b.colorIndex=6}E.chart.xAxis.categories.push(u);E.chart.series[0].data.push(b)}g_highcharts.charts.push(E);break;case"pie":var E={container:t,chart:{}};E.chart={credits:n,chart:{type:"pie",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{pie:{dataLabels:{style:{textShadow:"none"}}}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){return this.point.name+": "+Math.round(this.y)+"%"}},series:[{data:[]}]};var s=g_charts[e.id];var v=[];var y=0;var I=true;var u;var A={};if(s[0].keyType==WH.Types.RACE){var A={24:WH.TERMS.neutral,25:WH.TERMS.alliance,26:WH.TERMS.horde};for(var R in A){if(A.hasOwnProperty(R)){A[R]=WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+A[R]+WH.TERMS.closedparenthesis_punct}}}for(var f in s[0].data){if(!s[0].data.hasOwnProperty(f)){continue}y+=s[0].data[f];I&=!isNaN(f)&&f!="0";u=(WH.Gatherer.get(s[0].keyType,f,a.dataEnv)||{})[i]||f;u+=A[f]||"";v.push({k:f,keyName:u,v:s[0].data[f]})}if(!isNaN(s[1].data)&&y/s[1].data<.98){v.push({k:I?0:"Other",v:s[1].data-y})}if(g_gathered_types.hasOwnProperty(s[0].keyType)){v.sort((function(e,t){return WH.stringCompare(t.v,e.v)||WH.stringCompare(e.keyName,t.keyName)}))}else{v.sort((function(e,t){return WH.stringCompare(e.keyName,t.keyName)||WH.stringCompare(t.v,e.v)}))}for(var H=0;H<v.length;H++){var S=v[H];E.chart.series[0].data.push({id:S.k,name:S.keyName,y:S.v/s[1].data*100})}g_highcharts.charts.push(E);break;default:return WH.ce("div",{},WH.ct("(Chart type "+e.type+" unknown)"));break}g_highcharts.ShowCharts();return t}};WH.markup.tags["class-badge-grid"]={empty:false,attr:{unnamed:{req:false},text:{req:false},allowedChildren:{"class-badge":1}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t="class-text-badge-grid";let a=WH.ce("div",{classList:`${t} exclude-units`});let i=WH.ce("div",{classList:`${t}-header`});let n=WH.ce("div",{classList:`${t}-header-icon`});let s=WH.ce("div",{classList:`${t}-container`,dataset:{markupContentTarget:"1"}});WH.ae(a,i);WH.ae(i,n);WH.ae(a,s);if(e.text){WH.st(n,e.text)}WH.DOM.bindBreakpoints(a,{small:500,medium:1100});return a}};WH.markup.tags["class-badge"]={empty:true,attr:{unnamed:{req:false},text:{req:false},text2:{req:false},url:{req:false,valid:WH.markup.regex.noWhitespace}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t="class-text-badge";let a;if(e.url){a=WH.ce("a",{classList:`${t} exclude-units`,href:e.url})}else{a=WH.ce("span",{classList:`${t} exclude-units`})}WH.ae(a,WH.ce("span",{classList:`${t}-icon`}));if(e.unnamed){a.dataset.type=WH.Strings.slug(e.unnamed)}if(e.text){WH.ae(a,WH.ce("section",{classList:`${t}-text`},WH.ct(e.text)))}if(e.text2){WH.ae(a,WH.ce("section",{classList:`${t}-text`},WH.ct(`${e.text2}`)));a.dataset.textDisplay="two-lines"}return a}};WH.markup.tags["class"]={entityType:WH.Types.PLAYER_CLASS,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}if(WH.Wow.PlayerClass.exists(parseInt(e.unnamed),WH.markup.getDataEnvFromSiteAttr(e.site))){return true}return false},toNode:function(e){var t=WH.markup.entityTagToNode(WH.Types.PLAYER_CLASS,e);t.classList.add("c"+e.unnamed);return t},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.PLAYER_CLASS)};WH.markup.tags.code={block:true,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},rtrim:true,itrim:true,helpText:true,allowedChildren:{"<text>":1},toNode:function(e){var t=WH.ce("pre",{className:"code exclude-units"});if(e.wrap==="true"){t.style.whiteSpace="normal"}else if(e.wrap==="false"){t.style.whiteSpace="nowrap"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.color={empty:false,attr:{unnamed:{req:true,valid:/^.*/i}},allowedClass:WH.markup.CLASS.STAFF,extraColors:{deathknight:"c6","death-knight":"c6",dk:"c6",demonhunter:"c12","demon-hunter":"c12",dh:"c12",druid:"c11",evoker:"c13",hunter:"c3",mage:"c8",monk:"c10",paladin:"c2",priest:"c5",rogue:"c4",shaman:"c7",warlock:"c9",warrior:"c1","quest-item":"q",poor:"q0",common:"q1",uncommon:"q2",rare:"q3",epic:"q4",legendary:"q5",artifact:"q6",heirloom:"q7",wowtoken:"q8",glyph:"q9",kyrian:"covenant-kyrian",venthyr:"covenant-venthyr",necrolord:"covenant-necrolord","night-fae":"covenant-night-fae","meta-gem":"gem1","red-gem":"gem2","yellow-gem":"gem4","orange-gem":"gem6","blue-gem":"gem8","purple-gem":"gem10","green-gem":"gem12","prismatic-gem":"gem14",yell:"s1",say:"s2",whisper:"s3",exalted:"rep-exalted",revered:"rep-revered",honored:"rep-honored",friendly:"rep-friendly",neutral:"rep-neutral",unfriendly:"rep-unfriendly",hostile:"rep-hostile",hated:"rep-hated","skill-red":"q10","skill-orange":"r1","skill-yellow":"r2","skill-green":"r3","skill-gray":"r4","di-normal":"di-q1","di-magic":"di-q2","di-rare":"di-q3","di-legendary":"di-q4","di-set":"di-q5","di-primal":"di-q6","di-gray":"di-ic0","di-inferior-blue":"di-ic1","di-light-blue":"di-ic2","di-white":"di-ic3","di-blue":"di-ic4","di-gold":"di-ic5","di-orange":"di-ic6","di-green":"di-ic7","di-dubo":"di-ic8","di-violet":"di-ic9","d4-q0":"d4-q0","d4-q1":"d4-q1","d4-q2":"d4-q2","d4-q3":"d4-q3","d4-q4":"d4-q4","d4-q5":"d4-q5","d4-q6":"d4-q6","d4-q7":"d4-q7","d4-q8":"d4-q8","d4-collectible":"d4-item-collectible","d4-gambling":"d4-item-gambling","d4-materials":"d4-item-materials","d4-potion":"d4-item-potion","d4-questItem":"d4-item-questItem","d4-resource":"d4-item-resource","d4-rune":"d4-item-rune","d4-tome":"d4-item-tome","d4-number":"d4-color-number",blizzard:"blizzard-blue"},toNode:function(e){let t=/^(aqua|black|blue|fuchsia|gray|green|lightblue|lime|maroon|navy|olive|purple|red|silver|teal|white|yellow|#[a-f0-9]{6}|#[a-f0-9]{3})$/i;let a=WH.ce("span");if(WH.markup.tags.color.extraColors[e.unnamed]){a.className=WH.markup.tags.color.extraColors[e.unnamed]}else if(Object.values(WH.markup.tags.color.extraColors).includes(e.unnamed)){a.className=e.unnamed}else if(t.test(e.unnamed)){if(e.unnamed.toLowerCase()==="#00c0ff"){a.className="blizzard-blue"}else{a.style.color=e.unnamed}}WH.markup.applyCommonAttributes(a,e);return a}};WH.markup.tags.copy={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false},button:{req:false,valid:/^false$/},size:{req:false,valid:/^large$/}},allowedChildren:{"<text>":1},invisibleContent:true,rawText:true,toNode:function(e){let t=e.unnamed?WH.term("copy_format",e.unnamed):WH.TERMS.copy_clipboard;let a=e._contents.textContent;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}if(e.button==="false"){let e=WH.ce("span",{className:"tip"},WH.ct(a));WH.clickToCopy(e,a);return e}let i=WH.ce("button",{className:"btn btn-site fa fa-clipboard",type:"button"},WH.ct(t));if(e.size!=="large"){i.classList.add("btn-small")}WH.aE(i,"click",(()=>{WH.copyToClipboard(a);i.classList.remove("fa-clipboard");i.classList.add("fa-check");setTimeout((()=>{i.classList.remove("fa-check");i.classList.add("fa-clipboard")}),3*WH.Time.MS_SEC)}));return i}};WH.markup.tags["countdown-timer"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^\d+$/}},toNode:function(e){const t=WH.Gatherer.get(WH.Types.COUNTDOWN_TIMER,e.unnamed);if(!t?.targetTime){return WH.ce("div",{className:"q10"},WH.ct(`Countdown timer ${e.unnamed} not found!`))}const a=t.endTime*WH.Time.MS_SEC;if(a<WH.getServerTime().valueOf()){return document.createDocumentFragment()}const i=WH.ce("div",{className:"exclude-units"});WH.React.loadComponentCss("Countdown",(()=>{WH.React.initComponent(i,"modules/countdown/Countdown",{countdownLabel:t.countdownLabel,launchId:t.launchId,launchLabel:t.launchLabel,targetDate:t.targetTime*WH.Time.MS_SEC,themeColor:t.themeColor,url:t.url})}));return i}};WH.markup.tags.countdown={empty:true,attr:{bg:{req:true,valid:/^(https?:)?\/\/[^\/]+\/.+/},time:{req:true,valid:/^[A-Za-z0-9 :,-]+$/},text:{req:false,valid:/.*/},completion:{req:false,valid:/.*/},url:{req:false,valid:/^(https?:)?\/\/[^\/]+\/.+/}},toNode:function(e){var t=WH.ce("div",{className:"exclude-units"});var a={element:t,bg:e.bg,completionText:e.completion,time:e.time};if(e.text){a.text=e.text}if(e.url){a.url=e.url}WH.countdownClock(a);return t}};WH.markup.tags["cta-button"]={allowedClass:WH.markup.CLASS.STAFF,empty:false,helpText:"[cta-button=https://www.google.com border=strong class=c3]"+WH.TERMS.text+"[/cta-button]",attr:{unnamed:{req:false,valid:/\S+/},color:{req:false,valid:/\S+/},colortext:{req:false,empty:true},colorborder:{req:false,empty:true},game:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},disabled:{req:false,valid:/^true$/},guide:{req:false,valid:/^\d+$/},hash:{req:false,valid:/\S+/},onclick:{req:false,valid:/[\S ]+/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/},symbol:{req:false,valid:/\S+/},zoom:{req:false,empty:true},border:{req:false,valid:/^(strong|none)$/},style:{req:false,valid:/^[^"<>]+$/},rel:{req:false,valid:/\S+/}},validate:function(e){return WH.markup.tags.url.validate(e)},toNode:function(e){const t=WH.Game;const a=WH.Wow.PlayerClass;const{_textContents:i,color:n,disabled:s,guide:r,hash:o,newwindow:l,onclick:c,style:u,colortext:d,colorborder:f,tooltip:h,tooltip2:p,symbol:m,zoom:H,unnamed:g}=e;const W={style:"cta"};if(l){W.target="_blank"}if(g||r||o){const t=WH.markup.tags.url.getUrl(e);if(t){W.href=t}}if(c&&WH.markup.tags.url.validate(e)){W.clickHandler=c}if(i){W.label=" "}const{dataEnv:E}=WH.markup.getDatabaseDomainInfo(e);let _=t.getByEnv(E);if(!_){WH.warn('Invalid game provided in cta-button markup for "'+e.icon+'" icon: '+e.game);_=t.WOW;e.icon=WH.Icon.UNKNOWN}const T=WH.qs(".guide-content");let v;if(n){if(_===t.WOW){v=WH.Wow.PlayerClass.getBySlug(n,E)&&n}else if(_===t.D4){const e=new WH.D4.PlayerClass(E);v=e.fromIdString(n)&&n}}else if(a.getBySlug(T?.dataset?.class)!==undefined){v=T?.dataset?.class}const S=n||e.class;W["data-variation"]=S;const b=S?.match(/^c(\d+)$/);const y=b&&a.getSlug(parseInt(b[1],10));if(y||v){const e=y||v;W["data-variation"]=`${t.getKey(_)}-${e}`}else if(!(y||v)){const e=S?.match(/^(q|d4-q)(\d+)/);if(e){const a=e[1];const i=e[2];let n;let s;if(a==="q"){n=WH.Wow.Item.getQualitySlug(i);s=t.getKey(t.WOW)}else if(a==="d4-q"){n=WH.D4.Item.Quality.getSlug(i);s=t.getKey(t.D4)}W["data-variation"]=`${s}-${n}`}}const I=S||y||u;if(f!=null){if(I){W["data-border-color"]="true"}}else if(d!=null){if(I){W["data-text-color"]="true"}}if(e.icon){const a=t.getEnv(_);W.label=i;if(e.icon.includes("fa-")){const t=e.icon.replace(/^fa-/,"");W.iconConfig={faIcon:{prefix:"fas",name:t}}}else{W.iconConfig={iconUrl:WH.Icon.getIconUrl(e.icon,WH.Icon.MEDIUM,a)}}}if(m){W.label=i;W["data-symbol"]="true";const t=WH.markup.tags.symbol.toNode({site:e.site,domain:e.domain,unnamed:m});if(t?.classList?.contains("markup-symbol")){W.iconConfig={iconUrl:t.style.backgroundImage.replace(/^url\("?(.*?)"?\)$/,"$1")}}if(H!=null){W["data-enlarge-symbol"]="true"}}if(s){W.disabled=true}const A=new WH.Button(W);const R=A.getElement();if(h){WH.markup.attachMarkupTooltip(R,h,p)}return R}};WH.markup.tags.currency={entityType:WH.Types.CURRENCY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},amount:{req:false,valid:/^[0-9\:]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=WH.markup.entityTagToNode(WH.Types.CURRENCY,e);if(t.dataset.markupTooltipContainer){return t}var a=t.querySelector(".tinyicontxt");if(a){t.classList.add("q1")}if(e.amount){if(a){var i=t.textContent;t.classList.add("tip");WH.aE(t,"mouseover",(function(e){WH.Tooltips.showAtCursor(e,i,"q1")}));WH.aE(t,"mousemove",WH.Tooltips.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltips.hide);WH.st(t.querySelector(".tinyicontxt")||t,e.amount.split(":").join(" - "));var n=t.querySelector("img");if(n){t.style.backgroundImage="url("+n.src+")";t.classList.remove("icontiny");t.classList.add("icontinyr");n.parentNode.removeChild(n)}}else{WH.ae(t,WH.ct(WH.TERMS.wordspace_punct+"x"+e.amount.split(":").join(" - ")))}}else{var s=WH.ce("span");while(t.hasChildNodes()){WH.ae(s,t.firstChild)}WH.ae(t,s)}return t},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CURRENCY)};WH.markup.tags["d2-skill-calc"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/},order:{req:false,valid:/^true|false$/}},toNode:function(t){let a=WH.ce("div",{className:"diablo-2-skill-calc-markup exclude-units"});let i={embedded:true,hash:t.unnamed,editable:t.editable==="true",order:t.order!=="false"};let n=function(){new WH.D2.SkillCalc(a,i)};if(!WH.D2.hasOwnProperty("SkillCalc")){e.push(n);if(e.length===1){WH.loadAssets("diablo-2-skill-calc",(function(){let t;while(t=e.shift()){t()}}))}}else{n()}return a}}}();WH.markup.tags["d2-tooltip"]=function(){return{empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{float:{req:false,valid:/^(left|right)$/i},style:{req:false,valid:/^[^"<>]+$/}},toNode:function(e){let t=WH.ce("span",{className:"d2tt exclude-units"});if(e["float"]){t.classList.add("markup-float-"+e["float"])}WH.markup.applyCommonAttributes(t,e);WH.Fonts.load(WH.Game.D2);return t}}}();{let e=WH.markup.entityTag(WH.Types.D4_AFFIX,{icons:true});let t=e.toNode;let a=e.toText;e.attr.description={req:false,empty:true};e.toNode=(e,a,i)=>{if(e.description==null){return t(e,a,i)}let n=parseInt(e.unnamed);let s=WH.markup.getDatabaseDomainInfo(e);let r=WH.Gatherer.get(WH.Types.D4_AFFIX,n,s.dataEnv);let o=WH.ce("span");if(r){let e=(r.tooltipLines||[]).join(WH.TERMS.wordspace_punct);if(e){o.innerHTML=e}else{WH.st(o,r.displayName||r[s.nameKey]||r.name)}}else{WH.st(o,WH.Entity.getUnknownName(WH.Types.D4_AFFIX,n))}return o};e.toText=e=>{if(e.description==null){return a(e)}let t=parseInt(e.unnamed);let i=WH.markup.getDatabaseDomainInfo(e);let n=WH.Gatherer.get(WH.Types.D4_AFFIX,t,i.dataEnv);if(n){let e=(n.tooltipLines||[]).join(WH.TERMS.wordspace_punct);if(e){return WH.ce("div",{innerHTML:e}).textContent}else{return n.displayName||n[i.nameKey]||n.name}}else{return WH.Entity.getUnknownName(WH.Types.D4_AFFIX,t)}}}WH.markup.entityTag(WH.Types.D4_ASPECT,{icons:true});WH.markup.entityTag(WH.Types.D4_BOSS_POWER);WH.markup.tags["d4-build"]=(()=>{const e=WH.Gatherer;const t=WH.Types;return{empty:true,allowedParents:{builds:1},attr:{board:{req:false,valid:WH.markup.regex.isInt},header:{req:false,valid:/^(true|false)$/},points:{req:false,empty:true},sections:{req:false,valid:WH.markup.regex.anyChars},summary:{req:false,empty:true},tab:{req:false,valid:/^.+$/},tree:{req:false,empty:true},unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/}},toNode:a=>{let i={buildId:a.unnamed,requiresOrder:false,shownSections:[],tab:a.tab,type:"d4-build"};if(a.header){i.header=a.header!=="false"}if(a.sections){i.sections=a.sections}if(a.board){i.board=a.board}if(a.points!=null){i.shownSections.push("points");i.requiresOrder=a.points==="order"}a.tree!=null&&i.shownSections.push("tree");a.summary!=null&&i.shownSections.push("summary");const n=e.get(t.D4_BUILD,a.unnamed);i.hash=n.hash;i.draft=n.draft??false;i.name=n[`name_${Locale.getName()}`];const s=WH.ce("section",{className:"exclude-units"});s.whMarkupInfo=i;return s}}})();WH.markup.entityTag(WH.Types.D4_CHAOS_PERK);WH.markup.entityTag(WH.Types.D4_HORADRIC_COMPONENT);WH.markup.tags["d4-item"]={entityType:WH.Types.D4_ITEM,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},affixes:{req:false,valid:/^\d+(:\d+)*$/},"greater-affixes":{req:false,valid:/^\d+(:\d+)*$/},"item-power":{req:false,valid:/^\d+$/},masterworking:{req:false,valid:/^\d+(:\d+)*$/},upgrades:{req:false},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},tooltip:{req:false,empty:true}},validate:e=>!((e.domain||e.site)&&WH.markup.dbPage),toNode:(e,t)=>{const a=WH.Gatherer;const i=WH.Types;let n=[];if(e.affixes!=null){n.push(`affixes=${e.affixes}`)}if(e["greater-affixes"]!=null){n.push(`greaterAffixes=${e["greater-affixes"]}`)}if(e["item-power"]!=null){n.push(`itemPower=${e["item-power"]}`)}if(e.masterworking!=null){n.push(`masterworking=${e.masterworking}`)}let s=WH.markup.entityTagToNode(i.D4_ITEM,e,t,n);if(e.affixes!=null&&(e.icon??"false")==="false"){let t=a.get(i.D4_ITEM,e.unnamed);let n=e.affixes.split(":").map((e=>a.get(i.D4_AFFIX,parseInt(e)))).filter(Boolean);let r=t&&WH.D4.Item.getModifiedName(t,n);if(r){(WH.qs("span",s)||s).innerHTML=r}}if(s.dataset.markupTooltipContainer){return s}return s},toText:e=>WH.markup.entityTagToText(WH.Types.D4_ITEM,e)};WH.markup.tags["d4-paragon-calc"]=function(){return{empty:true,allowedParents:{builds:1},attr:{tab:{req:false,valid:/^.+$/},unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/},board:{req:false,valid:WH.markup.regex.isInt}},toNode:e=>{let t={hash:e.unnamed,tab:e.tab,type:"d4-paragon-calc"};if(e.board){t.board=e.board}const a=WH.ce("section",{className:"exclude-units"});a.whMarkupInfo=t;return a}}}();WH.markup.tags["d4-paragon-glyph"]={entityType:WH.Types.D4_PARAGON_GLYPH,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},tempname:{req:false},tooltip:{req:false,empty:true},desc:{req:false,empty:true}},validate:function(e){return!((e.domain||e.site)&&WH.markup.dbPage)},toNode:e=>{const t=WH.Types.D4_PARAGON_GLYPH;if(e.desc!=null){const a=parseInt(e.unnamed);const i=WH.Gatherer.get(t,a,WH.markup.getDataEnvFromSiteAttr(e.site));const n=i?.[`description_`+Locale.getName()];return n?WH.ce("span",{innerHTML:n}):WH.ct(WH.Entity.getPlaceholderName(t,a,WH.TERMS.description))}return WH.markup.entityTagToNode(t,e)},toText:e=>{const t=WH.Types.D4_PARAGON_GLYPH;if(e.desc!=null){const a=parseInt(e.unnamed);const i=WH.Gatherer.get(t,a,WH.markup.getDataEnvFromSiteAttr(e.site));const n=i?.[`description_`+Locale.getName()];return n?WH.ce("span",{innerHTML:n}).innerText:WH.Entity.getPlaceholderName(t,a,WH.TERMS.description)}return WH.markup.entityTagToText.bind(t,e)}};WH.markup.tags["d4-paragon-node"]={entityType:WH.Types.D4_PARAGON_NODE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},tempname:{req:false},tooltip:{req:false,empty:true},desc:{req:false,empty:true}},validate:function(e){return!((e.domain||e.site)&&WH.markup.dbPage)},toNode:e=>{const t=WH.Types.D4_PARAGON_NODE;if(e.desc!=null){const a=parseInt(e.unnamed);const i=WH.Gatherer.get(t,a,WH.markup.getDataEnvFromSiteAttr(e.site));const n=i?.[`description_`+Locale.getName()];return n?WH.ce("span",{innerHTML:n}):WH.ct(WH.Entity.getPlaceholderName(t,a,WH.TERMS.description))}return WH.markup.entityTagToNode(t,e)},toText:e=>{const t=WH.Types.D4_PARAGON_NODE;if(e.desc!=null){const a=parseInt(e.unnamed);const i=WH.Gatherer.get(t,a,WH.markup.getDataEnvFromSiteAttr(e.site));const n=i?.[`description_`+Locale.getName()];return n?WH.ce("span",{innerHTML:n}).innerText:WH.Entity.getPlaceholderName(t,a,WH.TERMS.description)}return WH.markup.entityTagToText.bind(t,e)}};WH.markup.entityTag(WH.Types.D4_SENESCHAL_STONE);WH.markup.tags["d4-skill-tree"]=function(){return{empty:true,allowedParents:{builds:1},attr:{summary:{req:false,empty:true},points:{req:false,empty:true},tab:{req:false,valid:/^.+$/},tree:{req:false,empty:true},unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/}},toNode:e=>{let t={hash:e.unnamed,shownSections:[],type:"d4-skill-tree",tab:e.tab,requiresOrder:false};if(e.points!=null){t.shownSections.push("points");t.requiresOrder=!!(e.points&&e.points==="order")}e.tree!=null&&t.shownSections.push("tree");e.summary!=null&&t.shownSections.push("summary");const a=WH.ce("section",{className:"exclude-units"});a.whMarkupInfo=t;return a}}}();WH.markup.tags["d4-skill"]={entityType:WH.Types.D4_SKILL,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},enchant:{req:false,empty:true},tempname:{req:false},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},mod:{req:false,valid:/^\d+$/},mods:{req:false,valid:/^\d+(:\d+)*$/},rank:{req:false,valid:/^\d+$/},tooltip:{req:false,empty:true}},validate:function(e){return!((e.domain||e.site)&&WH.markup.dbPage)},toNode:(e,t)=>{let a=[];if(e.mod!=null){a.push("mod="+e.mod)}else if(e.mods!=null){a.push("mods="+e.mods)}if(e.rank!=null){a.push("rank="+e.rank)}let i=WH.markup.entityTagToNode(WH.Types.D4_SKILL,e,t,a);const n=Locale.getId();const s=WH.Gatherer.get(WH.Types.D4_SKILL,parseInt(e.unnamed),WH.markup.getDataEnvFromSiteAttr(e.site));if(e.enchant!=null){i.dataset.wowhead="buff";if(s){WH.st(WH.qs("span",i)||i,s.enchantmentNames[n]||s.name)}}if(i.dataset.markupTooltipContainer){return i}if(e.mod!=null){if(i.dataset.type==="d4-skill"){i.dataset.skillType="upgrade"}WH.qsa('[data-type="d4-skill"]',i).forEach((e=>e.dataset.skillType="upgrade"));if(i.textContent!==""){if(s){let t=((s.mods||{})[n]||{})[e.mod];if(t!=null){WH.st(WH.qs("span",i)||i,t)}}}}return i},toText:e=>{if(e.mod!=null){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.Gatherer.get(WH.Types.D4_SKILL,parseInt(e.unnamed),t.dataEnv);if(a){let i=t.localeId??Locale.getId();let n=((a.mods||{})[i]||{})[e.mod];if(n!=null){return WH.markup.getEscapedHtml(n)}}}return WH.markup.entityTagToText(WH.Types.D4_SKILL,e)}};WH.markup.entityTag(WH.Types.D4_VAMPIRIC_POWER);WH.markup.entityTag(WH.Types.D4_WITCH_POWER);WH.markup.tags["d4-world-bosses"]={empty:true,attr:{},toNode:function(e){let t=WH.getPageData("markup.d4WorldBosses.spawns");let a=WH.ce("div");WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.noDataFound_tip));if(!t){return a}let i=WH.ce("div",{className:"d4-world-bosses-spawns exclude-units"});let n=WH.ce("ul");WH.ae(i,n);t.forEach((e=>{let t=new Date(e.active*WH.Time.MS_SEC);let a=t.toLocaleString(undefined,{month:"long",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"});WH.ae(n,WH.ce("li",{},WH.ct(`${a}`)))}));return i}};WH.markup.tags.db={empty:true,attr:{unnamed:{req:true,valid:/^(live|ptr|ptr2|beta|classic|classicptr|tbc|bc|mop|wod|legion|bfa|shadowlands|sl|d2|di|d4|wrath|wotlk|cata|mists|d4ptr|d4beta)$/}},toNode:function(e){WH.markup.setDataEnv(e.unnamed);return null},toText:function(e){WH.markup.setDataEnv(e.unnamed);return""}};WH.markup.tags.del={empty:false,attr:{copy:{req:false,valid:/^true$/}},toNode:function(e){var t=WH.ce("del");t.className="diffmod";WH.markup.applyCommonAttributes(t,e);if(!e.copy){t.setAttribute("unselectable","on")}return t}};WH.markup.entityTag(WH.Types.DI_EQUIP_ITEM,{icons:true});WH.markup.entityTag(WH.Types.DI_MISC_ITEM,{icons:true});WH.markup.entityTag(WH.Types.DI_NPC);WH.markup.entityTag(WH.Types.DI_OBJECT);WH.markup.tags["di-paragon-skill-calculator"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/}},toNode:function(t){let a=WH.ce("div",{className:"di-paragoncalc-shell-markup exclude-units"});let i={editable:t.editable==="true",embedded:true,hash:t.unnamed};let n=function(){new WH.DI.ParagonCalc.Shell(a,i)};if(!WH.DI.ParagonCalc||!WH.DI.ParagonCalc.Shell){e.push(n);if(e.length===1){WH.loadAssets("di-paragon-skill-calc",(()=>{let t;while(t=e.shift()){t()}}))}}else{n()}return a}}}();WH.markup.entityTag(WH.Types.DI_PARAGON_SKILL,{icons:true});WH.markup.entityTag(WH.Types.DI_QUEST);WH.markup.entityTag(WH.Types.DI_SET);WH.markup.entityTag(WH.Types.DI_SKILL,{icons:true});WH.markup.entityTag(WH.Types.DI_ZONE);WH.markup.tags["display-group"]={empty:false,attr:{"enable-options":{req:false,valid:/\S+/},color:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},unnamed:{req:true,valid:/\S+/}},toNode:function(e){const t=WH.markup.DisplayOptions;const a=this.createGroupButton(e);t.registerGroup({"enable-options":e["enable-options"],element:a,name:e.unnamed});return a},disable:e=>{e.dataset.groupActive=false;delete e.dataset.active},enable:e=>{e.dataset.groupActive=true;e.dataset.active=true;setTimeout((()=>delete e.dataset.active),1e3)},createGroupButton:function(e){const t=WH.Game;const a=WH.Icon;const{icon:i,_textContents:n}=e;let{color:s}=e;const{dataEnv:r}=WH.markup.getDatabaseDomainInfo(e);const o={iconConfig:i?{iconUrl:a.getIconUrl(i,a.MEDIUM,r)}:undefined,label:n??null,style:"cta"};s??=WH.qs(".guide-content")?.dataset?.class;if(s){const e=t.getByEnv(r);let a;if(e===t.WOW){a=WH.Wow.PlayerClass.getBySlug(s,r)}else if(e===t.D4){const e=new WH.D4.PlayerClass(r);a=e.fromIdString(s)}if(a){o["data-variation"]=`${t.getKey(e)}-${s}`}}const l=new WH.Button(o);return l.getElement()}};WH.markup.tags["display-option"]={empty:false,attr:{checked:{req:false,empty:true},color:{req:false,valid:/\S+/},group:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},radio:{req:false,valid:WH.markup.regex.anyChars},unnamed:{req:true,valid:/\S+/}},toNode:function(e){const{checked:t,group:a,radio:i,unnamed:n}=e;const s=WH.markup.DisplayOptions;const r=this.createOptionButton(e);s.registerOption({active:t!=null,containerName:n,element:r,groupName:a??null,radioName:i});return r},disable:e=>{e.dataset.checked=false;delete e.dataset.active},enable:e=>{e.dataset.checked=true;e.dataset.active=true},toggle:e=>{const t=e.dataset.checked!=="true";e.dataset.checked=t;return t},createOptionButton:function(e){const t=WH.Game;const a=WH.Icon;const{checked:i,icon:n,_textContents:s}=e;let{color:r}=e;const{dataEnv:o}=WH.markup.getDatabaseDomainInfo(e);const l={"data-checked":i!=null?true:undefined,iconConfig:n?{iconUrl:a.getIconUrl(n,a.MEDIUM,o)}:undefined,label:n?s:undefined,style:"cta"};r??=WH.qs(".guide-content")?.dataset?.class;if(r){const e=t.getByEnv(o);let a;if(e===t.WOW){a=WH.Wow.PlayerClass.getBySlug(r,o)}else if(e===t.D4){const e=new WH.D4.PlayerClass(o);a=e.fromIdString(r)}if(a){l["data-variation"]=`${t.getKey(e)}-${r}`}}const c=new WH.Button(l);return c.getElement()}};WH.markup.tags.div={empty:false,block:true,ltrim:true,rtrim:true,itrim:true,attr:{clear:{req:false,valid:/^(left|right|both)$/i},"display-options":{req:false,valid:WH.markup.regex.anyChars},"display-options-dim":{req:false,empty:true},unnamed:{req:false,valid:/^hidden$/i},float:{req:false,valid:/^(left|right)$/i},align:{req:false,valid:/^(left|right|center)$/i},margin:{req:false,valid:/^\d+$/},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");if(e.clear){t.style.clear=e.clear}if(e.unnamed){t.style.display="none"}if(e.width){t.style.width=e.width;t.style.maxWidth="100%"}if(e["float"]){t.className+=" markup-float-"+e["float"]}if(e.align){t.style.textAlign=e.align}if(e.margin){t.style.margin=e.margin+"px"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}t.className=t.className.replace(/^ +/,"");WH.markup.applyCommonAttributes(t,e);if(e["display-options"]){const a=WH.markup.DisplayOptions;a.registerContainer({dim:e["display-options-dim"]!=null,displayOptions:e["display-options"],element:t})}return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<div\\b[\\s\\S]*?>","</div>","g")){for(var i=0;i<a.length;++i){var n=a[i][1].match(/float:\s*(left|right)"/i),s=a[i][1].match(/width[:="]+\s*([0-9]+)/i);e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[div"+(n?" float="+n[1]:"")+(s?" width="+s[1]:"")+"]"+WH.markup.tags.div.fromHtml(a[i][0],t+1)+"[/div]")}}return e}};WH.markup.tags["dps-rankings"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[a-z0-9-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.getDataTree(t.dataEnv);let i=WH.getPageData(["markup.dpsRankings",a,e.unnamed].join("."));return!!i},toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.getDataTree(t.dataEnv);let i=a===WH.dataTree.CLASSIC?"classic.warcraftlogs.com":"www.warcraftlogs.com";let n=WH.getPageData(["markup.dpsRankings",a,e.unnamed].join("."));let s=n.data;let r=n.info;let o=document.createDocumentFragment();if(r){WH.ae(o,WH.ce("div",{className:"exclude-units",style:{fontSize:"90%"}},WH.ct(r)))}var l=WH.ce("div",{className:"highchart bar highcharts-wowhead-style exclude-units"});WH.ae(o,l);WH.Tools.Highcharts.loadScript((function(){var e={credits:{href:"https://"+i+"/",text:WH.TERMS.warcraftlogs_site},chart:{type:"bar",height:Math.max(400,Math.min(600,s.length*30)),styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var e=Math.ceil(Math.min(2,Math.max(0,4-Math.log10(this.y))));var t=WH.ce("div");WH.ae(t,WH.ct(this.x+WH.TERMS.colon_punct));WH.ae(t,WH.ce("b",{},WH.ct(WH.Strings.formatNumber(this.y,false,e,e))));WH.ae(t,WH.ct(WH.TERMS.wordspace_punct+WH.GlobalStrings.DPS));return t.innerHTML},useHTML:true},series:[{data:[]}]};s.sort((function(e,t){return t.dps-e.dps}));for(var t,n=0;t=s[n];n++){var r=WH.Wow.PlayerClass.getName(t.classId);if(t.spec==="DPS"){r=WH.Strings.sprintf(WH.TERMS.dpsRoleClass_format,r)}else{r=WH.Strings.sprintf(WH.TERMS.specclass_format,a===WH.getDataTree()?WH.Wow.PlayerClass.Specialization.getName(t.specId):t.spec,r)}e.xAxis.categories.push(r);var o={id:r,y:t.dps,colorIndex:"c"+t.classId};e.series[0].data.push(o)}Highcharts.chart(l,e)}));return o}};WH.markup.tags["dragonflight-talent-calc"]=function(){let e={};return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/},editable:{req:false,valid:/^true|false$/},heading:{req:false,valid:/^true|false$/},"max-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},tree:{req:false,valid:/^class|spec|hero$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);let i=t.dataEnv||a.dataEnv;let n=t["max-width"]||(t.tree?"600px":"1220px");if(/^\d+$/.test(n)){n=`${n}px`}let s=WH.ce("div",{className:"dragonflight-talent-markup dragonflight-talent-embed exclude-units",style:{margin:"0 auto",maxWidth:n}});let r={dataEnv:i,editable:t.editable==="true",embedded:true,fixedSize:t.hasOwnProperty("max-width"),hash:t.unnamed,titleBar:t.heading!=="false",tree:t.tree};let o=t.unnamed.indexOf("/")<=0;let l="TalentCalcDragonflight"+(o?"Manual":"");let c=function(){try{WH.DOM.setData(s,"talentCalc",new WH.Wow[l](s,r))}catch(e){WH.error({message:"Unable to create talent calc",options:r,error:e})}};if(!WH.Wow[l]||!o&&!WH.Wow[l].isReady(i)){let t=l+"."+i;e[t]=e[t]||[];e[t].push(c);if(e[t].length===1){WH.loadAssets("dragonflight-talent-calc"+(o?"-manual":""),(()=>{let a;while(a=e[t].shift()){a()}}),i)}}else{c()}return s}}}();WH.markup.tags["entity-list-toggle-option-selector"]={empty:true,attr:{category:{req:true,valid:WH.markup.regex.anyChars},group:{req:true,valid:WH.markup.regex.anyChars},icon:{req:false,valid:/^[a-z0-9 _-]+$/i},unnamed:{req:true,valid:/[\S ]+/}},toNode:e=>{const t=WH.Icon;const a=WH.Wow.PlayerClass;const i=WH.Wow.PlayerClass.Specialization;const n=WH.Game;const s="cta-button";const r="entity-list-toggle-option-selector clicked";const{category:o,group:l}=e;const c={buttonType:"toggler",entityListCategory:o,entityListGroup:l};const u=WH.ce("button",{className:`${s}`,dataset:c});WH.ae(u,WH.ce("span",{className:`${s}-text`},WH.ce("span",{className:`${s}-text-content`},WH.ct(e.unnamed))));const d=()=>{let t=e?.icon;if(t){return t}if(n.get()===n.WOW){const e=WH.qs(".guide-content");const t=e?.dataset.class;if(t){const n=e.dataset.spec;return n?i.getIconName(i.getBySlug(t,n)):a.getIconName(a.getBySlug(t))}}return n.getWowIconName(n.get())};u.style.backgroundImage=`url(${t.getIconUrl(d())})`;WH.aE(u,"click",(()=>{WH.qsa(`button[data-entity-list-category="${o}"]`).forEach((e=>e!==u&&delete e.dataset.state));u.dataset.state?delete u.dataset.state:u.dataset.state="active";u.dispatchEvent(new CustomEvent(r,{detail:u.dataset}))}));return u}};WH.markup.tags["entity-list-toggle-option"]={empty:false,attr:{checked:{req:false,empty:true},disable:{req:false,valid:WH.markup.regex.anyChars},"disable-requires":{req:false,valid:WH.markup.regex.isInt},enable:{req:false,valid:WH.markup.regex.anyChars},"enable-requires":{req:false,valid:WH.markup.regex.isInt},hide:{req:false,valid:WH.markup.regex.anyChars},"hide-requires":{req:false,valid:WH.markup.regex.isInt},show:{req:false,valid:WH.markup.regex.anyChars},"show-requires":{req:false,valid:WH.markup.regex.isInt},group:{req:false,valid:WH.markup.regex.anyChars},icon:{req:false,valid:/\S+/}},toNode:function(e){const t=WH.Icon;if(!e.show&&!e.hide&&!e.enable&&!e.disable&&!e.group){return WH.ce("div",{style:{display:"none"}})}const a=WH.ce(e.icon?"button":"div",{className:"entity-list-toggle-option",dataset:{startChecked:`${e.checked!=null}`},id:WH.Strings.guid()});if(e.icon){a.dataset.buttonType="toggler";a.classList.add("cta-button");WH.ae(a,WH.ce("span",{className:"cta-button-text"},WH.ce("span",{className:"cta-button-text-content"})));const i=WH.qs(".guide-content");const n=i?.dataset.class;if(n){a.dataset.class=n}a.style.backgroundImage=`url(${t.getIconUrl(e.icon)})`}WH.preventSelectStart(a);["show","hide","enable","disable"].forEach((function(t){let i=WH.ucfirst(t);if(e[t]){a.dataset["entityList"+i]=e[t];if(e[t+"-requires"]){a.dataset["entityList"+i+"Requires"]=e[t+"-requires"]}}}));if(e.group){a.dataset.entityListGroup=e.group}WH.markup.applyCommonAttributes(a,e);return a}};WH.markup.tags["entity-list-toggle"]=new function(){this.block=true;this.empty=false;this.ltrim=true;this.rtrim=true;this.itrim=true;this.attr={for:{req:true,valid:/.+/},grid:{req:false,empty:true}};this.toNode=function(t){let i=WH.ce("div",{className:"entity-list-toggle"});i.setAttribute("data-initialized","false");i.dataset["for"]=t["for"];let n=WH.ce("div",{className:"entity-list-toggle-controls"});WH.ae(i,n);if(t.grid!=null){n.classList.add("markup-grid")}WH.markup.applyCommonAttributes(i,t);clearTimeout(e.initTimer);e.initTimer=setTimeout(a,0);return i};const e={initTimer:undefined};function t(e,t){let a=t.id+"-requirement";let i=WH.qs("#"+a,e);if(!i){e.dataset.hasRequirements="true";let n=WH.qs(".entity-list-item-requirement-set",e);if(n){WH.ae(n,WH.ct(WH.TERMS.comma_punct))}else{n=WH.ce("span",{className:"entity-list-item-requirement-set"});let t=WH.ce("div",{className:"entity-list-item-requirement"});WH.aef(e,t);WH.Strings.sprintf(WH.GlobalStrings.SPELL_FAILED_REQUIRES_SPELL_FOCUS,"|").split("|").forEach((function(e,a){if(e){WH.ae(t,WH.ct(e))}if(a===0){WH.ae(t,n)}}))}i=WH.ce("span",{id:a,innerHTML:t.innerHTML});WH.ae(n,i)}}function a(){$('.entity-list-toggle[data-initialized="false"] .entity-list-toggle-controls').each((function(){let e=this;let t=this.parentNode;WH.qsa(".entity-list-toggle-option",e).forEach((function(e){e.classList.add("fa");e.classList.add("fa-fw");WH.aE(e,"click",(()=>{const a=e.closest(".entity-list-toggle")?.dataset["for"];if(a){WH.qsa(`.cta-button[data-state="active"][data-entity-list-category="${a}"]`).forEach((e=>delete e.dataset.state))}i(t,e,false)}));let a=e;while(a=a.parentNode?.closest(".entity-list-toggle-option")){a.dataset.hasNestedOptions=`${true}`}i(t,e,true);WH.qsa("a",e).forEach((function(e){WH.aE(e,"click",(function(e){e.preventDefault()}))}));WH.aE(window,"entity-list-toggle-option-selector clicked",(a=>{const n=a.detail;if(!n.state){return}const s=WH.Strings.splitCsv(e.dataset.entityListGroup);const r=e.dataset.checked!=="true"&&s.includes(n.entityListGroup);const o=e.dataset.checked==="true"&&n.entityListCategory===t.dataset["for"]&&!s.includes(n.entityListGroup);if(r||o){i(t,e,false)}}),{capture:true})}));t.setAttribute("data-initialized","true")}))}function i(e,t,a,i){if(i){i.preventDefault()}let s=WH.ge(e.dataset["for"]);if(!s){WH.error("No target wrapper for entity list toggler.",e);return}let r={enabled:{on:t.dataset.entityListEnable?WH.Strings.splitCsv(t.dataset.entityListEnable):[],off:t.dataset.entityListDisable?WH.Strings.splitCsv(t.dataset.entityListDisable):[],onRequires:parseInt(t.dataset.entityListEnableRequires),offRequires:parseInt(t.dataset.entityListDisableRequires)},shown:{on:t.dataset.entityListShow?WH.Strings.splitCsv(t.dataset.entityListShow):[],off:t.dataset.entityListHide?WH.Strings.splitCsv(t.dataset.entityListHide):[],onRequires:parseInt(t.dataset.entityListShowRequires),offRequires:parseInt(t.dataset.entityListHideRequires)}};if(a===true&&t.dataset.startChecked!=="true"||t.dataset.checked==="true"){t.dataset.checked="false";r.checked=false}else{t.dataset.checked="true";r.checked=true}n(s,t,a,r,"enabled","on");n(s,t,a,r,"enabled","off");n(s,t,a,r,"shown","on");n(s,t,a,r,"shown","off")}function n(e,a,i,n,s,r){let o=n[s].onRequires;let l=n[s].offRequires;let c=r==="on"?o:l;let u="entityListItem"+WH.ucfirst(s);n[s][r].forEach((d=>{let f=isNaN(d)?WH.qs(`:scope > [data-entity-list-item-target="${d}"]`,e):e.childNodes[d-1];if(!f){WH.warn(`Entity list toggle target [${d}] not found.`,"List:",e);return}if(i!==true){f.dataset.animate="true"}let h="entityListItemOnCount";let p="entityListItemOffCount";let m=r==="on"?h:p;let H=parseInt(f.dataset[m])||0;if(i!==true||n.checked){H+=n.checked?1:-1}f.dataset[m]=`${H}`;let g=parseInt(f.dataset[h]);let W=parseInt(f.dataset[p]);let E=isNaN(g)?null:o?g===o:g>0;let _=isNaN(W)?null:l?W===l:W>0;if(c){if(f.dataset[u+"Method"]==="direct"){return}}else{f.dataset[u+"Method"]="direct"}switch(null){case E:f.dataset[u]=`${!_}`;break;case _:f.dataset[u]=`${E}`;break;default:f.dataset[u]=`${E||!_}`}if(s==="enabled"){t(f,a)}}))}};WH.markup.tags.event={entityType:WH.Types.EVENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.EVENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.EVENT)};WH.markup.tags.faction={entityType:WH.Types.FACTION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.FACTION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FACTION)};WH.markup.tags.feedback={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{mailto:{req:false,valid:/^true$/i}},toNode:function(e){var t=WH.ce("a",{href:"mailto:"+WH.Feedback.EMAIL_ADDR},WH.ct(WH.Feedback.EMAIL_ADDR));if(!e.mailto){t.href="javascript:";WH.aE(t,"click",(function(){ContactTool.show()}))}var a=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/email.gif)"}},t);return WH.ce("b",{},a)}};WH.markup.tags["filter-target"]={trim:true,itrim:true,attr:{unnamed:{req:true,valid:/\w+=\w+/}},toNode:function(e,t){let a={};e.unnamed.match(/\w+=\w+/g).forEach((e=>{let t=e.split("=");a[t[0]]=t[1]}));return WH.ce("div",{className:"markup-filter-target exclude-units",dataset:{active:"",target:JSON.stringify(a),markupTree:t.treeGuid}})}};WH.markup.tags.filter={trim:true,itrim:true,attr:{unnamed:{req:true,valid:/^\w+$/},group:{req:true,valid:/^\w+$/}},toNode:function(e,t){let a=t.treeGuid;let i=WH.ce("span",{className:"markup-filter",dataset:{active:"",target:e.unnamed,group:e.group,markupTree:a}});let n=()=>{let e=WH.qsa(`.markup-filter-target[data-markup-tree="${a}"]`);e.forEach((e=>{e.dataset.active="true";let t=JSON.parse(e.dataset.target);for(let[i,n]of Object.entries(t)){let t=WH.qs(`.markup-filter[data-markup-tree="${a}"][data-group="${i}"][data-target="${n}"]`);if(t&&t.dataset.active==="false"){e.dataset.active="false";break}}}))};let s=()=>{let e=i.dataset.group;let t=WH.qsa(`.markup-filter[data-markup-tree="${a}"][data-group="${e}"]`);t.forEach((e=>{if(e.dataset.active!=="true"){e.dataset.active="false"}}));if(i.dataset.active==="true"){i.dataset.active="false"}else{i.dataset.active="true"}let n=WH.qsa(`.markup-filter[data-markup-tree="${a}"][data-group="${e}"][data-active="true"]`).length;if(n===0){t.forEach((e=>{e.dataset.active=""}))}};WH.aE(i,"click",(()=>{s();n()}));return i}};WH.markup.tags.follower={entityType:WH.Types.FOLLOWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.FOLLOWER,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FOLLOWER)};WH.markup.tags.forumrules={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("a",{href:WH.Url.generatePath("/forums/topic/2")},WH.ct("forum rules"));var a=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/favicon.gif)"}},t);return WH.ce("b",{},a)}};WH.markup.tags.galleryupload={empty:false,allowedClass:WH.markup.CLASS.ADMIN,attr:{unnamed:{req:true,valid:/^[0-9]+$/},submittext:{req:false,valid:/.+/}},toNode:function(e){var t="";var a=document.createDocumentFragment();var i=WH.ce("form",{className:"exclude-units",method:"POST",action:"/gallery-upload",enctype:"multipart/form-data"});WH.aE(i,"submit",WH.markup.tags.galleryupload._validateForm.bind(null,i));WH.ae(a,i);WH.ae(a,WH.ce("div",{className:"exclude-units",dataset:{markupContentTarget:1},style:{display:"none"}}));WH.ae(i,WH.ce("input",{type:"hidden",name:"gallery",value:e.unnamed}));WH.ae(i,WH.ce("input",{type:"hidden",name:"message",value:""}));WH.ae(i,WH.ce("input",{type:"hidden",name:"from",value:location.pathname+location.search}));WH.ae(i,WH.ce("input",{type:"file",name:"incoming",accept:".jpg,.jpeg,.png,image/jpeg,image/png",required:true}));WH.ae(i,WH.ct(" "));WH.ae(i,WH.ce("button",{type:"submit",className:"btn btn-primary"},WH.ct(e.submittext||WH.TERMS.submit)));return a},_validateForm:function(e){var t=3;var a=e.incoming;if(!a||a.value==""){return false}if(a.files&&a.files.length){if(a.files.length>1){alert("Too many files");return false}if(a.files[0].size>t*1048576){alert(WH.TERMS.filesizelimit_format.replace("%d",t).replace("&gt;",">"));return false}}e.message.value=e.nextSibling.textContent;return true}};WH.markup.tags["gear-planner"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:{},toNode:function(e){const t=WH.dataTree;const a=WH.markup.getDatabaseDomainInfo(e);const i=a.dataEnv;const n=WH.getDataTree(i);const s=WH.markup.tags["gear-planner"].callbacks[i]??=[];if(![t.CLASSIC,t.TBC,t.WRATH,t.CATA,t.MISTS].includes(n)){return WH.ce("div",{className:"q10 exclude-units"},WH.ct("[gear-planner] "+WH.TERMS.errorClassicOnly_tip))}const r={[t.TBC]:"GearPlannerTbc",[t.WRATH]:"GearPlannerWrath"}[n]??"GearPlanner";const o=[WH.dataTree.CLASSIC,WH.dataTree.TBC,WH.dataTree.WRATH];let l=WH.ce("div",{className:"exclude-units"});if(!o.includes(n)){WH.loadAssets("gear-planner",(()=>WH.React.initComponent(l,"modules/gear-planner/GearPlanner",{embedHash:e.unnamed})),i)}else{const t=function(){new WH.Wow[r](l,{dataEnv:a.dataEnv,embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable==="true"})};if(!WH.Wow[r]){s.push(t);if(s.length===1){WH.loadAssets("gear-planner",(()=>{while(s.length){s.pop()()}}),i)}}else{t()}}return l}};WH.markup.tags["gear-set"]={entityType:WH.Types.GEAR_SET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=e.unnamed;var a=g_gearsets[t];let i=WH.Entity.getUrl(WH.Types.GEAR_SET,t,(a||{}).name);var n=WH.ce("a",{href:i,target:"_blank"});n.setAttribute("whattach","true");if(a){if(a["class"]){n.className="icontiny c"+a["class"];WH.ae(n,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(a["class"])+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(n,WH.ct(" "))}WH.ae(n,WH.ct(a.name))}else{WH.ae(n,WH.ct(WH.Types.getUpperSingular(WH.Types.GEAR_SET)+WH.TERMS.wordspace_punct+"#"+t))}return n}};WH.markup.tags["google-sheet"]={empty:true,attr:{unnamed:{req:true,valid:/^[a-zA-Z0-9_-]+$/}},libraryLoaded:false,toNode:function(e){var t=WH.Strings.guid();var a=e.unnamed;var i=document.createDocumentFragment();WH.ae(i,WH.ce("img",{src:WH.staticUrl+"/images/icons/ajax-medium-242424.gif",style:{margin:"0 5px 0 0",position:"relative",top:"-1px",verticalAlign:"middle",width:"16px"}}));WH.ae(i,WH.ct(WH.TERMS.loading_ellipsis));var n=WH.ce("div",{className:"exclude-units",id:t},i);n.dataset.loading=1;if(!WH.markup.tags["google-sheet"].libraryLoaded){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.3.4/tabletop.min.js");WH.markup.tags["google-sheet"].libraryLoaded=true}setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,n,a),0);return n},fetchSheet:function(e,t){if(typeof Tabletop==="undefined"){setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,e,t),50);return}Tabletop.init({key:t,callback:WH.markup.tags["google-sheet"].renderSheet.bind(null,e,t),simpleSheet:true});setTimeout(function(e,t){if(e.dataset.loading){WH.markup.tags["google-sheet"].renderError(e,t)}}.bind(null,e,t),5e3)},renderError:function(e,t){var a=document.createDocumentFragment();WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.googlesheeterror_tip));WH.ae(a,WH.ce("a",{href:"https://docs.google.com/spreadsheets/d/"+t,target:"_blank"},WH.ct(t)));delete e.dataset.loading;$(e).empty().append(a)},renderSheet:function(e,t,a,i){if(!i||!i.model_names||!i.model_names.length||!i.models||!i.models[i.model_names[0]]){WH.markup.tags["google-sheet"].renderError(e,t);return}var n={columns:[],searchable:true,filtrable:true,clickable:false};var s=i.models[i.model_names[0]].column_names;for(var r=0;r<s.length;r++){var o=s[r];if(!o){continue}n.columns.push({id:WH.Strings.slug(o),name:WH.deUrlize(o),type:"text",align:a[0][o].length>10?"left":"center",compute:function(e,t,a,i){if(t[e].length<=10){var n=WH.ce("span",{className:"no-wrap"});WH.st(n,t[e]);WH.ae(a,n)}else{WH.st(a,t[e])}}.bind(null,o),getVisibleText:function(e,t){return t[e]}.bind(null,o),sortFunc:function(e,t,a){return WH.stringCompare(t[e],a[e])}.bind(null,o)})}Listview.templates[e.id]=n;delete e.dataset.loading;e.className="listview";WH.ee(e);new Listview({template:e.id,id:e.id,parent:e.id,data:a})}};WH.markup.tags.grid={empty:false,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{align:{req:false,valid:/^centered$/},"column-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},"expand-columns":{req:false,valid:/^true$/},"no-margin":{req:false,valid:/^true$/},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:WH.markup.regex.cssUnitOrInt}},toNode:function(e){let t=WH.ce("div",{className:"markup-grid exclude-units"});if(e.align==="centered"){t.dataset.align="centered";if(e["column-width"]){setTimeout((()=>{t.childNodes.forEach((t=>{if(t.tagName!=="BR"){t.style.flexBasis=`${e["column-width"]}px`}}))}),0)}}else{if(e["column-width"]){if(/\d$/.test(e["column-width"])){e["column-width"]+="px"}const a="repeat(auto-fill, minmax("+e["column-width"]+", 1fr))";t.style.gridTemplateColumns=a;if(e["expand-columns"]&&e["column-width"].includes("px")){WH.DOM.bindBreakpoints(t,{"full-columns":parseInt(e["column-width"].replace("px","").trim(),10)})}}if(e.width){if(/\d$/.test(e.width)){e.width+="px"}t.style.maxWidth="100%";t.style.width=e.width}}if(e["no-margin"]!=null){t.dataset.marginType="hidden"}return t}};WH.markup.tags["guide-content"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){const t=WH.Types;let a=document.createDocumentFragment();let i=WH.Entity.getUrl(t.GUIDE,e.unnamed);WH.ae(a,WH.ct(WH.TERMS.openparenthesis_punct+WH.TERMS.content+WH.TERMS.colon_punct));WH.ae(a,WH.ce("a",{href:i,dataset:{entity:t.getStringId(t.GUIDE)}},WH.ct(t.getUpperSingular(t.GUIDE)+WH.TERMS.wordspace_punct+"#"+e.unnamed)));WH.ae(a,WH.ct(WH.TERMS.closedparenthesis_punct));return a}};WH.markup.tags["guide-hub-header"]=(()=>({empty:false,attr:{image:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:e=>{const t="guide-hub-header";WH.loadAssets(t);const a=WH.ce("div",{className:`${t} exclude-units`});const i=WH.ae(a,WH.ce("div",{className:`${t}-image`}));WH.ae(a,WH.ce("div",{className:`${t}-title`,dataset:{markupContentTarget:"1"}}));if(e.image){i.style.backgroundImage=`url(${e.image})`}WH.DOM.bindBreakpoints(a,{small:500});return a}}))();WH.markup.tags.guide={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.GUIDE),toText:function(e){var t=e.unnamed;var a="name";if(g_guides[t]&&g_guides[t][a]){return WH.markup.getEscapedHtml(g_guides[t][a])}return WH.Types.getUpperSingular(WH.Types.GUIDE)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags["guild-rankings"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/[a-z-]+/},raid:{req:true,valid:/[a-z-]+/},difficulty:{req:false,valid:/(normal|heroic|mythic)/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ce("h3",{className:"heading-size-2 guild-boss-rankings-heading",dataset:{markupContentTarget:1}},WH.ce("a",{href:"https://raider.io/"},WH.ct("Powered by Raider.IO"))));var a;var i=WH.ce("tr");WH.ae(t,WH.ce("table",{className:"guild-boss-rankings exclude-units"},i));var n=WH.Strings.slug(e.unnamed);var s=WH.Strings.slug(e.raid);var r=WH.Strings.slug(e.difficulty||"mythic");let o=s+"."+n+"."+r;for(var l=1;l<=3;l++){a=WH.ce("td");WH.ae(i,a);let e=WH.getPageData(["markup.guildRankings",o].join("."));if(e){let t=e[l-1];if(t){var c=t.realm.toLowerCase().replace(/[^a-z ]/,"").replace(" ","-");a.className="guild-boss-rankings-earned";WH.ae(a,WH.ce("div",{className:"guild-boss-rankings-"+t.faction},WH.ce("a",{href:"https://raider.io/guilds/"+t.region.toLowerCase()+"/"+c+"/"+t.name,target:"_blank"},WH.ct(t.name))));WH.ae(a,WH.ce("a",{href:"https://raider.io/"+s+"/realm-rankings/"+t.region.toLowerCase()+"/"+c+"/"+r,target:"_blank"},WH.ct("("+t.region+") "+t.realm)));continue}}switch(l){case 1:WH.st(a,"1st Place");break;case 2:WH.st(a,"2nd Place");break;case 3:WH.st(a,"3rd Place");break;default:WH.st(a,l+"th Place")}WH.ae(a,WH.ce("br"));WH.ae(a,WH.ct("Not Earned"))}return t},toText:function(e){var t=WH.Strings.slug(e.unnamed);var a=WH.Strings.slug(e.raid);var i=WH.Strings.slug(e.difficulty||"mythic");let n=a+"."+t+"."+i;var s="";for(var r=1;r<=3;r++){var o="";switch(r){case 1:o="1st";break;case 2:o="2nd";break;case 3:o="3rd";break;default:o=r+"th"}s+=o+" Place: ";let e=WH.getPageData(["markup.guildRankings",n].join("."));if(e){let t=e[r-1];if(t){s+=t.name+", ("+t.region+") "+t.realm+", "+WH.ucfirst(t.faction)+". ";continue}}s+="Not Earned. "}return e._textContents+": "+s}};WH.markup.tags["h2"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}let t=WH.ce("h2");WH.markup.applyCommonAttributes(t,e);t.className=(t.className?" ":"")+"heading-size-2";if(e.first||e.unnamed){t.className+=" first"}if(e.last){t.className+=" last"}if(e.clear){if(e.clear=="true"){e.clear="both"}t.style.clear=e.clear}if(e.type&&["bar","d4-arrow","angled"].includes(e.type)){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}else if(e.type==="angled"){t.dataset.type="angled-divider"}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}return t},fromHtml:function(e){return e.replace(new RegExp("<h2\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h2>","gi"),"\n[h2]$1[/h2]")}};WH.markup.tags["h3"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}let t=WH.ce("h3");WH.markup.applyCommonAttributes(t,e);t.className=(t.className?" ":"")+"heading-size-3";if(e.first||e.unnamed){t.className+=" first"}if(e.last){t.className+=" last"}if(e.clear){if(e.clear=="true"){e.clear="both"}t.style.clear=e.clear}if(e.type&&["bar","d4-arrow","angled"].includes(e.type)){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}else if(e.type==="angled"){t.dataset.type="angled-divider"}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}return t},fromHtml:function(e){return e.replace(new RegExp("<h3\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h3>","gi"),"\n[h3]$1[/h3]")}};WH.markup.tags["h4"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}let t=WH.ce("h4");WH.markup.applyCommonAttributes(t,e);t.className=(t.className?" ":"")+"heading-size-4";if(e.first||e.unnamed){t.className+=" first"}if(e.last){t.className+=" last"}if(e.clear){if(e.clear=="true"){e.clear="both"}t.style.clear=e.clear}if(e.type&&["bar","d4-arrow","angled"].includes(e.type)){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}else if(e.type==="angled"){t.dataset.type="angled-divider"}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}return t},fromHtml:function(e){return e.replace(new RegExp("<h4\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h4>","gi"),"\n[h4]$1[/h4]")}};WH.markup.tags["h5"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}let t=WH.ce("h5");WH.markup.applyCommonAttributes(t,e);t.className=(t.className?" ":"")+"heading-size-5";if(e.first||e.unnamed){t.className+=" first"}if(e.last){t.className+=" last"}if(e.clear){if(e.clear=="true"){e.clear="both"}t.style.clear=e.clear}if(e.type&&["bar","d4-arrow","angled"].includes(e.type)){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}else if(e.type==="angled"){t.dataset.type="angled-divider"}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}return t},fromHtml:function(e){return e.replace(new RegExp("<h5\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h5>","gi"),"\n[h5]$1[/h5]")}};WH.markup.tags["h6"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}let t=WH.ce("h6");WH.markup.applyCommonAttributes(t,e);t.className=(t.className?" ":"")+"heading-size-6";if(e.first||e.unnamed){t.className+=" first"}if(e.last){t.className+=" last"}if(e.clear){if(e.clear=="true"){e.clear="both"}t.style.clear=e.clear}if(e.type&&["bar","d4-arrow","angled"].includes(e.type)){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}else if(e.type==="angled"){t.dataset.type="angled-divider"}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}return t},fromHtml:function(e){return e.replace(new RegExp("<h6\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h6>","gi"),"\n[h6]$1[/h6]")}};WH.markup.tags["heart-of-azeroth-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var a=WH.ce("div",{className:"exclude-units",id:"markup-heart-of-azeroth-calc-"+this.counter++});var i=function(){new WH.Wow.HeartOfAzerothCalc(a,{embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true"})};if(!WH.Wow.HeartOfAzerothCalc){this.callbacks.push(i);if(this.callbacks.length==1){WH.loadAssets("heart-of-azeroth-calc",(function(){for(var e,t=0;e=WH.markup.tags["heart-of-azeroth-calc"].callbacks[t];t++){e()}}))}}else{i()}return a}};WH.markup.tags["hero-talents"]=function(){let e=[];return{empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/}},toNode:function(t){const a=WH.ce("div",{className:"hero-talents-markup exclude-units"});const i=WH.Gatherer.get(WH.Types.GATHERER_HERO_TALENTS,t.unnamed);if(!i){WH.ae(a,WH.ce("b",{className:"q10"},WH.ct(`Hero talents "${t.unnamed}" not found!`)));return a}let n=()=>new WH.Wow.HeroTalentsEmbed(a,i);if(!WH.Wow.HeroTalentsEmbed){e.push(n);if(e.length===1){WH.loadAssets("hero-talents-embed",(()=>{let t;while(t=e.shift()){t()}}))}}else{n()}return a}}}();WH.markup.tags.hr={empty:true,trim:true,allowedModes:{article:1,quickfacts:1,comment:1},toNode:function(e){return WH.ce("hr")},fromHtml:function(e){return e.replace(/<hr\b[\s\S]*?>/gi,"[hr]")}};WH.markup.tags.html={empty:false,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){let t=e._contents.textContent;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}t=t.replace(/http:\/\/([^\/:@]+\.)?(zamimg|wowhead)\.com\//g,"https://$1$2.com/");let a=WH.ce("div",{innerHTML:t});var i=a.getElementsByTagName("script");while(i.length){i[0].parentNode.replaceChild(WH.ct(i[0].outerHTML),i[0])}var n=document.createDocumentFragment();while(a.hasChildNodes()){n.appendChild(a.firstChild)}WH.markup.tags.html.removeEventAttributes(n);return n},removeEventAttributes:function(e){var t=e.childNodes;for(var a=0;a<t.length;a++){WH.markup.tags.html.removeEventAttributes(t[a])}if(e instanceof Element){var i=/^\s*javascript:/i;var n=e.getAttributeNames();for(var a=0;a<n.length;a++){if(n[a].substr(0,2).toLowerCase()==="on"||i.test(e.getAttribute(n[a]))){e.removeAttribute(n[a])}}}}};WH.markup.tags.i={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("i");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(i|em)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[i]$2[/i]")}};WH.markup.tags.icon={empty:false,itrim:true,attr:{unnamed:{req:false,valid:/^class$/i},align:{req:false,valid:/^right$/i},color:{req:false,valid:WH.markup.regex.noWhitespace},float:{req:false,valid:/^(left|right)$/i},game:{req:false,valid:/\S+/},inline:{req:false,valid:/^true$/},kind:{req:false,valid:WH.markup.regex.noWhitespace},name:{req:false,valid:/\S+/},preset:{req:false,valid:/\S+/},site:{req:false,valid:WH.markup.regex.dataEnv},size:{req:false,valid:/^(tiny|small|medium|large|blizzard)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/},type:{req:false,valid:WH.markup.regex.kebabCase},url:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,presets:{boss:WH.STATIC_URL+"/images/icons/boss.gif",heroic:WH.STATIC_URL+"/images/icons/heroic.gif",mythic:WH.STATIC_URL+"/images/icons/mythic.gif"},validate:function(e){if(!e.name&&!e.url&&!e.preset){return false}if(e.preset&&!WH.markup.tags.icon.presets[e.preset]){return false}return true},toNode:function(e){const t=WH.Game;const a=WH.Types;let i=WH.markup.getDataEnvFromSiteAttr(e.site)??WH.getDataEnv();let n=e.size?e.size:"tiny";if(!e.name){e.name=""}if(["simple","round"].includes(e.type)){e.kind=e.type;delete e.type}let s=e.type&&a.getIdByString(e.type);let r;if(e.game){r=t.getByKey(e.game);if(!r){WH.warn('Invalid game provided in icon markup for "'+e.name+'" icon: '+e.game);r=t.WOW;e.name=WH.Icon.UNKNOWN}}else{r=s&&a.getGame(s)||t.DEFAULT}let o={color:e.color,dataEnv:t.getByEnv(i)===r?i:t.getEnv(r),game:r,kind:e.kind,span:e.hasOwnProperty("inline"),type:s};let l;if(n==="tiny"){l=WH.ce("span");WH.markup.applyCommonAttributes(l,e);if(e.unnamed===undefined){l.className=(l.className?" ":"")+"icontiny"+(e.align?"r":"");let t="";if(e.name){t=WH.Icon.getIconUrl(e.name,WH.Icon.TINY,o.dataEnv)}else if(e.preset){t=WH.markup.tags.icon.presets[e.preset]}else if(e.url&&WH.markup.isUrlSafe(e.url)){t=e.url}else{return document.createDocumentFragment()}l.style.backgroundImage="url("+t+")"}else{l.className=e.name}if(e.tooltip){WH.markup.attachMarkupTooltip(l,e.tooltip,e.tooltip2,true)}}else{let t=null;if(e.url&&WH.markup.isUrlSafe(e.url)){t=WH.markup.finalizeUrl(e.url,i)}else if(e._textContents&&WH.markup.isUrlSafe(e._textContents)){t=WH.markup.finalizeUrl(e._textContents,i)}else if(e.tooltip){t="javascript:"}l=WH.Icon.create(e.name.toLowerCase(),n,t,o);WH.markup.applyCommonAttributes(l,e);if(!t){WH.aE(l,"click",Icon.showIconInfo.bind(null,l))}if(e["float"]){l.style["float"]=e["float"]}while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}if(e.tooltip){let t=WH.Icon.getLink(l);if(t){WH.markup.attachMarkupTooltip(t,e.tooltip,e.tooltip2,true)}}}l.dataset.contiguous="true";return l}};WH.markup.tags.icondb={entityType:WH.Types.ICON,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},block:{req:false,valid:/^(true|false)$/},color:{req:false,valid:WH.markup.regex.noWhitespace},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},kind:{req:false,valid:WH.markup.regex.noWhitespace},name:{req:false,valid:/^true$/},site:{req:false,valid:WH.markup.regex.domain},size:{req:false,valid:/^(tiny|small|medium|large)$/},type:{req:false,valid:WH.markup.regex.noWhitespace},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){let t=e.size?e.size:"small";let a=e.name==="true";let i=e.unnamed;let n=WH.markup.getDatabaseDomainInfo(e);let s=WH.Entity.getPlaceholderName(WH.Types.ICON,i);if(["simple","round"].includes(e.type)){e.kind=e.type;delete e.type}let r=[];if(e.diff){r.push("diff="+e.diff)}if(e.diffnew){r.push("diffnew="+e.diffnew)}r=r.length?r.join("&"):null;if(e.tempname){s=e.tempname}let o=WH.ce("a");let l=WH.Gatherer.get(WH.Types.ICON,i,n.dataEnv);let c=n.dataEnv;let u;if(l&&l.name){if(l.hasOwnProperty("fromDataEnv")){c=l.fromDataEnv}u=WH.Entity.getUrl(WH.Types.ICON,i,l.name,undefined,c,n.localeId)}else{u=WH.Entity.getUrl(WH.Types.ICON,i,undefined,undefined,c,n.localeId)}o.href=u;if(l&&l.name){if(a){s=" "+l.name}if(t==="tiny"){o.classList.add("icontiny");let e=WH.ce("img",{src:WH.STATIC_URL+"/images/wow/icons/tiny/"+l.icon.toLowerCase()+".gif",style:{verticalAlign:"middle"},loading:"lazy"});WH.ae(o,e)}else{let i={color:e.color,kind:e.kind,span:a||e.block!=="true"};if(!a){if(r){i.rel=r}return WH.Icon.create(l.name,t,u,i)}WH.ae(o,WH.Icon.create(l.name,t,null,i))}}if(r){o.rel=r}if(a){WH.ae(o,WH.ct(s))}WH.markup.applyCommonAttributes(o,e);return o},toText:function(e){let t=e.unnamed;if(g_icons[t]&&g_icons[t].name){return WH.markup.getEscapedHtml(g_icons[t].name)}return WH.Types.getUpperSingular(WH.Types.ICON)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags.iconlist={empty:false,block:true,ltrim:true,rtrim:true,attr:{domain:{req:false,valid:WH.markup.regex.domain}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{b:1,achievement:1,currency:1,event:1,faction:1,item:1,itemset:1,npc:1,object:1,pet:1,quest:1,spell:1,title:1,zone:1},toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}var a={itemset:"item_set"};let i=WH.ce("div",{className:"icon-list-col exclude-units"});let n=WH.ce("table",{className:"icon-list"});WH.ae(i,n);var s;var r;for(var o=0;o<e._nodes.length;++o){var l=e._nodes[o];l.attr.domain=WH.getDataEnvKey(t.dataEnv);l.attr.icon="false";var c=WH.markup.tags[l.name].toNode(l.attr);var u="";var d=WH.Types[(a[l.name]||l.name).toUpperCase()];if(d){var f=g_gathered_types[d];var h=parseInt(l.attr.unnamed,10);u=f.getIcon&&f.getIcon(h)||f[h]&&f[h].icon;if(Array.isArray(u)){u=u[0]}}s=WH.ce("tr");WH.ae(n,s);r=WH.ce("th");WH.ae(s,r);if(u){var p="";if(c.tagName==="A"){p=c.href}else{var m=c.querySelector("a");if(m){p=m.href}}WH.ae(r,WH.markup.tags.icon.toNode({name:u,size:"small",url:p,_contents:document.createDocumentFragment()}))}else{WH.ae(r,WH.ce("ul",{},WH.ce("li",{},WH.ct(WH.Strings.nbsp))))}WH.ae(s,WH.ce("td",{},c))}return i}};WH.markup.tags.img={empty:true,count:0,attr:{alt:{req:false,valid:WH.markup.regex.anyChars},src:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/^[0-9]+$/},blog:{req:false,valid:/^[0-9]+$/},news:{req:false,valid:/^[0-9]+$/},size:{req:false,valid:/^(thumb|resized|normal|large|medium|small|tiny)$/i},width:{req:false,valid:/^[0-9%]+$/},height:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},margin:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/}},blogSize:/^(thumb|normal)$/i,idSize:/^(thumb|resized|normal)$/i,iconSize:/^(large|medium|small|tiny)$/i,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.src){if(e.src.includes("admin/screenshots/view")){return false}return true}else if(e.id){return e.size?WH.markup.tags.img.idSize.test(e.size):true}else if(e.icon){return e.size?WH.markup.tags.img.iconSize.test(e.size):true}else if(e.blog||e.news){return e.size?WH.markup.tags.img.blogSize.test(e.size):true}return false},toNode:function(e){var t=WH.ce("img",{loading:"lazy"});var a=t;var i=[];var n=[];WH.markup.applyCommonAttributes(t,e);t.removeAttribute("style");t.className="";let s="";if(e.src){s=e.src}else if(e.id){var r=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,e.id)||{};s=WH.getScreenshotUrl(e.id,e.size||"normal",{description:e.title,imageType:r.imageType})}else if(e.icon){s=WH.staticUrl+"/images/wow/icons/"+(e.size?e.size:"large")+"/"+e.icon+".jpg"}else if(e.blog||e.news){if(g_blogimages[e.blog||e.news]){var o=g_blogimages[e.blog||e.news];let i=e.alt?.trim()||o.alt?.trim()||"";if(e.size&&e.size=="thumb"){var l=WH.staticUrl+"/uploads/blog/images/"+(e.blog||e.news)+(o.type==3?".png":".jpg");s=WH.staticUrl+"/uploads/blog/thumbs/"+(e.blog||e.news)+(o.type==3?".png":".jpg");t.alt=i;t.width=o.thumbwidth;t.style.aspectRatio=o.thumbwidth/o.thumbheight;if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var c=WH.markup.tags.img.count++;a=WH.ce("a",{},a);a.href=l;a.id="img-thumb-"+c;setTimeout(function(e,t,a){var i=WH.ge("img-thumb-"+e);if(i){i.onclick=function(e,t,a){if(!WH.isLeftClick(a)){return}ScreenshotViewer.show({screenshots:e,pos:t});return false}.bind(null,t,a)}}.bind(null,c,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length),0);var u={url:l,caption:i,width:o.width,height:o.height,noMarkup:true};g_screenshots[WH.markup.mediaUid].push(u)}else{s=WH.staticUrl+"/uploads/blog/images/"+(e.blog||e.news)+(o.type==3?".png":".jpg");t.alt=i;if(!e.width&&!e.height){e.width=o.width;e.height=o.height}else if(!e.height){if(e.width.toString().indexOf("%")===-1){e.height=Math.round(o.height*e.width/o.width)}}else if(!e.width){e.width=Math.round(o.width*e.height/o.height)}}}else{return WH.ct(WH.TERMS.image+WH.TERMS.wordspace_punct+"#"+(e.blog||e.news))}}if(e.width){t.width=e.width}if(e.height){if(e.width){t.style.aspectRatio=e.width/e.height}else{t.height=e.height}}if(e["float"]){if(e["float"]=="center"){a=WH.ce("div",{},a);a.style.textAlign="center";n.push("margin:10px auto")}else{i.push("markup-float-"+e["float"]);if(e.margin){if(e["float"]=="left"){n.push("margin:0 "+e.margin+"px "+e.margin+"px 0")}else{n.push("margin:0 0 "+e.margin+"px "+e.margin+"px")}}}}i.push("content-image");if(e.border){if(e.border==0){i.push("no-border")}else{i.push("border");n.push("border-width:"+e.border+"px")}}else{if(e.shadow=="true"){i.push("content-image-shadowed")}}t.src=WH.Url.addMaxSizeParams(s,{width:t.width,height:t.height});t.alt=e.alt?.trim()||e.title?.trim()||t.alt?.trim()||"";if(e.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){n.push(e.style)}if(i.length){t.className=i.join(" ")}if(n.length){t.setAttribute("style",n.join(";"))}return a},fromHtml:function(e){var t;if(t=e.match(/<img\b[\s\S]*?src="[\s\S]+?"[\s\S]*?>/gi)){for(var a=0;a<t.length;++a){var i=t[a].match(/src="([\s\S]+?)"/i),n=t[a].match(/width[:="]+\s*([0-9]+)/i),s=t[a].match(/height[:="]+\s*([0-9]+)/i),r=t[a].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(t[a],"[img src="+i[1]+(n?" width="+n[1]:"")+(s?" height="+s[1]:"")+" border="+(r?r[1]:0)+"]")}}return e}};WH.markup.tags["inline-code"]={block:false,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},allowedChildren:{"<text>":1},toNode:function(e){var t=WH.ce("code",{className:"exclude-units"});if(e.wrap==="true"){t.style.whiteSpace="normal"}else if(e.wrap==="false"){t.style.whiteSpace="nowrap"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.ins={empty:false,toNode:function(e){var t=WH.ce("ins");t.className="diffmod";WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags["item-set"]={entityType:WH.Types.ITEM_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^-?[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ITEM_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM_SET)};WH.markup.tags.itemset={...WH.markup.tags["item-set"]};delete WH.markup.tags.itemset.entityType;WH.markup.tags.item={entityType:WH.Types.ITEM,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},"azerite-powers":{req:false,valid:/^[0-9:]+$/},bonus:{req:false,valid:/^[0-9:]+$/},covenant:{req:false,valid:/^[a-zA-Z\- ]+$/},"crafting-quality":{req:false,valid:WH.markup.regex.isInt},forg:{req:false,valid:/^\d+$/},gems:{req:false,valid:/^[0-9:]+$/},hero:{req:false,valid:/^[0-9]+$/},spec:{req:false,valid:/^[0-9]+$/},"spell-modifier":{req:false,valid:/^\d+$/},ak:{req:false,valid:/^[0-9]+$/},tooltip:{req:false,empty:true},tempname:{req:false},transmog:{req:false,valid:/^([0-9]+|hidden)$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.ak){t.push("artk="+e.ak)}if(e["azerite-powers"]){t.push("azerite-powers="+e["azerite-powers"])}if(e.bonus){t.push("bonus="+e.bonus)}if(e["crafting-quality"]){t.push("crafting-quality="+e["crafting-quality"])}if(e.forg){t.push("forg="+e.forg)}if(e.gems){t.push("gems="+e.gems)}if(e.hero){t.push("hero="+e.hero)}if(e.spec){t.push("spec="+e.spec)}if(e.transmog){t.push("transmog="+e.transmog)}if(e["spell-modifier"]){t.push(`spellModifier=${e["spell-modifier"]}`)}var a=WH.markup.entityTagToNode(WH.Types.ITEM,e,undefined,t);if(a.dataset.markupTooltipContainer){return a}a.dataset.entity="item";a.dataset.entityHasIcon="true";a.dataset.contiguous="true";if(e.covenant){let t=WH.Wow.Covenant.getIdBySlug(WH.Strings.slug(e.covenant,true));if(t){a.href+=`?covenant=${t}`}}return a},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM)};WH.markup.tags.large={allowedClass:WH.markup.CLASS.STAFF,empty:false,toNode:function(e){let t=WH.ce("span",{className:"large-text"});WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<span class="large-text"\b[\s\S]*?>([\s\S]*?)<\/span>/gi,"[large]$1[/large]")}};WH.markup.tags["legion-remix-artifact"]=function(){let e={};return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/},"max-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);let i=t["max-width"]||"100%";if(/^\d+$/.test(i)){i=`${i}px`}let n=WH.ce("div",{className:"legion-remix-artifact-markup exclude-units",style:{margin:"0 auto",maxWidth:i}});let s={dataEnv:a.dataEnv,editable:t.editable==="true",embedded:true,hash:t.unnamed};let r=function(){new WH.Wow.LegionRemixArtifact(n,s)};if(!WH.Wow.LegionRemixArtifact||!WH.Wow.LegionRemixArtifact.isReady(a.dataEnv)){let t=a.dataEnv;e[t]=e[t]||[];e[t].push(r);if(e[t].length===1){WH.loadAssets("legion-remix-artifact",(()=>{let a;while(a=e[t].shift()){a()}}),a.dataEnv)}}else{r()}return n}}}();WH.markup.tags.li={empty:false,ltrim:true,rtrim:true,itrim:true,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},"display-options-dim":{req:false,empty:true},"display-options":{req:false,valid:WH.markup.regex.anyChars},"entity-list-toggle-target":{req:false,valid:WH.markup.regex.anyChars},icon:{req:false,valid:WH.markup.regex.noWhitespace},style:{req:false,valid:/^[^<>]+$/}},helpText:function(){var e="";e+="[ul]";for(var t=0;t<3;++t){e+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}e+="\n[/ul]\n\n";e+="[ol]";for(var t=0;t<3;++t){e+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}e+="\n[/ol]\n";return e.toLowerCase()},toNode:function(e){let t=WH.ce("li");WH.markup.applyCommonAttributes(t,e);if(e.icon){t.classList.add("fa","fa-"+e.icon)}if(e["entity-list-toggle-target"]){t.dataset.entityListItemTarget=`${e["entity-list-toggle-target"]}`}WH.ae(t,WH.ce("div",{dataset:{markupContentTarget:1}}));if(e["display-options"]){const a=WH.markup.DisplayOptions;a.registerContainer({dim:e["display-options-dim"]!=null,displayOptions:e["display-options"],element:t})}return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<li\\b[\\s\\S]*?>","</li>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n\t"+Array(t+1).join("\t")+"[li]"+WH.markup.tags.li.fromHtml(a[i][0],t+1)+"[/li]")}}return e}};WH.markup.tags.lightbox={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^map$/},zone:{req:false,valid:/^-?[0-9]+[a-z]?$/i},floor:{req:false,valid:/^[0-9]+$/},pins:{req:false,valid:/^[0-9]+$/}},validate:function(e){switch(e.unnamed){case"map":if(e.zone){return true}break}return false},toNode:function(e){var t=WH.ce("a");WH.markup.applyCommonAttributes(t,e);var a="";switch(e.unnamed){case"map":a=WH.Url.generatePath("/maps")+"?data="+e.zone;if(e.floor){a+="."+e.floor}if(e.pins){a+=":"+e.pins}var i=a.substr(6).replace("data=","");t.href=a;WH.aE(t,"click",(function(e){if(!WH.isLeftClick(e)){return true}MapViewer.show({link:i});e.preventDefault()}))}return t}};WH.markup.tags["list-card"]=(()=>({empty:false,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},image:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:e=>{const t="list-card";WH.loadAssets(t);const a=WH.ce("div",{className:`${t} exclude-units`});const i=WH.ae(a,WH.ce("div",{className:`${t}-image`}));WH.ae(a,WH.ce("div",{className:`${t}-content`,dataset:{markupContentTarget:"1"}}));if(e.class){a.dataset.class=WH.Strings.slug(e.class)}else if(e.image){i.style.backgroundImage=`url(${e.image})`}WH.DOM.bindBreakpoints(a,{small:500});document.addEventListener("DOMContentLoaded",(()=>{if(!a.parentElement.classList.contains(`markup-container`)&&!a.parentElement.classList.contains(`${t}-container`)){a.parentElement.classList.add(`${t}-container`);WH.DOM.bindBreakpoints(a.parentElement,{tiny:600,small:1200})}}));return a}}))();WH.markup.tags.listview={empty:true,attr:{id:{req:true,valid:/^\d+/},rows:{req:false,valid:/^\d+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"exclude-units"});let a=WH.Gatherer.get(WH.Types.GATHERER_LISTVIEW,e.id);if(!a){t.className="error-message exclude-units";WH.ae(t,WH.ct("Listview #"+e.id+" not found."));return t}if(a.template!=="db2-file-markup"){t.className="error-message exclude-units";WH.ae(t,WH.ct("Listview #"+e.id+" uses unknown template: ["+a.template+"]."));return t}let i={id:WH.Strings.guid(),clickable:false,filtrable:true,hash:Listview.HASH_DISABLED,searchable:true,template:{noDebug:true,columns:[]},data:a.rows,parent:t,nItemsPerPage:e.rows,createNote:function(e,t){let i=[{label:"Product",option:WH.ct(a.product)},{label:"Build",option:WH.ct(a.build)},{label:"File",option:WH.ct(a.file)}];this.addOptions(i,{style:{minHeight:"39px"}})}};for(let e,t=0;e=a.cols[t];t++){i.template.columns.push({id:"col"+t,align:"left",compute:function(e,t,i,n){let s=t["col"+e];let r=WH.ct(s);if(a.cols[e].numeric){r=WH.ce("pre",{style:{display:"inline",margin:"0"}},r)}let o=t["col"+e+"icon"];if(o){if(r.nodeType!==Node.ELEMENT_NODE){r=WH.ce("span",{},r)}r.classList.add("icontiny");WH.aef(r,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+o+".gif",style:{paddingRight:"5px",verticalAlign:"middle"},loading:"lazy"}))}let l;if(l=a.cols[e].entityType){r=WH.ce("a",{href:WH.Entity.getUrl(l,s,undefined,undefined,a.dataEnv,a.locale)},r)}WH.ae(i,r);if(t.hotfixAdd){n.classList.add("new-row-2");WH.Tooltips.attach(i,"<i>New row via hotfix.</i>","q0",{byCursor:true})}else if(t.hotfixDelete){n.classList.add("deleted");WH.Tooltips.attach(i,"<i>Deleted row via hotfix.</i>","q0",{byCursor:true})}else if((t.changes||[])[e]){i.classList.add("changed-cell");WH.Tooltips.attach(i,WH.Strings.escapeHtml(t.changes[e]),"q0",{byCursor:true})}else if(t["new"]){n.classList.add("new-row");WH.Tooltips.attach(i,"<i>New row this build.</i>","q0",{byCursor:true})}}.bind(null,t),name:e.label||"[col"+t+"]",type:e.numeric?Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT,value:"col"+t,pos:t,sortFunc:function(e,t,a){let i=t["col"+e];let n=a["col"+e];return WH.stringCompare(i,n)}.bind(null,t)})}new Listview(i);t.querySelector("div").className="listview";return t}};WH.markup.tags["major-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},type:{req:false,valid:WH.markup.regex.noWhitespace},toc:{req:false,valid:/^.+$/i}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}var t=WH.ce("h2");t.classList.add("heading-size-2");if(e.first||e.unnamed){t.classList.add("first")}if(e.last){t.classList.add("last")}if(e.clear==="true"||e.clear==="both"){t.style.clear="both"}else if(e.clear){t.style.clear=e.clear}if(e.type==="bar"||e.type==="d4-arrow"){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}else if(e.type==="premium-gold"){t.classList.add("premium-gold-gradient-subtle")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags.map=function(){const e={};return{empty:false,attr:{zone:{req:true,valid:/^-?[0-9a-z\-_]+$/i},floor:{req:false,valid:/^\d+/},source:{req:false,valid:/\S+/},legacy:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{pin:1},mapHits:0,toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);var i=[];while(t._contents.hasChildNodes()){var n=t._contents.removeChild(t._contents.firstChild);i=i.concat(n.whMarkupInfo)}var s=document.createDocumentFragment();var r=WH.ce("div",{className:"exclude-units"});WH.markup.applyCommonAttributes(r,t);WH.ae(s,r);const o=()=>void new Mapper({parent:r,unique:WH.markup.tags.map.mapHits++,zone:t.zone,coords:i?i:null,legacy:t.legacy||false,level:t.hasOwnProperty("floor")?t.floor:undefined,dataEnv:a.dataEnv});if(Mapper.isDataReady(a.dataEnv)){o()}else{const t=WH.getDataEnvKey(a.dataEnv);e[t]??=[];e[t].push(o);if(e[t].length===1){WH.loadAssets("wow-mapper",(()=>{let a;while(a=e[t].shift()){a()}}),a.dataEnv)}}return s}}}();WH.markup.tags.markupdoc={empty:true,attr:{tag:{req:false,valid:/[a-z0-9]+/i}},allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.tag&&!WH.markup.tags[e.tag]){return false}return true},toNode:function(e){let t="";if(e.tag){t=WH.markup.tags.markupdoc.generateTagDocs(e.tag)}else{for(var a in WH.markup.tags){if(t!==""){t+='<div class="pad3"></div>'}t+=WH.markup.tags.markupdoc.generateTagDocs(a)}}let i=t;var n=WH.ce("div");n.innerHTML=i;var s=document.createDocumentFragment();while(n.firstChild!=null){s.appendChild(n.removeChild(n.firstChild))}return s},generateTagDocs:function(e){var t=WH.markup.tags[e];if(!t){return""}var a="";a='<div><h3 class="heading-size-3 first">Tag: ['+WH.markup.getEscapedHtml(e)+"]</h3>";a+='<table class="grid">';if(t.attr){a+='<tr><td align="right" width="200">Attributes:</td><td>';for(var i in t.attr){a+='<div style="margin: 5px; display: inline-block"><table><tr><th style="background-color: #242424; font-weight: bolder" colspan="2">';if(i=="unnamed"){a+="Self (["+e+"=???])"}else{a+=i}a+="</th></tr>";a+='<tr><td align="right">Required:</td><td>'+(t.attr[i].req?"Yes":"No")+"</td></tr>";a+='<tr><td align="right">Valid:</td><td>'+(t.attr[i].valid?WH.markup.getEscapedHtml(t.attr[i].valid.toString()):"--")+"</td></tr></table></div>"}a+="</td></tr>"}a+='<tr><td align="right" width="200">Has closing tag:</td><td>'+(t.empty?"No":"Yes")+"</td></tr>";a+='<tr><td align="right">Required group:</td><td>';if(t.allowedClass==WH.markup.CLASS.ADMIN){a+="Administrator"}else if(t.allowedClass==WH.markup.CLASS.STAFF){a+="Staff"}else if(t.allowedClass==WH.markup.CLASS.PREMIUM){a+="Premium"}else if(t.allowedClass&&t.allowedClass!=WH.markup.CLASS.PENDING){a+="Not pending"}else{a+="None"}a+="</td></tr>";if(t.allowedChildren){a+='<tr><td align="right">Allowed children:</td><td>';for(var n in t.allowedChildren){a+=WH.markup.getEscapedHtml(n)+"<br />"}a+="</td></tr>"}if(t.allowedParents){a+='<tr><td align="right">Allowed parents:</td><td>';for(var n in t.allowedParents){a+=WH.markup.getEscapedHtml(n)+"<br />"}a+="</td></tr>"}if(t.presets){a+='<tr><td align="right">Preset values:</td><td><table>';for(var s in t.presets){a+='<tr><td align="right">'+s+"</td><td>"+WH.markup.getEscapedHtml(t.presets[s])+"</td></tr>"}a+="</table></td></tr>"}if(t.trim){a+='<tr><td colspan="2">Trim whitespace</td></tr>'}if(t.ltrim){a+='<tr><td colspan="2">Trim preceding whitespace</td></tr>'}if(t.rtrim){a+='<tr><td colspan="2">Trim following whitespace</td></tr>'}if(t.itrim){a+='<tr><td colspan="2">Trim whitespace around interior content</td></tr>'}if(t.block){a+='<tr><td colspan="2">Automatically remove top padding if not the first item</td></tr>'}a+="</table></div>";return a}};WH.markup.tags.menu={empty:true,trim:true,ltrim:true,rtrim:true,attr:{tab:{req:true,valid:/^[0-9]+$/},path:{req:true,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.path.split(",");WH.Layout.set({activeTab:e.tab,breadcrumb:t});return null}};WH.markup.tags.minibox={empty:false,rtrim:true,itrim:true,attr:{float:{req:false,valid:/^(left|right)$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div",{className:"minibox exclude-units"});if(e["float"]==="left"){t.className+=" minibox-left"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags["minor-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,blockedDescendants:["major-heading","minor-heading","h2","h3","h4","h5","h6"],attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true);if(e.toc!=="false"){e.id=WH.markup.generateTocId(e.id)}}var t=WH.ce("h3");t.classList.add("heading-size-3");if(e.first||e.unnamed){t.classList.add("first")}if(e.last){t.classList.add("last")}if(e.clear==="true"||e.clear==="both"){t.style.clear="both"}else if(e.clear){t.style.clear=e.clear}if(e.type&&["bar","d4-arrow","angled"].includes(e.type)){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}else if(e.type==="angled"){t.dataset.type="angled-divider"}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags["mission-ability"]={entityType:WH.Types.MISSION_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION_ABILITY)};WH.markup.tags.garrisonability={...WH.markup.tags["mission-ability"]};delete WH.markup.tags.garrisonability.entityType;WH.markup.tags.mission={entityType:WH.Types.MISSION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION)};WH.markup.tags.model={empty:false,attr:{item:{req:false,valid:/^[0-9]+$/},object:{req:false,valid:/^[0-9]+$/},npc:{req:false,valid:/^[0-9]+$/},itemset:{req:false,valid:/^[0-9,]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},border:{req:false,valid:/^[0-9]+$/},fileid:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},humanoid:{req:false,valid:/^1$/},img:{req:false,valid:/\S+/},label:{req:false,valid:/[\S ]+/},link:{req:false,valid:/\S+/},shadow:{req:false,valid:/^(true|false)$/},slot:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,skipSlots:{4:1,5:1,6:1,7:1,8:1,9:1,10:1,16:1,19:1,20:1},toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var a=WH.ce("a");var i;WH.markup.applyCommonAttributes(a,e);var n=false;if(e.npc){a.href="#modelviewer:"+WH.Types.NPC+":"+e.npc+":"+(e.humanoid?"1":"0");WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.NPC,displayId:e.npc,slot:e.slot,displayAd:1,fromTag:1};if(e.humanoid){a.humanoid=1}if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.ModelViewer.getContentPath(t.dataEnv)+"thumbs/npc/"+e.npc+".png"};if(!e.img){s.width="150";s.height="150"}WH.ae(a,i=WH.ce("img",s));n=true}else if(e.object){a.href="#modelviewer:"+WH.Types.OBJECT+":"+e.object;WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.OBJECT,displayId:e.object,displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.ModelViewer.getContentPath(t.dataEnv)+"thumbs/obj/"+e.object+".png"};if(!e.img){s.width="150";s.height="150"}WH.ae(a,i=WH.ce("img",s));n=true}else if(e.item&&e.slot){a.href="#modelviewer:"+WH.Types.ITEM+":"+e.item+":"+e.slot;WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.ITEM,displayId:e.item,slot:e.slot,displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.Item.getThumbUrl(e.item,undefined,t.dataEnv)};if(!e.img){s.width="150";s.height="150"}WH.ae(a,i=WH.ce("img",s));n=true}else if(e.itemset){a.href="javascript:";WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.ITEM_SET,equipList:e.itemset.split(","),displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}))}else if(e.fileid){a.href="javascript:";WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,fileId:e.fileid,displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}WH.Wow.ModelViewer.showLightbox(a)}));if(e.img){var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img};WH.ae(a,i=WH.ce("img",s));n=true}}else{var r=document.createDocumentFragment();WH.ae(r,WH.ct("[model]"));WH.ae(r,WH.ce("span",{dataset:{markupContentTarget:1}}));WH.ae(r,WH.ct("[/model]"));return r}if(i){if(e["float"]){i.classList.add("markup-float-"+e["float"])}i.classList.add("content-image");if(e.border!==undefined){if(e.border==0){i.classList.add("no-border")}else{i.classList.add("border");i.style.borderWidth=""+e.border+"px"}}else{if(e.shadow=="true"){i.classList.add("content-image-shadowed")}}i.loading="lazy"}while(n&&e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}return a}};WH.markup.tags.modelviewer=WH.markup.tags.model;WH.markup.tags.money={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+|[0-9]+-[0-9]+$/},items:{req:false,valid:/^[0-9,]+$/},currency:{req:false,valid:/^[0-9,]+$/},achievement:{req:false,valid:/\S+/},side:{req:false,valid:/^(alliance|horde|both)$/i},arena:{req:false,valid:/^[0-9]+$/},honor:{req:false,valid:/^[0-9]+$/},conquest:{req:false,valid:/^[0-9]+$/},justice:{req:false,valid:/^[0-9]+$/},valor:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=[];var a=[];if(e.items){var i=e.items.split(",");if(i.length>=2){for(var n=0,s=i.length;n<s-1;n+=2){t.push({id:i[n],count:i[n+1]})}}}if(e.currency){var r=e.currency.split(",");if(r.length>=2){var o=null;for(var l=0,c=r.length;l<c-1;l+=2){var u=r[l];var d=parseInt(r[l+1]);if(o&&o.id===u){if(o.increment===null&&d-o.max<=5){o.increment=d-o.max}if(o.increment&&(o.max+o.increment===d||o.max/d>.925)){o.values.push(d);o.max=d;o.value=o.min+"-"+o.max;continue}}o={id:u,increment:null,max:d,min:d,value:d,values:[d]};a.push(o)}}}if(e.arena&&!e.conquest){e.conquest=e.arena}if(e.honor){a.push({id:WH.Wow.Currency.ID_HONOR,value:e.honor})}if(e.conquest){a.push({id:WH.Wow.Currency.ID_CONQUEST,value:e.conquest})}if(e.justice){a.push({id:WH.Wow.Currency.ID_JUSTICE,value:e.justice})}if(e.valor){a.push({id:WH.Wow.Currency.ID_VALOR,value:e.valor})}var f=e.achievement;var h=document.createDocumentFragment();if(e.unnamed){var p=null;var m=null;if(e.unnamed.indexOf("-")!==-1){var H=e.unnamed.split("-");p=this.calculateMoney(H[0]);m=this.calculateMoney(H[1])}else{p=this.calculateMoney(e.unnamed)}if(m===null||JSON.stringify(p)===JSON.stringify(m)){this.displayMoney(h,p)}else if(p.length===1&&m.length===1&&p[0].type===m[0].type){p[0].value+="-"+m[0].value;this.displayMoney(h,p)}else{this.displayMoney(h,p);h.appendChild(WH.ct(" - "));this.displayMoney(h,m)}}if(t.length>5){if(h.hasChildNodes()){h.appendChild(WH.ct(" "));h.appendChild(WH.ct(WH.Strings.sprintf(WH.TERMS.oneOfEntityCount_format,t.length,WH.Types.getUpperPlural(WH.Types.ITEM))))}}else{for(var n=0,s=t.length;n<s;n++){var g=t[n];if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}var W=g_items[g.id]||{};var E=W.icon||WH.Icon.UNKNOWN;var _=WH.staticUrl+"/images/wow/icons/tiny/"+E.toLowerCase()+".gif";h.appendChild(WH.ce("a",{href:WH.Entity.getUrl(WH.Types.ITEM,g.id),className:"moneyitem no-wrap",style:{backgroundImage:'url("'+_+'")'}},WH.ct(g.count)))}}for(var T=0,v=a.length;T<v;T++){var S=a[T];if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}var E=g_gatheredcurrencies.getIcon(S.id);if(E===WH.Icon.UNKNOWN){E=WH.Wow.Currency.getIcon(S.id)||E}var b=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.CURRENCY,S.id),className:"icontinyr tip q1 no-wrap",style:{backgroundImage:'url("'+WH.staticUrl+"/images/wow/icons/tiny/"+E.toLowerCase()+'.gif")'}});WH.ae(b,WH.ct(S.value===0?"??":S.value));if(S.values&&S.values.length>2){WH.Tooltips.addText(b,WH.TERMS.oneOf_colon+Locale.formatList(S.values,"or",280))}h.appendChild(b)}if(f>0){if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}h.appendChild(WH.markup.tags.achievementpoints.toNode({unnamed:f.toString()}))}return h},calculateMoney:function(e){var t=[];if(e>=1e4){t.push({type:"gold",value:WH.numberFormat(Math.floor(e/1e4))});e%=1e4}if(e>=100){t.push({type:"silver",value:WH.numberFormat(Math.floor(e/100))});e%=100}if(e>=1){t.push({type:"copper",value:WH.numberFormat(Math.floor(e))})}return t},displayMoney:function(e,t){var a=false;for(var i=0,n=t.length;i<n;i++){if(a){e.appendChild(WH.ct(WH.TERMS.wordspace_punct))}e.appendChild(WH.ce("span",{className:"money"+t[i].type},WH.ct(t[i].value)));a=true}}};WH.markup.tags.n5={empty:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/}},toNode:function(e){return document.createTextNode(WH.getN5(e.unnamed))}};WH.markup.tags["nav-item"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{nav:1},attr:{icon:{req:false,valid:/\S+/},site:{req:false,valid:WH.markup.regex.dataEnv},tooltip:{req:false,valid:/^.*$/},unnamed:{req:false,valid:/\S+/}},toNode:function(e){var t=WH.ce("div");t.whMarkupInfo={icon:e.icon,site:e.site,tooltip:e.tooltip,url:e.unnamed};return t}};WH.markup.tags.nav={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"nav-heading":1,"nav-item":1},toNode:function(e){const t=WH.Game;const a=WH.Icon;var n="nav-markup-"+WH.Strings.guid();var s=document.createDocumentFragment();WH.ae(s,WH.ce("div",{className:"clear"}));var r=WH.ce("div",{className:"smooth-nav-wrapper exclude-units",id:n});WH.ae(s,r);var o=WH.ce("div",{className:"smooth-nav-outer"});WH.ae(r,o);var l=WH.ce("div",{className:"smooth-nav-inner"});WH.ae(o,l);var c;var u;var d=e._contents;let f=WH.ce("div",{className:"smooth-nav-section-body"});while(d.hasChildNodes()){u=d.removeChild(d.firstChild);const e=!u.whMarkupInfo.url;if(e){if(f.hasChildNodes()){WH.ae(l,f)}const e=WH.ce("div",{className:"smooth-nav-section-heading"});while(u.hasChildNodes()){WH.ae(e,u.firstChild)}WH.ae(l,e);const t=WH.ce("div",{className:"smooth-nav-section-body"});WH.ae(l,t);f=t;if(WH.Device.isMobile()){e.dataset.actionState="collapsed";t.dataset.actionState="collapsed"}if(u.whMarkupInfo.collapsible==="true"){const a=WH.ce("span",{className:"smooth-nav-collapse-button"});e.appendChild(a);e.dataset.collapsible="true";t.dataset.collapsible="true";WH.aE(e,"click",(()=>{if(t.dataset.actionState==="collapsed"){delete t.dataset.actionState;delete e.dataset.actionState}else{t.dataset.actionState="collapsed";e.dataset.actionState="collapsed"}}))}}else{c=WH.ce("a",{href:"javascript:",id:n+"-"+i,rel:"np"});const e=WH.ce("span",{className:"text-content"});WH.ae(c,e);const s=WH.markup.getDataEnvFromSiteAttr(u.whMarkupInfo.site);let r=u.whMarkupInfo.icon?a.getIconUrl(u.whMarkupInfo.icon,a.LARGE,s??t.getEnv(t.get())):u.whMarkupInfo.icon;const o=WH.ae(e,WH.ce("div",{className:"thumbnail-container"}));WH.React.initComponent(o,"modules/universal/Thumbnail",{borderType:"loud",iconConfig:r?{iconUrl:r}:null,shape:WH.Theme.getTheme()==="immortal"?"diamond":undefined,size:"small"});if(u.whMarkupInfo.url){c.href=WH.markup.finalizeUrl(u.whMarkupInfo.url,s)}if(u.whMarkupInfo.tooltip){WH.Tooltips.attach(c,u.whMarkupInfo.tooltip.replace(/&lt;br&gt;/g,"<br>"),"q")}while(u.hasChildNodes()){WH.ae(e,u.firstChild)}if(!r){let t=false;let a=null;for(let i=0,n=e.childNodes.length;i<n;i++){if(e.childNodes[i].nodeType===Node.TEXT_NODE){e.dataset.text=WH.Strings.slug(e.childNodes[i].textContent,true,LOCALE_ENUS);t=true}else if(!t){a=e.childNodes[i].textContent||a}}if(!t&&a){e.dataset.text=WH.Strings.slug(a,true,LOCALE_ENUS)}}WH.ae(f,c)}}WH.ae(l,f);let h=WH.qs('a[href$="wowhead.com'+location.pathname+'"]',l);if(h){h.dataset.active="true"}setTimeout(WH.setupSmoothNavClicks.bind(null,"#"+n),0);return s}};WH.markup.tags.npc={entityType:WH.Types.NPC,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.NPC),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.NPC)};WH.markup.tags.object={entityType:WH.Types.OBJECT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.OBJECT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.OBJECT)};WH.markup.tags.ol={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(e){var t=WH.ce("ol",{className:"exclude-units"});var a=[];if(e.first){a.push("first")}if(e.last){a.push("last")}if(a.length>0){t.className=a.join(" ")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<ol\\b[\\s\\S]*?>","</ol>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[ol]"+WH.markup.tags.ol.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/ol]")}}return e}};WH.markup.tags["order-advancement"]={entityType:WH.Types.ORDER_ADVANCEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT)};WH.markup.tags.outfit={entityType:WH.Types.OUTFIT,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=e.unnamed;var a=g_outfits[t];let i=WH.markup.getDatabaseDomainInfo(e);let n=WH.Entity.getUrl(WH.Types.OUTFIT,t,a&&a.name,undefined,i.dataEnv,i.localeId);var s=WH.ce("a",{href:n,target:"_blank"});s.setAttribute("whattach","true");if(a){if(a.classs){s.className="icontiny c"+a.classs;WH.ae(s,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(a.classs)+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(s,WH.ct(" "))}WH.ae(s,WH.ct(a.name))}else{WH.ae(s,WH.ct(WH.Types.getUpperSingular(WH.Types.OUTFIT)+WH.TERMS.wordspace_punct+"#"+t))}return s}};WH.markup.tags.p={empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("p");t.style.lineHeight="1.4em";t.style.margin="1em 0 0 0";WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){let t;if(t=e.match(/<p\b[\s\S]*?>[\s\S]*?<\/p>/gi)){for(let a=0;a<t.length;a++){let i=t[a].match(/^<p\b[\s\S]*?text-align:\s*(center|left|right)/i);let n=t[a].match(/<p\b[\s\S]*?>([\s\S]*?)<\/p>/i);e=e.replace(t[a],"\n"+(i?`[div align=${i[1]}]`:"")+(n?n[1]:"")+(i?"[/div]":"")+"\n")}}return e}};WH.markup.tags.pad={empty:true,block:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div",{className:"pad exclude-units"});if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags["pet-ability"]={entityType:WH.Types.BATTLE_PET_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.BATTLE_PET_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BATTLE_PET_ABILITY)};WH.markup.tags.petability={...WH.markup.tags["pet-ability"]};delete WH.markup.tags.petability.entityType;WH.markup.tags["pet-talent-calc"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},site:{req:false,valid:WH.markup.regex.dataEnv}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(t){let a=WH.markup.getDataEnvFromSiteAttr(t.site);let i=WH.ce("div",{className:"talentcalc-markup-parent exclude-units"});let n={abilities:false,dataEnv:a,editable:t.editable==="true",embedded:true,hash:t.unnamed.replace(/^\/+/,""),pet:true};let s=()=>new WH.Wow.TalentCalcClassic(i,n);if(!WH.Wow.hasOwnProperty("TalentCalcClassic")||!WH.Wow.TalentCalcClassic.isReady(true,a)){e.push(s);if(e.length===1){WH.loadAssets("pet-talent-calc",(()=>e.forEach((e=>e()))),a)}}else{s()}return i}}}();WH.markup.tags.pet={entityType:WH.Types.HUNTER_PET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.HUNTER_PET),toText:function(e){let t=e.unnamed;let a=WH.Wow.Pet.getName(t);if(a){return WH.markup.getEscapedHtml(a)}return WH.Types.getUpperSingular(WH.Types.HUNTER_PET)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags.pin={empty:false,attr:{url:{req:false,valid:/\S+/},type:{req:false,valid:/^[0-9]+$/},x:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},y:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},path:{req:false,valid:/^([0-9]{1,2}(\.[0-9])?[,:]?)+$/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{map:1},toNode:function(e){let t=e.url;if(t&&!WH.markup.isUrlSafe(t)){t=""}let a=e._contents;if(t&&t.includes("npc=")){let e=document.createDocumentFragment();WH.ae(e,WH.ce("b",{className:"q"},a));WH.ae(e,WH.ce("br"));WH.ae(e,WH.ce("span",{className:"q2"},WH.ct(WH.TERMS.clicktoviewthisnpc_stc)));a=e}if(t&&!t.includes("/")&&t.includes("=")){t=`/${t}`}let i=null;if(e.path){i=[];e.path.split(":").forEach((e=>{let t=e.split(",");if(t.length===2){i.push([parseFloat(t[0]||0),parseFloat(t[1]||0)])}}))}let n=WH.ce("div");n.whMarkupInfo=[[parseFloat(e.x||0),parseFloat(e.y||0),{label:WH.ce("div",{},a).innerHTML,url:WH.markup.finalizeUrl(t),type:e.type,lines:i}]];return n}};WH.markup.tags.pre={empty:false,block:true,rtrim:true,toNode:function(e){var t=WH.ce("pre",{className:"code exclude-units"});if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<pre\b[\s\S]*?>([\s\S]*?)<\/pre>/gi,"[pre]$1[/pre]")}};WH.markup.entityTag(WH.Types.PROFESSION_TRAIT);WH.markup.tags["profession-tree-calc"]=function(){let e={};return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/},"max-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);let i=t["max-width"]||"700px";if(/^\d+$/.test(i)){i=`${i}px`}let n=WH.ce("div",{className:"profession-tree-calc-markup exclude-units",style:{margin:"0 auto",maxWidth:i}});let s={dataEnv:a.dataEnv,editable:t.editable==="true",embedded:true,hash:t.unnamed};let r=function(){new WH.Wow.ProfessionTreeCalc(n,s)};if(!WH.Wow.ProfessionTreeCalc||!WH.Wow.ProfessionTreeCalc.isReady(a.dataEnv)){let t=a.dataEnv;e[t]=e[t]||[];e[t].push(r);if(e[t].length===1){WH.loadAssets("profession-tree-calc",(()=>{let a;while(a=e[t].shift()){a()}}),a.dataEnv)}}else{r()}return n}}}();WH.markup.tags["pvp-calc"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var a=WH.ce("div",{className:"pvptalentcalc-markup-parent exclude-units",id:"markup-pvptalent-"+this.counter++});var i=function(){new PvpTalentCalc({id:a.id,embedded:true,markup:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true",dataDomain:t.host})};if(!WH.isSet("PvpTalentCalc")){this.callbacks.push(i);if(this.callbacks.length==1){WH.loadAssets("pvp-talent-calc",(function(){for(var e,t=0;e=WH.markup.tags["pvp-calc"].callbacks[t];t++){e()}}))}}else{i()}return a}};WH.markup.tags["talent-pvp"]=WH.markup.tags["pvp-calc"];WH.markup.tags["honor-calc"]=WH.markup.tags["pvp-calc"];WH.markup.tags.quest={entityType:WH.Types.QUEST,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){let t=e.unnamed;let a=WH.Gatherer.get(WH.Types.QUEST,t);let i=WH.markup.entityTagToNode(WH.Types.QUEST,e);if(i.dataset.markupTooltipContainer){return i}if(a){let e=i.querySelector("span");if(e&&a.hasOwnProperty("_side")){switch(a["_side"]){case 1:e.classList.add("icon-alliance");break;case 2:e.classList.add("icon-horde");break}}}return i},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.QUEST)};WH.markup.tags.quote={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:false,valid:/[\S ]+/},align:{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^true$/},blizzard:{req:false,valid:/^true$/},clear:{req:false,valid:/^(left|right|both)$/i},collapse:{req:false,valid:/^true$/},display:{req:false,valid:/^block$/},fancy:{req:false,valid:/^true$/},float:{req:false,valid:/^(left|right|none)$/i},pname:{req:false},type:{req:false,valid:WH.markup.regex.noWhitespace},url:{req:false,valid:WH.markup.regex.noWhitespace},wowhead:{req:false,valid:/^true$/}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(e){if(e.type||e.blizzard||e.wowhead||e.collapse||e.url){if(WH.markup.allow<WH.markup.CLASS.STAFF){return false}}return true},toNode:function(e){if(e.type==="box"){delete e.type;let t=Object.keys(WH.markup.tags.quote.attr);let a=Object.keys(WH.markup.tags.box.attr);if(!t.some((t=>!a.includes(t)&&e[t]!=null))){if(WH.markup.tags.box.validate(e)){return WH.markup.tags.box.toNode(e)}}WH.warn("[quote type=box] failed to convert to [box] as expected.",e)}let t=[];let a=WH.ce("div",{className:"quote-box exclude-units"});t.push(a);WH.markup.applyCommonAttributes(a,e);if(e.display)a.style.display=e.display;if(e.align)a.style.textAlign=e.align;if(e.clear)a.style.clear=e.clear;if(e.first)a.classList.add("first");if(e.last)a.classList.add("last");if(e["float"])a.classList.add("markup-float-"+e["float"]);let i=e.type||"user";if(e.fancy){a.dataset.fancy="true"}if(e.border){a.dataset.border="true"}if(e.blizzard){i="blizzard"}else if(e.wowhead){i="wowhead"}a.dataset.type=i;let n=WH.ce("div",{className:"quote-header"});WH.ae(a,n);let s=WH.ce("div",{className:"quote-body",dataset:{markupContentTarget:1}});t.push(s);WH.ae(a,s);let r=WH.markup.finalizeUrl(e.url);if(i==="blizzard"){let t=r.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/blog\/([0-9]+)/i)||r.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/forum\/topic\/([0-9]+)/i)||r.match(/^https?:\/\/(www\.)?worldofwarcraft\.com\/en-us\/news\/([0-9]+)/i)||r.match(/^https?:\/\/(us|eu)\.battle\.net\/forums\/(?:en\/)?wow\/topic\/([0-9]+)/i);if(t||r&&WH.markup.isUrlSafe(r)){let i;if(t){i=WH.TERMS.officialPost;let e=["","blue-tracker","topic"];if(["us","eu"].includes(t[1])){e.push(t[1])}e.push(t[2]);WH.ae(n,WH.ce("a",{href:e.join("/"),target:"_blank"},WH.ct(WH.TERMS.bluetracker)));WH.ae(n,WH.ce("span",{className:"quote-header-separator"},WH.ct(" | ")))}else{i=e.pname||(r.indexOf("bluetracker")>=0?WH.TERMS.bluetracker:WH.TERMS.viewOriginal)}WH.ae(n,WH.ce("a",{href:r,target:"_blank"},WH.ct(i)));a.dataset.hasLinks="true"}}else if(r&&WH.markup.isUrlSafe(r)){WH.ae(n,WH.ce("a",{classList:"quote-header-link",href:r,target:"_blank"},WH.ct(WH.TERMS.link)));a.dataset.hasLinks="true"}let o=e.unnamed&&e.unnamed.trim()||null;let l=!!o;a.dataset.hasSource=JSON.stringify(l);if(l){let n=WH.ce("div",{className:"quote-source"});t.push(n);if(e.fancy){WH.ae(a,n)}else{WH.aef(a,n)}if(i==="user"){let t=WH.TERMS.said_format.split("%s");if(t[0]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(t[0])))}if(e.url&&WH.markup.isUrlSafe(e.url)){let t=WH.ce("a",{href:WH.markup.finalizeUrl(e.url)},WH.ct(o));if(WH.markup.isUrlExternal(e.url)){t.target="_blank"}WH.ae(n,t)}else if(WH.User.isUsernameValid(o)){WH.ae(n,WH.ce("a",{href:WH.Url.generatePath("/user="+o)},WH.ct(o)))}else{WH.ae(n,WH.ct(o))}if(t[1]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(t[1])))}}else{WH.ae(n,WH.ct(o))}}if(e._nodes&&e._nodes.length){let t=e._nodes[0].parent;let a=0;let i=t.parent;while(i&&i.name==="quote"){a++;i=i.parent}if(a>=2){e.collapse="true"}}if(i!=="user"||l||e.collapse){let i=()=>a.classList.contains("quote-collapsed")?WH.term("show_format",WH.TERMS.quote):WH.term("hide_format",WH.TERMS.quote);a.dataset.hasToggle="true";let s=WH.ce("a",{className:"quote-toggle",href:"javascript:",ariaLabel:WH.TERMS.toggleQuoteVisibility});WH.Tooltips.attach(s,i,"q2");WH.aE(s,"click",(function(){const e=150;if(!a.classList.contains("quote-collapsed")){t.forEach((e=>{let t=getComputedStyle(e);e.dataset.startingHeight=e.getBoundingClientRect().height-parseInt(t.getPropertyValue("padding-top"))-parseInt(t.getPropertyValue("padding-bottom"))+"px";e.style.height=e.dataset.startingHeight}));a.classList.add("quote-collapsed");requestAnimationFrame((()=>{t.forEach((e=>e.style.height=null))}))}else{t.forEach((e=>e.style.height=e.dataset.startingHeight));a.classList.remove("quote-collapsed");setTimeout((()=>{requestAnimationFrame((()=>t.forEach((e=>e.style.height=null))))}),e+1)}if(WH.Tooltips.isVisible()){WH.Tooltips.show(s,i(),"q2")}}));WH.ae(n,s);if(e.collapse){a.classList.add("quote-collapsed")}}return a}};WH.markup.tags.race={entityType:WH.Types.RACE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},gender:{req:false,valid:/^(0|1)$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RACE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RACE)};WH.markup.tags["raid-bots-form"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^droptimizer|gear|talents|quick|stats$/}},toNode:function(e){return WH.Raidbots.createForm(e.unnamed)}};WH.markup.tags.random={empty:false,itrim:true,allowedChildren:{randomoption:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=[];for(var a=0;a<e._nodes.length;a++){if(e._nodes[a].name=="randomoption"){t.push(e._nodes[a].attr._contents)}}if(t.length==0){return e._contents}return t[Math.floor(Math.random()*t.length)]}};WH.markup.tags.randomoption={empty:false,rtrim:true,ltrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{random:1},toNode:function(e){return null}};WH.markup.tags["react-test"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{},toNode:function(e){const t=WH.ce("div");WH.React.initComponent(t,"MarkupTest");return t}};WH.markup.tags["reddit-video"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"reddit-markup exclude-units"});let a=e.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+a,(function(a){if(!a||!a.data||!a.data.children||!a.data.children[0]||!a.data.children[0].data||a.data.children[0].kind!=="t3"){WH.st(t,"Error: could not fetch Reddit post "+e.unnamed);t.classList.add("error-message");return}let i=a.data.children[0].data;let n=i.secure_media&&i.secure_media.reddit_video||i.preview&&i.preview.reddit_video_preview;if(!n||!n.fallback_url){WH.st(t,"Error: could not find any video in Reddit post "+e.unnamed);t.classList.add("error-message");return}WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let s=Math.min(window.innerWidth-40,e.width||800,n.width);WH.ae(t,WH.ce("div",{className:"reddit-markup-container",style:{width:s+"px",maxWidth:"100%"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+i.permalink}))))}));return t}};WH.markup.tags["reddit"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"reddit-markup exclude-units"});const a=()=>{WH.st(t,"Error: could not fetch Reddit post "+e.unnamed);t.classList.add("error-message")};let i=e.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.fetch(`https://www.reddit.com/comments/${i}.json`,{mode:"cors",error:()=>a(),success:i=>{let n=null;i.filter((e=>e.kind==="Listing")).forEach((e=>{if(n){return}e.data?.children?.filter((e=>e.kind==="t3")).forEach((e=>{if(e.data?.permalink){n??=e.data.permalink}}))}));if(!n){return a()}WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let s=Math.min(window.innerWidth-40,e.width||800);WH.ae(t,WH.ce("div",{className:"reddit-markup-container",style:{width:s+"px",maxWidth:"100%"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+n}))))}});return t}};WH.markup.tags.regexreplace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^[^a-z\\].+[^a-z\\]$/},with:{req:true,valid:/^.*$/}},toNode:function(e){let t=document.createDocumentFragment();WH.ae(t,WH.ct(" "));let a=WH.ce("span",{className:"q0"});WH.ae(t,a);WH.ae(a,WH.ct("Regex "+WH.TERMS.replace_ellipsis+' "'));WH.ae(a,WH.ce("b",{},WH.ct(e.unnamed)));WH.ae(a,WH.ct('" → "'));WH.ae(a,WH.ce("b",{},WH.ct(e["with"])));WH.ae(a,WH.ct('"'));return t}};WH.markup.tags["related-markup-content"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){let t=document.createDocumentFragment();let a=WH.Url.generate("/admin/guides/related-markup-view?id="+e.unnamed);WH.ae(t,WH.ct(WH.TERMS.openparenthesis_punct+WH.TERMS.content+WH.TERMS.colon_punct));WH.ae(t,WH.ce("a",{href:a},WH.ct("Related Markup #"+e.unnamed)));WH.ae(t,WH.ct(WH.TERMS.closedparenthesis_punct));return t}};WH.markup.tags.replace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^.+$/},with:{req:true,valid:/^.*$/}},toNode:function(e){let t=document.createDocumentFragment();WH.ae(t,WH.ct(" "));let a=WH.ce("span",{className:"q0"});WH.ae(t,a);WH.ae(a,WH.ct(WH.TERMS.replace_ellipsis+' "'));WH.ae(a,WH.ce("b",{},WH.ct(e.unnamed)));WH.ae(a,WH.ct('" → "'));WH.ae(a,WH.ce("b",{},WH.ct(e["with"])));WH.ae(a,WH.ct('"'));return t}};WH.markup.tags.resource={entityType:WH.Types.RESOURCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^\-?[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RESOURCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RESOURCE)};WH.markup.tags.reveal={empty:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!WH.markup.inNewsType||WH.markup.inNewsType>1){return document.createDocumentFragment()}var t=document.createDocumentFragment();var a=WH.ce("span",{className:"exclude-units",style:{display:"none"}});t.appendChild(a);t.appendChild(WH.ct(" "));var i=WH.ce("a",{className:"revealtoggle",href:"javascript:"});t.appendChild(i);WH.aE(i,"click",WH.markup.tags.reveal.toggleReveal.bind(null,i,a));WH.st(i,WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct);return t},toggleReveal:function(e,t){e=$(e);t=$(t);if(t.is(":visible")&&e.is(":visible")){t.hide();e.text(WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct)}else{t.show();if(e.hasClass("changelog")){e.hide()}else{e.text(WH.TERMS.openparenthesis_punct+WH.TERMS.hide.toLowerCase()+WH.TERMS.closedparenthesis_punct)}}}};WH.markup.tags["rt-branch"]={allowedParents:{"rotation-timeline":1},allowedChildren:{"rt-step-group":1,"rt-step":1},empty:false,attr:{text:{req:false,valid:WH.markup.regex.anyChars},type:{req:false,valid:WH.markup.regex.noWhitespace},unnamed:{req:false,valid:/^[0-9]+$/}},toNode:e=>{const t=WH.ce("div");const a=e.type&&e.type==="item"?WH.Types.ITEM:WH.Types.SPELL;const{icon:i}=WH.Gatherer.get(a,e.unnamed)??{icon:WH.Icon.UNKNOWN};t.whMarkupInfo={entityId:e.unnamed?parseInt(e.unnamed):null,entityType:a,icon:i,steps:[],text:e.text,type:"branch"};let n;while(e._contents.hasChildNodes()){n=e._contents.removeChild(e._contents.firstChild);t.whMarkupInfo.steps.push(n.whMarkupInfo)}return t}};WH.markup.tags["rt-half-step"]={allowedParents:{"rotation-timeline":1},allowedChildren:{"rt-step-group":1,"rt-step":1},empty:false,toNode:e=>{const t=WH.ce("div");t.whMarkupInfo={type:"half-step",steps:[]};let a;while(e._contents.hasChildNodes()){a=e._contents.removeChild(e._contents.firstChild);t.whMarkupInfo.steps.push(a.whMarkupInfo)}return t}};(()=>{const e="sub";const t="sup";const a=(e,t)=>{WH.markup.tags[e]={empty:true,allowedParents:{"rt-step-group":1},attr:{level:{req:false,valid:WH.markup.regex.noWhitespace},text:{req:false,valid:WH.markup.regex.anyChars},type:{req:false,valid:WH.markup.regex.noWhitespace},unnamed:{req:false,valid:/^[0-9]+$/}},toNode:e=>{const a=WH.ce("div");const i=e.type==="item"?WH.Types.ITEM:WH.Types.SPELL;const{icon:n}=WH.Gatherer.get(i,e.unnamed)??{icon:WH.Icon.UNKNOWN};a.whMarkupInfo={entityId:e.unnamed??parseInt(e.unnamed),entityType:i,icon:n,key:crypto.randomUUID(),level:t,text:e.text};return a}}};a(`rt-${e}`,e);a(`rt-${t}`,t)})();WH.markup.tags["rt-step-group"]={empty:false,allowedChildren:{"rt-sub":1,"rt-sup":1},allowedParents:{"rt-branch":1,"rt-half-step":1,"rotation-timeline":1},attr:{prepull:{req:false,empty:true},text:{req:false,valid:WH.markup.regex.anyChars},type:{req:false,valid:WH.markup.regex.noWhitespace},unnamed:{req:true,valid:/^[0-9]+$/}},toNode:e=>{const t=WH.ce("div");const a=e.type&&e.type==="item"?WH.Types.ITEM:WH.Types.SPELL;const{icon:i}=WH.Gatherer.get(a,e.unnamed)??{icon:WH.Icon.UNKNOWN};t.whMarkupInfo={entityId:parseInt(e.unnamed),entityType:a,icon:i,key:crypto.randomUUID(),prepull:e.prepull!=null?true:null,scripts:[],text:e.text,type:"step"};let n;while(e._contents.hasChildNodes()){n=e._contents.removeChild(e._contents.firstChild);t.whMarkupInfo.scripts.push(n.whMarkupInfo)}return t}};WH.markup.tags["rt-step"]={empty:true,allowedParents:{"rt-branch":1,"rt-half-step":1,"rotation-timeline":1},attr:{prepull:{req:false,empty:true},text:{req:false,valid:WH.markup.regex.anyChars},type:{req:false,valid:WH.markup.regex.noWhitespace},unnamed:{req:true,valid:/^[0-9]+$/}},toNode:e=>{const t=WH.ce("div");const a=e.type&&e.type==="item"?WH.Types.ITEM:WH.Types.SPELL;const{icon:i}=WH.Gatherer.get(a,e.unnamed)??{icon:WH.Icon.UNKNOWN};t.whMarkupInfo={entityId:parseInt(e.unnamed),entityType:a,icon:i,key:crypto.randomUUID(),prepull:e.prepull!=null?true:null,text:e.text,type:"step"};return t}};WH.markup.tags["rotation-timeline"]={empty:false,allowedChildren:{"rt-branch":1,"rt-half-step":1,"rt-step-group":1,"rt-step":1},toNode:e=>{const t=WH.ce("div",{className:"wh-rotation-timeline exclude-units"});const a=[];let i;while(e._contents.hasChildNodes()){i=e._contents.removeChild(e._contents.firstChild);a.push(i.whMarkupInfo)}WH.React.loadComponentCss("wow/RotationTimeline",(()=>{WH.React.initComponent(t,"modules/rotation-timeline/RotationTimeline",{rotationData:a})}));return t}};WH.markup.tags.s={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("del");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){e=e.replace(/<del\b[\s\S]*?>([\s\S]*?)<\/del>/gi,"[s]$1[/s]");return e.replace(/<s\b[\s\S]*?>([\s\S]*?)<\/s>/gi,"[s]$1[/s]")}};WH.markup.tags.screenshot={empty:false,attr:{alt:{req:false,valid:WH.markup.regex.anyChars},id:{req:false,valid:/^[0-9]+$/},url:{req:false,valid:/\S+/},thumb:{req:false,valid:/\S+/},size:{req:false,valid:/^(thumb|small|resized|normal)$/i},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.url&&!e.thumb){return false}else if(!e.id&&!e.url){return false}return true},toNode:function(e){var t=[];var a=[];var i="javascript:";var n="";let s=false;let r=e.size||"thumb";var o={};if(e.id){o=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,e.id)||{};s=o.staffOnly;i=WH.getScreenshotUrl(e.id,"normal",{description:e.title,imageType:o.imageType,staffOnly:o.staffOnly});var l=e.id;if(e.thumb&&e.thumb.match(/^[0-9]+$/)){l=e.thumb;e.thumb=null}n=WH.getScreenshotUrl(l,r,{description:e.title,imageType:o.imageType,staffOnly:o.staffOnly})}else if(e.url){i=e.url}if(e.thumb){n=e.thumb}if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var c=WH.ce("a",{href:i});WH.markup.applyCommonAttributes(c,e);WH.aE(c,"click",function(e,t,a){if(!WH.isLeftClick(a)){return}ScreenshotViewer.show({screenshots:e,pos:t});a.preventDefault()}.bind(null,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length));const u=WH.ce("img",{style:{verticalAlign:"middle"}});WH.ae(c,u);if(o.staffOnly){if(!e.height){switch(r){case"normal":u.style.maxHeight="1200px";break;case"resized":u.style.maxHeight="618px";break;case"small":u.style.maxHeight="300px";break;case"thumb":u.style.maxHeight="150px";break}}if(!e.width){switch(r){case"normal":u.style.maxWidth="min(100%, 1600px)";break;case"resized":u.style.maxWidth="min(100%, 772px)";break;case"small":u.style.maxWidth="min(100%, 300px)";break;case"thumb":u.style.maxWidth="min(100%, 150px)";break}}WH.Screenshots.showStaffOnlyWarning();if(WH.User.hasCapability(WH.User.CAP_STAFF_ONLY_SCREENSHOTS)){u.style.outline="3px dashed #f60"}else{return document.createDocumentFragment()}}if(e.size&&e.width){u.width=e.width}if(e.size&&e.height){u.height=e.height}u.src=WH.Url.addMaxSizeParams(n,{height:u.height,width:u.width});u.loading="lazy";u.classList.add("content-image");if(e.border!==undefined){if(e.border==0){u.classList.add("no-border")}else{u.classList.add("border");u.style.borderWidth=""+e.border+"px"}}else{if(e.shadow=="true"){u.classList.add("content-image-shadowed")}}if(e["float"]){u.classList.add("markup-float-"+e["float"])}u.alt=e.alt?.trim()||e.title?.trim()||"";var d={caption:e.title,width:e.size?null:e.width,height:e.size?null:e.height,noMarkup:true,staffOnly:s};if(e.id){d.id=e.id;d.imageType=o.imageType}else{d.url=e.url}g_screenshots[WH.markup.mediaUid].push(d);return c}};WH.markup.tags.script={ltrim:true,rtrim:true,empty:false,attr:{src:{req:false,valid:/^\S+$/}},allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){if(e.src){$.getScript(e.src,(function(){try{$.globalEval(e._contents.textContent)}catch(e){WH.error("Markup script error:",e)}}))}else{try{$.globalEval(e._contents.textContent)}catch(e){WH.error("Markup script error:",e)}}return null}};WH.markup.tags["section-header"]=function(){let e=false;let t=[];return{allowedClass:WH.markup.CLASS.STAFF,attr:{bg:{req:false,valid:WH.markup.regex.noWhitespace},collapse:{req:false,valid:/^true|mobile$/},icon:{req:false,valid:WH.markup.regex.noWhitespace},margin:{req:false,valid:/^[0-5]|half$/i},unnamed:{req:true,valid:/^[A-Za-z0-9' -]+$/}},block:true,empty:false,itrim:true,ltrim:true,rtrim:true,toNode:function(a){const i={"data-margin":a.margin,"data-variation":a.bg,iconName:a.icon,titleText:a.unnamed};const n=WH.ce("section",{className:"collapsible-section exclude-units",dataset:{collapsed:a.collapse==="true"||a.collapse==="mobile"&&WH.Device.isMobile(),contentSize:"large",markupContentTarget:1}});const s=WH.ae(n,WH.ce("header"));let r=()=>WH.React.initComponent(s,"modules/SectionHeader",{...i,collapseHandler:()=>{n.dataset.collapsed=`${n.dataset.collapsed!=="true"}`}});if(e){r()}else{t.push(r);if(t.length===1){WH.loadAssets("section-header",(()=>{e=true;while(t.length){t.shift()()}}))}}return n}}}();WH.markup.tags.section={empty:false,ltrim:true,rtrim:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{},toNode:function(e){var t=WH.ce("div");t.className="secheader";t.dataset.markupContentTarget=1;t.appendChild(WH.ce("var"));return t}};WH.markup.tags["set-content-phase"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{type:{req:true,valid:/^\d+$/},typeid:{req:true,valid:/^\d+$/},phase:{req:true,valid:/^\d+(\.\d+)?$/}},toNode:function(e){var t=document.createDocumentFragment();var a=WH.ce("span");WH.ae(t,a);var i=WH.ce("a",{href:"javascript:",className:"fa fa-edit",style:{paddingLeft:"0.5em"},dataset:{phase:e.phase}});WH.ae(t,i);WH.aE(i,"click",(function(){var t=i.dataset.phase;if(t==0){t=undefined}WH.Wow.showContentPhasePrompt(e.type,[e.typeid],t,(function(e){i.dataset.phase=e?e:0;WH.st(a,e?e:"??")}))}));return t}};WH.markup.tags.ship={entityType:WH.Types.SHIP,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.SHIP,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SHIP)};WH.markup.tags.skill={entityType:WH.Types.SKILL,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.SKILL),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SKILL)};WH.markup.tags.small={empty:false,toNode:function(e){var t=WH.ce("span",{className:"small-text"});WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<small\b[\s\S]*?>([\s\S]*?)<\/small>/gi,"[small]$1[/small]")}};WH.markup.tags["soulbind-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.ce("div",{className:"exclude-units"});let i=function(){new WH.Wow.SoulbindCalc(a,{embedded:true,hash:e.unnamed,editable:e.editable==="true",dataEnv:t.dataEnv})};if(!WH.Wow.SoulbindCalc){this.callbacks.push(i);if(this.callbacks.length===1){WH.loadAssets("soulbind-calc",(function(){let e;while(e=WH.markup.tags["soulbind-calc"].callbacks.shift()){e()}}))}}else{i()}return a}};WH.markup.tags.sound={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+$/},src:{req:false,valid:/\S+/},title:{req:false,valid:/\S+/},type:{req:false,valid:/\S+/},src2:{req:false,valid:/\S+/},type2:{req:false,valid:/\S+/},domain:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if(e.unnamed){return true}if(!e.src){return false}return true},toNode:function(e){var t;var a;var i;var n;var s;var r;var o=WH.markup.getDatabaseDomainInfo(e);if(e.unnamed){if(!(e.unnamed in g_sounds)){return null}if(!g_sounds[e.unnamed].hasOwnProperty("files")){return null}var l;var c=g_sounds[e.unnamed].files;c.sort((function(){return Math.sign(Math.random()-.5)}));while(!l&&c.length){l=c.shift();if(!l.hasOwnProperty("type")){l=undefined}}if(!l){return null}t=l.type;a=l.url;i=g_sounds[e.unnamed].name?g_sounds[e.unnamed].name:l.title;n=WH.Entity.getUrl(WH.Types.SOUND,e.unnamed,i,undefined,o.dataEnv,o.localeId)}else{if(WH.markup.allow<WH.markup.CLASS.STAFF){return null}a=e.src;i=e.title?e.title:"(Unknown)";if(!/^(https?:)?\/\//.test(a)){if(/^\d+$/.test(a)){let e=parseInt(a);let t=Locale.getName(o.localeId);a=WH.STATIC_URL+"/sound-ids/live/"+t+"/"+(e&255)+"/"+e}else{a=WH.STATIC_URL+"/wowsounds"+a}}if(e.hasOwnProperty("type")){t=e.type}else{switch(e.src.toLowerCase().substr(-4)){case".mp3":t="audio/mpeg";break;case".ogg":t='audio/ogg; codecs="vorbis"';break}}if(e.src2){s=e.src2;if(!/^(https?:)?\/\//.test(s)){if(/^\d+$/.test(s)){let e=parseInt(s);let t=Locale.getName(o.localeId);a=WH.STATIC_URL+"/sound-ids/live/"+t+"/"+(e&255)+"/"+e}else{s=WH.STATIC_URL+"/wowsounds"+s}}if(e.hasOwnProperty("type2")){r=e.type2}else{switch(e.src2.toLowerCase().substr(-4)){case".mp3":r="audio/mpeg";break;case".ogg":r='audio/ogg; codecs="vorbis"';break}}}}var u=document.createDocumentFragment();var d=WH.ce("audio");WH.ae(u,d);d.preload="none";d.controls="true";WH.markup.applyCommonAttributes(d,e);if(e.unnamed){d.setAttribute("rel","sound="+e.unnamed)}var f=WH.ce("source",{src:a});WH.ae(d,f);if(t){f.type=t}if(s){f=WH.ce("source",{src:s});WH.ae(d,f);if(r){f.type=r}}if(n){var h=WH.ce("div",{className:"audiomarkup"});h.appendChild(u.firstChild);WH.ae(h,WH.ce("br"));WH.ae(h,WH.ce("a",{href:n},WH.ct(i)));WH.ae(u,h)}return u},fromHtml:function(e){var t=e.match(/<audio [^>]*\brel="sound=(\d+)/);if(t){return"[sound="+t[1]+"]"}return e.replace(/<audio\b[\s\S]*?><source\b[\s\S]*\bsrc="([^"]*?)"[\s\S]*?<\/audio>/gi,'[sound src="$1"]')}};WH.markup.tags.span={empty:false,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},"display-options-dim":{req:false,empty:true},"display-options":{req:false,valid:WH.markup.regex.anyChars},style:{req:false,valid:/^[^<>]+$/},unnamed:{req:false,valid:/^(hidden|invisible)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("span");WH.markup.applyCommonAttributes(t,e);if(e.unnamed==="hidden"){t.style.display="none"}else if(e.unnamed==="invisible"){t.style.visibility="hidden"}if(e.tooltip){WH.markup.attachMarkupTooltip(t,e.tooltip,e.tooltip2)}if(e["display-options"]){const a=WH.markup.DisplayOptions;a.registerContainer({dim:e["display-options-dim"]!=null,displayOptions:e["display-options"],element:t})}return t},fromHtml:function(e){return e.replace(/<span\b([\s\S]*?)>([\s\S]*?)<\/span>/gi,(function(e,t,a){var i=/style="[\s\S]*?color:\s?#(\w{6});?/i;var n=t.match(i);if(n){var s={ffd100:"q","9d9d9d":"q0",ffffff:"q1","1eff00":"q2","0070dd":"q3",a335ee:"q4",ff8000:"q5",e5cc80:"q6","00ccff":"q8","71d5ff":"q9",ff4040:"q10",ffff98:"q13",ff8040:"r1",ffff00:"r2","40bf40":"r3",808080:"r4",c69b6d:"c1",f48cba:"c2",aad372:"c3",fff468:"c4",c41e3b:"c6","2359ff":"c7","68ccef":"c8","9382c9":"c9","008467":"c10",ff7c0a:"c11",a330c9:"c12","70b3a5":"c13"};var r=s[n[1]];if(r){return"[color="+r+"]"+a+"[/color]"}}return e}))}};WH.markup.tags["spec-badge"]={empty:true,attr:{unnamed:{req:false,valid:/^.*$/},icon:{req:false,valid:/^[a-zA-Z- ]+$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Icon;const a=WH.Wow.Expansion;const i=WH.Wow.PlayerClass;const n=i.Specialization;let s=WH.ce("section",{classList:"spec-badge exclude-units meta-text",dataset:{textStyle:"meta-small-bold"}});let r=WH.ce("section",{classList:"spec-badge-icon"});let o=WH.ce("section",{classList:"spec-badge-content"});let l=WH.ce("section",{classList:"spec-badge-content-class-spec"});let c=WH.ce("div");WH.ae(s,r);WH.ae(s,o);WH.ae(o,l);WH.ae(l,c);if(e.icon){s.dataset.icon="true";s.classList.add("fa");e.icon.trim().split(" ").forEach((e=>s.classList.add(`fa-${e}`)))}if(e.unnamed){let o=WH.Strings.slug(e.unnamed);let[u,...d]=o.split("-");if(u==="beast"){u=`${u}-${d[0]}`;d.shift()}else if(u==="feral"&&!a.available(a.MOP)){u=n.getSlug(i.DRUID,a.available(a.CATA)?n.ID_CATA_DRUID_FERAL_COMBAT:n.ID_CLASSIC_DRUID_FERAL_COMBAT);if(d.length>1){d.shift()}}let f=d.join("-");let h=i.getBySlug(f);let p=h&&n.getBySlug(f,u);WH.st(l,`${p&&n.getName(p)||WH.TERMS.unknown}${WH.TERMS.wordspace_punct}`);WH.st(c,h&&i.getName(h)||WH.TERMS.unknown);s.dataset.class=h||"0";s.title=l.textContent;WH.ae(r,t.create(p?n.getIconName(p):"inv_misc_questionmark",t.LARGE,null,{color:h?`c${h}`:`c0`,kind:"round"}))}else{WH.st(l,WH.TERMS.unknown);WH.st(c,WH.TERMS.unknown)}return s}};WH.markup.tags.spell={entityType:WH.Types.SPELL,empty:true,allowInReplies:true,attr:{buff:{req:false,valid:/^true$/},covenant:{req:false,valid:/^[a-zA-Z\- ]+$/},desc:{req:false,empty:true},def:{req:false,valid:WH.markup.regex.isInt},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},rank:{req:false,valid:WH.markup.regex.isInt},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false},tooltip:{req:false,empty:true},unnamed:{req:true,valid:/^[0-9]+$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.unnamed;var a=WH.markup.getDatabaseDomainInfo(e);let i=a.dataEnv;var n=a.nameKey;var s;var r=[];let o={};let l=WH.Entity.getPlaceholderName(WH.Types.SPELL,t);if(e.buff){r.push("buff")}if(e.diff){r.push("diff="+e.diff)}if(e.diffnew){r.push("diffnew="+e.diffnew)}if(e.rank){o.rank=e.rank}if(e.def){o.def=e.def}if(e.tempname){l=e.tempname}const c=WH.Gatherer.get(WH.Types.SPELL,t,a.dataEnv);if(e.desc!=null){let e=c?.["description_"+Locale.getName(a.localeId)];if(e==null){return WH.ct(l.replace(/\)?$/,(e=>WH.TERMS.wordspace_punct+WH.TERMS.description+(e[0]??""))))}e=WH.Tooltips.evalFormulas(e);const t=WH.ce("span",{innerHTML:e.replace(/[\r\n]/g,"")});const i=e=>{if(e.style.display==="none"){e.parentNode.removeChild(e)}else{Array.from(e.children).forEach(i)}};i(t);WH.qsa("br, div",t).forEach((e=>{e.tagName==="BR"||WH.aeb(e,WH.ct("\n"));WH.aea(e,WH.ct("\n"))}));return WH.ce("span",{innerHTML:WH.Strings.escapeHtml(t.textContent).trim().replace(/\n+/g,"<br>")})}let u=document.createDocumentFragment();if(c?.displayName||c?.[n]){if(c.hasOwnProperty("fromDataEnv")){i=c.fromDataEnv}var d=false;var f=false;switch(e.icon){case"false":break;case"large":case"medium":case"small":d=WH.Icon.create(c.icon.toLowerCase(),e.icon,WH.Entity.getUrl(WH.Types.SPELL,t,c[n],undefined,i,a.localeId),{span:true});d.dataset.entityIcon="spell";WH.ae(u,d);break;case"tiny":default:if(!c.displayName){if(e["class"]){e["class"]+=" icontiny"}else{e["class"]="icontiny"}}f=c.icon.toLowerCase()}s=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.SPELL,t,c[n],o,i,a.localeId)});WH.ae(u,s);if(r.length){s.rel=r.join("&")}WH.markup.applyCommonAttributes(s,e);s.dataset.entity="spell";s.dataset.entityHasIcon=d||f?"true":"false";s.dataset.contiguous="true";if(f){WH.ae(s,WH.ce("img",{alt:c.displayName||"",src:WH.staticUrl+"/images/wow/icons/tiny/"+f+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(s,WH.ct(" "));let e=WH.ce("span",{className:"tinyicontxt"});if(c.displayName){e.innerHTML=c.displayName}else{WH.ae(e,WH.ct(c[n]))}WH.ae(s,e)}else{if(c.displayName){s.innerHTML=c.displayName}else{WH.ae(s,WH.ct(c[n]))}}if(c.hasOwnProperty("quality")&&c.quality>=0){s.classList.add("q"+c.quality)}}else{s=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.SPELL,t,undefined,o,i,a.localeId)});WH.ae(u,s);if(r.length){s.rel=r.join("&")}s.dataset.entity="spell";WH.st(s,l)}if(e.covenant){let t=WH.Wow.Covenant.getIdBySlug(WH.Strings.slug(e.covenant,true));if(t){s.href+=`?covenant=${t}`}}if(e.tooltip!=null){u=WH.markup.replaceNodeWithTooltip(u,WH.Types.SPELL,e,r)}return u},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SPELL)};WH.markup.tags.spoiler={block:true,empty:false,attr:{unnamed:{req:false,valid:/^.*$/}},rtrim:true,ltrim:true,itrim:true,timer:null,toNode:function(e){var t=document.createDocumentFragment();t.appendChild(WH.ce("div",{className:"pad exclude-units"}));var a=WH.ce("div",{className:"spoiler-wrapper exclude-units"});t.appendChild(a);var i=WH.ce("div",{className:"spoiler-desc"});WH.ae(a,i);WH.ae(i,WH.ce("b",{},WH.ct(WH.TERMS.spoiler_colon)));if(e.unnamed){WH.ae(i,WH.ct(WH.TERMS.wordspace_punct+e.unnamed))}WH.ae(i,WH.ct(" "));var n=WH.ce("button",{type:"button",className:"spoiler-revealer btn btn-small btn-site"});WH.st(n,WH.TERMS.revealspoiler);WH.aE(n,"click",(function(){a.classList.add("spoiler-reveal")}));WH.ae(i,n);var s=WH.ce("button",{type:"button",className:"spoiler-hider btn btn-small btn-site"});WH.st(s,WH.TERMS.hidespoiler);WH.aE(s,"click",(function(){a.classList.remove("spoiler-reveal")}));WH.ae(i,s);var r=WH.ce("div",{className:"spoiler",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(r,e);WH.ae(a,r);return t}};WH.markup.tags.storyline={entityType:WH.Types.STORYLINE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.STORYLINE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.STORYLINE)};WH.markup.tags.style={ltrim:true,rtrim:true,empty:false,allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){WH.addCss(e._contents.textContent);return null}};WH.markup.tags.sub={empty:false,toNode:function(e){var t=WH.ce("sub");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<sub\b[\s\S]*?>([\s\S]*?)<\/sub>/gi,"[sub]$1[/sub]")}};WH.markup.tags.sup={empty:false,toNode:function(e){var t=WH.ce("sup");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<sup\b[\s\S]*?>([\s\S]*?)<\/sup>/gi,"[sup]$1[/sup]")}};WH.markup.tags["survey-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},class:{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/},date:{req:false,valid:/^\d{4}-\d\d-\d\d$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Gatherer;const a=WH.Strings;const i=WH.WarcraftLogs;let n=a.slug(e["class"]||"",true);let s=a.slug(e.spec||"",true);let r=[n,s].filter((function(e){return!!e})).join(".");if(e.date){r+="/"+e.date}let o=t.get(WH.Types.GATHERER_SURVEY_COVENANTS,r);if(!o){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(a.nbsp+" "+WH.TERMS.notenoughdata));return e}let l=WH.ce("div",{className:"top-covenants exclude-units"});if(e.background==="false"){l.classList.add("no-background")}let c=WH.ce("div");WH.ae(l,c);let u=0;o.data.sort((function(e,a){return WH.stringCompare(t.getName(WH.Types.COVENANT,e.id),t.getName(WH.Types.COVENANT,a.id))}));for(let e=0,n;n=o.data[e];e++){let e=t.get(WH.Types.COVENANT,n.id);let s=a.slug(e.name_enus||"");let r=WH.ce("span",{className:"covenant-"+s+" icon-"+s},WH.ct(t.getName(WH.Types.COVENANT,n.id)+" "+WH.Strings.formatNumber(n.pop/100,true,0,1)));WH.ae(c,r);WH.Tooltips.attach(r,i.getCovenantTooltip.bind(undefined,n),"q",{byCursor:true});u++}while(u<4){WH.ae(c,WH.ce("span"));u++}if(o.endTimestamp){let e=WH.ce("div",{className:"top-covenants-time"});WH.ae(l,e);let t=o.startTimestamp?new Date(o.startTimestamp*1e3):null;let a=new Date(o.endTimestamp*1e3);let i=(new Date).getFullYear()>(t||a).getFullYear()?{month:"short",day:"numeric",year:"numeric"}:{month:"long",day:"numeric"};let n=Locale.getIetf();a=a.toLocaleDateString(n,i);if(t){t=t.toLocaleDateString(n,i);WH.st(e,WH.term("dataCollectedDateRange_format",t,a))}else{WH.st(e,WH.term("dataCollectedDate_format",a))}}return l}};WH.markup.tags.symbol=(()=>{const e={alchemist:"Marker_Crafter_Alchemist",barbarian:"ClassIcon_Barb_Small",blacksmith:"Marker_Blacksmith",boss:"Marker_Boss","campaign-quest":3837410649,cellar:"Marker_DungeonCellar",challenge:"Marker_DungeonChallenge","completed-achievement":"Achievement_Completed","completed-quest":"QuestLog_CheckboxComplete02",currency:"CurrencyIcon",dungeon:"Marker_DungeonEntrance",druid:"ClassIcon_Druid_Small",fire:"DamageType_Fire",frost:"DamageType_Frost",gold:"gold",jeweler:"Marker_Crafter_Jeweler","legendary-star":"legendarystar",lightning:"DamageType_Lightning",mastery:"Mastery_Icon",materials:"Bag_Tab_Materials",necromancer:"ClassIcon_Necro_Small",nightmare:"nightmare_dungeon",obols:"GamblingCurrency",occultist:"Marker_Essence",owned:"AlreadyOwnedDiamondFrame","pact-divinity":"Vampire_Pact_Purple_Icon","pact-eternity":"Vampire_Pact_Green_Icon","pact-ferocity":"Vampire_Pact_Red_Icon",paragon:"ParagonPoint_Icon",physical:"DamageType_Physical",poison:"DamageType_Poison","priority-quest":"Marker_PriorityQuestProgress_Untracked","purveyor-of-curiosities":"Marker_Vendor_Gambling","red-dust":"Shards_Of_Hatred",rogue:"ClassIcon_Rogue_Small",salvage:"ItemTransmogSalvage",season:"Marker_Season","season-quest":"Quest_Season_Progress",shadow:"DamageType_Shadow","side-quest":"Marker_SideQuestAvailable",skill:"Skill_Icon",sorcerer:"ClassIcon_Sorc_Small",spiritborn:"ClassIcon_Spiritborn_Small","stable-master":"Marker_Vendor_Stable",transmog:"transmog","unique-star":"uniquestar",upgrade:"Crafting_UpgradePip_Unlocked",wardrobe:"Marker_Wardrobe",warning:"Warning_Icon",waypoint:889034296,"world-event":"Marker_WorldEvent","world-tier-statue":"Marker_WorldTiers"};const t={deathbringer:"talents-heroclass-deathknight-deathbringer","rider-of-the-apocalypse":"talents-heroclass-deathknight-rideroftheapocalypse",sanlayn:"talents-heroclass-deathknight-sanlayn","aldrachi-reaver":"talents-heroclass-demonhunter-aldrachireaver","fel-scarred":"talents-heroclass-demonhunter-felscarred",annihilator:"talents-heroclass-demonhunter-annihilator","druid-of-the-claw":"talents-heroclass-druid-druidoftheclaw","elunes-chosen":"talents-heroclass-druid-eluneschosen","keeper-of-the-grove":"talents-heroclass-druid-keeperofthegrove",wildstalker:"talents-heroclass-druid-wildstalker",chronowarden:"talents-heroclass-evoker-chronowarden",flameshaper:"talents-heroclass-evoker-flameshaper",scalecommander:"talents-heroclass-evoker-scalecommander","dark-ranger":"talents-heroclass-hunter-darkranger","pack-leader":"talents-heroclass-hunter-packleader",sentinel:"talents-heroclass-hunter-sentinel",frostfire:"talents-heroclass-mage-frostfire",spellslinger:"talents-heroclass-mage-spellslinger",sunfury:"talents-heroclass-mage-sunfury","conduit-of-the-celestials":"talents-heroclass-monk-conduitofthecelestials","master-of-harmony":"talents-heroclass-monk-masterofharmony","shado-pan":"talents-heroclass-monk-shadopan","herald-of-the-sun":"talents-heroclass-paladin-heraldofthesun",lightsmith:"talents-heroclass-paladin-lightsmith",templar:"talents-heroclass-paladin-templar",archon:"talents-heroclass-priest-archon",oracle:"talents-heroclass-priest-oracle",voidweaver:"talents-heroclass-priest-voidweaver",deathstalker:"talents-heroclass-rogue-deathstalker",fatebound:"talents-heroclass-rogue-fatebound",trickster:"talents-heroclass-rogue-trickster",farseer:"talents-heroclass-shaman-farseer",stormbringer:"talents-heroclass-shaman-stormbringer",totemic:"talents-heroclass-shaman-totemic",diabolist:"talents-heroclass-warlock-diabolist",hellcaller:"talents-heroclass-warlock-hellcaller","soul-harvester":"talents-heroclass-warlock-soulharvester",colossus:"talents-heroclass-warrior-colossus","mountain-thane":"talents-heroclass-warrior-mountainthane",slayer:"talents-heroclass-warrior-slayer"};return{empty:true,attr:{unnamed:{req:true}},toNode:function(a){const i=WH.Game;const{dataEnv:n}=WH.markup.getDatabaseDomainInfo(a);if(a.unnamed.startsWith("d4-")){let t=e[a.unnamed.substring(3)];if(typeof t==="string"){t=WH.D4.getStringHash(t,false)}if(t){return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url("${WH.D4.getImageUrlFromHash(t)}")`},dataset:{contiguous:"true"}})}}if(a.unnamed.startsWith("wow-hero-talent-")){const e=i.getEnvByEnv(i.WOW,n);let s=t[a.unnamed.substring(16)];if(s){return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url("${WH.Wow.getTextureAtlasMemberUrl(s,e)}")`,borderRadius:"1000px",position:"relative"},dataset:{contiguous:"true"}})}}if(a.unnamed.startsWith("wow-atlas-")){const e=i.getEnvByEnv(i.WOW,n);const t=a.unnamed.substring(10);if(/^[-a-zA-Z0-9_]+$/.test(t)){return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url("${WH.Wow.getTextureAtlasMemberUrl(t,e)}")`},dataset:{contiguous:"true"}})}}switch(a.unnamed){case"df-talent":return document.createTextNode("⭘");case"df-talent-line":return WH.ce("span",{style:{background:"linear-gradient(0deg, #000 0%, transparent 25%, transparent 75%, #000 100%),"+"linear-gradient(90deg, #000 -25%, var(--color, rgba(255, 209, 0, 0.8)) 50%, #000 125%)",display:"inline-block",height:"0.5em",margin:"0.25em 0",transform:"rotate(45deg)",width:"1em"},dataset:{contiguous:"true"}});case"delves-charged":return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url(${WH.STATIC_URL}/images/icons/wow/${a.unnamed}.png)`},dataset:{contiguous:"true"}});case"professions-tier-1":case"professions-tier-2":case"professions-tier-3":case"professions-tier-4":case"professions-tier-5":return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url(${WH.STATIC_URL}/images/wow/ui/${a.unnamed}.png)`},dataset:{contiguous:"true"}});default:return document.createTextNode("?")}}}})();WH.markup.tags.tab={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{tabs:1},attr:{name:{req:true,valid:/[\S ]+/},icon:{req:false,valid:/\S+/},iconborder:{req:false,valid:/^true$/},id:{req:false,valid:/[\S ]+/},textless:{req:false,valid:/^true$/}},toNode:function(e){var t=e.id?WH.Strings.slug(e.id,true,Locale.getId()):null;if(!t){t=WH.Strings.slug(e.name,true,Locale.getId())}if(!t){t=WH.Strings.guid()}e.name=WH.stringReplace(e.name,"_"," ");if(typeof e["class"]!="undefined"){e["class"]=WH.stringReplace(e["class"],"_"," ")}var a=WH.ce("div");a.whMarkupInfo={id:t,name:e.name,icon:e.icon,iconBorder:e.iconborder==="true",textless:e.textless==="true",class:e["class"]};return a}};WH.markup.tags.table={empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{tr:1},attr:{background:{req:false,valid:WH.markup.regex.noWhitespace},border:{req:false,valid:/^[0-9]+$/},cellspacing:{req:false,valid:/^[0-9]+$/},cellpadding:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)?$/}},toNode:function(e){var t=WH.ce("table",{className:"exclude-units"});WH.markup.applyCommonAttributes(t,e);if(e.background){t.dataset.background=e.background}if(typeof e.border!=="undefined"){t.border=e.border;t.classList.add("markup-table-clean-borders")}if(typeof e.cellspacing!=="undefined"){t.cellSpacing=e.cellspacing}if(typeof e.cellpadding!=="undefined"){t.cellPadding=e.cellpadding}if(e.width!==undefined){t.style.width=e.width+(/^\d+$/.test(e.width)?"px":"");t.style.maxWidth="100%"}t.appendChild(WH.ce("tbody"));return WH.ce("div",{className:"markup-table-wrapper"},t)},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<table\\b[\\s\\S]*?>","</table>","g")){for(var i=0;i<a.length;++i){var n=a[i][1].match(/border[:="]+\s*([0-9]+)/i),s=a[i][1].match(/width[:="]+\s*([0-9]+)/i),r=a[i][1].match(/cellspacing="([\s\S]+?)"/i),o=a[i][1].match(/cellpadding="([\s\S]+?)"/i);e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[table"+(n?" border="+n[1]:"")+(s?" width="+s[1]:"")+(r?" cellspacing="+r[1]:"")+(o?" cellpadding="+o[1]:"")+"]"+WH.markup.tags.table.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/table]")}}return e}};WH.markup.tags.tabs={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{tab:1},attr:{iconborders:{req:false,valid:/^true$/},name:{req:true,valid:/\S+/},size:{req:false,valid:/\S+/},textless:{req:false,valid:/^true$/},uniform:{req:false,valid:/^true$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){e.id=WH.Strings.slug(e.name,true,Locale.getId());var t=document.createDocumentFragment();WH.ae(t,WH.ce("div",{className:"clear exclude-units"}));let a=WH.ce("div",{className:"tabs-wrapper exclude-units"});WH.ae(t,a);WH.ae(a,WH.ce("div",{id:"dsf67g4d-"+e.id+(WH.markup.isPreview?"-preview":"")}));if(e.width){a.style.width=e.width;a.style.maxWidth="100%"}if(e.size==="thin"){a.classList.add("thin")}else if(e.size==="tall"){a.classList.add("tall")}if(e.textless==="true"){a.classList.add("textless-icons")}if(e.uniform==="true"){a.classList.add("uniform-width")}var i=WH.ce("div",{className:"tabbed-contents"});WH.ae(a,i);var n;var s;var r=[];while(e._contents.hasChildNodes()){s=e._contents.removeChild(e._contents.firstChild);n=s.whMarkupInfo;if(e.iconborders==="true"){n.iconBorder=true}if(e.textless==="true"){n.textless=true}r.push(n);var o=WH.ce("div",{className:"exclude-units",id:"tab-"+e.id+"-"+n.id,role:"tabpanel",tabIndex:"0"});o.style.display="none";while(s.hasChildNodes()){WH.ae(o,s.firstChild)}WH.ae(o,WH.ce("div",{className:"clear"}));WH.ae(i,o)}setTimeout(function(e,t,a){var i=new Tabs({parent:WH.ge("dsf67g4d-"+e.id+(a?"-preview":"")),forum:1,noScroll:a?true:false});for(var n=0;n<t.length;++n){var s=t[n];i.add(s.name,{id:e.id+"-"+s.id,icon:s.icon,iconBorder:s.iconBorder,textless:s.textless,class:s["class"]})}i.flush()}.bind(null,e,r,WH.markup.isPreview?"preview":""),0);return t}};WH.markup.tags.talent=(()=>{const e={legacy:[],classic:[],mists:[]};const t=(t,a)=>{const i=WH.ce("div",{className:"talentcalc-markup-parent exclude-units"});const n={embedded:true,hash:t.unnamed.replace(/^#+/,""),editable:t.editable==="true",abilities:t.abilities==="true"};const s=()=>new WH.Wow.TalentCalcClassic(i,n);if(!WH.Wow.TalentCalcClassic?.isReady(false,a.dataEnv)){e.classic.push(s);if(e.classic.length===1){WH.loadAssets("talent-calc-classic",(()=>e.classic.forEach((e=>e()))),a.dataEnv)}}else{s()}return i};const a=(t,a)=>{if(t.unnamed.indexOf("-")<0){t.glyphs="false"}const i=WH.ce("div",{className:"talentcalc-markup-parent exclude-units"});if(t.glyphs==="false"){i.className+="talentcalc-markup-no-glyphs"}if(t.specs!=="true"){i.className+=" talentcalc-markup-no-specs"}const n={parent:i,embedded:true,markup:true,hash:t.unnamed.replace(/^#+/,""),editable:t.editable==="true",dataDomain:a.host,dataEnv:a.dataEnv};if(t.builds){n.builds=JSON.parse(t.builds)}const s=()=>new TalentCalc(n);if(!WH.isSet("TalentCalc")){e.legacy.push(s);if(e.legacy.length===1){WH.loadAssets("talent-calc",(()=>e.legacy.forEach((e=>e()))),a.dataEnv)}}else{s()}return i};const i=(t,a)=>{const i=WH.ce("div",{className:"talentcalc-markup-parent exclude-units"});const n={dataEnv:a.dataEnv,editable:t.editable==="true",embedded:true,hash:t.unnamed.replace(/^#+/,"")};const s=()=>WH.React.initComponent(i,"modules/wow/mists/TalentCalc",n);if(!WH.Wow.TalentCalcMists?.isReady(a.dataEnv)){e.mists.push(s);if(e.mists.length===1){WH.loadAssets("talent-calc-mists",(()=>e.mists.forEach((e=>e()))),a.dataEnv)}}else{s()}return i};return{empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},abilities:{req:false,valid:/^true|false$/},editable:{req:false,valid:/^true$/},glyphs:{req:false,valid:/^false$/},specs:{req:false,valid:/^true$/},builds:{req:false,valid:/^true|false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:e=>{const n=WH.markup.getDatabaseDomainInfo(e);switch(WH.getDataTree(n.dataEnv)){case WH.dataTree.CLASSIC:case WH.dataTree.TBC:case WH.dataTree.WRATH:case WH.dataTree.CATA:return t(e,n);case WH.dataTree.MISTS:return i(e,n)}return a(e,n)}}})();WH.markup.tags.td={empty:false,itrim:true,allowedParents:{tr:1},attr:{unnamed:{req:false,valid:/^header$/},align:{req:false,valid:/^(right|left|center|justify)$/i},background:{req:false,valid:WH.markup.regex.noWhitespace},colspan:{req:false,valid:/^[0-9]+$/},rowspan:{req:false,valid:/^[0-9]+$/},valign:{req:false,valid:/^(top|middle|bottom|baseline)$/i},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){var t=WH.ce(e.unnamed?"th":"td");WH.markup.applyCommonAttributes(t,e);if(e.align!=undefined){t.style.textAlign=e.align}if(e.valign!=undefined){t.style.verticalAlign=e.valign}if(e.colspan!=undefined){t.colSpan=e.colspan}if(e.rowspan!=undefined){t.rowSpan=e.rowspan}if(e.width!=undefined){t.style.width=e.width;t.style.maxWidth="100%"}if(e.background){t.dataset.background=e.background}return t},fromHtml:function(e,t){t=t||0;var a=["td","th"],i;for(var n=0;n<a.length;++n){if(i=WH.markup.matchOuterTags(e,"<"+a[n]+"\\b[\\s\\S]*?>","</"+a[n]+">","g")){for(var s=0;s<i.length;++s){var r=i[s][1].match(/width[:="]+\s*([0-9]+)/i),o=i[s][1].match(/align="([\s\S]+?)"/i),l=i[s][1].match(/valign="([\s\S]+?)"/i),c=i[s][1].match(/colspan="([\s\S]+?)"/i),u=i[s][1].match(/rowspan="([\s\S]+?)"/i);e=e.replace(i[s][1]+i[s][0]+i[s][2],"\n\t\t"+Array(t+1).join("\t")+"[td"+(a[n]=="th"?"=header":"")+(r?" width="+r[1]:"")+(o?" align="+o[1]:"")+(l?" valign="+l[1]:"")+(c?" colspan="+c[1]:"")+(u?" rowspan="+u[1]:"")+"]"+WH.markup.tags.td.fromHtml(i[s][0],t+1)+"[/td]")}}}return e}};WH.markup.tags.threat={entityType:WH.Types.THREAT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.THREAT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.THREAT)};WH.markup.tags["tier-content"]={trim:true,itrim:true,toNode:function(){return WH.ce("div",{className:"tier-content"})}};WH.markup.tags["tier-label"]={trim:true,itrim:true,attr:{bg:{req:false,valid:WH.markup.regex.noWhitespace},icon:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){let t=WH.ce("div",{className:"tier-label wh-heading-responsive",dataset:{background:e.bg||"q0",qualityBg:e.bg.replace("q","")||"0",textStyle:"display-3-bold"}});if(e.icon){t.classList.add("fa","fa-"+e.icon)}let a=e._contents&&e._contents.lastChild;if(a&&a.nodeType===Node.TEXT_NODE){let e=a.nodeValue;let t=e.match(/[+-]$/);if(t){a.parentNode.replaceChild(WH.ce("span",{className:"tier-label-text",innerText:e.substr(0,e.length-1)},WH.ce("span",{className:"tier-label-superscript",innerText:t[0]})),a)}}return t}};WH.markup.tags["tier-list"]={block:true,empty:false,itrim:true,trim:true,allowedChildren:{tier:1},attr:{unnamed:{req:false,valid:WH.markup.regex.noWhitespace},grid:{req:false,empty:true}},toNode:function(e){const t=WH.ce("div",{className:(e.unnamed?"tier-list-"+e.unnamed:"tier-list-rows")+" exclude-units"});if(e.grid!=null&&e.unnamed==="rows"){t.dataset.contentMode="badge-grid"}return t}};WH.markup.tags.tier={empty:false,itrim:true,allowedChildren:{"tier-label":1,"tier-content":1},toNode:function(){return WH.ce("div",{className:"tier-list-tier"})}};WH.markup.tags.time=(()=>{const e=function(e){var t;if(e.server){t=WH.getServerTime().getTime()/1e3}else{t=(new Date).getTime()/1e3}var a=0;if(e.until){a=e.until-t}else{a=t-e.since}if(a>0){return WH.formatTimeElapsed(a)}else{return"0 "+WH.TERMS.seconds_lc}};const t=function(t,a){t.firstChild.nodeValue=e(a)};return{empty:true,attr:{until:{req:false,valid:/^\d+$/},since:{req:false,valid:/^\d+$/},server:{req:false,valid:/^true$/}},validate:function(e){if(!e.until&&!e.since){return false}return true},toNode:function(a){var i=WH.ce("span");i.title=new Date((a.until?a.until:a.since)*1e3).toLocaleString();WH.st(i,e(a));setInterval(t.bind(null,i,a),5e3);return i}}})();WH.markup.tags.title={entityType:WH.Types.TITLE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TITLE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TITLE)};WH.markup.tags.toc={block:true,post:true,trim:true,ltrim:true,rtrim:true,collect:["h2","h3","major-heading","minor-heading","toggler"],exclude:{minibox:["h2","h3","major-heading","minor-heading","toggler"],tabs:["h2","h3","major-heading","minor-heading","toggler"]},allowedClass:WH.markup.CLASS.STAFF,attr:{h3:{req:false,valid:/^false$/},"minor-heading":{req:false,valid:/^false$/}},postParseNode:(e,t)=>{let a=document.createDocumentFragment();let i;let n=0;let s;let r=[a];const o=e=>{const t=WH.Game.getKey(WH.Game.get());const a=WH.ce("b",{className:"default-section-heading"});const i=t==="wow"?WH.Icon.getIconUrl("inv_misc_note_02"):WH.STATIC_URL+"/images/toc/diablo-sections.webp";const n=WH.ce("ins");n.style.backgroundImage=`url(${i})`;const s=WH.ce("div",{className:"iconmedium",dataset:{game:t,kind:t==="wow"?"round":"diamond"}},n);const r=WH.ct(WH.TERMS.sections);WH.ae(a,s);WH.ae(a,r);WH.aef(e,a)};const l=()=>{let e=WH.ce("ul");let t=r.length-1;if(t===0){e.className="markup-toc"}WH.ae(r[t],e);r.push(e)};const c=(e,t)=>{let a=t.attr.toc||(t.name==="toggler"?t.attr.name:t.attr._textContents);let o=WH.Strings.slug(t.attr.id||a,true);let l=WH.ce("li");WH.ae(r[r.length-1],l);let c=WH.ce("a",{dataset:{disableWowheadTooltip:"true"},href:`#${o}`},WH.ct(a));WH.aE(c,"click",(e=>{e.preventDefault();WH.setHash(o);WH.scrollTo(WH.ge(o));s?.hide(e)}));WH.ae(l,c);i=e;n++};const u=(e,t,a,i)=>{let n=WH.ce("button",{className:"markup-toc-button"},WH.ct(e));let r=()=>{s=new WH.Popover(n,(()=>{}),{headerText:a,headerTextSubtitle:i,lightbox:true,slidePosition:"left",onShow:e=>{while(t.childNodes.length){WH.ae(e,t.childNodes[0])}},onHide:()=>WH.DOM.isVisible(t)&&s.skipHideAnimation(),afterHide:e=>{while(e.childNodes.length){WH.ae(t,e.childNodes[0])}}})};if(WH.Popover){r()}else{WH.loadAssets("popover",r,WH.getDataEnv())}return n};l();let d=[];[t.h2,t["major-heading"],e.h3!=="false"?t.h3:null,e["minor-heading"]!=="false"?t["minor-heading"]:null,t.toggler].filter(Boolean).forEach((e=>e.forEach((e=>d.push(e)))));d.sort(((e,t)=>e.collectionIndex-t.collectionIndex));const f=d.some((e=>e.name==="h2"||e.name==="major-heading"));d.forEach((e=>{switch(e.name){case"toggler":if(e.attr.toc!=="false"&&e.attr.name){let t=parseInt(e.attr.size)||3;if(t===3&&i==="h2"){l()}else if(t===2&&i==="h3"){r.pop()}c(`h${t}`,e)}break;case"h2":case"major-heading":if(e.attr.toc!=="false"){if(i==="h3"){r.pop()}c("h2",e)}break;case"h3":case"minor-heading":if(e.attr.toc!=="false"&&(i||t.h2.length===0||t["major-heading"].length===0)){if(i==="h2"){l()}else if(!i&&f){WH.ae(r[r.length-1],WH.ce("li",{},WH.ct(WH.TERMS.overview)));l()}c("h3",e)}break}}));let h=WH.ce("div",{className:"markup-toc-wrapper exclude-units"});let p=WH.ge("interior-sidebar-toc");if(p){WH.ae(h,u(WH.term("show_format",WH.TERMS.tableofcontents),WH.qs(".interior-sidebar-inner"),WH.qs(".interior-sidebar-header-text-title")?.innerText.trim()||WH.TERMS.guideContents,WH.qs(".interior-sidebar-header-text-subtitle")?.innerText.trim()));let e=WH.ge("interior-sidebar-related-markup");if(e){if(e.firstChild.nodeName==="UL"){o(e)}WH.qsa("li[class]",e).forEach((e=>e.className=""));let t=WH.qs('a[href$="wowhead.com'+location.pathname+'"]',e);if(t){t.classList.add("current");t.dataset.disableWowheadTooltip="true";t.closest("li")?.classList.add("current");t.after(a);WH.de(p);return h}}WH.ee(p);o(p);WH.ae(p,a);return h}let m=WH.ce("div",{className:"markup-toc-content"});if(n>5){WH.ae(h,u(WH.term("show_format",WH.TERMS.tableofcontents),m,WH.TERMS.tableofcontents))}let H=WH.getImitationHeading(WH.TERMS.tableofcontents,3,{classes:["markup-toc-heading",e.first&&"first",e.last&&"last"].filter(Boolean).join(" ")});WH.markup.applyCommonAttributes(H,e);WH.ae(m,H);WH.ae(m,a);WH.ae(h,m);return h}};WH.markup.tags.toggler={empty:false,attr:{id:{req:false,valid:/^[a-z0-9_-]+$/i},closed:{req:false,valid:/^(true|false)$/i},class:{req:false,valid:/^[a-z0-9 _-]+$/i},icon:{req:false,valid:/^[a-z0-9 _-]+$/i},name:{req:false,valid:/^.+$/i},size:{req:false,valid:/^[2-6]$/i},toc:{req:false,valid:/^.+$/i},unnamed:{req:false,valid:/^hidden$/i}},toNode:function(e){if(e.id){var t=WH.ce("a");t.href="javascript:";t.className="disclosure-"+(e.unnamed?"off":"on");WH.aE(t,"click",WH.disclose.bind(null,"#"+e.id,t));return t}var a=document.createDocumentFragment();var i=(e.toc!=="false"&&e.toc?WH.Strings.slug(e.toc,true):"")||(e.name?WH.Strings.slug(e.name,true):"")||WH.Strings.guid();if(e.toc!=="false"){i=WH.markup.generateTocId(i)}var n=WH.getMajorHeading("",e.size||3,undefined,{id:i});a.appendChild(n);var s=WH.ce("div",{className:"exclude-units"});a.appendChild(s);s.dataset.markupContentTarget=1;if(e.closed=="true"){s.style.display="none"}var t=WH.ce("a");WH.ae(n,t);t.href="javascript:";t.className="toggler-"+(e.closed=="true"?"off":"on");WH.aE(t,"click",WH.toggle.bind(t,s));WH.ae(t,WH.ce("span",{className:"fa fa-chevron-right fa-fw"}));var r=WH.ce("span");WH.ae(t,r);r.className="toggler-title";if(e.icon){r.className+=" toggler-title-with-icon";r.appendChild(Icon.create(e.icon,0,null,false,null,null,null,null,true))}if(e["class"]){r.className+=" "+e["class"]}WH.ae(r,WH.ct(e.name||WH.TERMS.clicktotoggledisplay_stc));return a}};WH.markup.tags.tooltip={empty:false,ltrim:true,rtrim:true,attr:{name:{req:false,valid:/\S+/},bare:{req:false,valid:/^true$/i},label:{req:false,valid:/[\S ]+/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(!e.unnamed&&!e.name){return false}return true},toNode:function(e){var t=document.createElement("div");if(e.label){var a=document.createElement("table");t.appendChild(a);var i=document.createElement("tr");a.appendChild(i);var n=document.createElement("td");i.appendChild(n);n.className="q0";n.style.width="300px";var s=document.createElement("small");n.appendChild(s);s.appendChild(document.createTextNode(e.label))}t.appendChild(e._contents);WH.markup.tooltipTags[e.name]=t.innerHTML;if(e.bare){WH.markup.tooltipTagsWithRawText[e.name]=true}return null}};WH.markup.tags["top-builds"]={empty:true,attr:{background:{req:false,valid:/^false$/},boss:{req:true,valid:/^.+$/},class:{req:true,valid:/^.+$/},difficulty:{req:true,valid:/^(heroic|mythic)$/},spec:{req:true,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(){return null}};WH.markup.tags["top-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},class:{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Gatherer;const a=WH.Strings;const i=WH.WarcraftLogs;let n=a.slug(e["class"]||"all",true);let s=a.slug(e.spec||"all",true);let r=WH.getPageData(["markup.topCovenants",n,s].join("."));if(!r||!r.topCovenants||!r.topCovenants.length){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(a.nbsp+" "+WH.TERMS.notenoughdata));return e}let o=WH.ce("div",{className:"top-covenants exclude-units"});if(e.background==="false"){o.classList.add("no-background")}let l=WH.ce("div");WH.ae(o,l);let c=0;r.topCovenants.sort((function(e,a){return WH.stringCompare(t.getName(WH.Types.COVENANT,e.id),t.getName(WH.Types.COVENANT,a.id))}));for(let e=0,n;n=r.topCovenants[e];e++){let e=t.get(WH.Types.COVENANT,n.id);let s=a.slug(e.name_enus||"");let r=WH.ce("span",{className:"covenant-"+s+" icon-"+s},WH.ct([e["name_"+Locale.getName()],WH.Strings.formatNumber(n.pop/100,true,0,1)].join(" ")));WH.ae(l,r);WH.Tooltips.attach(r,i.getCovenantTooltip.bind(undefined,n),"q",{byCursor:true});c++}while(c<4){WH.ae(l,WH.ce("span"));c++}return o}};WH.markup.tags["top-mythic-classes"]={empty:true,attr:{unnamed:{req:true,valid:/^[A-Za-z0-9' -]+$/},affixes:{req:true,valid:/^(current|all)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.getPageData(["markup.topMythicClasses",e.unnamed,e.affixes].join("."));let a=WH.ce("div");WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicclassesdata_tip));if(!t){return a}var i=WH.ce("div",{className:"top-mythic-classes exclude-units"});var n=["tank","healer","dps"];for(var s=0,r;r=t.classes[s];s++){var o=WH.staticUrl+"/images/classes/symbols/icon-"+WH.Wow.PlayerClass.getIdString(r.class_id)+".png";var l=Math.round(r.total/t.counts.total*100)+"%";var c=WH.ce("div",{className:"top-mythic-classes-class"});WH.ae(i,c);var u=WH.ce("div",{className:"top-mythic-classes-class-content"});WH.ae(c,u);WH.ae(u,WH.ce("div",{className:"top-mythic-classes-class-crest",style:{backgroundImage:"url("+o+")"}}));var d=WH.ce("div",{className:"top-mythic-classes-class-title"});WH.ae(u,d);WH.ae(d,WH.ce("span",{className:"c"+r.class_id},WH.ct(WH.Wow.PlayerClass.getName(r.class_id))));WH.ae(d,WH.ce("small",{},WH.ct(l)));for(var f=0,h;h=n[f];f++){if(r.hasOwnProperty(h)){var p=WH.ce("span");WH.ae(p,WH.ce("b",{},WH.ct(Math.round(r[h]/t.counts[h]*100))));WH.ae(p,WH.ct("%"));WH.ae(u,WH.ce("span",{className:"iconrole iconsmall "+h},p))}}}if(!i.hasChildNodes()){return a}return i}};WH.markup.tags["top-mythic-runs"]={empty:true,attr:{unnamed:{req:true,valid:/^.*$/},affixes:{req:true,valid:/^.*$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.getPageData(["markup.topMythicRuns",e.unnamed,e.affixes].join("."));let a=WH.ce("div");WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicrunsdata_tip));if(!t){return a}var i=WH.ce("div",{className:"top-mythic-runs exclude-units"});var n=5;for(var s=0,r;r=t.runs[s];s++){r=r.run;var o=WH.ce("div",{className:"top-mythic-runs-run"});WH.ae(i,o);WH.ae(o,WH.ce("div",{className:"top-mythic-runs-run-level"},WH.ct(WH.TERMS.mythicplus+WH.TERMS.wordspace_punct+r.mythic_level)));var l=r.clear_time_ms/1e3;var c=Math.floor(l/60);l=Math.round(l-c*60);WH.ae(o,WH.ce("div",{className:"top-mythic-runs-run-time"},WH.ct(c+WH.TERMS.wordspace_punct+(c===1?WH.TERMS.minute_lc:WH.TERMS.minutes_lc)+WH.TERMS.wordspace_punct+l+WH.TERMS.wordspace_punct+(l===1?WH.TERMS.second_lc:WH.TERMS.seconds_lc))));if(r.roster.length){var u=document.createDocumentFragment();var d=document.createDocumentFragment();for(var f=0,h;h=r.roster[f];f++){h=h.character;var p=WH.Wow.PlayerClass.Specialization.getSlug(h["class"].id,h.spec.id);var m=Icon.create(WH.Wow.PlayerClass.Specialization.getIconName(h.spec.id),Icon.sizeIds.small,undefined,"/"+p+"-"+WH.Wow.PlayerClass.getSlug(h["class"].id)+"-guide",undefined,undefined,undefined,undefined,true);WH.Tooltips.attach(m,'<span class="no-wrap">'+WH.sprintf(WH.TERMS.guide_format,WH.TERMS.specclass_format.replace("%1$s",WH.Wow.PlayerClass.Specialization.getName(h.spec.id)).replace("%2$s",WH.Wow.PlayerClass.getName(h["class"].id)))+"</span>","c"+h["class"].id);WH.ae(u,WH.ce("td",{},m));let e=h.race.id===WH.Wow.Race.ID_BLOOD_ELF?WH.Wow.Gender.Female:WH.Wow.Gender.Male;let t=WH.Icon.create(WH.Wow.Race.getIcon(h.race.id,e),WH.Icon.SMALL,WH.Entity.getUrl(WH.Types.RACE,h.race.id,WH.Wow.Race.getName(h.race.id)),{span:true});WH.Tooltips.attach(t,WH.Wow.Race.getName(h.race.id),"q");WH.ae(d,WH.ce("td",{},t))}var H=WH.ce("table");WH.ae(o,H);WH.ae(H,WH.ce("tr",{},u));WH.ae(H,WH.ce("tr",{},d))}if(e.affixes==="all"){var g=WH.ce("div",{className:"top-mythic-runs-run-affixes"});WH.ae(o,g);WH.ae(g,WH.ct(WH.TERMS.affixes+WH.TERMS.colon_punct));for(var W=0,E;E=r.weekly_modifiers[W];W++){var _=WH.Icon.create(E.icon,WH.Icon.SMALL,WH.Entity.getUrl(WH.Types.AFFIX,E.id,E.name),{span:true});var T=Icon.getLink(_);T.setAttribute("data-whattach","true");WH.ae(g,_)}}if(s+1===n){break}}if(!i.hasChildNodes()){return a}return i}};WH.markup.tags.tr={empty:false,itrim:true,allowedChildren:{td:1},allowedParents:{table:1},attr:{background:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){var t=WH.ce("tr");WH.markup.applyCommonAttributes(t,e);if(e.background){t.dataset.background=e.background}return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<tr\\b[\\s\\S]*?>","</tr>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n\t"+Array(t+1).join("\t")+"[tr]"+WH.markup.tags.tr.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/tr]")}}return e}};WH.markup.entityTag(WH.Types.TRADING_POST_ACTIVITY);WH.markup.tags["transmog-set"]={entityType:WH.Types.TRANSMOG_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TRANSMOG_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TRANSMOG_SET)};WH.markup.tags.twitch={empty:true,attr:{unnamed:{req:true,valid:/^\S+$/},width:{req:false,valid:/^[0-9]+%?$/},height:{req:false,valid:/^[0-9]+%?$/},time:{req:false,valid:/^(?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=function(){let t=640;let a;let i;let n=16/9;if((e.width??"").includes("%")&&(e.height??"").includes("%")){a=e.width;i=e.height}else if((e.width??"").includes("%")){a=e.width;i=`${parseInt(a)/n}%`}else if((e.height??"").includes("%")){i=e.height;a=`${parseInt(i)*n}%`}else if(e.width&&e.height){a=parseInt(e.width);i=parseInt(e.height);n=a/i;if(a>t){a=t;i=a/n}}else if(e.width){a=Math.min(parseInt(e.width),t);i=a/n}else if(e.height){i=parseInt(e.height);a=i*n;if(a>t){a=t;i=a/n}}else{a=t;i=a/n}return{width:a,height:i}}();const a=WH.ce("div",{className:"wh-twitch exclude-units"});a.style.maxWidth=""+t.width+"px";if(e.height&&e.width){a.style.aspectRatio=`${e.width} / ${e.height}`}else{a.style.aspectRatio="16 / 9"}let i=function(){if(/^[a-zA-Z0-9_-]{4,25}$/.test(e.unnamed)){return{type:"channel",id:e.unnamed,time:undefined}}let t;if(t=e.unnamed.match(/\/videos?\/(\d+)/)){let a={type:"video",id:t[1],time:undefined};if(t=e.unnamed.match(/[&?]t=((?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?)/)){a.time=t[1]}return a}if(t=e.unnamed.match(/clips\.twitch\.tv\/([a-zA-Z0-9_-]+)/)){return{type:"clip",id:t[1],time:undefined}}if(t=e.unnamed.match(/\/clips?\/([a-zA-Z0-9_-]+)/)){return{type:"clip",id:t[1],time:undefined}}if(t=e.unnamed.match(/twitch\.tv\/([a-zA-Z0-9_-]{3,25})/)){return{type:"channel",id:t[1],time:undefined}}return{type:undefined,id:undefined,time:undefined}}();let n="&parent="+encodeURIComponent(location.hostname);n+="&autoplay=false";if(e.time&&i.type==="video"){n+="&time="+encodeURIComponent(e.time)}else if(i.time){n+="&time="+encodeURIComponent(i.time)}switch(i.type){case"channel":WH.ae(a,WH.ce("iframe",{ariaLabel:WH.term("watchChannel_format",i.id),className:"wh-twitch-inner",src:"https://player.twitch.tv/?channel="+i.id+n,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"}));return a;case"video":WH.ae(a,WH.ce("iframe",{ariaLabel:WH.term("watchVideoFrom_format",i.id),className:"wh-twitch-inner",src:"https://player.twitch.tv/?video=v"+i.id+n,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"}));return a;case"clip":WH.ae(a,WH.ce("iframe",{ariaLabel:WH.term("watchVideoFrom_format",i.id),className:"wh-twitch-inner",src:"https://clips.twitch.tv/embed?clip="+i.id+n,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"}));return a}return WH.ce("div",{className:"error-message exclude-units",style:{border:"1px dashed",boxSizing:"border-box",height:t.height+"px",width:t.width+"px",padding:"5px"}},WH.ct("Error: Could not detect Twitch embed type for ["+e.unnamed+"]."))}};WH.markup.tags.u={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("ins");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(ins|u)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[u]$2[/u]")}};WH.markup.tags.ul={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(e){var t=WH.ce("ul",{className:"exclude-units"});var a=[];if(e.first){a.push("first")}if(e.last){a.push("last")}if(a.length>0){t.className=a.join(" ")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<ul\\b[\\s\\S]*?>","</ul>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[ul]"+WH.markup.tags.ul.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/ul]")}}return e}};WH.markup.tags.url={allowedClass:WH.markup.CLASS.USER,allowInReplies:true,empty:false,helpText:"[url=https://www.google.com]"+WH.TERMS.link+"[/url]",attr:{unnamed:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},site:{req:false,valid:WH.markup.regex.dataEnv},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/},guide:{req:false,valid:/^\d+$/},hash:{req:false,valid:/\S+/}},validate:function(e){if(e.onclick&&WH.markup.allow<WH.markup.CLASS.ADMIN){return false}if(e.tooltip&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(e.unnamed&&/^(mailto:|irc:)/i.test(e.unnamed.trim())&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(e.unnamed&&/^(javascript:)/i.test(e.unnamed.trim())){return false}if(e.unnamed&&e.unnamed.match(/^\/\/https?:\/\//)){return false}if(e.unnamed&&e.unnamed.match(/^[[\]]/)){return false}if(e.hash&&!e.guide){return false}if(e.unnamed&&e.guide){return false}return true},getUrl:function(e){return this.validate(e)?this.getUrlFromAttr(e):null},toNode:function(attr){let url=WH.markup.tags.url.getUrlFromAttr(attr);if(url==null){return document.createDocumentFragment()}let a=WH.ce("a",{href:url,dataset:{contiguous:"true"}});WH.markup.applyCommonAttributes(a,attr);let isExternal=!url.startsWith("#")&&url!=="javascript:"&&WH.markup.isUrlExternal(url);if(isExternal||attr.newwindow){a.target="_blank"}if(attr.rel){a.rel=attr.rel}if(attr.onclick){WH.aE(a,"click",function(code){return function(){eval(code)}}(attr.onclick))}if(attr.tooltip){WH.markup.attachMarkupTooltip(a,attr.tooltip,attr.tooltip2)}return a},fromHtml:function(e){return e.replace(/<a\b[^>]*?href=\"(.+?)\"[\s\S]*?>([\s\S]*?)<\/a>/gi,"[url=$1]$2[/url]").replace(/\[url=[^\]]+\]\[\/url\]/g,"")},getUrlFromAttr(e){let t=WH.markup.getDataEnvFromSiteAttr(e.site);if(e.unnamed){return WH.markup.isUrlSafe(e.unnamed,true)?WH.markup.finalizeUrl(e.unnamed,t):undefined}else if(e.guide){let a=WH.Gatherer.get(WH.Types.GUIDE,e.guide);let i=a&&a.url||WH.Entity.getUrl(WH.Types.GUIDE,e.guide,undefined,undefined,t);if(e.hash){i+=`#${e.hash}`}return i}else{return WH.markup.isUrlSafe(e._textContents,true)?WH.markup.finalizeUrl(e._textContents,t):undefined}}};WH.markup.tags["video-ad"]={allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,value:/^(left|right)$/}},empty:true,trim:true,toNode:function(e){if(!WH.WAS.showAds()){return WH.ce("div")}var t=WH.ce("div",{className:"exclude-units",id:"video-pos-page"});if(e.unnamed){t.className="video-pos-"+e.unnamed}return t}};WH.markup.tags.video={empty:true,attr:{border:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},id:{req:true,valid:/^[0-9]+$/},loop:{req:false,valid:/^(true|false)$/},shadow:{req:false,valid:/^(true|false)$/},unnamed:{req:false,valid:/^embed$/i},width:{req:false,valid:WH.markup.regex.isInt}},ltrim:true,rtrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!g_videos[e.id]){return WH.ce("b",{},WH.ct("Video #"+e.id))}var t=g_videos[e.id];var a=[];var i=[];if(e.unnamed){switch(t.videoType){case 1:return WH.markup.tags.youtube.toNode({unnamed:t.videoId,width:e.width});case 2:let a=WH.ce("video",{controls:true,loop:e.loop==="true"},WH.ce("source",{src:WH.Url.generateAnonymous("/video-stream/"+t.id+"-"+t.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})}));if(t.thumbnailScreenshot){let i=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,t.thumbnailScreenshot)||{};if(i.id){let n=WH.getScreenshotUrl(i.id,"normal",{description:t.videoId,imageType:i.imageType,staffOnly:i.staffOnly});if(e.width){n+="?maxWidth="+e.width}a.poster=n;a.preload="metadata"}}if(e.width){a.style.width=e.width+"px"}return a;default:return WH.ce("b",{},WH.ct("Video id "+e.id+" cannot be embedded with unsupported type: "+t.videoType))}}if(!g_videos[WH.markup.mediaUid]){g_videos[WH.markup.mediaUid]=[]}let n=t.videoId;if(t.videoType===2){n=e.id+"-"+n}var s=WH.ce("div",{className:"exclude-units",style:{display:"inline-block",position:"relative",zoom:1}});var r=WH.ce("a",{href:WH.sprintf(vi_siteurls[t.videoType],n)});WH.ae(s,r);WH.markup.applyCommonAttributes(r,e);WH.aE(r,"click",(function(e){if(!WH.isLeftClick(e)){return}VideoViewer.show({videos:WH.markup.mediaUid,pos:g_videos[WH.markup.mediaUid].length});e.preventDefault()}));if(vi_thumbnails[t.videoType]){var o=WH.ce("img",{src:WH.sprintf(vi_thumbnails[t.videoType],t.videoId)});if(e.width){o.style.width=e.width+"px"}o.loading="lazy";WH.ae(r,o);o.classList.add("content-image");if(e.border!==undefined){if(e.border==0){o.classList.add("no-border")}else{o.classList.add("border");o.style.borderWidth=""+e.border+"px"}}else{if(e.shadow!=="false"){o.classList.add("content-image-shadowed")}}if(e["float"]){o.classList.add("markup-float-"+e["float"])}if(t.hasCaption){o.alt=t.caption}WH.ae(r,WH.ce("img",{src:WH.staticUrl+"/images/icons/play-sm.png",style:{opacity:"0.6",position:"absolute",width:"48px",height:"48px",top:"23px",left:"38px"}}))}else{WH.st(r,t.caption)}g_videos[WH.markup.mediaUid].push(WH.dO(t));return s}};WH.markup.tags.visitedpage={empty:false,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){$.post("/visited-page",{id:e.unnamed},(function(){AchievementCheck()}));return null}};WH.markup.tags.wowheadresponse={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:true,valid:/[\S ]+/},roles:{req:true,valid:/[0-9]+/}},allowedModes:{article:1,quickfacts:1,comment:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.unnamed.trim();if(t.length<=0){return document.createDocumentFragment()}let a=WH.ce("div",{className:"box exclude-units",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(a,e);if(e.first){a.classList.add("firstmargin")}if(e.last){a.classList.add("last")}var i="comment-role-moderator";if(e.roles&U_GROUP_ADMIN){i="comment-role-admin"}a.classList.add(i);var n=WH.ce("small",{className:"icon-wowhead"});WH.ae(a,n);let s=WH.TERMS.said_format.split("%s");if(s[0]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(s[0])))}var r=WH.ce("b",{className:i});WH.ae(n,r);var o=WH.ce("a",{href:WH.Url.generatePath("/user="+t)},WH.ct(t));WH.ae(r,o);if(s[1]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(s[1])))}WH.ae(a,WH.ce("div",{className:"pad"}));return a}};WH.markup.tags.wrapper={trim:true,itrim:true,attr:{width:{req:false,valid:/^[0-9]+(%|px)$/}},toNode:function(e){const t="100%";const a=e.width??t;const i=WH.ce("div",{className:"wh-wrapper"});i.style.setProperty("--wh-wrapperWidth",a);let n;WH.aE(document.body,"resize",(()=>{const e=document.body.getBoundingClientRect().width;let t=a;if(!n&&i.clientWidth<i.scrollWidth){n=e;t="100%"}else if(n&&e<=n){t="100%"}i.style.setProperty("--wh-wrapperWidth",t)}));return i}};WH.markup.tags.youtube={empty:true,attr:{unnamed:{req:true,valid:/\S+/},title:{req:false,valid:/[\S ]+/},thumb:{req:false,valid:/\S+/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},start:{req:false,valid:/^\d+$/},end:{req:false,valid:/^\d+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.width?e.width:640;var a=e.height?e.height:360;var i={height:a,width:t,videoId:e.unnamed,playerVars:{autoplay:1}};if(e.start){i.playerVars.start=e.start}if(e.end){i.playerVars.end=e.end}if(!WH.markup.tags.youtube.listeningForApiReady){WH.markup.tags.youtube.listeningForApiReady=true;var n;if(WH.isSet("onYouTubeIframeAPIReady")&&typeof window.onYouTubeIframeAPIReady=="function"){n=window.onYouTubeIframeAPIReady}else{n=function(){}}window.onYouTubeIframeAPIReady=function(){WH.markup.tags.youtube.apiReady=true;n()};if(!WH.isSet("YT")){window.YT={};WH.ajaxIshRequest("https://www.youtube.com/iframe_api",true)}}var s={yt:i,loaded:false};var r=WH.ce("div",{className:"wh-youtube exclude-units"});if(e.height&&e.width){r.style.aspectRatio=`${e.width} / ${e.height}`}else{r.style.aspectRatio="16 / 9"}s.container=r;var o=a/t*100;var l="https://i.ytimg.com/vi/"+i.videoId+"/sddefault.jpg";if(t<=480||$(document).width()<=500){l="https://i.ytimg.com/vi/"+i.videoId+"/hqdefault.jpg"}if(e.thumb){l=e.thumb;r.classList.add("wh-youtube-custom-thumb")}if(o<=35){r.classList.add("wh-youtube-short")}r.style.background="url("+l+")";r.style.maxWidth=""+t+"px";let c=WH.ce("a",{ariaLabel:WH.TERMS.play,className:"wh-youtube-inner",href:"javascript:",style:{paddingTop:""+o+"%"}});WH.ae(r,c);if(e.title){WH.ae(c,WH.ce("div",{className:"wh-youtube-title"},WH.ct(e.title)))}WH.ae(c,WH.ce("i",{className:"fa fa-circle"}));WH.ae(c,WH.ce("i",{className:"fa fa-play-circle"}));WH.aE(c,"click",WH.markup.tags.youtube.onClick.bind(s));return r},fromHtml:function(e){var t;if(t=e.match(/<iframe\b[\s\S]*?src="[\s\S]*?youtube\.com\/embed\/[\s\S]*?"[\s\S]*?><\/iframe>/gi)){for(var a=0;a<t.length;++a){var i=t[a].match(/src="[\s\S]*?youtube\.com\/embed\/([\s\S]*?)"/i),n=t[a].match(/width[:="]+\s*([0-9]+)/i),s=t[a].match(/height[:="]+\s*([0-9]+)/i),r=t[a].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(t[a],"[youtube="+i[1]+(n?" width="+n[1]:"")+(s?" height="+s[1]:"")+"]")}}return e},listeningForApiReady:false,apiReady:false,onClick:function(){if(this.loaded){return}if(!WH.markup.tags.youtube.apiReady){setTimeout(WH.markup.tags.youtube.onClick.bind(this),125);return}this.container.classList.add("wh-youtube-loaded");this.loaded=true;this.player=new YT.Player(this.container.firstChild,this.yt)}};WH.markup.tags.zone={entityType:WH.Types.ZONE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ZONE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ZONE)};WH.markup.tags["<text>"]={empty:true,noHelp:true,allowInReplies:true,toNode:function(){const e=new RegExp("(.*\\.)?("+["allakhazam.com","battle.net","be-imba.hu","blizzard.com","curse.com","elitistjerks.com","eq2interface.com","eqinterface.com","fanbyte.com","guildfans.com","guildwork.com","hearthhead.com","hearthstonetopdecks.com","joystiq.com","lotrointerface.com","mmo-champion.com","mmoui.com","raidbots.com","raider.io","sc2ranks.com","tankspot.com","thottbot.com","torchlightarmory.com","torhead.com","vginterface.com","vindictusdb.com","warcraftlogs.com","worldoflogs.com","worldofwarcraft.com","wow-europe.com","wow-heroes.com","wowhead.com","wowinsider.com","wowinterface.com","wowpedia.org","wowwiki.com","zam.com"].join("|").replace(/\./g,"\\.")+")","i");const t=/\/t?way(?: +([^/;\n\d]+|#\d+))? +(\d+(?:[.,]\d+)?),? +(\d+(?:[.,]\d+)?)(?: +([^/;\n]*[^ /;\n]\b\)?(?!:\/\/)))?/;const a=/(https?:\/\/|www\.)([\/_a-z0-9%?#@\-+~&=;:'|]|\.[a-z0-9\-])+/gi;function i(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let a=JSON.parse(e.dataset.mapPinJson);if(a){t.push([a.x,a.y])}}catch(e){}}));return t}function n(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let a=JSON.parse(e.dataset.mapPinJson);if(a&&a.uiMapId){let e=a.name;if(a.uiMapName){if(e){e=WH.term("parens_format",e,a.uiMapName)}else{e=a.uiMapName}}t.push(WH.Wow.UiMap.generateInGamePinLinkCommand(a.uiMapId,a.x,a.y,e))}}catch(e){}}));return t}function s(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let a=JSON.parse(e.dataset.mapPinJson);if(a){t.push(WH.Wow.UiMap.generateTomTomCommand([a.x,a.y],{uiMapId:a.uiMapId,uiMapName:a.uiMapName,name:a.name}))}}catch(e){}}));return t}function r(t){let a=t.match("[a-z]+://([a-z0-9.-]+)");return!a||a[1].search(e)===0}function o(){a.lastIndex=0;t.lastIndex=0}return function(e,l){l=l||$.noop;if(e._rawText===" "&&!l.noNbsp){e._rawText=WH.Strings.nbsp}e._rawText=e._rawText.replace(/\\\[/g,"[");e._rawText=e._rawText.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"–").replace(/&mdash;/g,"—");if(l&&l.needsRaw){return WH.ct(e._rawText)}let c=e._rawText.split("\n");let u=document.createDocumentFragment();let d=!(l&&l.noLink);let f;let h=function(e){if(e.index>0){WH.ae(u,WH.ct(f.substr(0,e.index)));f=f.substr(e.index)}let t=WH.markup.finalizeUrl(e[0]);t=t.replace(/^www/,"https://www");if(WH.markup.allow<WH.markup.CLASS.USER&&!r(t)){let e=WH.ce("span",{className:"tip"},WH.ct(WH.TERMS.linkremoved));WH.Tooltips.attach(e,WH.TERMS.linkremoved_tip,"q",{byCursor:true});WH.ae(u,e)}else{let a=WH.ce("a",{href:t});if(WH.markup.isUrlExternal(t)){a.target="_blank"}WH.st(a,e[0]);WH.ae(u,a)}f=f.substr(e[0].length)};let p=function(e){if(e.index>0){WH.ae(u,WH.ct(f.substr(0,e.index)));f=f.substr(e.index)}let t;let a;let r=e[1]&&e[1].match(/^#(\d+)$/);if(r){t=r[1]}else{a=e[1]}let o=e[2].replace(/[.,]/,WH.TERMS.decimal_punct);let l=e[3].replace(/[.,]/,WH.TERMS.decimal_punct);let c=e[4];let d={name:c,x:o,y:l};let h=WH.ce("span",{className:"tip"},WH.ct(e[0]));let p={getAllCoords:i.bind(null,h),getAllInGameMapPins:n.bind(null,h),getAllTomTomCommands:s.bind(null,h),includeTomTom:true};if(t){d.uiMapId=t;p.uiMapId=t}else if(window.g_pageInfo&&g_pageInfo.uiMapId){d.uiMapId=g_pageInfo.uiMapId;p.uiMapId=g_pageInfo.uiMapId}if(a){d.uiMapName=a;p.uiMapName=a}if(c){p.name=c}h.dataset.mapPinJson=JSON.stringify(d);WH.Wow.UiMap.clickToCopyCoordinates(h,[o,l],p);WH.ae(u,h);f=f.substr(e[0].length)};let m;let H;if(!d){for(let e=0,a=c.length;e<a;e++){f=c[e];if(e>0){WH.ae(u,WH.ce("br"))}while(H=t.exec(f)){p(H);o()}if(f.length){WH.ae(u,WH.ct(f))}}}else{for(let e=0,i=c.length;e<i;e++){f=c[e];if(e>0){WH.ae(u,WH.ce("br"))}while(true){m=a.exec(f);H=t.exec(f);if(m&&H){if(H.index<m.index){p(H)}else{h(m)}}else if(m){h(m)}else if(H){p(H)}else{o();break}o()}if(f.length){WH.ae(u,WH.ct(f))}}}return u}}(),toText:function(e){return e._rawText}};WH.stub("Search");WH.Search.Live=new function(){const e=this;const t=WH.Entity;const a=WH.Game;const i=WH.Icon;const n=WH.Strings;const s=WH.Theme;const r=WH.Tooltips;const o=WH.Types;const l=WH.Url;const c=WH.Wow;const u=10;const d=500;const f="live-search-mobile-closer";const h={elements:{container:undefined,currentTextBox:undefined,filters:undefined,headerSearch:undefined,loader:undefined,noResults:undefined,resultContainer:undefined,selectedResult:undefined,viewAllLink:undefined},lastSearch:{},resultsCache:{},timer:undefined,prepared:false,cancelNext:false,hasData:false};this.attach=function(e){if(e.getAttribute("autocomplete")==="off"){return}e.setAttribute("autocomplete","off");WH.aE(e,"focus",A);WH.aE(e,"keyup",w);WH.aE(e,"keydown",N)};this.hide=function(e){if(e&&!WH.isLeftClick(e)){return}if(e&&e.target&&e.target.id!==f&&(e.target.closest(".live-search")||e.target.closest(".header-search"))){return}r.hide();if(h.elements.container){h.elements.container.style.display="none"}if(h.elements.headerSearch){h.elements.headerSearch.dataset.hasLiveSearch="false"}};this.reset=function(t){h.lastSearch[t.id]=null;t.value="";h.hasData=false;e.hide()};function p(e){if(e&&!y()){return}if(h.elements.currentTextBox==null){return}let t=WH.ac(h.elements.currentTextBox);h.elements.container.style.left=`${t[0]}px`;h.elements.container.style.top=t[1]+h.elements.currentTextBox.offsetHeight+"px";let a=getComputedStyle(h.elements.currentTextBox);h.elements.container.style.width=h.elements.currentTextBox.clientWidth-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)+"px";D()}function m(){if(h.elements.selectedResult){h.elements.selectedResult.dataset.selected="false";h.elements.selectedResult=undefined}}function H(e,t){const a=t===1?WH.Types.getUpperSingular(e):WH.Types.getUpperPlural(e);const i=new WH.Button({"data-active":`${false}`,"data-type":e,clickHandler:I,label:WH.term("parens_format",a,t),size:"small",style:"secondary"}).getElement();WH.ae(h.elements.filters,i)}function g(e,t){let n=WH.ce("div",{className:"result-icon"});if(e.icon){let s=a.get();t.dataset.gameIcon=a.getKey(s);n.style.backgroundImage=`url('${i.getIconUrl(e.icon,i.LARGE,a.getEnv(s))}')`}else if(e.type===o.NPC&&e.boss){n.dataset.icon="boss"}else if([o.QUEST,o.TITLE].includes(e.type)&&[c.SIDE_ALLIANCE,c.SIDE_HORDE].includes(e.side)){n.dataset.icon=c.getSideIcon(e.side)}else if(e.type===o.QUEST&&e.iconTextureType){n.className=`quest-${e.iconTextureType}-start`}else{n.dataset.icon=WH.Types.getReferenceName(e.type)}return n}function W(e){let a=WH.ce("a",{className:"live-search-result",dataset:{selected:JSON.stringify(false),type:e.type},href:t.getUrl(e.type,e.id,e.name)});WH.aE(a,"mouseover",C);if(e.quality!=null){a.classList.add("q"+e.quality)}if(e.type===o.PLAYER_CLASS){a.classList.add("c"+e.id)}return a}function E(e,t){let a=WH.ce("span",{className:"result-name"});let i=e.displayName??n.escapeHtml(e.name);i=i.replace(t,(function(e,t,a,i){if(t){if(!/<[^>]*$/.test(i.substring(0,a))){return'<span class="exact-match">'+e+"</span>"}}return e}));if(e.type===o.TITLE){i=i.replace("%s",'<span class="q0">&lt;'+WH.TERMS.name+"&gt;</span>")}else if(e.type===o.SPELL&&e.rank){i=WH.term("parens_format",i,e.rank)}a.innerHTML=i;if(e.subtitle){WH.ae(a,WH.ce("div",{className:"result-name-subtitle"},WH.ct(e.subtitle)))}return a}function _(e){return WH.ce("span",{className:"result-type"},WH.ct(o.getUpperSingular(e.type)))}function T(e){if(!y()){if(h.hasData){L()}return}let t=WH.qs('[data-active="true"]',h.elements.filters);let a=".live-search-result";if(t&&t.dataset.type!=="0"){a+='[data-filtered="true"]'}let i=WH.qsa(a);let n=e?i.item(i.length-1):i.item(0);if(!h.elements.selectedResult){b(n);return}let s=e?h.elements.selectedResult.previousSibling:h.elements.selectedResult.nextSibling;if(t){for(let t=0;t<i.length;t++){let a=i.item(t);if(h.elements.selectedResult.href===a.href){s=e?i.item(t-1):i.item(t+1);break}}}b(s||n)}function v(e,t,a){WH.displayNone(h.elements.loader);h.hasData=true;r.hide();WH.displayNone(h.elements.noResults);WH.ee(h.elements.resultContainer);while(h.elements.filters.lastChild!==h.elements.filters.firstChild){WH.de(h.elements.filters.lastChild)}t=t.replace(/\s+/g," ").trim();h.elements.viewAllLink.href=l.generatePath("/search?q="+encodeURIComponent(t));delete h.elements.container.dataset.noResults;t=n.escapeHtml(t).replace(/[^\u00C0-\u1FFF\u2C00-\uD7FF\w-]/gi," ");let i=WH.createOrRegex(t,t==="s"?"[%]":null);if(a.length===0){WH.displayDefault(h.elements.noResults);h.elements.container.dataset.noResults=`${true}`;h.elements.filters.dataset.hidden="true";return}let s={};for(let e=0;e<a.length;e++){let t=a[e];if(s[t.type]){s[t.type].count++}else{s[t.type]={position:e,count:1}}let n=W(t);WH.ae(n,g(t,n));WH.ae(n,E(t,i));WH.ae(n,_(t));WH.ae(h.elements.resultContainer,n)}Object.entries(s).sort((function(e,t){return e[1].position-t[1].position})).forEach((function(e){H(parseInt(e[0]),e[1].count)}));h.elements.filters.dataset.hidden="false";D()}function S(e,t){if(h.resultsCache[t]){v(e,t,h.resultsCache[t])}else{if(h.resultsCache.hasOwnProperty(t)){return}h.resultsCache[t]=null}WH.fetch(l.generatePath("/search/suggestions-template"),{cookies:false,query:{q:t,v:WH.getDataCacheVersion()},success:function(t){h.resultsCache[t.search]=t.results;if(t.search===h.lastSearch[e.id]){v(e,t.search,t.results)}},error:function(){h.resultsCache[t]=[];if(t===h.lastSearch[e.id]){v(e,t,[])}}})}function b(e,t){m();h.elements.selectedResult=e;h.elements.selectedResult.dataset.selected="true";if(e.parentNode===h.elements.resultContainer){let t=e.offsetTop;let a=h.elements.resultContainer.scrollTop;if(t+e.clientHeight>a+h.elements.resultContainer.clientHeight){h.elements.resultContainer.scrollTop=t-(h.elements.resultContainer.clientHeight-e.offsetHeight)}else if(t<a){h.elements.resultContainer.scrollTop=t}}else{h.elements.resultContainer.scrollTop=0}if(!t){L();h.cancelNext=true}}function y(){if(!h.elements.container){return false}return h.elements.container.style.display!=="none"}function I(e){let t=WH.qs('[data-active="true"]',h.elements.filters);if(t){t.dataset.active="false"}m();e.target.dataset.active="true";let a=e.target.dataset.type==="0";WH.qsa(".live-search-result").forEach((t=>{t.dataset.filtered=JSON.stringify(a||t.dataset.type===e.target.dataset.type)}));D();h.elements.currentTextBox.focus()}function A(e){let t=e.target;if(t!==document){h.elements.currentTextBox=t}m();L()}function R(){if(!y()){return}let e=true;setTimeout((()=>{e=false}),WH.Layout.Responsive.HEADER_RESIZE_MS+1);let t=()=>{p();if(e){requestAnimationFrame(t)}};t()}function N(t){switch(t.key){case"Enter":if(h.elements.selectedResult){t.preventDefault();window.location.href=h.elements.selectedResult.href}break;case"Escape":e.hide();break;case"ArrowUp":t.preventDefault();T(true);break;case"ArrowDown":t.preventDefault();T();break}}function w(t){let a=t.target;let i=a.value.replace(/\s+/g," ").trim();if(i===h.lastSearch[a.id]){return}h.lastSearch[a.id]=i;if(a!==document){h.elements.currentTextBox=a}if(i.length){M(a,i)}else{e.hide()}}function C(){b(this,true)}function M(e,t){if(h.cancelNext){h.cancelNext=false;return}h.hasData=false;O();clearTimeout(h.timer);if(h.resultsCache[t]){L();v(e,t,h.resultsCache[t]);return}WH.displayDefault(h.elements.loader);L();h.timer=setTimeout(S.bind(0,e,t),d)}function O(){if(h.prepared){return}h.prepared=true;if(h.elements.headerSearch){h.elements.headerSearch=WH.Layout.getElement("header-search")}h.elements.container=WH.ce("div",{className:"live-search",style:{display:"none"}});h.elements.filters=WH.ce("div",{className:"wh-button-group",id:"search-filters",dataset:{hidden:JSON.stringify(true)}});const t=new WH.Button({"data-active":`${true}`,"data-type":`${0}`,clickHandler:I,label:WH.TERMS.all,size:"small",style:"secondary"}).getElement();WH.ae(h.elements.filters,t);WH.ae(h.elements.container,h.elements.filters);h.elements.loader=WH.ce("div",{className:"live-search-loading"},WH.ce("span",{className:"live-search-loading-indicator"}));WH.ae(h.elements.loader,WH.ce("div",undefined,WH.ct(WH.TERMS.loading_ellipsis)));WH.ae(h.elements.container,h.elements.loader);h.elements.resultContainer=WH.ce("div",{className:"live-search-results"});WH.ae(h.elements.container,h.elements.resultContainer);h.elements.noResults=WH.ce("span",{className:"live-search-result empty",style:{display:"none"}},WH.ct(WH.TERMS.noresults));WH.ae(h.elements.container,h.elements.noResults);const a=WH.ae(h.elements.container,WH.ce("div",{className:"wh-button-group",dataset:{groupType:"vertically-stacked"}}));h.elements.container.dataset.noResults=`${true}`;h.elements.viewAllLink=new WH.Button({"data-span":"full","data-variation":WH.getDataTreeKey(),href:l.generatePath("/search"),id:"view-all-btn",label:WH.TERMS.viewAllSearchResults,style:"primary"}).getElement();WH.ae(a,h.elements.viewAllLink);let i=new WH.Button({clickHandler:t=>{e.hide(t)},"data-span":"full","data-variation":WH.getDataTreeKey(),iconConfig:{faIcon:{prefix:"fas",name:"xmark"}},id:f,label:WH.TERMS.closesearch,style:"secondary"}).getElement();WH.aE(i,"click",e.hide);WH.ae(a,i);WH.ae(document.body,h.elements.container);WH.aE(window,"resize",p.bind(e,true));WH.aE(document,"click",(function(t){if(!ZUL.getEnabled()){e.hide(t)}}))}function L(){if(h.elements.container&&!y()){p();if(h.elements.headerSearch){h.elements.headerSearch.dataset.hasLiveSearch="true"}h.elements.container.style.opacity="0";WH.displayDefault(h.elements.container);$(h.elements.container).animate({opacity:"1"},"fast")}}function D(){let e=h.elements.container.getBoundingClientRect().top+h.elements.container.offsetHeight-h.elements.resultContainer.offsetHeight+h.elements.resultContainer.scrollHeight+u;h.elements.container.style.bottom=e>window.innerHeight?u+"px":null}};WH.Tools.Bloodmallet=new function(){var e=false;this.loadCharts=function(){if(typeof window.Highcharts!=="object"){WH.error("Can't load Bloodmallet charts because the Highcharts library isn't available.");return}if(typeof window.bloodmallet_chart_import!=="object"){if(!e){e=true;let a=2;const i=()=>{if(--a<=0){t()}};let n=WH.ce("script",{type:"text/javascript",src:WH.STATIC_URL+"/js/3rd-party/bloodmallet_chart_import.js?2024-05-20"});WH.aE(n,"load",i);WH.ae(document.getElementsByTagName("head")[0],n);let s=WH.ce("link",{rel:"stylesheet",href:WH.STATIC_URL+"/css/3rd-party/bloodmallet_charts.css?2024-05-20"});WH.aE(s,"load",i);WH.ae(document.getElementsByTagName("head")[0],s)}}else{t()}};this.updateChartsSizes=function(e){var t=[];$(e).find(".bloodmallet_chart[data-highcharts-chart]").each((function(){t.push(this.getAttribute("data-highcharts-chart"))}));if(t.length>0){WH.Tools.Highcharts.updateSizes(t)}};function t(){bloodmallet_chart_import.run();setTimeout(a,9);$(window).resize(WH.Tools.Highcharts.updateSizes)}function a(){var e=0;var t=[];$(".bloodmallet_chart").each((function(){var a=this.getAttribute("data-highcharts-chart");if(a!==""){t.push(a)}else{e++}}));if(t.length>0){WH.Tools.Highcharts.updateSizes(t)}if(e>0){setTimeout(a,9*e)}}};WH.Tools.Highcharts=new function(){var e=[];var t=false;var a={};var i=50;this.loadScript=function(a){if(a){e.push(a)}if(typeof window.Highcharts!=="object"){if(!t){t=true;n(WH.STATIC_URL+"/js/3rd-party/highcharts.js",s)}}else{s()}};this.updateSizes=function(e){if(typeof Highcharts==="undefined"||!Array.isArray(Highcharts.charts)){return 0}var t=0;if(Array.isArray(e)){for(var a=0,i;i=e[a];a++){if(Highcharts.charts[i]){r(Highcharts.charts[i]);t++}}}else{for(var n=0,s;s=Highcharts.charts[n];n++){r(s);t++}}return t};function n(e,t){let a=WH.ce("script",{type:"text/javascript"});if(WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}a.src=e;WH.aE(a,"load",t);WH.ae(document.getElementsByTagName("head")[0],a)}function s(){while(e.length){e.pop()()}}function r(e){clearTimeout(a[e.index]);a[e.index]=setTimeout((function(){e.setSize(null,null)}),i)}};WH.stub("User");WH.User.Completion=new function(){const e=this;const t={pageData:{achievementCriteria:undefined,byType:{},wardrobe:undefined}};this.getAchievementCriteria=()=>t.pageData.achievementCriteria??=WH.getPageData("user.completion.achievementCriteria")||{};this.getByType=function(e){return t.pageData.byType[e]=t.pageData.byType[e]||WH.getPageData("user.completion.type."+e)||{}};this.getWardrobe=function(){return t.pageData.wardrobe=t.pageData.wardrobe||WH.getPageData("user.completion.wardrobe")||{}}};WH.Wow.Achievement=new function(){const e=WH.getPageData("wow.achievement.categoryNames")||{};this.getCategoryName=function(t){return e[t]};this.getRootCategoryNames=()=>({...WH.getPageData("wow.achievement.rootCategoryNames")})};WH.Wow.Area=new function(){const e=this;const t={categoryNames:undefined,names:undefined};this.getInstanceTypeName=e=>WH.getPageData("wow.area.instanceTypeNames")[e];this.getCategoryName=function(e){t.categoryNames=t.categoryNames||WH.getPageData("wow.area.categoryNames")||{};return t.categoryNames[e]||null};this.getName=function(t){return e.getNameList()[t]||null};this.getNameList=function(){if(!t.names){t.names=WH.getPageData("wow.area.names")||{}}return t.names}};WH.Wow.BattlePet=new function(){const e={families:undefined,sources:{"-1":WH.TERMS.unknown,...WH.getPageData("wow.battlePet.sources")}};this.getBreedName=e=>WH.getPageData("wow.battlePet.breeds")[e];this.getFamilyName=function(t){e.families=e.families||WH.getPageData("wow.battlePet.families")||{};return e.families[t]};this.getSourceName=t=>e.sources[t];this.getSources=()=>({...e.sources})};WH.Wow.BattlePetAbility=new function(){const e={types:undefined};this.getTypeName=function(t){e.types=e.types||WH.getPageData("wow.battlePetAbility.types")||{};return e.types[t]}};WH.Wow.Building=new function(){const e=WH.getPageData("wow.building.shortNames")||{};this.getShortName=function(t){return e[t]||WH.TERMS.unknown};this.hasShortName=function(t){return e.hasOwnProperty(t)}};var g_artifact_knowledge_max_level=55;var g_file_factions={1:"alliance",2:"horde"};var g_file_racefactions={10:2,11:1,3:1,7:1,1:1,4:1,2:2,6:2,8:2,5:2,9:2,22:1,24:3,25:1,26:2,27:2,28:2,29:1,30:1,31:2,32:1,34:1,35:2,36:2,37:1};var g_class_forums={6:18,12:29,11:3,3:4,8:6,10:28,2:7,5:8,4:5,7:9,9:10,1:11};var g_file_gems={1:"meta",2:"red",4:"yellow",6:"orange",8:"blue",10:"purple",12:"green",14:"prismatic",16:"hydraulic",32:"cogwheel"};var g_chr_specs_by_class={12:["577","581"],6:["250","251","252"],11:["102","103","104","105"],13:["1467","1468","1473"],3:["253","254","255"],8:["62","63","64"],10:["268","270","269"],2:["65","66","70"],5:["256","257","258"],4:["259","260","261"],7:["262","263","264"],9:["265","266","267"],1:["71","72","73"]};if(WH.isClassicTree()||WH.isTbcTree()){g_chr_specs_by_class={11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}if(WH.isWrathTree()||WH.isCataTree()){g_chr_specs_by_class={6:["398","399","400"],11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}if(WH.isMistsTree()){g_chr_specs_by_class={6:["398","399","400"],11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],10:["268","270","269"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}var g_battlepet_types={1:"humanoid",2:"dragonkin",3:"flying",4:"undead",5:"critter",6:"magic",7:"elemental",8:"beast",9:"aquatic",10:"mechanical"};var g_battlepet_passives={1:238,2:245,3:239,4:242,5:236,6:243,7:241,8:237,9:240,10:244};var g_skill_recipe_subclass={171:6,164:4,185:5,333:8,202:3,356:9,773:11,755:10,165:1,186:12,197:2};if(WH.isClassicTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773];delete g_skill_recipe_subclass[755]}if(WH.isTbcTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773]}if(WH.isWrathTree()||WH.isCataTree()||WH.isMistsTree()){g_skill_recipe_subclass[129]=7}var g_skill_recipe_subclass_url={171:"alchemy",164:"blacksmithing",185:"cooking",333:"enchanting",202:"engineering",356:"fishing",773:"inscription",755:"jewelcrafting",165:"leatherworking",186:"mining",197:"tailoring"};if(WH.isClassicTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773];delete g_skill_recipe_subclass_url[755]}if(WH.isTbcTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773]}if(WH.isWrathTree()||WH.isCataTree()||WH.isMistsTree()){g_skill_recipe_subclass_url[129]="first-aid"}var g_grayedOutStats={3:[250,251,252,102,105,1467,1468,1473,62,63,64,270,65,66,70,256,257,258,262,264,265,266,267,71,72,73],4:[102,103,104,105,1467,1468,253,254,255,62,63,64,268,270,269,65,256,257,258,259,260,261,262,263,264,265,266,267],5:[71,72,73,259,260,261,253,254,255,103,104,250,251,252,66,70,263,268,269],6:[250,251,252,102,103,104,1467,1473,253,254,255,62,63,64,268,269,66,70,258,259,260,261,262,263,265,266,267,71,72,73],50:[251,252,102,103,105,1467,1468,1473,253,254,255,62,63,64,270,269,65,70,256,257,258,259,260,261,262,263,264,265,266,267,71,72]};if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()||WH.isCataTree()||WH.isMistsTree()){g_grayedOutStats={}}var g_specPrimaryStatOrders={62:[5,3,4],63:[5,3,4],64:[5,3,4],65:[5,4,3],66:[4,3,5],70:[4,3,5],71:[4,3,5],72:[4,3,5],73:[4,3,5],102:[5,3,4],103:[3,4,5],104:[3,4,5],105:[5,3,4],1467:[5,3,4],1468:[5,3,4],1473:[5,3,4],250:[4,3,5],251:[4,3,5],252:[4,3,5],253:[3,5,4],254:[3,5,4],255:[3,5,4],256:[5,3,4],257:[5,3,4],258:[5,3,4],259:[3,4,5],260:[3,4,5],261:[3,4,5],262:[5,3,4],263:[3,5,4],264:[5,3,4],265:[5,3,4],266:[5,3,4],267:[5,3,4],268:[3,5,4],269:[3,5,4],270:[5,3,4],577:[3,5,4],581:[3,5,4]};var g_spec_to_role={62:2,63:2,64:2,65:1,66:0,70:2,71:2,72:2,73:0,74:2,79:2,81:0,102:2,103:2,104:0,105:1,1467:2,1468:1,1473:2,250:0,251:2,252:2,253:2,254:2,255:2,256:1,257:1,258:2,259:2,260:2,261:2,262:2,263:2,264:1,265:2,266:2,267:2,268:0,269:2,270:1,535:2,536:2,537:0,577:2,581:0};var g_character_slots_data=[{id:1,name:"head",itemSlots:[1]},{id:2,name:"neck",itemSlots:[2],noModel:1},{id:3,name:"shoulder",itemSlots:[3]},{id:15,name:"back",itemSlots:[16],iconName:"chest"},{id:5,name:"chest",itemSlots:[5,20]},{id:4,name:"shirt",itemSlots:[4]},{id:19,name:"tabard",itemSlots:[19]},{id:9,name:"wrists",itemSlots:[9]},{id:10,name:"hands",itemSlots:[10]},{id:6,name:"waist",itemSlots:[6]},{id:7,name:"legs",itemSlots:[7]},{id:8,name:"feet",itemSlots:[8]},{id:11,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger1"},{id:12,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger2"},{id:13,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket1"},{id:14,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket2"},{id:16,name:"mainhand",itemSlots:[21,13,17,15,25,26],simCraftName:"main_hand"},{id:17,name:"offhand",itemSlots:[22,13,17,23,14],simCraftName:"off_hand"}];var g_classes_allowed_armor={6:[1,2,3,4,5],12:[1,2,5],11:[1,2,5],3:[1,2,3,5],8:[1,5],10:[1,2,5],2:[1,2,3,4,5,6],5:[1,5],4:[1,2,5],7:[1,2,3,5,6],9:[1,5],1:[1,2,3,4,5,6]};var g_classes_allowed_weapon={6:[0,1,4,5,6,7,8,20],12:[0,7,9,13,15,20],11:[4,5,6,10,13,15,20],13:[0,1,4,5,6,7,8,10,13,15,20],3:[2,3,6,10,18,20],8:[7,10,15,19,20],10:[0,4,6,7,10,13,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[0,2,3,4,7,13,15,18,20],7:[0,1,4,5,6,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,18,20]};if(WH.isMistsTree()){delete g_classes_allowed_weapon[12];delete g_classes_allowed_weapon[13];delete g_classes_allowed_armor[12];delete g_classes_allowed_armor[13]}else if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()||WH.isCataTree()){g_character_slots_data[g_character_slots_data.length-2].itemSlots=[21,13,17];if([WH.dataEnv.CLASSIC,WH.dataEnv.TBC].includes(WH.getDataEnv())){g_character_slots_data[g_character_slots_data.length-1].itemSlots=[22,13,23,14]}g_character_slots_data.push({id:18,name:"ranged",itemSlots:[15,25,26,28]});g_classes_allowed_armor[2].push(7,11);g_classes_allowed_armor[7].push(9,11);g_classes_allowed_armor[11].push(8,11);g_classes_allowed_armor[6].push(10,11);g_classes_allowed_weapon={11:[4,5,10,13,15,20],3:[0,1,2,3,6,7,8,10,13,15,16,18,20],8:[7,10,15,19,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[2,3,4,7,13,15,16,18,20],7:[0,1,4,5,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,16,18,20]};if(WH.isWrathTree()||WH.isCataTree()){g_classes_allowed_weapon[6]=[0,1,4,5,6,7,8,20];g_classes_allowed_weapon[4].push(0);g_classes_allowed_weapon[11].push(6)}if(WH.isClassicTree()){g_classes_allowed_weapon[11].push(6)}}WH.getRaceSideSortString=function(e){var t=parseInt(e.side||g_file_racefactions[e.id]);if(t===1){return"alliance"}else if(t===2){return"horde"}else if(t===3){return"both"}return"npc"};WH.Wow.Covenant=new function(){this.KYRIAN=1;this.NECROLORD=4;this.NIGHT_FAE=3;this.VENTHYR=2;const e={};e[this.KYRIAN]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_kyrian.jpg";e[this.NECROLORD]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_necrolord.jpg";e[this.NIGHT_FAE]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_night_fae.jpg";e[this.VENTHYR]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_venthyr.jpg";const t={};t[this.KYRIAN]="ui_sigil_kyrian";t[this.NECROLORD]="ui_sigil_necrolord";t[this.NIGHT_FAE]="ui_sigil_nightfae";t[this.VENTHYR]="ui_sigil_venthyr";const a={[this.KYRIAN]:"kyrian",[this.NECROLORD]:"necrolord",[this.NIGHT_FAE]:"night-fae",[this.VENTHYR]:"venthyr"};this.getArmoryBackgroundImageUrl=function(t){return e[t]};this.getIcon=function(e){return t[e]};this.getIdBySlug=function(e){return parseInt(Object.keys(a).find((t=>a[t]===e)))||undefined};this.getSlug=function(e){return a[e]}};WH.Wow.Currency=new function(){this.ID_CONQUEST=390;this.ID_HONOR=392;this.ID_JUSTICE=395;this.ID_VALOR=396;const e=WH.getPageData("wow.currency.categories")||{};const t=WH.getPageData("wow.currency.namesAndIcons")||{};this.getCategoryName=function(t){return e[t]||null};this.getIcon=function(e){return t[e]&&t[e].icon||null};this.getName=function(e){return t[e]&&t[e].name||null}};var g_achievements={};var g_affixes={};var g_azeriteEssences={};var g_azeriteEssencePowers={};var g_bfa_champions={};var g_buildings={};var g_champions={};var g_classes={};var g_factions={};var g_followers={};var g_gatheredcurrencies={};var g_gatheredzones={};var g_gearsets={};var g_guides={};var g_holidays={};var g_icons={};var g_items={};var g_itemsets={};var g_mission_abilities={};var g_missions={};var g_npcs={};var g_objects={};var g_orderadvancements={};var g_outfits={};var g_petabilities={};var g_pets={};var g_quests={};var g_races={};var g_resources={};var g_ships={};var g_skills={};var g_sounds={};var g_spells={};var g_storylines={};var g_threats={};var g_titles={};var g_transmogsets={};var g_charts={};window.g_gathered_types={};g_gathered_types[WH.Types.ACHIEVEMENT]=g_achievements;g_gathered_types[WH.Types.ADVENTURE_COMBATANT_ABILITY]={};g_gathered_types[WH.Types.AFFIX]=g_affixes;g_gathered_types[WH.Types.AZERITE_ESSENCE]=g_azeriteEssences;g_gathered_types[WH.Types.AZERITE_ESSENCE_POWER]=g_azeriteEssencePowers;g_gathered_types[WH.Types.BATTLE_PET_ABILITY]=g_petabilities;g_gathered_types[WH.Types.BFA_CHAMPION]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_ALLIANCE]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_HORDE]=g_bfa_champions;g_gathered_types[WH.Types.BUILDING]=g_buildings;g_gathered_types[WH.Types.CHAMPION]=g_champions;g_gathered_types[WH.Types.CHAMPION_ALLIANCE]=g_champions;g_gathered_types[WH.Types.CHAMPION_HORDE]=g_champions;g_gathered_types[WH.Types.COVENANT]={};g_gathered_types[WH.Types.CURRENCY]=g_gatheredcurrencies;g_gathered_types[WH.Types.D4_AFFIX]={};g_gathered_types[WH.Types.D4_ASPECT]={};g_gathered_types[WH.Types.D4_ITEM]={};g_gathered_types[WH.Types.D4_PARAGON_GLYPH]={};g_gathered_types[WH.Types.D4_PARAGON_NODE]={};g_gathered_types[WH.Types.D4_SKILL]={};g_gathered_types[WH.Types.DECOR]={};g_gathered_types[WH.Types.DI_EQUIP_ITEM]={};g_gathered_types[WH.Types.DI_MISC_ITEM]={};g_gathered_types[WH.Types.DI_NPC]={};g_gathered_types[WH.Types.DI_OBJECT]={};g_gathered_types[WH.Types.DI_PARAGON_SKILL]={};g_gathered_types[WH.Types.DI_QUEST]={};g_gathered_types[WH.Types.DI_SET]={};g_gathered_types[WH.Types.DI_SKILL]={};g_gathered_types[WH.Types.DI_ZONE]={};g_gathered_types[WH.Types.ENCOUNTER]={};g_gathered_types[WH.Types.EVENT]=g_holidays;g_gathered_types[WH.Types.FACTION]=g_factions;g_gathered_types[WH.Types.FOLLOWER]=g_followers;g_gathered_types[WH.Types.FOLLOWER_ALLIANCE]=g_followers;g_gathered_types[WH.Types.FOLLOWER_HORDE]=g_followers;g_gathered_types[WH.Types.HUNTER_PET]=g_pets;g_gathered_types[WH.Types.ICON]=g_icons;g_gathered_types[WH.Types.ITEM]=g_items;g_gathered_types[WH.Types.ITEM_SET]=g_itemsets;g_gathered_types[WH.Types.MISSION]=g_missions;g_gathered_types[WH.Types.MISSION_ABILITY]=g_mission_abilities;g_gathered_types[WH.Types.NPC]=g_npcs;g_gathered_types[WH.Types.OBJECT]=g_objects;g_gathered_types[WH.Types.ORDER_ADVANCEMENT]=g_orderadvancements;g_gathered_types[WH.Types.PLAYER_CLASS]=g_classes;g_gathered_types[WH.Types.PROFESSION_TRAIT]={};g_gathered_types[WH.Types.QUEST]=g_quests;g_gathered_types[WH.Types.RACE]=g_races;g_gathered_types[WH.Types.RESOURCE]=g_resources;g_gathered_types[WH.Types.SHIP]=g_ships;g_gathered_types[WH.Types.SHIP_ALLIANCE]=g_ships;g_gathered_types[WH.Types.SHIP_HORDE]=g_ships;g_gathered_types[WH.Types.SKILL]=g_skills;g_gathered_types[WH.Types.SOULBIND]={};g_gathered_types[WH.Types.SOUND]=g_sounds;g_gathered_types[WH.Types.SPELL]=g_spells;g_gathered_types[WH.Types.STORYLINE]=g_storylines;g_gathered_types[WH.Types.THREAT]=g_threats;g_gathered_types[WH.Types.TITLE]=g_titles;g_gathered_types[WH.Types.TRADING_POST_ACTIVITY]={};g_gathered_types[WH.Types.ZONE]=g_gatheredzones;g_gathered_types[WH.Types.GEAR_SET]=g_gearsets;g_gathered_types[WH.Types.GUIDE]=g_guides;g_gathered_types[WH.Types.OUTFIT]=g_outfits;g_gathered_types[WH.Types.TRANSMOG_SET]=g_transmogsets;g_gathered_types[WH.Types.GATHERER_GUIDE_IMAGE]={};g_gathered_types[WH.Types.GATHERER_LISTVIEW]={};g_gathered_types[WH.Types.GATHERER_SCREENSHOT]={};g_gathered_types[WH.Types.GATHERER_SURVEY_COVENANTS]={};var g_completion_categories={1:[12],3:[2,4,9,"15-2","15-5"],6:[-5,-6,9,11]};WH.cO(g_items,{add:function(e,t){var a={};a[e]=t;WH.Gatherer.addData(WH.Types.ITEM,WH.getDataEnv(),a)},getIcon:function(e,t,a,i){var n=WH.Gatherer.get(WH.Types.ITEM,e,i);var s=Icon.questionMarkIcon;if(n!=null&&n.icon){s=n.icon}var r=g_items.getAppearance(e,t,a,i);if(r!=null&&r[1]){s=r[1]}return s},getAppearance:function(e,t,a,i){var n=null;var s=WH.Gatherer.get(WH.Types.ITEM,e,i);var r=-1;var o=s&&s.appearances?s.appearances:s&&s.jsonequip&&s.jsonequip.appearances?s.jsonequip.appearances:null;if(a&&o&&o[a]){n=o[a]}else{if(WH.isSet("g_itembonuses")&&t&&t.length>0){for(var l in t){var c=t[l];if(c>0&&g_itembonuses[c]){WH.arrayWalk(g_itembonuses[c],(function(e){if(e[0]===WH.Wow.Item.Bonuses.EFFECT_TYPE_DISPLAY_MOD){r=e[1]}}))}if(r!=-1&&o&&o[r]){n=o[r];break}}}}return n},createIcon:function(e,t,a,i,n){var s={};if(n&&n.length>0){s.bonus=n.join(":")}return Icon.create(g_items.getIcon(e,n),t,null,WH.Entity.getUrl(WH.Types.ITEM,e,null,s),a,i)}});WH.cO(g_spells,{add:function(e,t){if(g_spells[e]!=null){WH.cO(g_spells[e],t)}else{g_spells[e]=t}},getIcon:function(e){if(g_spells[e]!=null&&g_spells[e].icon){return g_spells[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_spells.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.SPELL,e),a,i)}});WH.cO(g_petabilities,{add:function(e,t){if(g_petabilities[e]!=null){WH.cO(g_petabilities[e],t)}else{g_petabilities[e]=t}},getIcon:function(e){if(g_petabilities[e]!=null&&g_petabilities[e].icon){return g_petabilities[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_petabilities.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.BATTLE_PET_ABILITY,e),a,i)}});WH.cO(g_achievements,{getIcon:function(e){if(g_achievements[e]!=null&&g_achievements[e].icon){return g_achievements[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_achievements.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.ACHIEVEMENT,e),a,i)}});WH.cO(g_classes,{getIcon:e=>WH.Wow.PlayerClass.getIconName(e)||WH.Icon.UNKNOWN,createIcon:function(e,t,a,i){return Icon.create(g_classes.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.PLAYER_CLASS,e),a,i)}});WH.cO(g_races,{getIcon:function(e,t){if(t===undefined){t=WH.Wow.Gender.Male.value}return WH.Wow.Race.getIcon(e,WH.Wow.Gender.tryFrom(t))||WH.Icon.UNKNOWN},createIcon:function(e,t,a,i){return Icon.create(g_races.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.RACE,e),a,i)}});WH.cO(g_skills,{getIcon:function(e){if(g_skills[e]!=null&&g_skills[e].icon){return g_skills[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_skills.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.SKILL,e),a,i)}});WH.cO(g_gatheredcurrencies,{getIcon:function(e){if(g_gatheredcurrencies[e]!=null&&g_gatheredcurrencies[e].icon){return g_gatheredcurrencies[e].icon}return WH.Icon.UNKNOWN},createIcon:function(e,t,a,i){return Icon.create(g_gatheredcurrencies.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.CURRENCY,e),Math.abs(a),i)}});WH.cO(g_holidays,{getIcon:function(e){if(g_holidays[e]!=null&&g_holidays[e].icon){return g_holidays[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_holidays.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.EVENT,e),a,i)}});WH.cO(g_mission_abilities,{getIcon:function(e){if(g_mission_abilities[e]!=null&&g_mission_abilities[e].icon){return g_mission_abilities[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){var n=Icon.create(g_mission_abilities.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.MISSION_ABILITY,e),a,i);n.className+=" garrison-ability";return n}});WH.Wow.Difficulty=new function(){const e=this;this.ID_NONE=0;this.ID_DUNGEON_NORMAL=1;this.ID_DUNGEON_HEROIC=2;this.ID_LEGACY_10_PLAYER=3;this.ID_LEGACY_25_PLAYER=4;this.ID_LEGACY_10_PLAYER_HEROIC=5;this.ID_LEGACY_25_PLAYER_HEROIC=6;this.ID_LEGACY_RAID_FINDER=7;this.ID_DUNGEON_CHALLENGE=8;this.ID_RAID_40_PLAYER=9;this.ID_SCENARIO=11;this.ID_SCENARIO_HEROIC=12;this.ID_RAID_NORMAL=14;this.ID_RAID_HEROIC=15;this.ID_RAID_MYTHIC=16;this.ID_RAID_FINDER=17;this.ID_RAID_EVENT=18;this.ID_DUNGEON_EVENT=19;this.ID_SCENARIO_EVENT=20;this.ID_DUNGEON_MYTHIC=23;this.ID_DUNGEON_TIMEWALKING=24;this.ID_CLASSIC_RAID_20_PLAYER=148;this.ID_TBC_DUNGEON_NORMAL=173;this.ID_TBC_DUNGEON_HEROIC=174;this.ID_TBC_10_PLAYER=175;this.ID_TBC_25_PLAYER=176;this.ID_SEASON_OF_MASTERY_DUNGEON=184;this.ID_SEASON_OF_MASTERY_20_PLAYER=185;this.ID_SEASONAL_40_PLAYER=186;this.ID_SEASON_OF_DISCOVERY_10_PLAYER=198;this.ID_SEASON_OF_DISCOVERY_5_PLAYER=201;this.ID_SEASON_OF_DISCOVERY_1_PLAYER=207;this.ID_SEASON_OF_DISCOVERY_20_PLAYER=215;this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG=226;this.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL=231;this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1=30720;this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2=30721;this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3=30722;this.ID_WOTLK_10_PLAYER_HEROIC=193;this.ID_WOTLK_25_PLAYER_HEROIC=194;this.ID_MISTS_CELESTIAL=237;this.ID_DUNGEON_FOLLOWER=205;this.ID_QUEST=216;this.ID_STORY=220;this.GROUP_NONE=1;this.GROUP_DUNGEON=2;this.GROUP_LEGACY_RAID=3;this.GROUP_RAID=4;this.GROUPS={};this.GROUPS[this.GROUP_RAID]=[this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_FINDER];this.GROUPS[this.GROUP_LEGACY_RAID]=[this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_LEGACY_RAID_FINDER,this.ID_SEASONAL_40_PLAYER,this.ID_SEASON_OF_MASTERY_20_PLAYER,this.ID_SEASON_OF_DISCOVERY_20_PLAYER,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3,this.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL,this.ID_RAID_40_PLAYER,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_TBC_10_PLAYER,this.ID_TBC_25_PLAYER,this.ID_WOTLK_10_PLAYER_HEROIC,this.ID_WOTLK_25_PLAYER_HEROIC,this.ID_RAID_NORMAL];this.GROUPS[this.GROUP_DUNGEON]=[this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_CHALLENGE,this.ID_DUNGEON_TIMEWALKING,this.ID_TBC_DUNGEON_NORMAL,this.ID_TBC_DUNGEON_HEROIC,this.ID_SEASON_OF_MASTERY_DUNGEON,this.ID_SEASON_OF_DISCOVERY_10_PLAYER,this.ID_SEASON_OF_DISCOVERY_5_PLAYER,this.ID_SEASON_OF_DISCOVERY_1_PLAYER,this.ID_MISTS_CELESTIAL];this.GROUPS[this.GROUP_NONE]=[this.ID_NONE];this.SORT_ORDER=[this.ID_NONE,this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_CHALLENGE,this.ID_DUNGEON_EVENT,this.ID_DUNGEON_TIMEWALKING,this.ID_TBC_DUNGEON_NORMAL,this.ID_TBC_DUNGEON_HEROIC,this.ID_SEASON_OF_MASTERY_DUNGEON,this.ID_SEASON_OF_DISCOVERY_5_PLAYER,this.ID_SEASON_OF_DISCOVERY_1_PLAYER,this.ID_LEGACY_RAID_FINDER,this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_SEASON_OF_MASTERY_20_PLAYER,this.ID_RAID_40_PLAYER,this.ID_SEASONAL_40_PLAYER,this.ID_SEASON_OF_DISCOVERY_10_PLAYER,this.ID_SEASON_OF_DISCOVERY_20_PLAYER,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2,this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3,this.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL,this.ID_TBC_10_PLAYER,this.ID_TBC_25_PLAYER,this.ID_WOTLK_10_PLAYER_HEROIC,this.ID_WOTLK_25_PLAYER_HEROIC,this.ID_MISTS_CELESTIAL,this.ID_RAID_FINDER,this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_EVENT,this.ID_SCENARIO,this.ID_SCENARIO_HEROIC,this.ID_SCENARIO_EVENT];const t=-2;const a=-1;const i=1;const n=2;const s=3;const r=4;const o=5;const l={};l[a]=this.ID_DUNGEON_NORMAL;l[t]=this.ID_DUNGEON_HEROIC;l[o]=this.ID_LEGACY_RAID_FINDER;l[i]=this.ID_LEGACY_10_PLAYER;l[n]=this.ID_LEGACY_25_PLAYER;l[s]=this.ID_LEGACY_10_PLAYER_HEROIC;l[r]=this.ID_LEGACY_25_PLAYER_HEROIC;this.comparator=function(t,a){var i=e.SORT_ORDER.indexOf(parseInt(t));var n=e.SORT_ORDER.indexOf(parseInt(a));if(i<0){if(n<0){return 0}return 1}if(n<0){return-1}return Math.sign(i-n)};this.convertLegacyDropDifficulty=function(e){return l[e]||e};this.getIds=function(){var e=[];for(var t in this){if(!this.hasOwnProperty(t)||typeof this[t]!="number"){continue}if(t.substr(0,3)==="ID_"){e.push(this[t])}}return e};this.getIconClass=function(e){let t=undefined;switch(e){case this.ID_DUNGEON_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t="icon-heroic";break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t="icon-mythic";break}return t};this.getName=function(e){var t="";switch(e){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_TBC_DUNGEON_NORMAL:t=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t=WH.TERMS.mythic;break;case this.ID_DUNGEON_CHALLENGE:t=WH.TERMS.mythicplus;break;case this.ID_DUNGEON_TIMEWALKING:t=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:t=WH.TERMS.raidfinder;break;case this.ID_LEGACY_10_PLAYER:case this.ID_TBC_10_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,10);break;case this.ID_LEGACY_25_PLAYER:case this.ID_TBC_25_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,25);break;case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_WOTLK_10_PLAYER_HEROIC:t=WH.sprintf(WH.TERMS.heroic_format,10);break;case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_WOTLK_25_PLAYER_HEROIC:t=WH.sprintf(WH.TERMS.heroic_format,25);break;case this.ID_RAID_40_PLAYER:t=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:t=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break;case this.ID_SEASON_OF_MASTERY_DUNGEON:t=WH.TERMS.seasonOfMastery;break;case this.ID_SEASON_OF_MASTERY_20_PLAYER:t=WH.TERMS.player20SeasonOfMastery;break;case this.ID_SEASONAL_40_PLAYER:case this.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL:t=WH.TERMS.player40Seasonal;break;case this.ID_SEASON_OF_DISCOVERY_10_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,10);break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER:case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG:t=WH.TERMS.player20Seasonal;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1:t=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel1;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2:t=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel2;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3:t=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel3;break;case this.ID_SEASON_OF_DISCOVERY_5_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,5);break;case this.ID_SEASON_OF_DISCOVERY_1_PLAYER:t=WH.TERMS.normal;break;case this.ID_MISTS_CELESTIAL:t=WH.TERMS.celestial;break}return t||"["+e+"]"};this.getNameAbbrev=function(e){var t="";switch(e){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_TBC_DUNGEON_NORMAL:t=WH.TERMS.normal_abbrev;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t=WH.TERMS.heroic_abbrev;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t=WH.TERMS.mythic_abbrev;break;case this.ID_DUNGEON_TIMEWALKING:t=WH.TERMS.timewalking_abbrev;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:t=WH.TERMS.lookingforraid_abbrev;break;case this.ID_LEGACY_10_PLAYER:t="10"+WH.TERMS.normal_abbrev;break;case this.ID_TBC_10_PLAYER:t="10"+WH.TERMS.player.substr(0,1);break;case this.ID_LEGACY_25_PLAYER:t="25"+WH.TERMS.normal_abbrev;break;case this.ID_TBC_25_PLAYER:t="25"+WH.TERMS.player.substr(0,1);break;case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_WOTLK_10_PLAYER_HEROIC:t="10"+WH.TERMS.heroic_abbrev;break;case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_WOTLK_25_PLAYER_HEROIC:t="25"+WH.TERMS.heroic_abbrev;break;case this.ID_RAID_40_PLAYER:t="40";break;case this.ID_CLASSIC_RAID_20_PLAYER:t="20";break;case this.ID_SEASON_OF_MASTERY_DUNGEON:case this.ID_SEASON_OF_MASTERY_20_PLAYER:t=WH.TERMS.seasonOfMastery_abbrev;break;case this.ID_SEASONAL_40_PLAYER:case this.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL:t=WH.TERMS.seasonal;break;case this.ID_SEASON_OF_DISCOVERY_10_PLAYER:case this.ID_SEASON_OF_DISCOVERY_20_PLAYER:case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG:case this.ID_SEASON_OF_DISCOVERY_5_PLAYER:case this.ID_SEASON_OF_DISCOVERY_1_PLAYER:t=WH.TERMS.seasonOfDiscovery_abbrev;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1:t=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel1;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2:t=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel2;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3:t=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel3;break;case this.ID_MISTS_CELESTIAL:t=WH.TERMS.celestial;break}return t||"["+e+"]"};this.getNameShorthand=function(t){let a="";switch(t){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_LEGACY_10_PLAYER:case this.ID_LEGACY_25_PLAYER:case this.ID_TBC_DUNGEON_NORMAL:a=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:case this.ID_WOTLK_10_PLAYER_HEROIC:case this.ID_WOTLK_25_PLAYER_HEROIC:a=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:a=WH.TERMS.mythic;break;case this.ID_DUNGEON_TIMEWALKING:a=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:a=WH.TERMS.lookingforraid_abbrev;break;case this.ID_RAID_40_PLAYER:a=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:a=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break;case this.ID_TBC_10_PLAYER:case this.ID_TBC_25_PLAYER:a=e.getNameAbbrev(t);break;case this.ID_SEASON_OF_MASTERY_DUNGEON:a=WH.TERMS.seasonOfMastery_abbrev;break;case this.ID_SEASON_OF_MASTERY_20_PLAYER:a=WH.TERMS.seasonOfMastery_abbrev+WH.TERMS.wordspace_punct+"20";break;case this.ID_SEASONAL_40_PLAYER:case this.ID_SEASON_OF_DISCOVERY_40_PLAYER_BWL:a=WH.TERMS.seasonal+WH.TERMS.wordspace_punct+"40";break;case this.ID_SEASON_OF_DISCOVERY_10_PLAYER:case this.ID_SEASON_OF_DISCOVERY_20_PLAYER:case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_ZG:case this.ID_SEASON_OF_DISCOVERY_5_PLAYER:case this.ID_SEASON_OF_DISCOVERY_1_PLAYER:a=WH.TERMS.seasonOfDiscovery_abbrev+WH.TERMS.wordspace_punct+WH.TERMS.normal;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_1:a=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel1;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_2:a=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel2;break;case this.ID_SEASON_OF_DISCOVERY_20_PLAYER_MC_HEAT_LEVEL_3:a=WH.TERMS.seasonOfDiscoveryMoltenCoreHeatLevel3;break;case this.ID_MISTS_CELESTIAL:a=WH.TERMS.celestial;break}return a||"["+t+"]"}};WH.Wow.Event=new function(){this.getNextEvent=function(e,t){t=t||new Date;for(let a in e){let i=e[a];if(new Date(i.end)>=t){return i}}return null}};WH.Wow.Expansion=new function(){const e=this;const t=WH.Wow;this.CLASSIC=0;this.TBC=1;this.WRATH=2;this.CATA=3;this.MOP=4;this.WOD=5;this.LEGION=6;this.BFA=7;this.SL=8;this.DF=9;this.TWW=10;this.MN=11;this.TLT=12;this.LEVEL_CAP_RETAIL_CLASSIC=30;this.LEVEL_CAP_RETAIL_TBC=30;this.LEVEL_CAP_RETAIL_WRATH=30;this.LEVEL_CAP_RETAIL_CATA=35;this.LEVEL_CAP_RETAIL_MOP=35;this.LEVEL_CAP_RETAIL_WOD=40;this.LEVEL_CAP_RETAIL_LEGION=45;this.LEVEL_CAP_RETAIL_BFA=50;this.LEVEL_CAP_RETAIL_SL=60;this.LEVEL_CAP_RETAIL_DF=70;this.LEVEL_CAP_RETAIL_TWW=80;this.LEVEL_CAP_RETAIL_MN=90;this.LEVEL_START_RETAIL_CATA=30;this.LEVEL_START_RETAIL_EXPANSION=10;const a={[this.CLASSIC]:"",[this.TBC]:"tbc",[this.WRATH]:"wotlk",[this.CATA]:"cata",[this.MOP]:"mop",[this.WOD]:"wod",[this.LEGION]:"legion",[this.BFA]:"bfa",[this.SL]:"sl",[this.DF]:"df",[this.TWW]:"tww",[this.MN]:"mn",[this.TLT]:"tlt"};const i={[this.CLASSIC]:[WH.TERMS.classic],[this.TBC]:[WH.TERMS.theburningcrusade_short,WH.TERMS.burningcrusade_abbrev],[this.WRATH]:[WH.TERMS.wrathofthelichking_short,WH.TERMS.wrathofthelichking_abbrev],[this.CATA]:[WH.TERMS.cataclysm_short,WH.TERMS.cataclysm_abbrev],[this.MOP]:[WH.TERMS.mistsofpandaria_short,WH.TERMS.mistsofpandaria_abbrev],[this.WOD]:[WH.TERMS.warlordsofdraenor_short,WH.TERMS.warlordsofdraenor_abbrev],[this.LEGION]:[WH.TERMS.legion_abbrev],[this.BFA]:[WH.TERMS.battleforazeroth_short,WH.TERMS.battleforazeroth_abbrev],[this.SL]:[WH.TERMS.shadowlands_expansion,WH.TERMS.shadowlands_abbrev],[this.DF]:[WH.TERMS.dragonflight_expansion,WH.TERMS.dragonflight_abbrev],[this.TWW]:[WH.TERMS.theWarWithin_wowExpansion,WH.TERMS.theWarWithin_wowExpansionAbbrev],[this.MN]:[WH.TERMS.midnight_wowExpansion,WH.TERMS.midnight_wowExpansionAbbrev],[this.TLT]:[WH.TERMS.theLastTitan_wowExpansion,WH.TERMS.theLastTitan_wowExpansionAbbrev]};const n={[this.CLASSIC]:"classic",[this.TBC]:"theburningcrusade",[this.WRATH]:"wrathofthelichking",[this.CATA]:"cataclysm",[this.MOP]:"mistsofpandaria",[this.WOD]:"warlordsofdraenor",[this.LEGION]:"legion_expansion",[this.BFA]:"battleforazeroth",[this.SL]:"shadowlands_expansion",[this.DF]:"dragonflight_expansion",[this.TWW]:"theWarWithin_wowExpansion",[this.MN]:"midnight_wowExpansion",[this.TLT]:"theLastTitan_wowExpansion"};const s={[this.CLASSIC]:"classic_abbrev",[this.TBC]:"theburningcrusade_short",[this.WRATH]:"wrathofthelichking_abbrev",[this.CATA]:"cataclysm_abbrev",[this.MOP]:"mistsofpandaria_abbrev",[this.WOD]:"warlordsofdraenor_abbrev",[this.LEGION]:"legion_abbrev",[this.BFA]:"battleforazeroth_abbrev",[this.SL]:"shadowlands_abbrev",[this.DF]:"dragonflight_abbrev",[this.TWW]:"theWarWithin_wowExpansionAbbrev",[this.MN]:"midnight_wowExpansionAbbrev",[this.TLT]:"theLastTitan_wowExpansionAbbrev"};const r={[this.CLASSIC]:"classic",[this.TBC]:"theburningcrusade_short",[this.WRATH]:"wrathofthelichking_short",[this.CATA]:"cataclysm_short",[this.MOP]:"mistsofpandaria_short",[this.WOD]:"warlordsofdraenor_short",[this.LEGION]:"legion_expansion",[this.BFA]:"battleforazeroth_short",[this.SL]:"shadowlands_short",[this.DF]:"dragonflight_short",[this.TWW]:"theWarWithin_wowExpansionShort",[this.MN]:"midnight_wowExpansionShort",[this.TLT]:"theLastTitan_wowExpansionShort"};const o={availableExpansionsCache:{},currentExpansionsCache:{}};this.available=function(t,a){return e.get(a)>=t};this.get=function(e){e=e||WH.getDataEnv();if(o.availableExpansionsCache[e]){return o.availableExpansionsCache[e]}let t=l(WH.Wow.getVersionString(e));if(t===undefined){let t="Could not get expansion for data env. ["+e+"]";WH.error(t);throw t}o.availableExpansionsCache[e]=t;return t};this.getAbbreviation=function(e){return WH.TERMS[s[e]]||WH.TERMS.unknown};this.getAllAvailable=function(t){let a=e.get(t);let i=[];for(let e=0;e<=a;e++){i.push(e)}return i};this.getCurrent=t=>{t=t||WH.getDataEnv();if(o.currentExpansionsCache[t]){return o.currentExpansionsCache[t]}let a=e.getAllAvailable(t);a.sort(((e,t)=>t-e));let i=a.find((a=>e.isLaunched(a,t)));if(i==null){throw new Error(`No launched WoW expansions found in ${WH.getDataEnvKey(t)}.`)}o.currentExpansionsCache[t]=i;return i};this.getIconClass=function(e){if(!a[e]){return null}return"icon-"+a[e]};this.getName=function(e){return WH.TERMS[n[e]]||WH.TERMS.unknown};this.getRightIconClass=function(t){let a=e.getIconClass(t);return a?a+"-right":null};this.getSearchText=function(e){var t=i[e]||[];for(var a=1;a<t.length;a++){if(t[a-1]===t[a]){t.splice(a--,1)}}return t};this.getShortName=function(e){return WH.TERMS[r[e]]||WH.TERMS.unknown};this.isLaunched=(a,i)=>{i=i||WH.getDataEnv();if(a<e.get(i)){return true}let n=t.getVersionString(i).split(".").map((e=>parseInt(e)));return n[0]>=c(a)&&(n[1]>0||n[2]>1)};function l(e){let t=parseInt(e.substr(0,e.indexOf(".")));if(isNaN(t)){return undefined}return t-1}function c(e){return e+1}};WH.Wow.Faction=new function(){this.REP_LEVEL_REVERED=63e3;this.REP_RANK_HATED=0;this.REP_RANK_HOSTILE=1;this.REP_RANK_UNFRIENDLY=2;this.REP_RANK_NEUTRAL=3;this.REP_RANK_FRIENDLY=4;this.REP_RANK_HONORED=5;this.REP_RANK_REVERED=6;this.REP_RANK_EXALTED=7;this.getCategoryName=e=>WH.getPageData("wow.faction.categoryNames")[e];this.getFriendshipName=(e,t)=>WH.getPageData("wow.faction.friendships")[e]?.[t];this.getRankName=function(e){return WH.getPageData("wow.faction.ranks")[e].name}};WH.Wow.Follower=new function(){this.FOLLOWER_TYPE_FOLLOWER=1;this.FOLLOWER_TYPE_SHIP=2;this.FOLLOWER_TYPE_LEGION_CHAMPION=4;this.FOLLOWER_TYPE_BFA_CHAMPION=22;this.FOLLOWER_TYPE_ADVENTURE_COMBATANT=123};WH.Wow.Gender=WH.defineEnum({Both:3,Female:1,Male:0,Neutral:4,None:2},(function(e){const t=this;const a=WH.Wow.Expansion;const i=WH.WebP;this.getIcon=function(){switch(t){case e.Female:return n()?"ui-charactercreate-body-2":"ui-charactercreate-gender-female";case e.Male:return n()?"ui-charactercreate-body-1":"ui-charactercreate-gender-male"}};this.getName=function(){if(t===e.Male&&n()){return WH.TERMS.body1}if(t===e.Female&&n()){return WH.TERMS.body2}return WH.TERMS[t.name.toLowerCase()]};this.getFilename=()=>t.name.toLowerCase();function n(){return!WH.isClassicTree()&&!WH.isTbcTree()}}));WH.Wow.Glyph=new function(){const e=1;const t=2;const a=3;this.getTypeName=function(i){switch(i){case e:return WH.TERMS.major;case t:return WH.TERMS.minor;case a:return WH.TERMS.prime;default:return WH.TERMS.unknown}}};WH.Wow.Item=new function(){const e=this;const t=WH.Wow.Difficulty;const a=WH.Wow.Expansion;this.CLASS_WEAPON=2;this.CLASS_GEM=3;this.CLASS_ARMOR=4;this.CLASS_QUEST=12;this.ARMOR_SUBCLASS_MISC=0;this.ARMOR_SUBCLASS_CLOTH=1;this.ARMOR_SUBCLASS_LEATHER=2;this.ARMOR_SUBCLASS_MAIL=3;this.ARMOR_SUBCLASS_PLATE=4;this.ARMOR_SUBCLASS_COSMETIC=5;this.ARMOR_SUBCLASS_SHIELDS=6;this.ARMOR_SUBCLASS_LIBRAMS=7;this.ARMOR_SUBCLASS_IDOLS=8;this.ARMOR_SUBCLASS_TOTEMS=9;this.ARMOR_SUBCLASS_SIGILS=10;this.ARMOR_SUBCLASS_RELICS=11;this.ARMOR_SUBCLASS_RINGS=-2;this.ARMOR_SUBCLASS_AMULETS=-3;this.ARMOR_SUBCLASS_TRINKETS=-4;this.ARMOR_SUBCLASS_OFF_HAND_FRILLS=-5;this.ARMOR_SUBCLASS_CLOAKS=-6;this.ARMOR_SUBCLASS_TABARDS=-7;this.ARMOR_SUBCLASS_SHIRTS=-8;this.WEAPON_SUBCLASS_ONE_HANDED_AXE=0;this.WEAPON_SUBCLASS_TWO_HANDED_AXE=1;this.WEAPON_SUBCLASS_BOW=2;this.WEAPON_SUBCLASS_GUN=3;this.WEAPON_SUBCLASS_ONE_HANDED_MACE=4;this.WEAPON_SUBCLASS_TWO_HANDED_MACE=5;this.WEAPON_SUBCLASS_POLEARM=6;this.WEAPON_SUBCLASS_ONE_HANDED_SWORD=7;this.WEAPON_SUBCLASS_TWO_HANDED_SWORD=8;this.WEAPON_SUBCLASS_WARGLAIVE=9;this.WEAPON_SUBCLASS_STAFF=10;this.WEAPON_SUBCLASS_FIST_WEAPON=13;this.WEAPON_SUBCLASS_MISCELLANEOUS=14;this.WEAPON_SUBCLASS_DAGGER=15;this.WEAPON_SUBCLASS_THROWN=16;this.WEAPON_SUBCLASS_CROSSBOW=18;this.WEAPON_SUBCLASS_WAND=19;this.WEAPON_SUBCLASS_FISHING_POLE=20;this.FLAGS2_APPEARANCE_UNCOLLECTIBLE=4194304;this.INVENTORY_TYPE_HEAD=1;this.INVENTORY_TYPE_NECK=2;this.INVENTORY_TYPE_SHOULDERS=3;this.INVENTORY_TYPE_SHIRT=4;this.INVENTORY_TYPE_CHEST=5;this.INVENTORY_TYPE_WAIST=6;this.INVENTORY_TYPE_LEGS=7;this.INVENTORY_TYPE_FEET=8;this.INVENTORY_TYPE_WRISTS=9;this.INVENTORY_TYPE_HANDS=10;this.INVENTORY_TYPE_FINGER=11;this.INVENTORY_TYPE_TRINKET=12;this.INVENTORY_TYPE_ONE_HAND=13;this.INVENTORY_TYPE_SHIELD=14;this.INVENTORY_TYPE_RANGED=15;this.INVENTORY_TYPE_BACK=16;this.INVENTORY_TYPE_TWO_HAND=17;this.INVENTORY_TYPE_BAG=18;this.INVENTORY_TYPE_TABARD=19;this.INVENTORY_TYPE_ROBE=20;this.INVENTORY_TYPE_MAIN_HAND=21;this.INVENTORY_TYPE_OFF_HAND=22;this.INVENTORY_TYPE_HELD_IN_OFF_HAND=23;this.INVENTORY_TYPE_PROJECTILE=24;this.INVENTORY_TYPE_THROWN=25;this.INVENTORY_TYPE_RANGED_RIGHT=26;this.INVENTORY_TYPE_QUIVER=27;this.INVENTORY_TYPE_RELIC=28;this.INVENTORY_TYPE_PROFESSION_TOOL=29;this.INVENTORY_TYPE_PROFESSION_ACCESSORY=30;this.INVENTORY_TYPE_EQUIPABLE_SPELL_OFFENSIVE=31;this.INVENTORY_TYPE_EQUIPABLE_SPELL_UTILITY=32;this.INVENTORY_TYPE_EQUIPABLE_SPELL_DEFENSIVE=33;this.INVENTORY_TYPE_EQUIPABLE_SPELL_WEAPON=34;this.INV_TYPES=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_NECK,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_FINGER,this.INVENTORY_TYPE_TRINKET,this.INVENTORY_TYPE_ONE_HAND,this.INVENTORY_TYPE_SHIELD,this.INVENTORY_TYPE_RANGED,this.INVENTORY_TYPE_BACK,this.INVENTORY_TYPE_TWO_HAND,this.INVENTORY_TYPE_BAG,this.INVENTORY_TYPE_TABARD,this.INVENTORY_TYPE_ROBE,this.INVENTORY_TYPE_MAIN_HAND,this.INVENTORY_TYPE_OFF_HAND,this.INVENTORY_TYPE_HELD_IN_OFF_HAND,this.INVENTORY_TYPE_PROJECTILE,this.INVENTORY_TYPE_THROWN,this.INVENTORY_TYPE_RANGED_RIGHT,this.INVENTORY_TYPE_QUIVER,this.INVENTORY_TYPE_RELIC,this.INVENTORY_TYPE_PROFESSION_TOOL,this.INVENTORY_TYPE_PROFESSION_ACCESSORY,this.INVENTORY_TYPE_EQUIPABLE_SPELL_OFFENSIVE,this.INVENTORY_TYPE_EQUIPABLE_SPELL_UTILITY,this.INVENTORY_TYPE_EQUIPABLE_SPELL_DEFENSIVE,this.INVENTORY_TYPE_EQUIPABLE_SPELL_WEAPON];this.QUALITY_DEFAULT="";this.QUALITY_POOR=0;this.QUALITY_COMMON=1;this.QUALITY_UNCOMMON=2;this.QUALITY_RARE=3;this.QUALITY_EPIC=4;this.QUALITY_LEGENDARY=5;this.QUALITY_ARTIFACT=6;this.QUALITY_HEIRLOOM=7;this.QUALITY_WOW_TOKEN=8;this.QUALITY_GLYPH=9;this.QUALITY_FAIL=10;this.QUALITY_SET_BONUSES=13;this.WRATH_ARMOR_SCALING_INDEXES={[e.ARMOR_SUBCLASS_CLOTH]:{[e.INVENTORY_TYPE_SHOULDERS]:12,[e.INVENTORY_TYPE_CHEST]:16,[e.INVENTORY_TYPE_HEAD]:20,[e.INVENTORY_TYPE_LEGS]:24},[e.ARMOR_SUBCLASS_LEATHER]:{[e.INVENTORY_TYPE_SHOULDERS]:13,[e.INVENTORY_TYPE_CHEST]:17,[e.INVENTORY_TYPE_HEAD]:21,[e.INVENTORY_TYPE_LEGS]:25},[e.ARMOR_SUBCLASS_MAIL]:{[e.INVENTORY_TYPE_SHOULDERS]:14,[e.INVENTORY_TYPE_CHEST]:18,[e.INVENTORY_TYPE_HEAD]:22,[e.INVENTORY_TYPE_LEGS]:26},[e.ARMOR_SUBCLASS_PLATE]:{[e.INVENTORY_TYPE_SHOULDERS]:15,[e.INVENTORY_TYPE_CHEST]:19,[e.INVENTORY_TYPE_HEAD]:23,[e.INVENTORY_TYPE_LEGS]:27},[e.ARMOR_SUBCLASS_CLOAKS]:{[e.INVENTORY_TYPE_BACK]:28},[e.ARMOR_SUBCLASS_SHIELDS]:{[e.INVENTORY_TYPE_SHIELD]:29}};this.SCALING_STATS_DISTRIBUTION_STAT_MAX=10;this.ITEM_SCALING_VALUE_SPELL_POWER_INDEX=6;this.DBCITEM_FLAGS_SCALING_SPELL_POWER=32768;const i=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_ROBE];const n=[e.ARMOR_SUBCLASS_CLOTH,e.ARMOR_SUBCLASS_LEATHER,e.ARMOR_SUBCLASS_MAIL,e.ARMOR_SUBCLASS_PLATE];const s=WH.getPageData("wow.item.classNames");const r={};const o=WH.getPageData("wow.item.slotToInvTypes");const l=WH.getPageData("wow.item.subclassNames");const c=WH.getPageData("wow.item.subsubclassNames");var u={default:{"":"ffd100",0:"9d9d9d",1:"ffffff",2:"1eff00",3:"0070dd",4:"a335ee",5:"ff8000",6:"e5cc80",7:"00ccff",8:"00ccff",9:"71d5ff",10:"ff4040",13:"ffff98"}};this.getQualityIds=()=>Object.keys(u.default).map((e=>parseInt(e)));var d={"":"default",0:"poor",1:"common",2:"uncommon",3:"rare",4:"epic",5:"legendary",6:"artifact",7:"heirloom",8:"wowtoken",9:"glyph",10:"error",13:"setbonuses",14:"minorpower"};const f={1:WH.TERMS.arena,2:WH.TERMS.battleground,4:WH.TERMS.world};const h=[e.WEAPON_SUBCLASS_BOW,e.WEAPON_SUBCLASS_GUN,e.WEAPON_SUBCLASS_THROWN,e.WEAPON_SUBCLASS_CROSSBOW,e.WEAPON_SUBCLASS_WAND];const p={invTypeNames:undefined,nameDescriptions:undefined};this.getArmorSubclasses=function(){let t=n.slice();if(a.available(a.MOP)){t.push(e.ARMOR_SUBCLASS_COSMETIC)}return t};this.getBondTypeName=function(e){return{1:WH.GlobalStrings.ITEM_BIND_ON_PICKUP,2:WH.GlobalStrings.ITEM_BIND_ON_EQUIP,3:WH.GlobalStrings.ITEM_BIND_ON_USE,4:WH.GlobalStrings.ITEM_BIND_QUEST,5:WH.GlobalStrings.ITEM_BIND_QUEST}[e]||WH.TERMS.unknownBindType_stc};this.getClassName=function(e,t){if(t!=null){return(l[e]||{})[t]}else{return s[e]}};this.getClassNameMap=()=>s;this.getSlotsToInvTypes=function(){return o[WH.getDataEnv()]||o[WH.getRootEnv()]};this.getInvTypeName=function(e){p.invTypeNames=p.invTypeNames||WH.getPageData("wow.item.invTypeNames")||{};return p.invTypeNames[e]};this.getInvTypeSlots=function(e){let t=WH.getDataEnv();if(!r[t]){r[t]={};let e=o[t]||o[WH.getRootEnv()];for(let a in e){if(!e.hasOwnProperty(a)){continue}for(let i=0,n;n=e[a][i];i++){if(!r[t][n]){r[t][n]=[]}r[t][n].push(parseInt(a))}}}return r[t][e]||[]};this.getNameDescription=function(e){return(m()[e]||{}).name||null};this.getNameDescriptionColor=function(e){return(m()[e]||{}).color||null};this.getQualityClass=function(e){let t=u[WH.Theme.getTheme()]||u["default"];return t[e]?`q${e}`:""};this.getQualityColor=function(t,a){var i=a?u["default"]:u[WH.Theme.getTheme()]||u["default"];var n=i[t]||i[e.QUALITY_DEFAULT];return"#"+n};this.getQualityName=function(e){return WH.TERMS[d[e]]||WH.TERMS.unknown};this.getQualitySlug=e=>d[e];this.getSourceCategory=function(e,t){switch(e){case 2:if(t.bd){return WH.TERMS.bossdrop}if(t.z){return WH.TERMS.zonedrop}break;case 4:return WH.TERMS.quests;case 5:return WH.TERMS.vendors}return WH.Wow.getSourceName(e)||""};this.getSourceDescription=function(e,a){switch(e){case 3:if(a.p&&f[a.p]){return{text:f[a.p]}}break}switch(a.t||0){case 0:case 1:case 2:if(a.z){var i={url:WH.Entity.getUrl(WH.Types.ZONE,a.z,WH.Wow.Area.getName(a.z)),text:WH.Wow.Area.getName(a.z)};if(a.t&&e==5){i.pretext=WH.TERMS.vendorin}if(a.dd){let e=t.getNameAbbrev(t.convertLegacyDropDifficulty(a.dd));i.posttext=WH.Strings.sprintf(WH.TERMS.parens_format,"",e)}return i}break;case 5:return{url:WH.Url.generate("/quests="+a.c2+"."+a.c),text:WH.Wow.Quest.getCategoryName(a.c)};break;case 6:if(a.c&&a.s){return{url:WH.Url.generate("/spells="+a.c+"."+a.s),text:WH.Wow.Skill.getName(a.s)}}else{return{url:WH.Url.generate("/spells=0"),text:"??"}}break}};this.getThumbUrl=function(e,t,a){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(a)+"/webthumbs/item/"+(e&255)+"/"+e+(t?"-"+t:"")+WH.WebP.getImageExtension()};this.getTypeNameAndUrl=function(e,t,a){if(c.hasOwnProperty(e)&&c[e].hasOwnProperty(t)&&c[e][t].hasOwnProperty(a)){return{url:WH.Url.generatePath("/items="+e+"."+t+"."+a),text:c[e][t][a]}}if(l.hasOwnProperty(e)&&l[e].hasOwnProperty(t)){return{url:WH.Url.generatePath("/items="+e+"."+t),text:l[e][t]}}if(s.hasOwnProperty(e)){return{url:WH.Url.generatePath("/items="+e),text:s[e]}}WH.error("Could not find item class name for: "+JSON.stringify({itemClass:e,itemSubClass:t,itemSubSubClass:a}));return{url:WH.Url.generatePath("/items"),text:WH.TERMS.unknown}};this.getWeaponSubclasses=function(){let t=WH.cOr({},l[e.CLASS_WEAPON]);if(!a.available(a.LEGION)){delete t[e.WEAPON_SUBCLASS_WARGLAIVE]}if(a.available(a.MOP)){delete t[e.WEAPON_SUBCLASS_THROWN]}let i=Object.keys(t).map(Number);i.sort((function(e,t){return e-t}));e.getWeaponSubclasses=function(e){return e}.bind(this,i);return i};this.isArmorInvType=function(e){return i.includes(e)};this.isBodyArmor=function(t,a){return t===e.CLASS_ARMOR&&n.includes(a)};this.isRangedWeaponSubclass=function(e){return h.includes(e)};this.tooltipHasSpecStats=function(e){const t=WH.Wow.Item.Stat;let a=/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?\D*?)<\/span>/gi;let i=a.exec(e);while(i!=null){if(g_grayedOutStats.hasOwnProperty(i[1])||[t.ID_AGI_STR_INT,t.ID_AGI_STR,t.ID_AGI_INT,t.ID_STR_INT].includes(parseInt(i[1]))){return true}i=a.exec(e)}return e.indexOf("\x3c!--traitspec")>0};function m(){return p.nameDescriptions=p.nameDescriptions||WH.getPageData("wow.item.bonusNameDescriptions")||{}}};WH.Links=new function(){const e=WH.Game;const t=WH.Gatherer;const a=WH.Wow.Item;const i=WH.ShareServices;const n=WH.Theme;this.show=function(u,d,f){u.blur();if(u.addedLinksMenu&&!d.alwaysRefresh){return}let h=[];h.push(Menu.createHeading({label:WH.TERMS.clickToCopy}));h.push([0,WH.TERMS.link,WH.copyToClipboard.bind(null,location.href),null,{fontIcon:"link"}]);let p=WH.qsa("#main .wowhead-tooltip[data-markup]");if(p.length>1){Array.from(p).map((e=>({tag:e.dataset.markup,label:WH.qs(".whtt-name",e)?.innerText}))).filter((e=>e.label)).map((e=>Menu.createItem({label:WH.term("markupTag_format",e.label),url:WH.copyToClipboard.bind(null,e.tag),options:{icon:n.getFaviconUrl()}}))).forEach((e=>h.push(e)))}else{let e=d.type&&d.typeId&&WH.markup.Tags.getByEntityType(d.type);e&&h.push(Menu.createItem({label:WH.TERMS.wowheadMarkupTag,url:WH.copyToClipboard.bind(null,WH.markup.Tags.getWhml(e,d.typeId,d)),options:{icon:n.getFaviconUrl()}}))}let m=r(d);if(m){h.push([0,WH.TERMS.inGameLink,WH.copyToClipboard.bind(null,m),null,{icon:"/images/icons/wow.png"}])}let H=s(d);if(H){h.push([0,WH.TERMS.inGameDressingRoomCommand,WH.copyToClipboard.bind(null,H),null,{icon:"/images/icons/wow.png"}])}let g=o(d);if(g){h.push([0,WH.TERMS.inGameSoundCommand,WH.copyToClipboard.bind(null,g),null,{icon:"/images/icons/wow.png"}])}let W=l(d);if(W){h.push([0,WH.TERMS.mogItImportString,WH.copyToClipboard.bind(null,W),null,{fontIcon:"code"}])}let E=c(d);if(E){h.push([0,WH.TERMS.simulationCraftImportString,WH.copyToClipboard.bind(null,E),null,{fontIcon:"code"}])}if(d.typeId){h.push(Menu.createItem({label:WH.term("id_format",WH.Types.getUpperSingular(d.type))+WH.TERMS.colon_punct+d.typeId,url:WH.copyToClipboard.bind(null,d.typeId),options:{fontIcon:"hashtag"}}))}if(u.dataset.displayId){h.push(Menu.createItem({label:WH.TERMS.displayId+WH.TERMS.colon_punct+u.dataset.displayId,url:function(e){let t=WH.ge("wh-mv-view-in-3d-button");let a=t&&t.dataset.mvDisplayId||u.dataset.displayId;WH.copyToClipboard(a,e)},options:{fontIcon:"hashtag"}}))}let _=WH.getPageData("links.copyMenuItems");_?.forEach((e=>{h.push(Menu.createItem({label:e.label,url:t=>WH.copyToClipboard(e.value,t),options:{fontIcon:e.fontIcon??"clipboard"}}))}));if(WH.User.hasRole(U_GROUP_STAFF)){let e=[Menu.createHeading({label:WH.term("parens_format",WH.TERMS.clickToCopy,WH.TERMS.staffemployees)})];if(u.dataset.modelMarkup){e.push(Menu.createItem({label:"Model Markup",url:WH.copyToClipboard.bind(null,u.dataset.modelMarkup)}))}if(u.dataset.displayId){let i=parseInt(u.dataset.displayId);if(u.dataset.modelEntityType==WH.Types.NPC){let t=WH.STATIC_URL+WH.Wow.ModelViewer.getStaticBase()+"/webthumbs/npc-row/"+(i&255)+"/"+i+".jpg";e.push(Menu.createItem({label:"NPC Row Image",url:WH.copyToClipboard.bind(null,t),options:{tooltip:t}}))}if(u.dataset.modelEntityType==WH.Types.ITEM){let n=t.get(WH.Types.ITEM,parseInt(u.dataset.modelEntityId));if(n&&n.classs===a.CLASS_WEAPON){let t=WH.STATIC_URL+WH.Wow.ModelViewer.getStaticBase()+"/webthumbs/item-large/"+(i&255)+"/"+i+".jpg";e.push(Menu.createItem({label:"Item Large Image",url:WH.copyToClipboard.bind(null,t),options:{tooltip:t}}))}}}{const t=parseInt(u.dataset.blizzardTransmogSet??0);if(t){let a=WH.STATIC_URL+WH.Wow.ModelViewer.getStaticBase()+"/webthumbs/blizzard-transmog-row/"+(t&255)+"/"+t+".jpg";e.push(Menu.createItem({label:"Transmog Set Row Image",url:WH.copyToClipboard.bind(null,a),options:{tooltip:a}}))}}let i=WH.Wow.ModelViewer.getModelScreenshotUrl();if(i){e.push(Menu.createItem({label:"Model Image URL",url:function(e){WH.copyToClipboard(i.replace(/\.webp$/,".png"),e)},options:{fontIcon:"picture-o"}}))}if(e.length>1){h=h.concat(e)}}h.push(Menu.createHeading({label:WH.TERMS.share}));i.getShareServices(location.href,i.getSubredditByGame(e.get())).forEach((e=>{h.push(Menu.createItem({label:e.name,url:e.url,options:{fontIcon:e.fontIcon.name,newWindow:true}}))}));u.addedLinksMenu=true;if(Menu.hasMenu(u)){Menu.replace(u,h)}else{Menu.add(u,h,{showAtElement:true,showImmediately:true},f)}};function s(e){if(!e.dressup||!e.dressup.length){return null}var t='/run local function f(i,b)DressUpItemLink("item:"..i.."::::::::::::9:"..b);end;';for(var a=0,i=e.dressup.length;a<i;a++){var n=e.dressup[a].slice(0);while(n.length<2){n.push(0)}t+="f("+n.shift()+","+(n.length>1?'"'+n.join(":")+'"':n.shift())+");"}return t}function r(e){if(!(e.linkColor&&e.linkId&&e.linkName)){return null}var t=e.linkName.replace(/:+$/,"").replace(/"/g,'\\"');return"/script DEFAULT_CHAT_FRAME:AddMessage("+'"\\124c'+e.linkColor+"\\124H"+e.linkId+"\\124h["+t+']\\124h\\124r");'}function o(e){return e.sound?"/script PlaySound("+e.sound+")":null}function l(e){if(!e.dressup||!e.dressup.length){return null}var t="";for(var a=0,i=e.dressup.length;a<i;a++){var n=e.dressup[a];if(n[0]){t+=(t?":":"compare?items=")+n[0];if(n[1]){t+=".0.0.0.0.0.0.0.0.0."+n[1]}}}return t||null}function c(e){if(e.type!==WH.Types.ITEM||!e.slot){return null}var t=u(parseInt(e.slot));if(!t){return null}var a=t+"="+e.linkName.toLowerCase().replace(/ /g,"_").replace(/[^+.%\w]/g,"")+",id="+e.typeId;if(e.bonuses&&e.bonuses.length&&e.bonuses[0]!=0){a+=",bonus_id="+e.bonuses.join("/")}if(e.dropLevel){a+=",drop_level="+e.dropLevel}return a}function u(e){for(var t in g_character_slots_data){if(g_character_slots_data.hasOwnProperty(t)&&g_character_slots_data[t].itemSlots.indexOf(e)!==-1){return g_character_slots_data[t].simCraftName||g_character_slots_data[t].name}}return null}};WH.Wow.ItemSet=new function(){this.getNote=e=>WH.getPageData("wow.itemSet.notes")[e];this.getThumbUrl=function(e,t,a,i){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(i)+"/webthumbs/item-set/"+t+"/"+a+"/"+(Math.abs(e)&255)+"/"+e+WH.WebP.getImageExtension()};this.getTypeName=e=>WH.getPageData("wow.itemSet.typeNames")[e]};WH.Wow.MissionAbility=new function(){const e={types:undefined};this.getTypeName=function(t,a){e.types=e.types||WH.getPageData("wow.missionAbility.types")||{};return e.types[t]&&e.types[t][a]||undefined};this.getTypeNames=function(t){e.types=e.types||WH.getPageData("wow.missionAbility.types")||{};return e.types[t]}};WH.Wow.Models=new function(){this.getRaceIdFromMask=function(e){if(e){let t=WH.Wow.Race.getIdsFromMask(e);if(t.length){t.sort(((e,t)=>e-t));return t[0]}}return null};this.isPepeEnabled=function(){return WH.isRetailTree()}};WH.Wow.Npc=new function(){const e=this;this.CLASSIFICATION_NORMAL=0;this.CLASSIFICATION_BOSS=3;const t=[71953,72057,71952,71954,71955];this.getClassification=e=>WH.getPageData("wow.npc.classifications")[e];this.getThumbUrl=function(e,t){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(t)+"/webthumbs/npc/"+(e&255)+"/"+e+WH.WebP.getImageExtension()};this.getTypeName=function(t){return e.getTypeNames()[t]};this.getTypeNames=function(){return WH.getPageData("wow.npc.types")};this.isClassified=t=>t!=null&&t!==e.CLASSIFICATION_NORMAL;this.usesPersonalLootOutdoors=e=>t.includes(e);this.typeExists=function(t){return e.getTypeNames()[t]!==undefined}};WH.Wow.Pet=new function(){const e=WH.getPageData("wow.pet.names")||{};this.getFoods=()=>WH.getPageData("wow.pet.food");this.getName=function(t){return e[t]||null};this.getType=e=>WH.getPageData("wow.pet.types")[e]};WH.Wow.PlayerClass=new function(){const e=this;const t=WH.Game;const a=WH.Wow.Item;this.DEATH_KNIGHT=6;this.DEMON_HUNTER=12;this.DRUID=11;this.EVOKER=13;this.HUNTER=3;this.MAGE=8;this.MONK=10;this.PALADIN=2;this.PRIEST=5;this.ROGUE=4;this.SHAMAN=7;this.WARLOCK=9;this.WARRIOR=1;const i=WH.getPageData("wow.playerClass.raceIds")||{};const n={[WH.dataEnv.CLASSIC]:[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.TBC]:[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.WRATH]:[this.DEATH_KNIGHT,this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.CATA]:[this.DEATH_KNIGHT,this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.MISTS]:[this.DEATH_KNIGHT,this.DRUID,this.HUNTER,this.MAGE,this.MONK,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.MAIN]:[this.DEATH_KNIGHT,this.DEMON_HUNTER,this.DRUID,this.EVOKER,this.HUNTER,this.MAGE,this.MONK,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR]};const s={[this.DEATH_KNIGHT]:"deathknight",[this.DEMON_HUNTER]:"demonhunter",[this.DRUID]:"druid",[this.EVOKER]:"evoker",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.MONK]:"monk",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"};const r=WH.getPageData("wow.playerClass.names")||{};const o={};o[a.ARMOR_SUBCLASS_CLOTH]=[this.MAGE,this.PRIEST,this.WARLOCK];o[a.ARMOR_SUBCLASS_LEATHER]=[this.DEMON_HUNTER,this.DRUID,this.MONK,this.ROGUE];o[a.ARMOR_SUBCLASS_MAIL]=[this.EVOKER,this.HUNTER,this.SHAMAN];o[a.ARMOR_SUBCLASS_PLATE]=[this.DEATH_KNIGHT,this.PALADIN,this.WARRIOR];const l={[WH.dataEnv.CLASSIC]:{[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.TBC]:{[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.WRATH]:{[this.DEATH_KNIGHT]:"death-knight",[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.CATA]:{[this.DEATH_KNIGHT]:"death-knight",[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.MISTS]:{[this.DEATH_KNIGHT]:"death-knight",[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.MONK]:"monk",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.MAIN]:{[this.DEATH_KNIGHT]:"death-knight",[this.DEMON_HUNTER]:"demon-hunter",[this.DRUID]:"druid",[this.EVOKER]:"evoker",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.MONK]:"monk",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"}};const c={colorCache:undefined};this.canBeRace=function(t,a){if(!i[t]){WH.error("Class not available in current data env.",e.getName(t)||t,WH.getDataEnvKey());return false}return i[t].indexOf(a)>-1};this.exists=function(e,t){return this.getAll(t).includes(e)};this.getAll=function(e){e=e||t.getEnv(t.WOW);let a=n[e]||n[WH.getRootEnv(e)]||n[t.getEnv(t.WOW)];if(!a){WH.error("No classes defined for "+WH.getDataEnvKey()+".");return[]}return a.slice()};this.getBySlug=function(e,t){let a=u(t);for(let t in a){if(a[t]===e){return parseInt(t)}}return undefined};this.getBySpec=function(t,a){return e.Specialization.getClassId(t,a)};this.getColor=function(t){if(!c.colorCache){let t=e=>"#"+e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.?\d*))?\)$/).slice(1).map(((e,t)=>(t===3?Math.round(parseFloat(e)*255):parseFloat(e)).toString(16).padStart(2,"0").replace("NaN",""))).join("");let a=WH.dataEnv.BETA;WH.Tooltips.prepare(a);let i=WH.Tooltips.getTd();c.colorCache={};e.getAll(a).forEach((e=>{let a=WH.ce("span",{className:"c"+e},WH.ct("text"));WH.ae(i,a);c.colorCache[e]=t(getComputedStyle(a).getPropertyValue("color"))}));WH.Tooltips.hide()}if(!c.colorCache[t]){throw new Error("Invalid WoW class ID: "+t)}return c.colorCache[t]};this.getHtmlClass=e=>`c${e}`;this.getIconName=function(e){return"class_"+s[e]};this.getIdString=function(e){return s[e]};this.getName=function(e){return r[e]||null};this.getPreferredArmorSubclass=function(e){for(let t in o){if(o[t].includes(e)){return parseInt(t)}}return undefined};this.getSlug=function(e,t){return u(t)[e]};this.removeClasses=function(e){let t=/^c1?\d$/;e.classList.forEach((function(e,a,i){if(t.test(e)){i.remove(e)}}))};function u(e){return l[e]||l[WH.getRootEnv(e)]||l[t.getEnv(t.WOW)]}function d(){for(let t in n){n.hasOwnProperty(t)&&n[t].sort((function(t,a){return(e.getName(t)||"").localeCompare(e.getName(a)||"")}))}}d()};WH.Wow.Quest=new function(){const e=WH.getPageData("wow.quest.categoryNames")||{};const t=WH.getPageData("wow.quest.types")||{};this.getCategoryName=function(t){return e[t]};this.getQuestClass=function(e,t){if(t){return`quest-${t}-${e}`}return null};this.getTypeName=function(e){return t[e]||null};this.roundQuestXp=function(e){if(e==undefined){return e}let t=e<1e3?10:50;return Math.round(e/t)*t}};WH.Wow.Race=new function(){const e=this;const t=WH.Wow.Expansion;const a=WH.Game;const i=WH.Wow.Gender;const n=WH.Wow;this.ID_BLOOD_ELF=10;this.ID_BROKEN=14;this.ID_DARK_IRON_DWARF=34;this.ID_DRACTHYR_ALLIANCE=52;this.ID_DRACTHYR_HORDE=70;this.ID_DRACTHYR_VISAGE_ALLIANCE=75;this.ID_DRACTHYR_VISAGE_HORDE=76;this.ID_DRAENEI=11;this.ID_DWARF=3;this.ID_EARTHEN_ALLIANCE=85;this.ID_EARTHEN_HORDE=84;this.ID_FEL_ORC=12;this.ID_FOREST_TROLL=18;this.ID_GNOME=7;this.ID_GOBLIN=9;this.ID_HARANIR_ALLIANCE=86;this.ID_HARANIR_HORDE=91;this.ID_HIGHMOUNTAIN_TAUREN=28;this.ID_HUMAN=1;this.ID_ICE_TROLL=21;this.ID_KUL_TIRAN=32;this.ID_LIGHTFORGED_DRAENEI=30;this.ID_MAGHAR_ORC=36;this.ID_MECHAGNOME=37;this.ID_NIGHT_ELF=4;this.ID_NIGHTBORNE=27;this.ID_NORTHREND_SKELETON=20;this.ID_ORC=2;this.ID_PANDAREN_ALLIANCE=25;this.ID_PANDAREN_HORDE=26;this.ID_PANDAREN_NEUTRAL=24;this.ID_SKELETON=15;this.ID_TAUNKA=19;this.ID_TAUREN=6;this.ID_THIN_HUMAN=33;this.ID_TROLL=8;this.ID_TUSKARR=17;this.ID_UNDEAD=5;this.ID_VOID_ELF=29;this.ID_VRYKUL=16;this.ID_VULPERA=35;this.ID_WORGEN=22;this.ID_ZANDALARI_TROLL=31;const s=WH.getPageData("wow.race.files")||{};const r=WH.getPageData("wow.race.masks")||{};const o={[this.ID_BROKEN]:i.Male,[this.ID_FEL_ORC]:i.Male,[this.ID_FOREST_TROLL]:i.Male,[this.ID_ICE_TROLL]:i.Male,[this.ID_NORTHREND_SKELETON]:i.Male,[this.ID_SKELETON]:i.Male,[this.ID_TAUNKA]:i.Male,[this.ID_THIN_HUMAN]:i.Male,[this.ID_TUSKARR]:i.Male,[this.ID_VRYKUL]:i.Male};const l=1101;const c=690;const u=l|c;const d=WH.getPageData("wow.race.names");const f=WH.getPageData("wow.race.ids");const h=[e.ID_DARK_IRON_DWARF,e.ID_DRACTHYR_ALLIANCE,e.ID_DRACTHYR_VISAGE_ALLIANCE,e.ID_DRAENEI,e.ID_DWARF,e.ID_EARTHEN_ALLIANCE,e.ID_GNOME,e.ID_HARANIR_ALLIANCE,e.ID_HUMAN,e.ID_KUL_TIRAN,e.ID_LIGHTFORGED_DRAENEI,e.ID_MECHAGNOME,e.ID_NIGHT_ELF,e.ID_PANDAREN_ALLIANCE,e.ID_VOID_ELF,e.ID_WORGEN];const p=[e.ID_BLOOD_ELF,e.ID_DRACTHYR_HORDE,e.ID_DRACTHYR_VISAGE_HORDE,e.ID_EARTHEN_HORDE,e.ID_GOBLIN,e.ID_HARANIR_HORDE,e.ID_HIGHMOUNTAIN_TAUREN,e.ID_MAGHAR_ORC,e.ID_NIGHTBORNE,e.ID_ORC,e.ID_PANDAREN_HORDE,e.ID_TAUREN,e.ID_TROLL,e.ID_UNDEAD,e.ID_VULPERA,e.ID_ZANDALARI_TROLL];let m={[t.CLASSIC]:{[this.ID_DWARF]:"dwarf",[this.ID_GNOME]:"gnome",[this.ID_HUMAN]:"human",[this.ID_NIGHT_ELF]:"night-elf",[this.ID_ORC]:"orc",[this.ID_TAUREN]:"tauren",[this.ID_TROLL]:"troll",[this.ID_UNDEAD]:"undead"},[t.TBC]:{[this.ID_BLOOD_ELF]:"blood-elf",[this.ID_DRAENEI]:"draenei"},[t.CATA]:{[this.ID_GOBLIN]:"goblin",[this.ID_WORGEN]:"worgen"},[t.MOP]:{[this.ID_PANDAREN_ALLIANCE]:"alliance-pandaren",[this.ID_PANDAREN_HORDE]:"horde-pandaren",[this.ID_PANDAREN_NEUTRAL]:"pandaren"},[t.LEGION]:{[this.ID_HIGHMOUNTAIN_TAUREN]:"highmountain-tauren",[this.ID_LIGHTFORGED_DRAENEI]:"lightforged-draenei",[this.ID_NIGHTBORNE]:"nightborne",[this.ID_VOID_ELF]:"void-elf"},[t.BFA]:{[this.ID_DARK_IRON_DWARF]:"dark-iron-dwarf",[this.ID_KUL_TIRAN]:"kul-tiran",[this.ID_MAGHAR_ORC]:"maghar-orc",[this.ID_MECHAGNOME]:"mechagnome",[this.ID_VULPERA]:"vulpera",[this.ID_ZANDALARI_TROLL]:"zandalari-troll"},[t.DF]:{[this.ID_DRACTHYR_ALLIANCE]:"alliance-dracthyr",[this.ID_DRACTHYR_HORDE]:"horde-dracthyr"},[t.TWW]:{[this.ID_EARTHEN_ALLIANCE]:"alliance-earthen",[this.ID_EARTHEN_HORDE]:"horde-earthen"},[t.MN]:{[this.ID_HARANIR_ALLIANCE]:"alliance-haranir",[this.ID_HARANIR_HORDE]:"horde-haranir"}};const H={localeSortedIds:undefined,localeSortedIdsAll:undefined,slugsByEnvCache:{}};this.exists=function(e,t){t=t||a.getEnv(a.WOW);if(!f){return g(t)[e]!==undefined}return f[t].includes(e)};this.getAll=function(){let e=[];let t=g();for(let a in t){if(t.hasOwnProperty(a)){e.push(parseInt(a))}}return e};this.getFileName=function(e){return s[e]};this.getGenders=function(e){return o.hasOwnProperty(e)?[o[e]]:[i.Male,i.Female]};this.getIcon=function(t,a){if(!e.isPlayableRace(t)){return undefined}let n=e.getFileName(t);if(!n){return undefined}a=a||i.Male;a=e.validateGender(t,a);return"race_"+n+"_"+a.getFilename()};this.getIdFromSlug=function(e){let t=g();for(var a in t){if(!t.hasOwnProperty(a)){continue}if(t[a]===e){return parseInt(a)}}return undefined};this.getIdsFromMask=function(t){let a=[];if(t<0){WH.error("Race mask expected to be non-negative.",t);return a}let i=4294967295;if(t>i){if(window.BigInt){a=a.concat(Object.keys(r).filter((e=>r[e]>i&&BigInt(r[e])&BigInt(t))).map((e=>parseInt(e))))}else{WH.warn("Unable to check bits above 32 on large mask.",t)}t=t&i}a=a.concat(Object.keys(r).filter((e=>r[e]&t)).map((e=>parseInt(e))));return a.sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getName=function(t){return e.getNames()[t]};this.getNames=()=>d;this.getPlayableRaceIds=function(t){var a=t?"localeSortedIdsAll":"localeSortedIds";if(H[a]){return H[a]}var i=[];let n=g();for(var s in n){if(n.hasOwnProperty(s)&&(t===true||s!=e.ID_PANDAREN_ALLIANCE&&s!=e.ID_PANDAREN_HORDE)){i.push(parseInt(s))}}i.sort((function(t,a){return WH.stringCompare(e.getName(t),e.getName(a))}));H[a]=i;return i};this.getRequiredGender=function(e){return o[e]};this.getSide=function(e){if((e&u)===l){return n.SIDE_ALLIANCE}else if((e&u)===c){return n.SIDE_HORDE}return undefined};this.getSideByRaceId=function(e){if(h.includes(e)){return n.SIDE_ALLIANCE}if(p.includes(e)){return n.SIDE_HORDE}};this.getSlug=function(e){return g()[e]};this.getUnique=function(){return e.getAll().filter((function(t){return![e.ID_PANDAREN_ALLIANCE,e.ID_PANDAREN_HORDE].includes(t)}))};this.isPlayableRace=function(t){return e.getSlug(t)!==undefined};this.validateGender=function(t,a){let i=e.getGenders(t);if(i.includes(a)){return a}return i[Math.floor(Math.random()*i.length)]};function g(e){e=e||a.getEnv(a.WOW);if(!H.slugsByEnvCache[e]){H.slugsByEnvCache[e]={};let a=t.get(e);for(let t=0;t<=a;t++){let a=m[t];if(!a){continue}Object.entries(a).forEach((([t,a])=>H.slugsByEnvCache[e][t]=a))}}return H.slugsByEnvCache[e]}};WH.Wow.Realm=new function(){const e={callbacks:[],dataRequested:false};this.fetchData=function(a){if(window["g_bnet_realms"]){window.requestAnimationFrame(a);return}if(e.dataRequested){e.callbacks.push(a);return}let i=WH.ajaxIshRequest(WH.Url.getDataPageUrl("realms"));if(i){WH.aE(i,"load",t);if(a){e.callbacks.push(a)}}e.dataRequested=true};this.getAll=function(){return window["g_bnet_realms"]||null};this.getSlugByName=function(e,t){var a=this.getAll();if(!a){return null}a=a[e.toUpperCase()];if(!a){return null}var i="name_"+Locale.getName();t=t.toLocaleLowerCase();for(var n in a){if(!a.hasOwnProperty(n)){continue}var s=a[n];if(s.name.toLocaleLowerCase()===t){return s.slug}if(s[i]&&s[i].toLocaleLowerCase()===t){return s.slug}}return null};function t(){if(!window["g_bnet_realms"]){WH.error("The realm data failed to load.");return}while(e.callbacks.length){var t=e.callbacks.shift();try{t()}catch(e){WH.error("Realm data loading callback error:",e)}}}};WH.Wow.Season=new function(){const e=this;const t=WH.LocalStorage;this.SEASON_ALL=-1;this.PHASE_ALL=-1;this.SEASON_CLASSIC_20TH_ANNIVERSARY=11;this.SEASON_RETAIL_LEGION_REMIX=16711680;this.NO_SEASON=0;this.NO_PHASE=0;this.MAX_LEVEL_BY_PHASE={[WH.dataEnv.CLASSIC]:{1:25,2:40,3:50,4:60}};this.MAX_LEVEL_BY_PHASE[WH.dataEnv.CLASSICPTR]=this.MAX_LEVEL_BY_PHASE[WH.dataEnv.CLASSSIC];this.getCurrentSeason=e=>({[WH.dataEnv.CLASSIC]:2,[WH.dataEnv.CLASSICPTR]:2}[e??WH.getDataEnv()]);this.getCurrentPhase=e=>WH.PageMeta.dataEnv.phases?.[e??WH.getDataEnv()];this.getPreferredSeason=()=>{let i=t.get(t.KEY_PREFERRED_SEASON);return a(i)?i:e.getCurrentSeason()};this.getSeasonName=function(e,t){return{[WH.dataTree.CLASSIC]:{[0]:WH.term("wowClassic")+WH.TERMS.hyphen_punct+WH.term("classicEra"),[1]:WH.TERMS.seasonOfMastery,[2]:WH.TERMS.seasonOfDiscovery,[11]:WH.term("wowClassic")+WH.TERMS.hyphen_punct+WH.term("anniversary")},[WH.dataTree.RETAIL]:{[0]:WH.TERMS.retailWow,[this.SEASON_RETAIL_LEGION_REMIX]:WH.term("remix_format",WH.TERMS.legion_expansion)}}[WH.getDataTree(t)]?.[e]??null};this.getSeasonAbbrevName=function(e,t){return{[WH.dataTree.CLASSIC]:{[0]:WH.term("wowClassic"),[1]:WH.TERMS.seasonOfMastery_abbrev,[2]:WH.TERMS.seasonOfDiscovery_abbrev,[11]:WH.term("anniversary")},[WH.dataTree.RETAIL]:{[0]:WH.TERMS.retailWow,[this.SEASON_RETAIL_LEGION_REMIX]:WH.term("remix_format",WH.TERMS.legion_abbrev)}}[WH.getDataTree(t)]?.[e]??null};this.setPreferredSeason=e=>{if(a(e)){t.set(t.KEY_PREFERRED_SEASON,e)}};function a(t){return!!(typeof t==="number"&&(t===e.SEASON_ALL||e.getSeasonName(t)))}};WH.Wow.Skill=new function(){this.CATEGORY_TALENTS=-2;this.CATEGORY_PROFICIENCIES=-11;this.CATEGORY_SPECIALIZATION=-12;this.CATEGORY_GLYPHS=-13;this.CATEGORY_PVP_TALENTS=-16;this.ID_DEFENSE=95;this.ID_RIDING=762;this.ID_AXES=44;this.ID_BOWS=45;this.ID_CROSSBOWS=226;this.ID_DAGGERS=173;this.ID_FIST_WEAPONS=473;this.ID_GUNS=46;this.ID_MACES=54;this.ID_POLEARMS=229;this.ID_STAVES=136;this.ID_SWORDS=43;this.ID_THROWN=176;this.ID_TWO_HANDED_AXES=172;this.ID_TWO_HANDED_MACES=160;this.ID_TWO_HANDED_SWORDS=55;this.ID_UNARMED=162;this.ID_WANDS=228;const e=WH.getPageData("wow.skill.categoryNames")||{};const t=WH.getPageData("wow.skill.categoryNames.singular")||{};const a=WH.getPageData("wow.skill.names")||{};this.getCategoryName=function(a,i=false){return(i?t[a]:null)||e[a]||null};this.getCategoryNames=()=>({...e});this.getName=function(e){return a[e]||null};this.getSpecializationName=e=>WH.getPageData("wow.skill.specializationNames")[e]};WH.Wow.Spell=new function(){const e=this;this.AURA_EFFECT_MOD_DAMAGE_DONE=13;this.AURA_EFFECT_MOD_RESISTANCE=22;this.AURA_EFFECT_MOD_STAT=29;this.AURA_EFFECT_MOD_SKILL_TEMPORARY=30;this.AURA_EFFECT_INCREASE_MAX_HEALTH_FLAT=34;this.AURA_EFFECT_MOD_PARRY_PCT=47;this.AURA_EFFECT_MOD_DODGE_PCT=49;this.AURA_EFFECT_MOD_BLOCK_PCT=51;this.AURA_EFFECT_MOD_MELEE_RANGED_CRIT_PCT=52;this.AURA_EFFECT_MOD_MELEE_RANGED_HIT_CHANCE_PCT=54;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT=55;this.AURA_EFFECT_MOD_SPELL_CRIT_PCT=57;this.AURA_EFFECT_MOD_SPELL_HASTE_PCT=65;this.AURA_EFFECT_MOD_SPELL_CRIT_PCT2=71;this.AURA_EFFECT_MOD_DAMAGE_DONE_PCT=79;this.AURA_EFFECT_POWER_REGEN=85;this.AURA_EFFECT_MOD_SKILL=98;this.AURA_EFFECT_MOD_MELEE_ATTACK_POWER=99;this.AURA_EFFECT_ADD_MODIFIER_FLAT=107;this.AURA_EFFECT_REDUCE_TARGET_RESISTANCES_FLAT=123;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER=124;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_POWER_PCT=132;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_HEALTH_PCT=133;this.AURA_EFFECT_ALLOW_PCT_OF_MANA_REGENERATION_TO_CONTINUE_IN_COMBAT=134;this.AURA_EFFECT_MOD_HEALING_POWER=135;this.AURA_EFFECT_MOD_HEALING_POWER_PCT=136;this.AURA_EFFECT_MOD_STAT_PCT2=137;this.AURA_EFFECT_MOD_MELEE_ATTACK_SPEED_PCT=138;this.AURA_EFFECT_MOD_RANGED_ATTACK_SPEED_PCT=140;this.AURA_EFFECT_MOD_BASE_RESISTANCE_PCT=142;this.AURA_EFFECT_MOD_RESISTACE_FLAT_DOES_NOT_STACK=143;this.AURA_EFFECT_MOD_BLOCK_VALUE_PCT=150;this.AURA_EFFECT_REGEN_HEALTH_WORKS_IN_COMBAT=161;this.AURA_EFFECT_MOD_MELEE_ATTACK_POWER_PCT=166;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER_PCT=167;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_STAT=174;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_STAT=175;this.AURA_EFFECT_MOD_RESISTANCE_BY_PCT_OF_STAT=182;this.AURA_EFFECT_MOD_ATTACKER_MELEE_HIT_CHANCE_PCT=184;this.AURA_EFFECT_MOD_ATTACKER_RANGED_HIT_CHANCE_PCT=185;this.AURA_EFFECT_MOD_ATTACKER_MELEE_CRIT_CHANCE_PCT=187;this.AURA_EFFECT_MOD_ATTACKER_RANGED_CRIT_CHANCE_PCT=188;this.AURA_EFFECT_MOD_RATING=189;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT2=199;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER_BY_PCT_OF_STAT=212;this.AURA_EFFECT_ADD_MODIFIER_FLAT_LABEL=219;this.AURA_EFFECT_MOD_MAX_HEALTH=230;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_ATTACK_POWER=237;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_ATTACK_POWER=238;this.AURA_EFFECT_MOD_EXPERTISE=240;this.AURA_EFFECT_MOD_ATTACK_POWER_FOR_EVERY_SCHOOL_RESISTANCE_POINT=285;this.AURA_EFFECT_MOD_CRIT_CHANCE_PCT_ALL=290;this.AURA_EFFECT_MOD_MELEE_ATTACK_SPEED=319;this.AURA_EFFECT_MOD_ATTACKSPEED_2=342;this.AURA_EFFECT_MOD_BLOCK_VALUE_PCT_2=561;this.AURA_EFFECT_MOD_COMBAT_RATING_BY_STAT_PCT=583;this.AURA_607=607;this.AURA_EFFECT_MOD_RANGED_ATTACK_SPEED_PCT_2=615;this.FLAGS4_REQUIRES_OFFHAND_WEAPON=16777216;this.ID_EXOTIC_BEASTS=53270;this.OPTIONAL_REAGENT_ICON_PATH="/images/wow/interface/GuildFrame/communities-icon-addgroupplus.png";const t=6;const a=2;const i=4;const n=1;const s=3;const r=0;const o=5;const l={[t]:WH.TERMS.arcane,[a]:WH.TERMS.fire,[i]:WH.TERMS.frost,[n]:WH.TERMS.holy,[s]:WH.TERMS.nature,[r]:WH.TERMS.physical,[o]:WH.TERMS.shadow};const c=1;const u=2;const d=4;const f=[15,25,30,35,40,45,50];this.get=function(e){return WH.Gatherer.get(WH.Types.SPELL,e)||null};this.getName=function(e){return WH.Gatherer.getName(WH.Types.SPELL,e)};this.getProficiencyFilterSelectFromFlags=function(e){if(e&c){return 1}if(e&u){return 2}if(e&d){return 5}};this.getProficiencyNameFromFlags=function(e){if(e&c){return WH.TERMS.weapons}if(e&u){return WH.TERMS.armor}if(e&d){return WH.TERMS.languages}};this.getProjectBranchName=function(e){return this.getProjectBranchNames()[e]||WH.TERMS.unknown};this.getProjectBranchNames=function(){return WH.getPageData("wow.spell.projectBranches")};this.getSchoolName=function(e){return l[e]};this.getTalentLevels=function(){return f}};WH.Wow.Title=new function(){this.getCategoryName=e=>WH.getPageData("wow.title.categoryNames")[e]};WH.Wow.TransmogSet=new function(){const e=WH.User.Completion;this.getCompletionAmount=function(t,a){if(!t||!(a in e.getWardrobe())){return null}let i=e.getWardrobe()[a]||[];let n=Object.keys(t);if(n.length===0){return 0}let s=0;n.forEach((function(e){let a=t[e];for(let t=0;t<a.length;t++){if(i.includes(e+"|"+a[t])){s++;return}}}));return s/n.length};this.getThumbUrl=function(e,t,a,i){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(i)+"/webthumbs/transmog/"+t+"/"+a+"/"+(e&255)+"/"+e+WH.WebP.getImageExtension()};this.getStyleFromNote=e=>{const t=WH.getPageData("wow.transmogSet.styleToNotes");let a=Object.keys(t).find((a=>t[a].includes(e)));if(a!=null){a=parseInt(a)}return a};this.getStyleName=e=>WH.getPageData("wow.transmogSet.styleNames")[e]};WH.Wow.UiMap=new function(){const e=this;this.clickToCopyCoordinates=function(e,t,i){i=i||{};let n=typeof t==="function"?t:function(){return t};e.style.cursor="pointer";WH.Tooltips.attach(e,(()=>{let e=WH.ce("div",undefined,WH.ct(n().join(WH.TERMS.comma_punct)));WH.ae(e,WH.ce("div",{className:"q2",style:{marginTop:"10px"}},WH.ct(WH.TERMS.clickToCopy)));return e.innerHTML}),"q",{noWrap:true,stopPropagation:true});WH.aE(e,"click",a.bind(e,n,i))};this.generateInGamePinLinkCommand=function(e,t,a,i){let n;if(i){n="\\124A:Waypoint-MapPin-ChatIcon:13:13:0:0\\124a "+WH.term("mapPin_format",i).replace(/:+$/,"").replace(/"/g,'\\"')}else{n=WH.GlobalStrings.MAP_PIN_HYPERLINK.replace(/\|/g,"\\124")}return'/script DEFAULT_CHAT_FRAME:AddMessage("'+"\\124cffffff00\\124Hworldmap:"+e+":"+t+":"+a+"\\124h["+n+"]\\124h\\124r"+'");'};this.generateTomTomCommand=function(e,t){let a=t.uiMapId?" #"+t.uiMapId:t.uiMapName?" "+t.uiMapName:"";let i="/way"+a+" "+e[0]+" "+e[1];if(t.name&&t.name!==t.uiMapName){i+=" "+t.name}return i};function t(e,t){return{x:parseFloat(e[0])*100,y:parseFloat(e[1])*100,name:t.name&&t.uiMapName?WH.term("parens_format",t.name,t.uiMapName):t.name||t.uiMapName}}function a(a,i){let n=a();let s=i.getAllCoords?i.getAllCoords():null;if(s&&s.length<=1){s=null}let r=i.getAllInGameMapPins?i.getAllInGameMapPins():null;if(r&&r.length<=1){r=null}let o=i.getAllTomTomCommands?i.getAllTomTomCommands():null;if(o&&o.length<=1){o=null}let l=[Menu.createHeading({label:WH.TERMS.copy_clipboard})];let c=s||o?[Menu.createHeading({label:WH.TERMS.copyAll})]:null;l.push(Menu.createItem({label:WH.TERMS.coordinates,url:function(e){WH.copyToClipboard(n.join(" "),e)}}));if(s){c.push(Menu.createItem({label:WH.TERMS.coordinates,url:function(e){let t=[];s.forEach((function(e){t.push(e.join(" "))}));WH.copyToClipboard(t.join("\n"),e)}}))}if(i.uiMapId){l.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(a){let s=t(n,i);let r=e.generateInGamePinLinkCommand(i.uiMapId,s.x,s.y,s.name);WH.copyToClipboard(r,a)}}));if(r){c.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(e){WH.copyToClipboard(r.join("\n"),e)}}))}else if(s){c.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(a){let n=[];s.forEach((function(a){let s=t(a,i);n.push(e.generateInGamePinLinkCommand(i.uiMapId,s.x,s.y,s.name))}));WH.copyToClipboard(n.join("\n"),a)}}))}}if(i.includeTomTom||i.uiMapId||i.uiMapName){l.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(t){WH.copyToClipboard(e.generateTomTomCommand(n,i),t)}}));if(o){c.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(e){WH.copyToClipboard(o.join("\n"),e)}}))}else if(s){c.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(t){let a=[];s.forEach((function(t){a.push(e.generateTomTomCommand(t,i))}));WH.copyToClipboard(a.join("\n"),t)}}))}}let u=c?l.concat(c):l;if(u.length===2){u[1][Menu.ITEM_URL]();return}Menu.show(u,this)}};WH.Wow.WorldObject=new function(){this.getType=e=>WH.getPageData("wow.worldObject.types")[e]};WH.Wow.Item.Gems=new function(){const e=this;this.MASK_META=1;this.MASK_RED=2;this.MASK_YELLOW=4;this.MASK_BLUE=8;this.MASK_ORANGE=this.MASK_RED|this.MASK_YELLOW;this.MASK_PURPLE=this.MASK_RED|this.MASK_BLUE;this.MASK_GREEN=this.MASK_YELLOW|this.MASK_BLUE;this.MASK_PRISMATIC=this.MASK_RED|this.MASK_YELLOW|this.MASK_BLUE;this.SOCKET_META=1;this.SOCKET_RED=2;this.SOCKET_YELLOW=3;this.SOCKET_BLUE=4;this.SOCKET_SHA_TOUCHED=5;this.SOCKET_COGWHEEL=6;this.SOCKET_PRISMATIC=7;this.SOCKET_RELIC_IRON=8;this.SOCKET_RELIC_BLOOD=9;this.SOCKET_RELIC_SHADOW=10;this.SOCKET_RELIC_FEL=11;this.SOCKET_RELIC_ARCANE=12;this.SOCKET_RELIC_FROST=13;this.SOCKET_RELIC_FIRE=14;this.SOCKET_RELIC_WATER=15;this.SOCKET_RELIC_LIFE=16;this.SOCKET_RELIC_STORM=17;this.SOCKET_RELIC_HOLY=18;this.SOCKET_PUNCHCARD_RED=19;this.SOCKET_PUNCHCARD_YELLOW=20;this.SOCKET_PUNCHCARD_BLUE=21;this.SOCKET_DOMINATION=22;this.SOCKET_CRYSTALLIC=23;this.SOCKET_TINKER=24;this.SOCKET_PRIMORDIAL=25;const t=[];const a={};a[this.MASK_META]="meta";a[this.MASK_RED]="red";a[this.MASK_YELLOW]="yellow";a[this.MASK_ORANGE]="orange";a[this.MASK_BLUE]="blue";a[this.MASK_PURPLE]="purple";a[this.MASK_GREEN]="green";a[this.MASK_PRISMATIC]="prismatic";const i={};i[this.SOCKET_META]=this.MASK_META;i[this.SOCKET_RED]=this.MASK_RED;i[this.SOCKET_YELLOW]=this.MASK_YELLOW;i[this.SOCKET_BLUE]=this.MASK_BLUE;i[this.SOCKET_PRISMATIC]=this.MASK_PRISMATIC;const n={[e.SOCKET_META]:"meta",[e.SOCKET_RED]:"red",[e.SOCKET_YELLOW]:"yellow",[e.SOCKET_BLUE]:"blue",[e.SOCKET_PRISMATIC]:"prismatic",[e.SOCKET_COGWHEEL]:"cogwheel",[e.SOCKET_DOMINATION]:"domination",[e.SOCKET_SHA_TOUCHED]:"hydraulic",[e.SOCKET_PRIMORDIAL]:"primordial",[e.SOCKET_TINKER]:"tinker",[e.SOCKET_RELIC_BLOOD]:"relic-blood",[e.SOCKET_RELIC_ARCANE]:"relic-arcane",[e.SOCKET_RELIC_FEL]:"relic-fel",[e.SOCKET_RELIC_IRON]:"relic-iron",[e.SOCKET_RELIC_SHADOW]:"relic-shadow",[e.SOCKET_RELIC_FROST]:"relic-frost",[e.SOCKET_RELIC_FIRE]:"relic-fire",[e.SOCKET_RELIC_WATER]:"relic-water",[e.SOCKET_RELIC_LIFE]:"relic-life",[e.SOCKET_RELIC_STORM]:"relic-storm",[e.SOCKET_RELIC_HOLY]:"relic-holy"};this.getGemMaskFromType=function(e){return i[e]};this.getGemMaskString=function(e){return a[e]};this.getGemColorName=function(e){return s()[e]};this.getGemColors=function(){if(WH.isClassicTree()){return[]}if(!t.length){let a=[e.MASK_META,e.MASK_RED,e.MASK_ORANGE,e.MASK_YELLOW,e.MASK_GREEN,e.MASK_BLUE,e.MASK_PURPLE,e.MASK_PRISMATIC];let i=Object.keys(s());i.sort((function(t,i){t=parseInt(t);i=parseInt(i);let n=a.indexOf(t);let s=a.indexOf(i);if(n<0){if(s<0){return e.getGemColorName(t).localeCompare(e.getGemColorName(i))}return 1}else{if(s<0){return-1}return n-s}}));i.forEach((function(a){let i=parseInt(a);t.push({id:i,name:e.getGemColorName(i)})}))}return JSON.parse(JSON.stringify(t))};this.getSocketName=e=>WH.getPageData("wow.item.gems.socketNames")[e];this.getSocketTypeName=function(e){return WH.getPageData("wow.item.gems.typeNames")[e]};this.getSocketTypeString=t=>n[t]??n[e.SOCKET_PRISMATIC];function s(){return WH.getPageData("wow.item.gems.colorNames")}};WH.Wow.Item.Stat=new function(){const e=this;this.ID_MANA=0;this.ID_HEALTH=1;this.ID_ENDURANCE=2;this.ID_AGILITY=3;this.ID_STRENGTH=4;this.ID_INTELLECT=5;this.ID_SPIRIT=6;this.ID_STAMINA=7;this.ID_ENERGY=8;this.ID_RAGE=9;this.ID_FOCUS=10;this.ID_WEAPON_SKILL_RATING=11;this.ID_DEFENSE_SKILL_RATING=12;this.ID_DODGE_RATING=13;this.ID_PARRY_RATING=14;this.ID_BLOCK_RATING=15;this.ID_HIT_MELEE_RATING=16;this.ID_HIT_RANGED_RATING=17;this.ID_HIT_SPELL_RATING=18;this.ID_CRIT_MELEE_RATING=19;this.ID_CRIT_RANGED_RATING=20;this.ID_CRIT_SPELL_RATING=21;this.ID_CORRUPTION_RESISTANCE=23;this.ID_CRAFTING_STAT_1=24;this.ID_CRAFTING_STAT_2=25;this.ID_HASTE_MELEE_RATING=28;this.ID_HASTE_RANGED_RATING=29;this.ID_HASTE_SPELL_RATING=30;this.ID_HIT_RATING=31;this.ID_CRIT_RATING=32;this.ID_RESILIENCE_RATING=35;this.ID_HASTE_RATING=36;this.ID_EXPERTISE_RATING=37;this.ID_ATTACK_POWER=38;this.ID_RANGED_ATTACK_POWER=39;this.ID_VERSATILITY_RATING=40;this.ID_SPELL_HEALING_DONE=41;this.ID_SPELL_DAMAGE_DONE=42;this.ID_MANA_REGENERATION=43;this.ID_ARMOR_PENETRATION_RATING=44;this.ID_SPELL_POWER=45;this.ID_HEALTH_REGENERATION=46;this.ID_SPELL_PENETRATION=47;this.ID_BLOCK_VALUE=48;this.ID_MASTERY_RATING=49;this.ID_ARMOR=50;this.ID_FIRE_RESISTANCE=51;this.ID_FROST_RESISTANCE=52;this.ID_HOLY_RESISTANCE=53;this.ID_SHADOW_RESISTANCE=54;this.ID_NATURE_RESISTANCE=55;this.ID_ARCANE_RESISTANCE=56;this.ID_PVP_POWER_RATING=57;this.ID_SPEED_RATING=61;this.ID_LEECH_RATING=62;this.ID_AVOIDANCE_RATING=63;this.ID_AGI_STR_INT=71;this.ID_AGI_STR=72;this.ID_AGI_INT=73;this.ID_STR_INT=74;this.CRAFTING_STAT_FROM=[this.ID_CRAFTING_STAT_1,this.ID_CRAFTING_STAT_2];this.CRAFTING_STAT_TO=[this.ID_CRIT_RATING,this.ID_HASTE_RATING,this.ID_VERSATILITY_RATING,this.ID_MASTERY_RATING,this.ID_SPEED_RATING,this.ID_LEECH_RATING,this.ID_AVOIDANCE_RATING];const t={agi:WH.TERMS.agility_abbrev,amplify:WH.TERMS.amplify_abbrev,arcres:WH.TERMS.arcaneresist_abbrev,arcsplpwr:WH.TERMS.arcanepower_abbrev,armor:WH.TERMS.armor,armorbonus:WH.TERMS.additionalarmor_abbrev,armorpenrtng:WH.TERMS.penetration_abbrev,atkpwr:WH.TERMS.attackpower_abbrev,avoidance:WH.TERMS.avoidance_abbrev,block:WH.TERMS.blockvalue_abbrev,blockrtng:WH.TERMS.block,cleave:WH.TERMS.cleave_abbrev,corruption:WH.TERMS.corruption_abbrev,corruptionres:WH.TERMS.corruptionResistance_abbrev,critstrkrtng:WH.TERMS.crit,defrtng:WH.TERMS.defense_abbrev,dmg:WH.TERMS.damage_abbrev,dmgmax1:WH.TERMS.maximum_abbrev,dmgmin1:WH.TERMS.minimum_abbrev,dodgertng:WH.TERMS.dodge,dps:WH.TERMS.dps,exprtng:WH.TERMS.expertise_abbrev,firres:WH.TERMS.fireresist_abbrev,firsplpwr:WH.TERMS.firepower_abbrev,frores:WH.TERMS.frostresist_abbrev,frosplpwr:WH.TERMS.frostpower_abbrev,hastertng:WH.TERMS.haste,health:WH.TERMS.health_abbrev,healthrgn:WH.TERMS.healthregen_abbrev,hitrtng:WH.TERMS.hit,holres:WH.TERMS.holyresist_abbrev,holsplpwr:WH.TERMS.holypower_abbrev,int:WH.TERMS.intellect_abbrev,level:WH.TERMS.level_abbrev,lifesteal:WH.TERMS.leech_abbrev,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregen_abbrev,mastrtng:WH.TERMS.mastery_abbrev,mleatkpwr:WH.TERMS.attackpower_abbrev,mlecritstrkrtng:WH.TERMS.crit,mledmgmax:WH.TERMS.maximum_abbrev,mledmgmin:WH.TERMS.minimum_abbrev,mledps:WH.TERMS.dps,mlehastertng:WH.TERMS.haste,mlehitrtng:WH.TERMS.hit,mlespeed:WH.TERMS.speed,multistrike:WH.TERMS.multistrike_abbrev,natres:WH.TERMS.natureresist_abbrev,natsplpwr:WH.TERMS.naturepower_abbrev,nsockets:WH.TERMS.socket_abbrev,parryrtng:WH.TERMS.parry,pvppower:WH.TERMS.pvppower_abbrev,readiness:WH.TERMS.readiness_abbrev,reqarenartng:WH.TERMS.rating,reqlevel:WH.TERMS.level,resirtng:WH.TERMS.resilience_abbrev,rgdatkpwr:WH.TERMS.rangedap_abbrev,rgdcritstrkrtng:WH.TERMS.crit,rgddmgmax:WH.TERMS.maximum_abbrev,rgddmgmin:WH.TERMS.minimum_abbrev,rgddps:WH.TERMS.dps,rgdhastertng:WH.TERMS.haste,rgdhitrtng:WH.TERMS.hit,rgdspeed:WH.TERMS.speed,shares:WH.TERMS.shadowresist_abbrev,shasplpwr:WH.TERMS.shadowpower_abbrev,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus_abbrev,spi:WH.TERMS.spirit_abbrev,splcritstrkrtng:WH.TERMS.crit,spldmg:WH.TERMS.damage_abbrev,splhastertng:WH.TERMS.haste,splheal:WH.TERMS.heal,splhitrtng:WH.TERMS.hit,splpen:WH.TERMS.penetration_abbrev,splpwr:WH.TERMS.spellpower_abbrev,sta:WH.TERMS.stamina_abbrev,str:WH.TERMS.strength_abbrev,sturdiness:WH.TERMS.indestructible_abbrev,versatility:WH.TERMS.versatility_abbrev};const a=0;const i=1;const n=2;const s=3;const r=4;const o={};o[a]=e.ID_STRENGTH;o[i]=e.ID_AGILITY;o[n]=e.ID_STAMINA;o[s]=e.ID_INTELLECT;o[r]=e.ID_SPIRIT;const l={agi:WH.TERMS.agility,amplify:WH.TERMS.amplifyrating_stc,arcres:WH.TERMS.arcaneresistance_stc,arcsplpwr:WH.TERMS.arcanespellpower_stc,armor:WH.TERMS.armor,armorbonus:WH.TERMS.additionalarmor_stc,armorpenrtng:WH.TERMS.armorpenetrationrating_stc,atkpwr:WH.TERMS.attackpower_stc,avoidance:WH.TERMS.avoidancerating_stc,block:WH.TERMS.blockvalue_stc,blockrtng:WH.TERMS.blockrating_stc,cleave:WH.TERMS.cleaverating_stc,corruption:WH.TERMS.corruption,corruptionres:WH.TERMS.corruptionResistance_stc,critstrkrtng:WH.TERMS.criticalstrikerating_stc,defrtng:WH.TERMS.defenserating_stc,dmg:WH.TERMS.weapondamage_stc,dmgmax1:WH.TERMS.maximumdamage_stc,dmgmin1:WH.TERMS.minimumdamage_stc,dodgertng:WH.TERMS.dodgerating_stc,dps:WH.TERMS.damagepersecond_stc,exprtng:WH.TERMS.expertiserating_stc,firres:WH.TERMS.fireresistance_stc,firsplpwr:WH.TERMS.firespellpower_stc,frores:WH.TERMS.frostresistance_stc,frosplpwr:WH.TERMS.frostspellpower_stc,hastertng:WH.TERMS.hasterating_stc,health:WH.TERMS.health,healthrgn:WH.TERMS.healthregeneration_stc,hitrtng:WH.TERMS.hitrating_stc,holres:WH.TERMS.holyresistance_stc,holsplpwr:WH.TERMS.holyspellpower_stc,int:WH.TERMS.intellect,level:WH.TERMS.level,lifesteal:WH.TERMS.leechrating_stc,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregeneration_stc,mastrtng:WH.TERMS.masteryrating_stc,mleatkpwr:WH.TERMS.meleeattackpower_stc,mlecritstrkrtng:WH.TERMS.meleecriticalstrikerating_stc,mledmgmax:WH.TERMS.meleemaximumdamage_stc,mledmgmin:WH.TERMS.meleeminimumdamage_stc,mledps:WH.TERMS.meleedps,mlehastertng:WH.TERMS.meleehasterating_stc,mlehitrtng:WH.TERMS.meleehitrating_stc,mlespeed:WH.TERMS.meleespeed_stc,multistrike:WH.TERMS.multistrikerating_stc,natres:WH.TERMS.natureresistance_stc,natsplpwr:WH.TERMS.naturespellpower_stc,nsockets:WH.TERMS.numberofsockets_stc,parryrtng:WH.TERMS.parryrating_stc,pvppower:WH.TERMS.pvppower,readiness:WH.TERMS.readinessrating_stc,reqarenartng:WH.TERMS.requiredpersonalandteamarenarating_stc,reqlevel:WH.TERMS.requiredlevel_stc,resirtng:WH.TERMS.resiliencerating_stc,rgdatkpwr:WH.TERMS.rangedattackpower_stc,rgdcritstrkrtng:WH.TERMS.rangedcriticalstrikerating_stc,rgddmgmax:WH.TERMS.rangedmaximumdamage_stc,rgddmgmin:WH.TERMS.rangedminimumdamage_stc,rgddps:WH.TERMS.rangeddps,rgdhastertng:WH.TERMS.rangedhasterating_stc,rgdhitrtng:WH.TERMS.rangedhitrating_stc,rgdspeed:WH.TERMS.rangedspeed_stc,shares:WH.TERMS.shadowresistance_stc,shasplpwr:WH.TERMS.shadowspellpower_stc,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus,spi:WH.TERMS.spirit,splcritstrkrtng:WH.TERMS.spellcriticalstrikerating_stc,spldmg:WH.TERMS.damagedonebyspells_stc,splhastertng:WH.TERMS.spellhasterating_stc,splheal:WH.TERMS.healingdonebyspells_stc,splhitrtng:WH.TERMS.spellhitrating_stc,splpen:WH.TERMS.spellpenetration_stc,splpwr:WH.TERMS.spellpower_stc,sta:WH.TERMS.stamina,str:WH.TERMS.strength,sturdiness:WH.TERMS.indestructiblerating_stc,versatility:WH.TERMS.versatilityrating_stc};const c={agi:WH.TERMS.agility,amplify:WH.TERMS.amplify,arcres:WH.TERMS.arcaneresist,arcsplpwr:WH.TERMS.arcanepower,armor:WH.TERMS.armor,armorbonus:WH.TERMS.bonusarmor,armorpenrtng:WH.TERMS.armorpen,atkpwr:WH.TERMS.attackpower_abbrev,avoidance:WH.TERMS.avoidance,block:WH.TERMS.blockvalue,blockrtng:WH.TERMS.block,cleave:WH.TERMS.cleave,corruption:WH.TERMS.corruption,corruptionres:WH.TERMS.corruptionResist,critstrkrtng:WH.TERMS.crit,defrtng:WH.TERMS.defense,dmg:WH.TERMS.damage,dmgmax1:WH.TERMS.maxdamage,dmgmin1:WH.TERMS.mindamage,dodgertng:WH.TERMS.dodge,dps:WH.TERMS.dps,exprtng:WH.TERMS.expertise,firres:WH.TERMS.fireresist,firsplpwr:WH.TERMS.firepower,frores:WH.TERMS.frostresist,frosplpwr:WH.TERMS.frostpower,hastertng:WH.TERMS.haste,health:WH.TERMS.health,healthrgn:WH.TERMS.healthregen_abbrev,hitrtng:WH.TERMS.hit,holres:WH.TERMS.holyresist,holsplpwr:WH.TERMS.holypower,int:WH.TERMS.intellect,level:WH.TERMS.level,lifesteal:WH.TERMS.leech,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregen_abbrev,mastrtng:WH.TERMS.mastery,mleatkpwr:WH.TERMS.meleeap,mlecritstrkrtng:WH.TERMS.meleecrit,mledmgmax:WH.TERMS.meleemaxdamage,mledmgmin:WH.TERMS.meleemindamage,mledps:WH.TERMS.meleedps,mlehastertng:WH.TERMS.meleehaste,mlehitrtng:WH.TERMS.meleehit,mlespeed:WH.TERMS.meleespeed,multistrike:WH.TERMS.multistrike,natres:WH.TERMS.natureresist,natsplpwr:WH.TERMS.naturepower,nsockets:WH.TERMS.sockets,parryrtng:WH.TERMS.parry,pvppower:WH.TERMS.pvppower_abbrev,readiness:WH.TERMS.readiness,reqarenartng:WH.TERMS.reqrating,reqlevel:WH.TERMS.reqlevel,resirtng:WH.TERMS.resilience,rgdatkpwr:WH.TERMS.rangedap,rgdcritstrkrtng:WH.TERMS.rangedcrit,rgddmgmax:WH.TERMS.rangedmaxdamage,rgddmgmin:WH.TERMS.rangedmindamage,rgddps:WH.TERMS.rangeddps,rgdhastertng:WH.TERMS.rangedhaste,rgdhitrtng:WH.TERMS.rangedhit,rgdspeed:WH.TERMS.rangedspeed,shares:WH.TERMS.shadowresist,shasplpwr:WH.TERMS.shadowpower,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus,spi:WH.TERMS.spirit,splcritstrkrtng:WH.TERMS.spellcrit,spldmg:WH.TERMS.spelldamage,splhastertng:WH.TERMS.spellhaste,splheal:WH.TERMS.healing,splhitrtng:WH.TERMS.spellhit,splpen:WH.TERMS.spellpen,splpwr:WH.TERMS.spellpower,sta:WH.TERMS.stamina,str:WH.TERMS.strength,sturdiness:WH.TERMS.indestructible,versatility:WH.TERMS.versatility};const u=[this.ID_SPEED_RATING,this.ID_LEECH_RATING,this.ID_AVOIDANCE_RATING];this.convertBaseIndex=function(e){return o[e]};this.getTertiaryStats=function(){return u.slice()};this.jsonToAbbr=function(e){return t[e]};this.jsonToDesc=function(e){return l[e]};this.jsonToName=function(e){return c[e]}};WH.Wow.Item.Bonuses=new function(){"use strict";const e=this;const t=WH.Wow.Item;const a=WH.Wow.Item.Stat;const i=WH.Strings;this.CONTEXT_CHALLENGE_MODE=16;this.CONTEXT_DUNGEON_MYTHIC=23;this.CONTEXT_CHALLENGE_MODE_2=33;this.CONTEXT_CHALLENGE_MODE_3=34;this.CONTEXT_CHALLENGE_MODE_JACKPOT=35;this.CONTEXT_CHALLENGE_MODE_4=87;this.EFFECT_TYPE_ADJUST_ITEM_LEVEL=1;this.EFFECT_TYPE_ADJUST_STAT=2;this.EFFECT_TYPE_QUALITY=3;this.EFFECT_TYPE_TAG_DESCRIPTION=4;this.EFFECT_TYPE_NAME_SUFFIX=5;this.EFFECT_TYPE_ADD_SOCKET=6;this.EFFECT_TYPE_DISPLAY_MOD=7;this.EFFECT_TYPE_ADJUST_REQUIRED_LEVEL=8;this.EFFECT_TYPE_SCALE_HEIRLOOM=11;this.EFFECT_TYPE_SCALE_DYNAMIC_REWARD=13;this.EFFECT_TYPE_PREVIEW_LEVEL=14;this.EFFECT_TYPE_BOND=16;this.EFFECT_TYPE_APPLY_ITEM_EFFECT=23;this.EFFECT_TYPE_CRAFTING_STAT=25;this.EFFECT_TYPE_REQUIRED_LEVEL_CURVE_POINTS=27;this.EFFECT_TYPE_ITEM_BONUS_LIST_GROUP=34;this.EFFECT_TYPE_SET_ITEM_LEVEL=42;this.EFFECT_TYPE_SET_PVP_ITEM_LEVEL=43;const n=[e.CONTEXT_CHALLENGE_MODE,e.CONTEXT_CHALLENGE_MODE_2,e.CONTEXT_CHALLENGE_MODE_3,e.CONTEXT_CHALLENGE_MODE_4,e.CONTEXT_CHALLENGE_MODE_JACKPOT];this.getEffects=function(e){let t=s();let a=t[e]||[];let i=[];a.forEach((e=>{i.push({type:e[0],params:e.slice(1)})}));return i};this.getLevelAdjustmentBonus=function(e){switch(true){case e<-455:throw`Delta ${e} too low.`;case e<-450:return 9617-e;case e<-430:return 9463-e;case e<-410:return 9443-e;case e<-400:return 9066-e;case e<-100:return 3229+e;case e<=200:return 1472+e;case e<=400:return 2929+e;case e<=407:return 9054+e;case e<=410:return 9056+e;case e<=430:return 9423+e;case e<=450:return 9443+e;case e<=455:return 9467+e;case e>455:throw`Delta ${e} too high.`}};this.getName=function(n,r){n=parseInt(n);if(n===0){return WH.TERMS.normal}let o=s();if(!o){return WH.TERMS.normal}let l=[];let c=r.level;let u=false;let d=e.getEffects(n);d.sort(((e,t)=>e.type-t.type));let f="";let h="";let p="";let m="";let H="";let g="";d.forEach((s=>{switch(s.type){case e.EFFECT_TYPE_ADJUST_ITEM_LEVEL:f=WH.TERMS.itemlevel+WH.TERMS.wordspace_punct+(s.params[0]>=0?"+":"")+s.params[0];break;case e.EFFECT_TYPE_ADJUST_STAT:case e.EFFECT_TYPE_CRAFTING_STAT:let o=WH.statToJson[s.params[0]]&&a.jsonToName(WH.statToJson[s.params[0]])||"Unknown stat";if(s.params[0]===a.ID_CORRUPTION_RESISTANCE){o+=" "+s.params[1];u=true}l.push(WH.TERMS.stat+WH.TERMS.colon_punct+o);break;case e.EFFECT_TYPE_QUALITY:h=s.params[0];break;case e.EFFECT_TYPE_TAG_DESCRIPTION:p=t.getNameDescription(s.params[0])||p;break;case e.EFFECT_TYPE_NAME_SUFFIX:m=t.getNameDescription(s.params[0])||m;break;case e.EFFECT_TYPE_ADD_SOCKET:let d=s.params[1];l.push(WH.TERMS.sockets+WH.TERMS.colon_punct+s.params[0]+WH.TERMS.wordspace_punct+(WH.Wow.Item.Gems.getSocketTypeName(d)||WH.TERMS.other));break;case e.EFFECT_TYPE_ADJUST_REQUIRED_LEVEL:l.push(WH.sprintf(WH.TERMS.requireslevel_format.replace("%s","$1"),r.reqlevel+s.params[0]));break;case e.EFFECT_TYPE_SCALE_HEIRLOOM:if(r.heirloombonuses){let e="?";for(let t=0,a;a=r.heirloombonuses[t];t++){if(n===a){e=t+1;break}}l.push(WH.sprintf(WH.TERMS.heirloomupgradejs_format,e))}break;case e.EFFECT_TYPE_SCALE_DYNAMIC_REWARD:f=WH.TERMS.scaleswithlevel_stc;break;case e.EFFECT_TYPE_PREVIEW_LEVEL:f=WH.TERMS.itemlevel+WH.TERMS.colon_punct+c+"+";break;case e.EFFECT_TYPE_BOND:g=t.getBondTypeName(s.params[0]);break;case e.EFFECT_TYPE_APPLY_ITEM_EFFECT:if(s.params[0]>0){let e=WH.Tooltips.getScalingData(WH.Types.ITEM,"bonusEffects")||{};H=(e.effectSpellName||{})[s.params[0]]||""}break;case e.EFFECT_TYPE_ITEM_BONUS_LIST_GROUP:let W=WH.getPageData("wow.item.bonuses.upgrades")||{};if(W[n]){H=W[n][2]?WH.Strings.sprintf(WH.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT_STRING,W[n][2],W[n][0],W[n][1]):WH.Strings.sprintf(WH.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT,W[n][0],W[n][1])}break;case e.EFFECT_TYPE_SET_ITEM_LEVEL:f=WH.TERMS.itemlevel+WH.TERMS.colon_punct+s.params[0];break;case e.EFFECT_TYPE_SET_PVP_ITEM_LEVEL:f=i.sprintf(WH.GlobalStrings.ITEM_UPGRADE_PVP_ITEM_LEVEL_STAT_FORMAT,s.params[0]);break}}));if(u&&!f&&c){f=WH.TERMS.itemlevel+WH.TERMS.wordspace_punct+c}if(f){l.unshift(f)}if(p){l.push(WH.TERMS.description+WH.TERMS.colon_punct+p)}if(m){l.push(WH.TERMS.suffix+WH.TERMS.colon_punct+m)}if(H&&!u){l.unshift(WH.TERMS.effect+WH.TERMS.colon_punct+H)}if(h){l.push(WH.TERMS.quality_colon+t.getQualityName(h))}if(g){l.push(g)}l=l.join(" / ");return l||WH.TERMS.normal};this.getQuality=function(t){let a=s();let i;for(let n,s=0;n=t[s];s++){let t=a[n]||[];for(let a,n=0;a=t[n];n++){if(a[0]===e.EFFECT_TYPE_QUALITY){i=Math.max(i||0,a[1])}}}return i};this.isMythicPlusContext=function(e){return n.includes(e)};function s(){let e=window.g_itembonuses||{};if(!Object.keys(e).length){WH.error("Item bonus data not found.")}return e}};WH.Wow.PlayerClass.Specialization=new function(){const e=this;const t=WH.Game;const a=WH.Icon;const i=WH.Wow.PlayerClass;this.ID_DEATH_KNIGHT_BLOOD=250;this.ID_DEATH_KNIGHT_FROST=251;this.ID_DEATH_KNIGHT_UNHOLY=252;this.ID_DEMON_HUNTER_HAVOC=577;this.ID_DEMON_HUNTER_VENGEANCE=581;this.ID_DEMON_HUNTER_DEVOURER=1480;this.ID_DRUID_BALANCE=102;this.ID_DRUID_FERAL=103;this.ID_DRUID_GUARDIAN=104;this.ID_DRUID_RESTORATION=105;this.ID_EVOKER_AUGMENTATION=1473;this.ID_EVOKER_DEVASTATION=1467;this.ID_EVOKER_PRESERVATION=1468;this.ID_HUNTER_BEAST_MASTERY=253;this.ID_HUNTER_MARKSMANSHIP=254;this.ID_HUNTER_SURVIVAL=255;this.ID_MAGE_ARCANE=62;this.ID_MAGE_FIRE=63;this.ID_MAGE_FROST=64;this.ID_MONK_BREWMASTER=268;this.ID_MONK_MISTWEAVER=270;this.ID_MONK_WINDWALKER=269;this.ID_PALADIN_HOLY=65;this.ID_PALADIN_PROTECTION=66;this.ID_PALADIN_RETRIBUTION=70;this.ID_PRIEST_DISCIPLINE=256;this.ID_PRIEST_HOLY=257;this.ID_PRIEST_SHADOW=258;this.ID_ROGUE_ASSASSINATION=259;this.ID_ROGUE_OUTLAW=260;this.ID_ROGUE_SUBTLETY=261;this.ID_SHAMAN_ELEMENTAL=262;this.ID_SHAMAN_ENHANCEMENT=263;this.ID_SHAMAN_RESTORATION=264;this.ID_WARLOCK_AFFLICTION=265;this.ID_WARLOCK_DEMONOLOGY=266;this.ID_WARLOCK_DESTRUCTION=267;this.ID_WARRIOR_ARMS=71;this.ID_WARRIOR_FURY=72;this.ID_WARRIOR_PROTECTION=73;this.ID_CLASSIC_DEATH_KNIGHT_BLOOD=398;this.ID_CLASSIC_DEATH_KNIGHT_FROST=399;this.ID_CLASSIC_DEATH_KNIGHT_UNHOLY=400;this.ID_CLASSIC_DRUID_BALANCE=283;this.ID_CLASSIC_DRUID_FERAL_COMBAT=281;this.ID_CLASSIC_DRUID_RESTORATION=282;this.ID_CLASSIC_HUNTER_BEAST_MASTERY=361;this.ID_CLASSIC_HUNTER_MARKSMANSHIP=363;this.ID_CLASSIC_HUNTER_SURVIVAL=362;this.ID_CLASSIC_MAGE_ARCANE=81;this.ID_CLASSIC_MAGE_FIRE=41;this.ID_CLASSIC_MAGE_FROST=61;this.ID_CLASSIC_PALADIN_HOLY=382;this.ID_CLASSIC_PALADIN_PROTECTION=383;this.ID_CLASSIC_PALADIN_RETRIBUTION=381;this.ID_CLASSIC_PRIEST_DISCIPLINE=201;this.ID_CLASSIC_PRIEST_HOLY=202;this.ID_CLASSIC_PRIEST_SHADOW=203;this.ID_CLASSIC_ROGUE_ASSASSINATION=182;this.ID_CLASSIC_ROGUE_COMBAT=181;this.ID_CLASSIC_ROGUE_SUBTLETY=183;this.ID_CLASSIC_SHAMAN_ELEMENTAL=261;this.ID_CLASSIC_SHAMAN_ENHANCEMENT=263;this.ID_CLASSIC_SHAMAN_RESTORATION=262;this.ID_CLASSIC_WARLOCK_AFFLICTION=302;this.ID_CLASSIC_WARLOCK_DEMONOLOGY=303;this.ID_CLASSIC_WARLOCK_DESTRUCTION=301;this.ID_CLASSIC_WARRIOR_ARMS=161;this.ID_CLASSIC_WARRIOR_FURY=164;this.ID_CLASSIC_WARRIOR_PROTECTION=163;this.ID_CATA_DEATH_KNIGHT_BLOOD=398;this.ID_CATA_DEATH_KNIGHT_FROST=399;this.ID_CATA_DEATH_KNIGHT_UNHOLY=400;this.ID_CATA_DRUID_BALANCE=752;this.ID_CATA_DRUID_FERAL_COMBAT=750;this.ID_CATA_DRUID_RESTORATION=748;this.ID_CATA_HUNTER_BEAST_MASTERY=811;this.ID_CATA_HUNTER_MARKSMANSHIP=807;this.ID_CATA_HUNTER_SURVIVAL=809;this.ID_CATA_MAGE_ARCANE=799;this.ID_CATA_MAGE_FIRE=851;this.ID_CATA_MAGE_FROST=823;this.ID_CATA_PALADIN_HOLY=831;this.ID_CATA_PALADIN_PROTECTION=839;this.ID_CATA_PALADIN_RETRIBUTION=855;this.ID_CATA_PRIEST_DISCIPLINE=760;this.ID_CATA_PRIEST_HOLY=813;this.ID_CATA_PRIEST_SHADOW=795;this.ID_CATA_ROGUE_ASSASSINATION=182;this.ID_CATA_ROGUE_COMBAT=181;this.ID_CATA_ROGUE_SUBTLETY=183;this.ID_CATA_SHAMAN_ELEMENTAL=261;this.ID_CATA_SHAMAN_ENHANCEMENT=263;this.ID_CATA_SHAMAN_RESTORATION=262;this.ID_CATA_WARLOCK_AFFLICTION=871;this.ID_CATA_WARLOCK_DEMONOLOGY=867;this.ID_CATA_WARLOCK_DESTRUCTION=865;this.ID_CATA_WARRIOR_ARMS=746;this.ID_CATA_WARRIOR_FURY=815;this.ID_CATA_WARRIOR_PROTECTION=845;this.ROLE_TANK=0;this.ROLE_HEAL=1;this.ROLE_DPS=2;const n={};n[WH.dataEnv.CLASSIC]={};n[WH.dataEnv.CLASSIC][i.DRUID]=[this.ID_CLASSIC_DRUID_BALANCE,this.ID_CLASSIC_DRUID_FERAL_COMBAT,this.ID_CLASSIC_DRUID_RESTORATION];n[WH.dataEnv.CLASSIC][i.HUNTER]=[this.ID_CLASSIC_HUNTER_BEAST_MASTERY,this.ID_CLASSIC_HUNTER_MARKSMANSHIP,this.ID_CLASSIC_HUNTER_SURVIVAL];n[WH.dataEnv.CLASSIC][i.MAGE]=[this.ID_CLASSIC_MAGE_ARCANE,this.ID_CLASSIC_MAGE_FIRE,this.ID_CLASSIC_MAGE_FROST];n[WH.dataEnv.CLASSIC][i.PALADIN]=[this.ID_CLASSIC_PALADIN_HOLY,this.ID_CLASSIC_PALADIN_PROTECTION,this.ID_CLASSIC_PALADIN_RETRIBUTION];n[WH.dataEnv.CLASSIC][i.PRIEST]=[this.ID_CLASSIC_PRIEST_DISCIPLINE,this.ID_CLASSIC_PRIEST_HOLY,this.ID_CLASSIC_PRIEST_SHADOW];n[WH.dataEnv.CLASSIC][i.ROGUE]=[this.ID_CLASSIC_ROGUE_ASSASSINATION,this.ID_CLASSIC_ROGUE_COMBAT,this.ID_CLASSIC_ROGUE_SUBTLETY];n[WH.dataEnv.CLASSIC][i.SHAMAN]=[this.ID_CLASSIC_SHAMAN_ELEMENTAL,this.ID_CLASSIC_SHAMAN_ENHANCEMENT,this.ID_CLASSIC_SHAMAN_RESTORATION];n[WH.dataEnv.CLASSIC][i.WARLOCK]=[this.ID_CLASSIC_WARLOCK_AFFLICTION,this.ID_CLASSIC_WARLOCK_DEMONOLOGY,this.ID_CLASSIC_WARLOCK_DESTRUCTION];n[WH.dataEnv.CLASSIC][i.WARRIOR]=[this.ID_CLASSIC_WARRIOR_ARMS,this.ID_CLASSIC_WARRIOR_FURY,this.ID_CLASSIC_WARRIOR_PROTECTION];n[WH.dataEnv.TBC]=n[WH.dataEnv.CLASSIC];n[WH.dataEnv.WRATH]={...n[WH.dataEnv.CLASSIC]};n[WH.dataEnv.WRATH][i.DEATH_KNIGHT]=[this.ID_CLASSIC_DEATH_KNIGHT_BLOOD,this.ID_CLASSIC_DEATH_KNIGHT_FROST,this.ID_CLASSIC_DEATH_KNIGHT_UNHOLY];n[WH.dataEnv.CATA]={};n[WH.dataEnv.CATA][i.DEATH_KNIGHT]=[this.ID_CATA_DEATH_KNIGHT_BLOOD,this.ID_CATA_DEATH_KNIGHT_FROST,this.ID_CATA_DEATH_KNIGHT_UNHOLY];n[WH.dataEnv.CATA][i.DRUID]=[this.ID_CATA_DRUID_BALANCE,this.ID_CATA_DRUID_FERAL_COMBAT,this.ID_CATA_DRUID_RESTORATION];n[WH.dataEnv.CATA][i.HUNTER]=[this.ID_CATA_HUNTER_BEAST_MASTERY,this.ID_CATA_HUNTER_MARKSMANSHIP,this.ID_CATA_HUNTER_SURVIVAL];n[WH.dataEnv.CATA][i.MAGE]=[this.ID_CATA_MAGE_ARCANE,this.ID_CATA_MAGE_FIRE,this.ID_CATA_MAGE_FROST];n[WH.dataEnv.CATA][i.PALADIN]=[this.ID_CATA_PALADIN_HOLY,this.ID_CATA_PALADIN_PROTECTION,this.ID_CATA_PALADIN_RETRIBUTION];n[WH.dataEnv.CATA][i.PRIEST]=[this.ID_CATA_PRIEST_DISCIPLINE,this.ID_CATA_PRIEST_HOLY,this.ID_CATA_PRIEST_SHADOW];n[WH.dataEnv.CATA][i.ROGUE]=[this.ID_CATA_ROGUE_ASSASSINATION,this.ID_CATA_ROGUE_COMBAT,this.ID_CATA_ROGUE_SUBTLETY];n[WH.dataEnv.CATA][i.SHAMAN]=[this.ID_CATA_SHAMAN_ELEMENTAL,this.ID_CATA_SHAMAN_ENHANCEMENT,this.ID_CATA_SHAMAN_RESTORATION];n[WH.dataEnv.CATA][i.WARLOCK]=[this.ID_CATA_WARLOCK_AFFLICTION,this.ID_CATA_WARLOCK_DEMONOLOGY,this.ID_CATA_WARLOCK_DESTRUCTION];n[WH.dataEnv.CATA][i.WARRIOR]=[this.ID_CATA_WARRIOR_ARMS,this.ID_CATA_WARRIOR_FURY,this.ID_CATA_WARRIOR_PROTECTION];n[WH.dataEnv.MISTS]={[i.DEATH_KNIGHT]:[this.ID_DEATH_KNIGHT_BLOOD,this.ID_DEATH_KNIGHT_FROST,this.ID_DEATH_KNIGHT_UNHOLY],[i.DRUID]:[this.ID_DRUID_BALANCE,this.ID_DRUID_FERAL,this.ID_DRUID_GUARDIAN,this.ID_DRUID_RESTORATION],[i.HUNTER]:[this.ID_HUNTER_BEAST_MASTERY,this.ID_HUNTER_MARKSMANSHIP,this.ID_HUNTER_SURVIVAL],[i.MAGE]:[this.ID_MAGE_ARCANE,this.ID_MAGE_FIRE,this.ID_MAGE_FROST],[i.MONK]:[this.ID_MONK_BREWMASTER,this.ID_MONK_MISTWEAVER,this.ID_MONK_WINDWALKER],[i.PALADIN]:[this.ID_PALADIN_HOLY,this.ID_PALADIN_PROTECTION,this.ID_PALADIN_RETRIBUTION],[i.PRIEST]:[this.ID_PRIEST_DISCIPLINE,this.ID_PRIEST_HOLY,this.ID_PRIEST_SHADOW],[i.ROGUE]:[this.ID_ROGUE_ASSASSINATION,this.ID_ROGUE_OUTLAW,this.ID_ROGUE_SUBTLETY],[i.SHAMAN]:[this.ID_SHAMAN_ELEMENTAL,this.ID_SHAMAN_ENHANCEMENT,this.ID_SHAMAN_RESTORATION],[i.WARLOCK]:[this.ID_WARLOCK_AFFLICTION,this.ID_WARLOCK_DEMONOLOGY,this.ID_WARLOCK_DESTRUCTION],[i.WARRIOR]:[this.ID_WARRIOR_ARMS,this.ID_WARRIOR_FURY,this.ID_WARRIOR_PROTECTION]};n[WH.dataEnv.MAIN]={};n[WH.dataEnv.MAIN][i.DEATH_KNIGHT]=[this.ID_DEATH_KNIGHT_BLOOD,this.ID_DEATH_KNIGHT_FROST,this.ID_DEATH_KNIGHT_UNHOLY];n[WH.dataEnv.MAIN][i.DEMON_HUNTER]=[this.ID_DEMON_HUNTER_HAVOC,this.ID_DEMON_HUNTER_VENGEANCE];n[WH.dataEnv.MAIN][i.DRUID]=[this.ID_DRUID_BALANCE,this.ID_DRUID_FERAL,this.ID_DRUID_GUARDIAN,this.ID_DRUID_RESTORATION];n[WH.dataEnv.MAIN][i.EVOKER]=[this.ID_EVOKER_DEVASTATION,this.ID_EVOKER_PRESERVATION,this.ID_EVOKER_AUGMENTATION];n[WH.dataEnv.MAIN][i.HUNTER]=[this.ID_HUNTER_BEAST_MASTERY,this.ID_HUNTER_MARKSMANSHIP,this.ID_HUNTER_SURVIVAL];n[WH.dataEnv.MAIN][i.MAGE]=[this.ID_MAGE_ARCANE,this.ID_MAGE_FIRE,this.ID_MAGE_FROST];n[WH.dataEnv.MAIN][i.MONK]=[this.ID_MONK_BREWMASTER,this.ID_MONK_MISTWEAVER,this.ID_MONK_WINDWALKER];n[WH.dataEnv.MAIN][i.PALADIN]=[this.ID_PALADIN_HOLY,this.ID_PALADIN_PROTECTION,this.ID_PALADIN_RETRIBUTION];n[WH.dataEnv.MAIN][i.PRIEST]=[this.ID_PRIEST_DISCIPLINE,this.ID_PRIEST_HOLY,this.ID_PRIEST_SHADOW];n[WH.dataEnv.MAIN][i.ROGUE]=[this.ID_ROGUE_ASSASSINATION,this.ID_ROGUE_OUTLAW,this.ID_ROGUE_SUBTLETY];n[WH.dataEnv.MAIN][i.SHAMAN]=[this.ID_SHAMAN_ELEMENTAL,this.ID_SHAMAN_ENHANCEMENT,this.ID_SHAMAN_RESTORATION];n[WH.dataEnv.MAIN][i.WARLOCK]=[this.ID_WARLOCK_AFFLICTION,this.ID_WARLOCK_DEMONOLOGY,this.ID_WARLOCK_DESTRUCTION];n[WH.dataEnv.MAIN][i.WARRIOR]=[this.ID_WARRIOR_ARMS,this.ID_WARRIOR_FURY,this.ID_WARRIOR_PROTECTION];n[WH.dataEnv.BETA]={...n[WH.dataEnv.MAIN]};n[WH.dataEnv.BETA][i.DEMON_HUNTER]=[this.ID_DEMON_HUNTER_HAVOC,this.ID_DEMON_HUNTER_VENGEANCE,this.ID_DEMON_HUNTER_DEVOURER];const s={};s[WH.dataEnv.CLASSIC]={};s[WH.dataEnv.CLASSIC][i.DRUID]={};s[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_BALANCE]="balance";s[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_FERAL_COMBAT]="feral-combat";s[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_RESTORATION]="restoration";s[WH.dataEnv.CLASSIC][i.HUNTER]={};s[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_BEAST_MASTERY]="beast-mastery";s[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_MARKSMANSHIP]="marksmanship";s[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_SURVIVAL]="survival";s[WH.dataEnv.CLASSIC][i.MAGE]={};s[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_ARCANE]="arcane";s[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_FIRE]="fire";s[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_FROST]="frost";s[WH.dataEnv.CLASSIC][i.PALADIN]={};s[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_HOLY]="holy";s[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_PROTECTION]="protection";s[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_RETRIBUTION]="retribution";s[WH.dataEnv.CLASSIC][i.PRIEST]={};s[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_DISCIPLINE]="discipline";s[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_HOLY]="holy";s[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_SHADOW]="shadow";s[WH.dataEnv.CLASSIC][i.ROGUE]={};s[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_ASSASSINATION]="assassination";s[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_COMBAT]="combat";s[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_SUBTLETY]="subtlety";s[WH.dataEnv.CLASSIC][i.SHAMAN]={};s[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_ELEMENTAL]="elemental";s[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_ENHANCEMENT]="enhancement";s[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_RESTORATION]="restoration";s[WH.dataEnv.CLASSIC][i.WARLOCK]={};s[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_AFFLICTION]="affliction";s[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_DEMONOLOGY]="demonology";s[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_DESTRUCTION]="destruction";s[WH.dataEnv.CLASSIC][i.WARRIOR]={};s[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_ARMS]="arms";s[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_FURY]="fury";s[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_PROTECTION]="protection";s[WH.dataEnv.TBC]={...s[WH.dataEnv.CLASSIC]};s[WH.dataEnv.WRATH]={...s[WH.dataEnv.TBC]};s[WH.dataEnv.WRATH][i.DEATH_KNIGHT]={};s[WH.dataEnv.WRATH][i.DEATH_KNIGHT][this.ID_CLASSIC_DEATH_KNIGHT_BLOOD]="blood";s[WH.dataEnv.WRATH][i.DEATH_KNIGHT][this.ID_CLASSIC_DEATH_KNIGHT_FROST]="frost";s[WH.dataEnv.WRATH][i.DEATH_KNIGHT][this.ID_CLASSIC_DEATH_KNIGHT_UNHOLY]="unholy";s[WH.dataEnv.CATA]={};s[WH.dataEnv.CATA][i.DEATH_KNIGHT]={};s[WH.dataEnv.CATA][i.DEATH_KNIGHT][this.ID_CATA_DEATH_KNIGHT_BLOOD]="blood";s[WH.dataEnv.CATA][i.DEATH_KNIGHT][this.ID_CATA_DEATH_KNIGHT_FROST]="frost";s[WH.dataEnv.CATA][i.DEATH_KNIGHT][this.ID_CATA_DEATH_KNIGHT_UNHOLY]="unholy";s[WH.dataEnv.CATA][i.DRUID]={};s[WH.dataEnv.CATA][i.DRUID][this.ID_CATA_DRUID_BALANCE]="balance";s[WH.dataEnv.CATA][i.DRUID][this.ID_CATA_DRUID_FERAL_COMBAT]="feral-combat";s[WH.dataEnv.CATA][i.DRUID][this.ID_CATA_DRUID_RESTORATION]="restoration";s[WH.dataEnv.CATA][i.HUNTER]={};s[WH.dataEnv.CATA][i.HUNTER][this.ID_CATA_HUNTER_BEAST_MASTERY]="beast-mastery";s[WH.dataEnv.CATA][i.HUNTER][this.ID_CATA_HUNTER_MARKSMANSHIP]="marksmanship";s[WH.dataEnv.CATA][i.HUNTER][this.ID_CATA_HUNTER_SURVIVAL]="survival";s[WH.dataEnv.CATA][i.MAGE]={};s[WH.dataEnv.CATA][i.MAGE][this.ID_CATA_MAGE_ARCANE]="arcane";s[WH.dataEnv.CATA][i.MAGE][this.ID_CATA_MAGE_FIRE]="fire";s[WH.dataEnv.CATA][i.MAGE][this.ID_CATA_MAGE_FROST]="frost";s[WH.dataEnv.CATA][i.PALADIN]={};s[WH.dataEnv.CATA][i.PALADIN][this.ID_CATA_PALADIN_HOLY]="holy";s[WH.dataEnv.CATA][i.PALADIN][this.ID_CATA_PALADIN_PROTECTION]="protection";s[WH.dataEnv.CATA][i.PALADIN][this.ID_CATA_PALADIN_RETRIBUTION]="retribution";s[WH.dataEnv.CATA][i.PRIEST]={};s[WH.dataEnv.CATA][i.PRIEST][this.ID_CATA_PRIEST_DISCIPLINE]="discipline";s[WH.dataEnv.CATA][i.PRIEST][this.ID_CATA_PRIEST_HOLY]="holy";s[WH.dataEnv.CATA][i.PRIEST][this.ID_CATA_PRIEST_SHADOW]="shadow";s[WH.dataEnv.CATA][i.ROGUE]={};s[WH.dataEnv.CATA][i.ROGUE][this.ID_CATA_ROGUE_ASSASSINATION]="assassination";s[WH.dataEnv.CATA][i.ROGUE][this.ID_CATA_ROGUE_COMBAT]="combat";s[WH.dataEnv.CATA][i.ROGUE][this.ID_CATA_ROGUE_SUBTLETY]="subtlety";s[WH.dataEnv.CATA][i.SHAMAN]={};s[WH.dataEnv.CATA][i.SHAMAN][this.ID_CATA_SHAMAN_ELEMENTAL]="elemental";s[WH.dataEnv.CATA][i.SHAMAN][this.ID_CATA_SHAMAN_ENHANCEMENT]="enhancement";s[WH.dataEnv.CATA][i.SHAMAN][this.ID_CATA_SHAMAN_RESTORATION]="restoration";s[WH.dataEnv.CATA][i.WARLOCK]={};s[WH.dataEnv.CATA][i.WARLOCK][this.ID_CATA_WARLOCK_AFFLICTION]="affliction";s[WH.dataEnv.CATA][i.WARLOCK][this.ID_CATA_WARLOCK_DEMONOLOGY]="demonology";s[WH.dataEnv.CATA][i.WARLOCK][this.ID_CATA_WARLOCK_DESTRUCTION]="destruction";s[WH.dataEnv.CATA][i.WARRIOR]={};s[WH.dataEnv.CATA][i.WARRIOR][this.ID_CATA_WARRIOR_ARMS]="arms";s[WH.dataEnv.CATA][i.WARRIOR][this.ID_CATA_WARRIOR_FURY]="fury";s[WH.dataEnv.CATA][i.WARRIOR][this.ID_CATA_WARRIOR_PROTECTION]="protection";s[WH.dataEnv.MISTS]={};s[WH.dataEnv.MISTS][i.DEATH_KNIGHT]={};s[WH.dataEnv.MISTS][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_BLOOD]="blood";s[WH.dataEnv.MISTS][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_FROST]="frost";s[WH.dataEnv.MISTS][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_UNHOLY]="unholy";s[WH.dataEnv.MISTS][i.DRUID]={};s[WH.dataEnv.MISTS][i.DRUID][this.ID_DRUID_BALANCE]="balance";s[WH.dataEnv.MISTS][i.DRUID][this.ID_DRUID_FERAL]="feral";s[WH.dataEnv.MISTS][i.DRUID][this.ID_DRUID_GUARDIAN]="guardian";s[WH.dataEnv.MISTS][i.DRUID][this.ID_DRUID_RESTORATION]="restoration";s[WH.dataEnv.MISTS][i.HUNTER]={};s[WH.dataEnv.MISTS][i.HUNTER][this.ID_HUNTER_BEAST_MASTERY]="beast-mastery";s[WH.dataEnv.MISTS][i.HUNTER][this.ID_HUNTER_MARKSMANSHIP]="marksmanship";s[WH.dataEnv.MISTS][i.HUNTER][this.ID_HUNTER_SURVIVAL]="survival";s[WH.dataEnv.MISTS][i.MAGE]={};s[WH.dataEnv.MISTS][i.MAGE][this.ID_MAGE_ARCANE]="arcane";s[WH.dataEnv.MISTS][i.MAGE][this.ID_MAGE_FIRE]="fire";s[WH.dataEnv.MISTS][i.MAGE][this.ID_MAGE_FROST]="frost";s[WH.dataEnv.MISTS][i.MONK]={};s[WH.dataEnv.MISTS][i.MONK][this.ID_MONK_BREWMASTER]="brewmaster";s[WH.dataEnv.MISTS][i.MONK][this.ID_MONK_MISTWEAVER]="mistweaver";s[WH.dataEnv.MISTS][i.MONK][this.ID_MONK_WINDWALKER]="windwalker";s[WH.dataEnv.MISTS][i.PALADIN]={};s[WH.dataEnv.MISTS][i.PALADIN][this.ID_PALADIN_HOLY]="holy";s[WH.dataEnv.MISTS][i.PALADIN][this.ID_PALADIN_PROTECTION]="protection";s[WH.dataEnv.MISTS][i.PALADIN][this.ID_PALADIN_RETRIBUTION]="retribution";s[WH.dataEnv.MISTS][i.PRIEST]={};s[WH.dataEnv.MISTS][i.PRIEST][this.ID_PRIEST_DISCIPLINE]="discipline";s[WH.dataEnv.MISTS][i.PRIEST][this.ID_PRIEST_HOLY]="holy";s[WH.dataEnv.MISTS][i.PRIEST][this.ID_PRIEST_SHADOW]="shadow";s[WH.dataEnv.MISTS][i.ROGUE]={};s[WH.dataEnv.MISTS][i.ROGUE][this.ID_ROGUE_ASSASSINATION]="assassination";s[WH.dataEnv.MISTS][i.ROGUE][this.ID_ROGUE_OUTLAW]="combat";s[WH.dataEnv.MISTS][i.ROGUE][this.ID_ROGUE_SUBTLETY]="subtlety";s[WH.dataEnv.MISTS][i.SHAMAN]={};s[WH.dataEnv.MISTS][i.SHAMAN][this.ID_SHAMAN_ELEMENTAL]="elemental";s[WH.dataEnv.MISTS][i.SHAMAN][this.ID_SHAMAN_ENHANCEMENT]="enhancement";s[WH.dataEnv.MISTS][i.SHAMAN][this.ID_SHAMAN_RESTORATION]="restoration";s[WH.dataEnv.MISTS][i.WARLOCK]={};s[WH.dataEnv.MISTS][i.WARLOCK][this.ID_WARLOCK_AFFLICTION]="affliction";s[WH.dataEnv.MISTS][i.WARLOCK][this.ID_WARLOCK_DEMONOLOGY]="demonology";s[WH.dataEnv.MISTS][i.WARLOCK][this.ID_WARLOCK_DESTRUCTION]="destruction";s[WH.dataEnv.MISTS][i.WARRIOR]={};s[WH.dataEnv.MISTS][i.WARRIOR][this.ID_WARRIOR_ARMS]="arms";s[WH.dataEnv.MISTS][i.WARRIOR][this.ID_WARRIOR_FURY]="fury";s[WH.dataEnv.MISTS][i.WARRIOR][this.ID_WARRIOR_PROTECTION]="protection";s[WH.dataEnv.MAIN]={};s[WH.dataEnv.MAIN][i.DEATH_KNIGHT]={};s[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_BLOOD]="blood";s[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_FROST]="frost";s[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_UNHOLY]="unholy";s[WH.dataEnv.MAIN][i.DEMON_HUNTER]={};s[WH.dataEnv.MAIN][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_HAVOC]="havoc";s[WH.dataEnv.MAIN][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_VENGEANCE]="vengeance";s[WH.dataEnv.MAIN][i.DRUID]={};s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_BALANCE]="balance";s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_FERAL]="feral";s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_GUARDIAN]="guardian";s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_RESTORATION]="restoration";s[WH.dataEnv.MAIN][i.EVOKER]={[this.ID_EVOKER_AUGMENTATION]:"augmentation",[this.ID_EVOKER_DEVASTATION]:"devastation",[this.ID_EVOKER_PRESERVATION]:"preservation"};s[WH.dataEnv.MAIN][i.HUNTER]={};s[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_BEAST_MASTERY]="beast-mastery";s[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_MARKSMANSHIP]="marksmanship";s[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_SURVIVAL]="survival";s[WH.dataEnv.MAIN][i.MAGE]={};s[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_ARCANE]="arcane";s[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_FIRE]="fire";s[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_FROST]="frost";s[WH.dataEnv.MAIN][i.MONK]={};s[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_BREWMASTER]="brewmaster";s[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_MISTWEAVER]="mistweaver";s[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_WINDWALKER]="windwalker";s[WH.dataEnv.MAIN][i.PALADIN]={};s[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_HOLY]="holy";s[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_PROTECTION]="protection";s[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_RETRIBUTION]="retribution";s[WH.dataEnv.MAIN][i.PRIEST]={};s[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_DISCIPLINE]="discipline";s[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_HOLY]="holy";s[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_SHADOW]="shadow";s[WH.dataEnv.MAIN][i.ROGUE]={};s[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_ASSASSINATION]="assassination";s[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_OUTLAW]="outlaw";s[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_SUBTLETY]="subtlety";s[WH.dataEnv.MAIN][i.SHAMAN]={};s[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_ELEMENTAL]="elemental";s[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_ENHANCEMENT]="enhancement";s[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_RESTORATION]="restoration";s[WH.dataEnv.MAIN][i.WARLOCK]={};s[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_AFFLICTION]="affliction";s[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_DEMONOLOGY]="demonology";s[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_DESTRUCTION]="destruction";s[WH.dataEnv.MAIN][i.WARRIOR]={};s[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_ARMS]="arms";s[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_FURY]="fury";s[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_PROTECTION]="protection";s[WH.dataEnv.BETA]={...s[WH.dataEnv.MAIN]};s[WH.dataEnv.BETA][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_DEVOURER]="devourer";const r={[this.ID_DEATH_KNIGHT_FROST]:137006,[this.ID_DEATH_KNIGHT_UNHOLY]:137007,[this.ID_DEATH_KNIGHT_BLOOD]:137008,[this.ID_DRUID_GUARDIAN]:137010,[this.ID_DRUID_FERAL]:137011,[this.ID_DRUID_RESTORATION]:137012,[this.ID_DRUID_BALANCE]:137013,[this.ID_HUNTER_BEAST_MASTERY]:137015,[this.ID_HUNTER_MARKSMANSHIP]:137016,[this.ID_HUNTER_SURVIVAL]:137017,[this.ID_MAGE_FIRE]:137019,[this.ID_MAGE_FROST]:137020,[this.ID_MAGE_ARCANE]:137021,[this.ID_MONK_BREWMASTER]:137023,[this.ID_MONK_MISTWEAVER]:137024,[this.ID_MONK_WINDWALKER]:137025,[this.ID_PALADIN_RETRIBUTION]:137027,[this.ID_PALADIN_PROTECTION]:137028,[this.ID_PALADIN_HOLY]:137029,[this.ID_PRIEST_HOLY]:137031,[this.ID_PRIEST_DISCIPLINE]:137032,[this.ID_PRIEST_SHADOW]:137033,[this.ID_ROGUE_SUBTLETY]:137035,[this.ID_ROGUE_OUTLAW]:137036,[this.ID_ROGUE_ASSASSINATION]:137037,[this.ID_SHAMAN_RESTORATION]:137039,[this.ID_SHAMAN_ELEMENTAL]:137040,[this.ID_SHAMAN_ENHANCEMENT]:137041,[this.ID_WARLOCK_AFFLICTION]:137043,[this.ID_WARLOCK_DEMONOLOGY]:137044,[this.ID_WARLOCK_DESTRUCTION]:137046,[this.ID_WARRIOR_PROTECTION]:137048,[this.ID_WARRIOR_ARMS]:137049,[this.ID_WARRIOR_FURY]:137050,[this.ID_DEMON_HUNTER_HAVOC]:212612,[this.ID_DEMON_HUNTER_VENGEANCE]:212613,[this.ID_DEMON_HUNTER_DEVOURER]:1213636,[this.ID_EVOKER_DEVASTATION]:356809,[this.ID_EVOKER_PRESERVATION]:356810,[this.ID_EVOKER_AUGMENTATION]:396186};const o={icons:WH.getPageData("wow.playerClass.specialization.icons"),names:WH.getPageData("wow.playerClass.specialization.names"),heroTreeNames:WH.getPageData("wow.playerClass.specialization.heroTreeNames")};this.getAll=function(t){let a=[];i.getAll(t).forEach((function(t){a=a.concat(e.getByClass(t)||[])}));return a};this.getClassId=function(e,t){let a;if(typeof e==="string"){e=parseInt(e);WH.error("Spec ID was incorrect type.")}Object.entries(l(t)).some((([t,i])=>{if(i.includes(e)){a=parseInt(t);return true}}));return a};this.getByClass=function(t,a){let i=l(a);if(!i[t]){return undefined}let n=i[t].slice();n.sort((function(t,a){(e.getName(t)||t.toString()).localeCompare(e.getName(a)||a.toString())}));return n};this.getByIndex=function(e,t,a){let i=l(a);return i[e]&&i[e][t]||undefined};this.getBySlug=function(e,t,a){let n=c(a);let s=i.getBySlug(e,a);if(n[s]){for(let e in n[s]){if(n[s][e]===t){return parseInt(e)}}}return undefined};this.getHeroTreeNames=function(e){return o.heroTreeNames[e]};this.getIconName=function(e){return o.icons[e]};this.getIconUrl=function(t,i){return a.getIconUrl(e.getIconName(t),i)};this.getId=function(e,t){let a=l();if(a[e]){for(let i=0,n;n=a[e][i];i++){if(i+1===t){return n}}}else{WH.error("Tried to get a specialization ID from a non-existent class.",e,t)}WH.error("Could not get a specialization ID for this class and spec.",e,t);return undefined};this.getName=function(e){return o.names[e]};this.getNameWithClass=function(t){return WH.Strings.sprintf(WH.TERMS.specclass_format,e.getName(t),i.getName(i.getBySpec(t)))};this.getNumber=function(e,t,a){let i=l(a);if(i[e]){for(let a=0;a<i[e].length;a++){if(t===i[e][a]){return a+1}}}WH.error("Could not get a specialization number for this class and spec.",e,t);return undefined};this.getRoleName=function(t){switch(t){case e.ROLE_TANK:return WH.TERMS.tank;case e.ROLE_HEAL:return WH.TERMS.healing;case e.ROLE_DPS:return WH.TERMS.dps}};this.getSlug=function(e,t,a){return(c(a)[e]||{})[t]};this.getSpecSpellBySpec=e=>r[e];function l(e){return n[e]||n[WH.getRootEnv(e)]||n[t.getEnv(t.WOW)]}function c(e){return s[e]||s[WH.getRootEnv(e)]||s[t.getEnv(t.WOW)]}};WH.Wow.PlayerHousingModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.Tooltips;const a=WH.Url;const i=20;const n=76;const s={elements:{lightboxContent:undefined,screen:undefined},library:{},libraryLoadedCallbacks:{},ratio:16/9,resizeEventBound:false,shown:false};var r,o,l=[],c,u,d,f,h,p,m;this.applyDataEnv=function(e,t){e.env=e.dataEnv=e.gameDataEnv=WH.getDataEnvKey(t)};this.getBackgroundFilename=function(){return"background-181818.png"};this.getBackgroundUrl=function(t){return WH.STATIC_URL+e.getStaticBase(t)+"/"+e.getBackgroundFilename()};this.getContentPath=t=>{let i=`${e.getStaticBase(t)}/`;if(WH.isDataEnvRestricted(t)){return a.generatePrivate(i)}return""+(WH.isDev()?"https://wow.zamimg.com":WH.STATIC_URL)+i};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return s.library[e]};this.getStaticBase=function(e){return"/modelviewer/"+WH.getDataEnvKey(e)};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}var i=!!s.libraryLoadedCallbacks[a];if(!i){s.libraryLoadedCallbacks[a]=[]}if(t){if(s.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{s.libraryLoadedCallbacks[a].push(t)}}if(i){return}let n=WH.ce("script");let r="";n.src=`${e.getContentPath(a)}viewer-ph/${r}viewer.min.js`;WH.aE(n,"load",(function(){if(window.ZamModelViewer){s.library[a]=window.ZamModelViewer;delete window.ZamModelViewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but ZamModelViewer is still undefined!");return}while(s.libraryLoadedCallbacks[a].length){s.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load ZamModelViewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){d=e;Lightbox.show("modelviewer",{onShow:T,onHide:W},e)};function H(){WH.onLoad(g)}function g(){if(location.hash&&location.hash.indexOf("#modelviewer")==0){var t=location.hash.split(":");if(t.length>=3){t.shift();var a=parseInt(t.shift());var i={type:a,extendedHash:true};switch(a){case WH.Types.DECOR:i.typeId=parseInt(t.shift());break}if(i.typeId){e.showLightbox(i)}}else{var n=WH.ge("wh-mv-view-in-3d-button");if(n){n.click()}}}}function W(){s.shown=false;if(!d.noPound){if(!d.fromTag&&p&&p.indexOf("modelviewer")==-1){WH.setHash(p)}else{WH.clearHash()}}if(f){f.destroy()}if(d.onHide){d.onHide()}}function E(){if(!s.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=s.elements.lightboxContent.offsetWidth;t=s.elements.lightboxContent.offsetHeight;s.elements.screen.style.width="100%";s.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-i;t=window.innerHeight-Lightbox.BLEED_SIZE-n;let a=Math.round(t*(16/9));let r=Math.round(e*(9/16));if(e>a){e=a}else if(t>r){t=r}s.elements.screen.style.width=e+"px";s.elements.screen.style.height=t+"px"}}function _(){let t=d.dataEnv||WH.getDataEnv();if(!e.isLibraryLoaded(t)){e.loadLibrary(_.bind(this),t);return}if(f)f.destroy();var a={mode:"model-viewer",contentPath:e.getContentPath(t),wasmPath:e.getContentPath(t)+"viewer-ph/",container:$(s.elements.screen),aspect:s.ratio,background:e.getBackgroundFilename()};if(c)a.link=c;if(u)a.label=u;e.applyDataEnv(a,t);WH.debug("Creating ZamModelViewer with these options:",JSON.stringify(a),a);e.viewer=f=new(e.getLibrary(t))(a);e.viewer.method("addObject",[6,r]);if(e.viewer.setAdaptiveMode){e.viewer.setAdaptiveMode(true);if(!s.resizeEventBound){WH.aE(window,"resize",E);s.resizeEventBound=true}}E()}function T(e,a,i){m=i;s.shown=true;if(a){e=$(e);e.addClass("has-lightbox-caption modelviewer");s.elements.screen=WH.ce("div",{className:"modelviewer-screen"});s.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(s.elements.lightboxContent,s.elements.screen);e.append(s.elements.lightboxContent);let a=WH.ce("a",{className:"fa fa-arrows-alt",href:"javascript:"});WH.aE(a,"click",(function(){f.setFullscreen(true)}));t.attach(a,WH.TERMS.fullscreen,"q2");WH.ae(s.elements.screen,a);let i=WH.ce("a",{className:"fa fa-pause",href:"javascript:"});const r=()=>i.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play;WH.aE(i,"click",(()=>{f.method("setAnimPaused",i.classList.contains("fa-pause"));i.classList.toggle("fa-play");i.classList.toggle("fa-pause");t.show(i,r(),"q2")}));t.attach(i,r,"q2");WH.ae(s.elements.screen,i);E();e.append($("<a/>",{class:"dialog-option fa fa-times",href:"javascript:",click:Lightbox.hide,text:WH.TERMS.close}));e.append($("<a/>",{class:"dialog-option fa fa-question",href:WH.Url.generatePath("/help=modelviewer"),target:"_blank",text:WH.TERMS.help}));h=$("<div/>",{class:"modelviewer-model"});var n=$("<div/>",{class:"modelviewer-instructions"});n.append(WH.TERMS.modelviewercontrols_tip);e.append(n);var o=$("<div/>",{id:"modelviewer-msg",class:"sub",css:{display:"none","margin-top":"-6px",color:"#ccc","font-size":"13px"}});e.append(o)}h.hide();r=i.typeId;setTimeout(_,1);var l=$("#modelviewer-msg");if(i.message&&l.length>0){l.html(i.message);l.show()}else l.hide();if(i.link)c=i.link;if(i.label)u=i.label;var d="";if(i.fromTag){d+="Custom ";switch(i.type){case WH.Types.DECOR:d+="Decor "+i.typeId;break}}else{switch(i.type){case WH.Types.DECOR:d+="Decor "+i.typeId;break}}WH.Track.interactiveEvent({category:"Model Viewer",action:"Show",label:WH.Strings.slug(d)});p=location.hash}H()}));WH.Wow.ModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.Wow.Expansion;const a=WH.Gatherer;const i=WH.Wow.Gender;const n=WH.Icon;const s=WH.Wow.Item;const r=WH.LocalStorage;const o=WH.Wow.Race;const l=WH.Wow.PlayerClass.Specialization;const c=WH.Tooltips;const u=WH.Types;const d=WH.Url;this.ANIMATION_CHARACTER_CREATE="DressingRoom";this.UNSHEATHED_DEFAULT=-1;const f=[181581];const h={[s.INVENTORY_TYPE_ONE_HAND]:s.INVENTORY_TYPE_MAIN_HAND,[s.INVENTORY_TYPE_TWO_HAND]:s.INVENTORY_TYPE_MAIN_HAND,[s.INVENTORY_TYPE_THROWN]:s.INVENTORY_TYPE_MAIN_HAND,[s.INVENTORY_TYPE_RANGED_RIGHT]:s.INVENTORY_TYPE_MAIN_HAND,[s.INVENTORY_TYPE_RANGED]:s.INVENTORY_TYPE_OFF_HAND,[s.INVENTORY_TYPE_HELD_IN_OFF_HAND]:s.INVENTORY_TYPE_OFF_HAND};const p=[s.INVENTORY_TYPE_HEAD,s.INVENTORY_TYPE_SHOULDERS,s.INVENTORY_TYPE_SHIRT,s.INVENTORY_TYPE_CHEST,s.INVENTORY_TYPE_WAIST,s.INVENTORY_TYPE_LEGS,s.INVENTORY_TYPE_FEET,s.INVENTORY_TYPE_WRISTS,s.INVENTORY_TYPE_HANDS,s.INVENTORY_TYPE_ONE_HAND,s.INVENTORY_TYPE_SHIELD,s.INVENTORY_TYPE_RANGED,s.INVENTORY_TYPE_BACK,s.INVENTORY_TYPE_TWO_HAND,s.INVENTORY_TYPE_TABARD,s.INVENTORY_TYPE_ROBE,s.INVENTORY_TYPE_MAIN_HAND,s.INVENTORY_TYPE_OFF_HAND,s.INVENTORY_TYPE_HELD_IN_OFF_HAND,s.INVENTORY_TYPE_THROWN,s.INVENTORY_TYPE_RANGED_RIGHT];const m=1;const H=2;const g=4;const W=8;const E=16;const _=32;const T=64;const v=128;const S=256;const b=512;const y=1024;const I=WH.getPageData("wow.modelViewer.raceGenderMap")||{};const A=20;const R=76;const N={animationsLoaded:false,elements:{animationSelect:undefined,definition:undefined,gender:undefined,lightboxContent:undefined,race:undefined,screen:undefined},library:{},libraryLoadedCallbacks:{},ratio:16/9,resizeEventBound:false,shouldersOverride:undefined,shown:false};var w,C,M=[],O,L,D,k,P,x,U;this.applyDataEnv=function(e,t){e.env=e.dataEnv=e.gameDataEnv=WH.getDataEnvKey(t)};this.getBackgroundFilename=function(){return"background-181818.png"};this.getBackgroundUrl=function(t){return WH.staticUrl+e.getStaticBase(t)+"/"+e.getBackgroundFilename()};this.getContentPath=t=>{let a=`${e.getStaticBase(t)}/`;if(WH.isDataEnvRestricted(t)){return d.generatePrivate(a)}return""+(WH.isDev()?"https://wow.zamimg.com":WH.STATIC_URL)+a};this.getEffectiveInventoryType=function(e){return h[e]||e};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return N.library[e]};this.getModelId=function(e,t){return I[e]?.[t]??e+"_"+t};this.getModelScreenshotUrl=function(){let e=WH.ge("wh-mv-view-in-3d-button");if(!(e&&e.dataset.mvDisplayId)){return}let t;let a=parseInt(e.dataset.mvType);let i=parseInt(e.dataset.mvTypeId);let n=parseInt(e.dataset.mvDisplayId);if(a===WH.Types.NPC){return WH.Wow.Npc.getThumbUrl(n)}else if(a===WH.Types.ITEM){let e=WH.Gatherer.get(a,i);let t=e&&e.jsonequip&&e.jsonequip.races;let s=WH.Wow.Models.getRaceIdFromMask(t);if(e.classs!==WH.Wow.Item.CLASS_ARMOR){s=undefined}return WH.Wow.Item.getThumbUrl(n,s)}};this.getSheathTypes=function(t,i){let n={mainhand:e.UNSHEATHED_DEFAULT,offhand:e.UNSHEATHED_DEFAULT};if(t){let i=a.get(u.ITEM,t);if(i&&i.jsonequip){n.mainhand=i.jsonequip.sheathtype||e.UNSHEATHED_DEFAULT}}if(i){let t=a.get(u.ITEM,i);if(t&&t.jsonequip){n.offhand=t.jsonequip.sheathtype||e.UNSHEATHED_DEFAULT;if(t.jsonequip.sheathtype===4){n.offhand=9}else if(t.jsonequip.sheathtype===undefined){n.offhand=3}}}return n};this.getStaticBase=function(e){return"/modelviewer/"+WH.getDataEnvKey(e)};this.grabScreenshot=function(e,t){if(!t){t="screenshot";if(g_pageInfo){if(g_pageInfo.name){t=g_pageInfo.name}else{if(g_pageInfo.type&&WH.Types.getReferenceName(g_pageInfo.type)){t=WH.Types.getReferenceName(g_pageInfo.type);if(g_pageInfo.typeId){t+=" "+g_pageInfo.typeId}}}}}var a=$(e.renderer.canvas)[0];var i="fullscreenchange";var n;var s=function(a){if(a){document.removeEventListener(i,n,false)}window.requestAnimationFrame((function(){e.renderer.makeDataURL=["image/png",1];window.requestAnimationFrame((function(){var a=e.renderer.screenshotDataURL;var i=WH.ce("a");i.download=t+".png";i.href=a;i.style.display="none";WH.ae(document.body,i);i.click();if(document.exitFullscreen){document.exitFullscreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}}))}))};if(a.requestFullscreen){document.addEventListener(i,n=s.bind(this,true),false);a.requestFullscreen()}else if(a.webkitRequestFullscreen){i="webkit"+i;document.addEventListener(i,n=s.bind(this,true),false);a.webkitRequestFullscreen()}else if(a.mozRequestFullScreen){i="moz"+i;document.addEventListener(i,n=s.bind(this,true),false);a.mozRequestFullScreen()}else{s(false)}};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}var i=!!N.libraryLoadedCallbacks[a];if(!i){N.libraryLoadedCallbacks[a]=[]}if(t){if(N.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{N.libraryLoadedCallbacks[a].push(t)}}if(i){return}var n=WH.ce("script");let s=WH.getGets().hasOwnProperty("teamLiquid")?"tl/":"";n.src=`${e.getContentPath(a)}viewer/${s}viewer.min.js`;WH.aE(n,"load",(function(){if(window.ZamModelViewer){N.library[a]=window.ZamModelViewer;delete window.ZamModelViewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but ZamModelViewer is still undefined!");return}while(N.libraryLoadedCallbacks[a].length){N.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load ZamModelViewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){D=e;Lightbox.show("modelviewer",{onShow:ae,onHide:J},e)};this.supportsEnchantVisual=function(t){switch(e.getEffectiveInventoryType(t)){case s.INVENTORY_TYPE_MAIN_HAND:case s.INVENTORY_TYPE_OFF_HAND:return true}return false};this.supportsInventoryType=function(e){return p.indexOf(parseInt(e))>=0};function F(){let t=G();let a=t.race;let n=t.gender;if(!a){if(N.elements.gender.style.display==="none"){return}WH.displayNone(N.elements.gender);w=M[1];switch(D.slot){case 1:C=H;break;case 3:C=g;break;default:C=m}}else{if(N.elements.gender.style.display==="none"){WH.displayInline(N.elements.gender)}n=o.validateGender(a,i.tryFrom(parseInt(n))).value;w=e.getModelId(a,n);C=E;r.set(r.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL,{race:parseInt(a),gender:n})}Q();te()}function q(){let t=false;let a=false;let i=function(){return t?WH.TERMS.sheathed:WH.TERMS.unsheathed};let n=WH.ce("a",{className:"fa fa-hand-"+(t?"paper":"rock")+"-o",href:"javascript:"});c.attach(n,i,"q2");WH.aE(n,"click",(function(){t=!t;let o;let l;if(t){(U.itemData||[]).forEach((function(e){let t=s.getInvTypeSlots(e[2]);if(t.includes(WH.Wow.INVENTORY_SLOT_MAIN_HAND)){o=e[0]}else if(t.includes(WH.Wow.INVENTORY_SLOT_OFF_HAND)){l=e[0]}}))}let u=e.getSheathTypes(o,l);U.characterData.sheathMain=u.mainhand;U.characterData.sheathOff=u.offhand;if(k){if(!WH.isClassicTree()){k.method("setSheath",[u.mainhand,u.offhand])}else{k.method("setAppearance",[U.characterData.hairstyle,U.characterData.haircolor,U.characterData.facetype,U.characterData.skincolor,U.characterData.features,U.characterData.haircolor,U.characterData.hornstyle,U.characterData.blindfolds,U.characterData.tattoos,u.mainhand,u.offhand])}}n.classList.toggle("fa-hand-rock-o");n.classList.toggle("fa-hand-paper-o");if(a){c.show(n,i(),"q2")}r.set(r.KEY_WOW_MODEL_VIEWER_SHEATHED,t)}));if(r.get(r.KEY_WOW_MODEL_VIEWER_SHEATHED)===true){n.click()}a=true;return n}function Y(e,t){let a=WH.Gatherer.get(WH.Types.ITEM,e);let i=[];let n=e=>{M[1]=e;w=e;if(G().race){F()}else{te()}};let s=(e,t)=>i.some((i=>[w,M[1]].includes(a.appearances[i.mod][0])&&i.si===parseInt(e)&&(t==null||i.ai===parseInt(t))));let r=[];for(let e in t){let o=t[e];if(Object.keys(o).length){let t=[];for(let r in o){let l=o[r];let c=l.mod;if(a.appearances&&a.appearances[c]&&a.appearances[c][0]){i.push(l);t.push(Menu.createItem({crumb:r,label:WH.ce("span",{className:"artifact-appearance",style:{backgroundColor:"rgba("+WH.Strings.sprintf("%d,%d,%d,1",l.swatchrgb>>16&255,l.swatchrgb>>8&255,l.swatchrgb&255)+")"}}),url:n.bind(null,a.appearances[c][0]),options:{checkedFunc:s.bind(null,e,r)}}))}}r.push(Menu.createItem({crumb:e,label:o["1"]?o["1"].setname:"",submenu:t,options:{checkedFunc:s.bind(null,e,null)}}))}}return r}function B(e,t,a){let i=[];for(let n in e){let s=e[n];let r=WH.ce("span",{className:"spec-variant"},WH.ct(s.specName));let o=Menu.createItem({label:r,url:(e=>{w=e.modelId;WH.st(t,e.specName);te()}).bind(null,s),options:{tinyIcon:WH.Icon.getIconUrl(l.getIconName(s.specId),WH.Icon.TINY),checkedFunc:(e=>e===w).bind(null,s.modelId)}});if(s.modelId===a){WH.st(t,s.specName)}i.push(o)}return i}function G(){return{race:N.elements.race.selectedIndex>=0?N.elements.race.options[N.elements.race.selectedIndex].value:"",gender:N.elements.gender.selectedIndex>=0?N.elements.gender.options[N.elements.gender.selectedIndex].value:0}}function V(){WH.onLoad(X)}function z(t,a){let n;let s;if(a.race!=null&&a.gender!=null){n=a.race;s=a.gender;P.hide();t=false}else{P.show()}if(a.hasOwnProperty("characterData")&&a.characterData.hasOwnProperty("race")){n=a.characterData.race}if(a.hasOwnProperty("characterData")&&a.characterData.hasOwnProperty("gender")){s=a.characterData.gender}if(n==null&&s==null&&location.hash){let e=location.hash.match(/modelviewer:.*?([0-9]+)\+([0-9]+)/);if(e&&K(parseInt(e[1]),parseInt(e[2]))){n=parseInt(e[1]);s=parseInt(e[2]);WH.displayInline(N.elements.gender)}}N.elements.race.options[0].hidden=!t;N.elements.race.options[0].disabled=!t;if(t){N.elements.race.selectedIndex=0;if(s==null){WH.displayNone(N.elements.gender)}}else{if(n==null&&s==null){let e=o.ID_HUMAN;let t=i.Male.value;if(g_user&&g_user.settings&&g_user.settings.defaultModel){e=g_user.settings.defaultModel.race;t=g_user.settings.defaultModel.gender-1}else{let a=r.get(r.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL);if(a&&a.race){e=a.race;t=a.gender}}e=a.defaultRace||e;if(K(e,t)){n=e;s=t}else{n=o.ID_HUMAN;s=i.Male.value}}WH.displayInline(N.elements.gender)}if(s!=null){N.elements.gender.selectedIndex=s}if(n!=null&&s!=null){w=e.getModelId(n,s);C=E;for(let e,t=0;e=N.elements.race.options[t];t++){if(e.value==n){N.elements.race.selectedIndex=t}}for(let e,t=0;e=N.elements.gender.options[t];t++){if(e.value==s){N.elements.gender.selectedIndex=t}}}}function K(e,t){let a=i.tryFrom(t);if(!a){return false}return o.exists(e)&&o.validateGender(e,a)===a}function j(e,t){return WH.inArray([s.INVENTORY_TYPE_SHIRT,s.INVENTORY_TYPE_CHEST,s.INVENTORY_TYPE_WAIST,s.INVENTORY_TYPE_LEGS,s.INVENTORY_TYPE_FEET,s.INVENTORY_TYPE_WRISTS,s.INVENTORY_TYPE_HANDS,s.INVENTORY_TYPE_BACK,s.INVENTORY_TYPE_TABARD,s.INVENTORY_TYPE_ROBE],e)!==-1||f.indexOf(t)!==-1}function Z(){if(N.animationsLoaded){return}if(!k||!k.method("isLoaded")){setTimeout(Z,100);return}WH.ee(N.elements.animationSelect);let t=[];let a=k.method("getNumAnimations");for(let e=0;e<a;e++){let a=k.method("getAnimation",e);if(a&&!t.includes(a)){t.push(a)}}t.sort();t.forEach((function(e){WH.ae(N.elements.animationSelect,WH.ce("option",{value:e},WH.ct(e)))}));let i=t.indexOf(e.ANIMATION_CHARACTER_CREATE);if(i>=0){WH.debug("Setting model viewer animation to:",t[i]);k.method("setAnimation",t[i]);N.elements.animationSelect.selectedIndex=i}N.animationsLoaded=true}function X(){if(location.hash&&location.hash.indexOf("#modelviewer")==0){var t=location.hash.split(":");if(t.length>=3){t.shift();var a=parseInt(t.shift());var i={type:a,extendedHash:true};switch(a){case WH.Types.NPC:i.displayId=parseInt(t.shift());var n=parseInt(t.shift());if(n==1){i.humanoid=1}break;case WH.Types.OBJECT:i.displayId=parseInt(t.shift());break;case WH.Types.ITEM:i.displayId=parseInt(t.shift());i.slot=parseInt(t.shift());break;case WH.Types.ITEM_SET:var s=t.shift();i.equipList=s.split(";");break}if(i.displayId||i.equipList){e.showLightbox(i)}}else{var r=WH.ge("wh-mv-view-in-3d-button");if(r){r.click()}}}}function Q(){let e=[];let t=[WH.Types.ITEM_SET,WH.Types.TRANSMOG_SET,WH.Types.OUTFIT,WH.Types.GEAR_SET];if(t.includes(U.type)&&U.itemData){for(let t in U.itemData){e.push({itemId:U.itemData[t][0],itemBonus:U.itemData[t][1],slot:U.itemData[t][2]})}}if(e.length===0){return}if(U.characterData){let t=$.extend({},U.characterData);t.date=(new Date).getTime();if(!t["class"]&&t.charClass){t["class"]=t.charClass;delete t.charClass}if(Array.isArray(t.charCustomization)){t.charCustomization.forEach((function(e){if(e.optionSlug){t[e.optionSlug]=e.choiceId}}));delete t.charCustomization}e.push(t)}else{let t=G();t.date=(new Date).getTime();e.push(t)}r.set(r.KEY_WOW_MODEL_VIEWER_LAST_MODEL,e)}function J(){N.shown=false;if(!D.noPound){if(!D.fromTag&&x&&x.indexOf("modelviewer")==-1){WH.setHash(x)}else{WH.clearHash()}}if(k){k.destroy()}if(D.onHide){D.onHide()}}function ee(){if(!N.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=N.elements.lightboxContent.offsetWidth;t=N.elements.lightboxContent.offsetHeight;N.elements.screen.style.width="100%";N.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-A;t=window.innerHeight-Lightbox.BLEED_SIZE-R;let a=Math.round(t*(16/9));let i=Math.round(e*(9/16));if(e>a){e=a}else if(t>i){t=i}N.elements.screen.style.width=e+"px";N.elements.screen.style.height=t+"px"}if(e&&t){N.ratio=e/t;if(k&&k.renderer.onResize){k.renderer.onResize(e,t,N.ratio)}}}function te(){let a=D.dataEnv||WH.getDataEnv();if(!e.isLibraryLoaded(a)){e.loadLibrary(te.bind(this),a);return}var i=G();var n=i.race;var s=i.gender;if(k)k.destroy();var o={type:e.getLibrary(a).WOW,contentPath:e.getContentPath(a),container:$(N.elements.screen),aspect:N.ratio,background:e.getBackgroundFilename(),models:{type:C,id:w}};if(U.hasOwnProperty("characterData")){if(U.characterData.race==n&&U.characterData.gender==s){if(!WH.isClassicTree()){o.charCustomization={race:U.characterData.race,gender:U.characterData.gender,options:U.characterData.charCustomization||[]}}else{o.sk=U.characterData.skincolor;o.ha=U.characterData.hairstyle;o.hc=U.characterData.haircolor;o.fa=U.characterData.facetype;o.fh=U.characterData.features;o.fc=U.characterData.haircolor;o.ep=U.characterData.blindfolds;o.ho=U.characterData.hornstyle;o.ta=U.characterData.tattoos}o.cls=U.characterData.charClass}if(r.get(r.KEY_WOW_MODEL_VIEWER_SHEATHED)===true){if(!WH.isClassicTree()){o.charCustomization=o.charCustomization||{};if(U.characterData.hasOwnProperty("sheathMain")){o.charCustomization.sheathMain=U.characterData.sheathMain}if(U.characterData.hasOwnProperty("sheathOff")){o.charCustomization.sheathOff=U.characterData.sheathOff}}else{if(U.characterData.hasOwnProperty("sheathMain")){o.sheathMain=U.characterData.sheathMain}if(U.characterData.hasOwnProperty("sheathOff")){o.sheathOff=U.characterData.sheathOff}}}}if((C==W||C==_||C==E)&&M.length){var l=[];M=[].concat.apply([],M);for(var c=0;c<M.length;c+=2){l.push([M[c],M[c+1]])}o.items=l}if(N.shouldersOverride){o.shouldersOverride=N.shouldersOverride}if(O)o.link=O;if(L)o.label=L;if(!t.available(t.WOD)){o.hd=false}else if(t.available(t.SL)){o.hd=true}if(e.canTakeScreenshots()&&WH.getGets().modelViewerTransparency!==undefined){o.transparent=true;delete o.background;N.elements.screen.style.backgroundImage='url("'+e.getBackgroundUrl(a)+'")'}e.applyDataEnv(o,a);WH.debug("Creating ZamModelViewer with these options:",JSON.stringify(o),o);e.viewer=k=new(e.getLibrary(a))(o);if(e.viewer.setAdaptiveMode){e.viewer.setAdaptiveMode(true);if(!N.resizeEventBound){WH.aE(window,"resize",ee);N.resizeEventBound=true}}ee();if(!D.noPound){var u="#modelviewer";if(D.extendedHash||!WH.ge("wh-mv-view-in-3d-button")){switch(D.type){case WH.Types.NPC:u+=":"+D.type+":"+D.displayId+":"+(D.humanoid|0);break;case WH.Types.OBJECT:u+=":"+D.type+":"+D.displayId;break;case WH.Types.ITEM:u+=":"+D.type+":"+D.displayId+":"+(D.slot|0);break;case WH.Types.ITEM_SET:u+=":"+D.type+":"+M.join(";");break;case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:u+=":"+D.type+":"+M.join(";");break}}if(n&&s){u+=":"+n+"+"+s}else{u+=":"}WH.ee(N.elements.animationSelect);WH.ae(N.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));N.animationsLoaded=false;Z();location.replace(WH.rtrim(u,":"))}}function ae(t,a,r){U=r;N.shown=true;if(a){t=$(t);t.addClass("has-lightbox-caption modelviewer");N.elements.screen=WH.ce("div",{className:"modelviewer-screen"});N.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(N.elements.lightboxContent,N.elements.screen);t.append(N.elements.lightboxContent);let a=WH.ce("a",{className:"fa fa-arrows-alt",href:"javascript:"});WH.aE(a,"click",(function(){k.setFullscreen(true)}));c.attach(a,WH.TERMS.fullscreen,"q2");WH.ae(N.elements.screen,a);let h=WH.ce("a",{className:"fa fa-pause",href:"javascript:"});const p=()=>h.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play;WH.aE(h,"click",(()=>{k.method("setAnimPaused",h.classList.contains("fa-pause"));h.classList.toggle("fa-play");h.classList.toggle("fa-pause");c.show(h,p(),"q2")}));c.attach(h,p,"q2");WH.ae(N.elements.screen,h);if(U.itemData&&U.itemData.length){for(let e=0,t;t=U.itemData[e];e++){let e=s.getInvTypeSlots(t[2]);if(e.includes(WH.Wow.INVENTORY_SLOT_MAIN_HAND)||e.includes(WH.Wow.INVENTORY_SLOT_OFF_HAND)){WH.ae(N.elements.screen,q());break}}}ee();let m=WH.ce("div",{className:"modelviewer-animation"});WH.ae(m,WH.ce("var",undefined,WH.ct(WH.TERMS.animation)));N.elements.animationSelect=WH.ce("select");WH.ae(N.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));WH.aE(N.elements.animationSelect,"change",(function(){let e=N.elements.animationSelect.value;if(e&&k&&k.method("isLoaded")){WH.debug("Setting model viewer animation to:",e);k.method("setAnimation",e)}}));WH.ae(m,N.elements.animationSelect);Z();t.append(m);t.append($("<a/>",{class:"dialog-option fa fa-times",href:"javascript:",click:Lightbox.hide,text:WH.TERMS.close}));t.append($("<a/>",{class:"dialog-option fa fa-question",href:WH.Url.generatePath("/help=modelviewer"),target:"_blank",text:WH.TERMS.help}));if(e.canTakeScreenshots()){t.append($("<a/>",{class:"dialog-option fa fa-camera",href:"javascript:",click:function(){e.grabScreenshot(k)},text:WH.TERMS.screenshot}));let a=WH.ce("a",{className:"dialog-option fa"},WH.ct("Transparency"));t.append(a);if(WH.getGets().modelViewerTransparency===undefined){a.classList.add("fa-square");WH.aE(a,"click",(function(){location.href=d.getModifiedPageQuery((function(e){e.modelViewerTransparency=""}))}))}else{a.classList.add("fa-check-square","fa-color-white");WH.aE(a,"click",(function(){location.href=d.getModifiedPageQuery((function(e){delete e.modelViewerTransparency}))}))}}if(r.modelTileUrl){t.append($("<a/>",{class:"dialog-option fa fa-th-large",href:r.modelTileUrl,text:"Tile"}))}if(r.itemData){let e=WH.ce("div",{className:"modelviewer-slots"});let t=WH.ce("div",{className:"modelviewer-slots-left"});let a=WH.ce("div",{className:"modelviewer-slots-right"});let i=WH.ce("div",{className:"modelviewer-slots-bottom"});WH.ae(e,t);WH.ae(e,a);WH.ae(e,i);WH.ae(N.elements.screen,e);N.elements.screen.dataset.dressingRoomButton="true";WH.ae(e,WH.ce("a",{className:"btn btn-site btn-small modelviewer-dressing-room-link fa fa-male",href:WH.Url.generate("/dressing-room"),text:WH.TERMS.openindressingroom}));let s={};for(let e=0,r;r=g_character_slots_data[e];++e){let o=r.name==="back"?"chest":r.name;s[r.id]=n.create("inventoryslot_"+o,n.MEDIUM,"javascript:");s[r.id].classList.add("modelviewer-slots-noicon");if(r.noModel){s[r.id].style.visibility="hidden"}WH.ae(e<8?t:e<16?a:i,s[r.id])}let o;for(let e=0,t;t=r.itemData[e];e++){if(o=s[t[2]]){n.setName(o,n.MEDIUM,g_items.getIcon(t[0],t[1]).toLowerCase());o.classList.remove("modelviewer-slots-noicon");o.style.visibility=""}}}P=$("<div/>",{class:"modelviewer-model"});var l=o.getPlayableRaceIds();N.elements.race=WH.ce("select");P.append(N.elements.race);WH.aE(N.elements.race,"change",F);WH.ae(N.elements.race,WH.ce("option"));for(let e=0,t=l.length;e<t;++e){WH.ae(N.elements.race,WH.ce("option",{value:l[e],text:o.getName(l[e])}))}N.elements.gender=WH.ce("select");P.append(N.elements.gender);WH.aE(N.elements.gender,"change",F);WH.ae(N.elements.gender,WH.ce("option",{value:i.Male.value,text:i.Male.getName()}));WH.ae(N.elements.gender,WH.ce("option",{value:i.Female.value,text:i.Female.getName()}));WH.displayNone(N.elements.gender);let H=U.artifact&&Object.keys(U.artifact).length>0;let g=$("<a>"+WH.TERMS.artifactappearances+"</a>");g.get(0).style.marginLeft="5px";if(H){Menu.add(g,Y(U.typeId,U.artifact))}let W=U.specVariants&&Object.keys(U.specVariants).length>0;let E=WH.ce("a",{style:{marginLeft:"5px"}},WH.ct(WH.TERMS.specializationvariants));if(W){Menu.add(E,B(U.specVariants,E,r.displayId))}if(H){P.append("<br>");P.append(g)}t.append(P);if(W){t.append("<br>");t.append(E)}var u=$("<div/>",{class:"modelviewer-instructions"});u.append(WH.TERMS.modelviewercontrols_tip);t.append(u);var f=$("<div/>",{id:"modelviewer-msg",class:"sub",css:{display:"none","margin-top":"-6px",color:"#ccc","font-size":"13px"}});t.append(f);if(WH.isSet("g_user")&&g_user.id)$.ajax({url:WH.Url.generatePath("/website-achievement-explored"),data:{trigger:"modelviewer"},success:function(){AchievementCheck()},type:"POST"})}N.shouldersOverride=undefined;switch(r.type){case WH.Types.NPC:P.hide();if(r.humanoid){C=_}else{C=W}if(r.equipList){M=r.equipList}w=r.displayId;break;case WH.Types.OBJECT:P.hide();C=T;w=r.displayId;break;case WH.Types.ITEM:case WH.Types.ITEM_SET:case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:if(r.type==WH.Types.ITEM){M=[r.slot,r.displayId]}else{M=r.equipList}if(r.shouldersOverride&&r.shouldersOverride.length===2){N.shouldersOverride=r.shouldersOverride}if(M.length>2||j(M[0],M[1])||WH.inArray([WH.Types.TRANSMOG_SET,WH.Types.OUTFIT,WH.Types.GEAR_SET],r.type)>=0&&M.length>1){z(false,r)}else{switch(M[0]){case 1:C=H;break;case 3:C=g;break;default:C=m}w=M[1];z(true,r)}break}if(r.fileId){P.hide();C=S;w=r.fileId}setTimeout(te,1);var h=$("#modelviewer-msg");if(r.message&&h.length>0){h.html(r.message);h.show()}else h.hide();if(r.link)O=r.link;if(r.label)L=r.label;var p="";if(r.fromTag){p+="Custom ";switch(r.type){case WH.Types.NPC:p+="NPC "+r.displayId+(r.humanoid?" humanoid":"");break;case WH.Types.OBJECT:p+="Object "+r.displayId;break;case WH.Types.ITEM:p+="Item "+r.displayId+" Slot "+(r.slot|0);break;case WH.Types.ITEM_SET:p+="Item set "+M.join(".");break;case WH.Types.TRANSMOG_SET:p+="Transmog set "+M.join(".");break;case WH.Types.OUTFIT:p+="Outfit "+M.join(".");break;case WH.Types.GEAR_SET:p+="Gear set "+M.join(".");break}}else{switch(r.type){case WH.Types.NPC:p+="NPC "+(r.typeId?r.typeId:" DisplayID "+r.displayId);break;case WH.Types.OBJECT:p+="Object "+r.typeId;break;case WH.Types.ITEM:p+="Item "+r.typeId;break;case WH.Types.ITEM_SET:p+="Item set "+M.join(".");break;case WH.Types.TRANSMOG_SET:p+="Transmog set "+M.join(".");break;case WH.Types.OUTFIT:p+="Outfit "+M.join(".");break;case WH.Types.GEAR_SET:p+="Gear set "+M.join(".");break}}WH.Track.interactiveEvent({category:"Model Viewer",action:"Show",label:WH.Strings.slug(p)});x=location.hash;Q()}V()}));